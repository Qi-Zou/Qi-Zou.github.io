<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>史上最便宜的个人博客网站</title>
      <link href="/2024/07/09/%E5%8F%B2%E4%B8%8A%E6%9C%80%E4%BE%BF%E5%AE%9C%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/"/>
      <url>/2024/07/09/%E5%8F%B2%E4%B8%8A%E6%9C%80%E4%BE%BF%E5%AE%9C%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99/</url>
      
        <content type="html"><![CDATA[<h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>为什么说这是史上最便宜的个人博客网站呢，因为它就是免费的，通过使用hexo可以在本地搭建个人博客，然后通过github pages进行部署，不需要购买服务器，不需要购买域名，不需要购买数据库，只需要一台电脑就可以完成个人博客的搭建，而且还可以通过github进行版本控制，方便以后进行博客的更新和维护。</p><p>但是！！！</p><p>你需要在一个固定的电脑上，搭建hexo、git等等一系列的环境，才能开始写你的博客，一旦脱离了这个电脑，你就无法在这个博客网站上写博文了，虽然我讲构建博客的代码一起放在github的另外仓库进行托管，但是我换电脑，就需要在新电脑上安装必要的环境，才能继续使用，这个安装太过于繁琐，因此我的博文已经很久没有更新了</p><p>但是！！！</p><p>最近发现了一个平台</p><p>就是这个： <a href="https://docs.marscode.cn/introduction#%E8%B1%86%E5%8C%85-marscode-ide">MarsCode IDE</a></p><p>是它让我可以重新使用自己的博客：<a href="https://qi-zou.github.io/">https://qi-zou.github.io/</a></p><p>为什么说它拯救了我的博客网站呢，下面我就介绍一下我的操作流程：</p><h1 id="操作流程"><a href="#操作流程" class="headerlink" title="操作流程"></a>操作流程</h1><ol><li><p>首先进入 <a href="https://www.marscode.cn/dashboard">豆包IDE工作台</a>，正常注册登录就行</p></li><li><p>创建项目，选择从github上导入你的项目，这里我直接选择我的博客网站源代码仓库：<br><img src="image2.png" alt="alt text"></p></li><li><p>创建完成后，就可以直接进入到你的项目了，在这里你可以看到一个类似于VSCode在线编辑器，相当于提供了一个免费的在线服务器给你<br><img src="image3.png" alt="alt text"></p></li><li><p>后面就可以按照hexo的教程，去创建文档，写博客，发布，然后就会看到你的博客更新了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &quot;博客文章&quot;</span><br></pre></td></tr></table></figure><p><img src="image4.png" alt="alt text"></p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 清理</span><br><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line"># 生成</span><br><span class="line">hexo generate</span><br><span class="line"></span><br><span class="line"># 本地运行</span><br><span class="line">hexo s</span><br><span class="line"></span><br><span class="line"># 发布</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><ol start="5"><li>然后就可以通过访问你的博客网站，查看你的博客了，是不是很方便呢<br><img src="image5.png" alt="alt text"></li></ol><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>通过使用MarsCode IDE，我重新使用了自己的博客网站，而且不需要在本地搭建环境，只需要一个浏览器就可以开始写博客了，而且还可以通过github进行版本控制，方便以后进行博客的更新和维护，希望这个平台能够帮助到更多的人，让更多的人能够使用自己的博客网站。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 博客搭建 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python代码创建dify知识库</title>
      <link href="/2024/07/08/python%E4%BB%A3%E7%A0%81%E5%88%9B%E5%BB%BAdify%E7%9F%A5%E8%AF%86%E5%BA%93/"/>
      <url>/2024/07/08/python%E4%BB%A3%E7%A0%81%E5%88%9B%E5%BB%BAdify%E7%9F%A5%E8%AF%86%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h1 id="使用python代码实现dify知识库的搭建案例"><a href="#使用python代码实现dify知识库的搭建案例" class="headerlink" title="使用python代码实现dify知识库的搭建案例"></a>使用python代码实现dify知识库的搭建案例</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>由于dify上构建知识库时，分割文本块不太可控，并且无法读取类似飞书文档这种在线文档的内容，因此这里提供了可以使用python代码完成再dify上构建知识库</p><blockquote><p>小知识：想要读取飞书文档，大家可以试试feishu2md这个开源项目，这个项目可以将在线的飞书文档直接下载成markdown格式的文档，并且还能保存图片到本地，并且markdown格式的文档做分割非常方便</p><p>开源项目地址：<a href="https://github.com/Wsine/feishu2md">GitHub - Wsine/feishu2md: 一键命令下载飞书文档为 Markdown</a></p></blockquote><h1 id="实现代码"><a href="#实现代码" class="headerlink" title="实现代码"></a>实现代码</h1><p>下面就是我实际使用的代码，将本地的文本读取，并导入到知识库中</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">读取渠道履约提供的标签库，导入到知识库中</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommodityKnowledge</span>:</span></span><br><span class="line">    <span class="comment"># 本地</span></span><br><span class="line">    api_key = <span class="string">&quot;dataset-tkRjxM0CmA4Vot3Y4K79xxx&quot;</span></span><br><span class="line">    dataset_url = <span class="string">&quot;http://172.xxx/v1/datasets/&quot;</span></span><br><span class="line">    <span class="comment"># 线上</span></span><br><span class="line">    <span class="comment"># api_key = &quot;dataset-vpVceWuVyZFoYZGe46c9xxx&quot;</span></span><br><span class="line">    <span class="comment"># dataset_url = &quot;http://dify.xxx.com/v1/datasets/&quot;</span></span><br><span class="line">    dataset_name = <span class="string">&quot;商品标签库&quot;</span></span><br><span class="line">    dataset_id = <span class="string">&quot;7d99fecf-39cb-48f4-885b-8b1eb74xxx&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># 根据文本创建文本</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_by_text</span>(<span class="params">self, name, text</span>):</span></span><br><span class="line">        url = <span class="string">f&quot;<span class="subst">&#123;self.dataset_url&#125;</span><span class="subst">&#123;self.dataset_id&#125;</span>/document/create_by_text&quot;</span></span><br><span class="line">        payload = json.dumps(&#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">            <span class="string">&quot;text&quot;</span>: text,</span><br><span class="line">            <span class="string">&quot;indexing_technique&quot;</span>: <span class="string">&quot;high_quality&quot;</span>,</span><br><span class="line">            <span class="string">&quot;process_rule&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;custom&quot;</span>,</span><br><span class="line">                <span class="string">&quot;rules&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;pre_processing_rules&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="string">&quot;id&quot;</span>: <span class="string">&quot;remove_extra_spaces&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;enabled&quot;</span>: <span class="literal">True</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">&quot;segmentation&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;separator&quot;</span>: <span class="string">&quot;\n&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;max_tokens&quot;</span>: <span class="number">1000</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">f&#x27;Bearer <span class="subst">&#123;self.api_key&#125;</span>&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Apifox/1.0.0 (https://apifox.com)&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">        result_json = json.loads(response.text)</span><br><span class="line">        document_id = result_json[<span class="string">&quot;document&quot;</span>][<span class="string">&quot;id&quot;</span>]</span><br><span class="line">        <span class="keyword">return</span> document_id</span><br><span class="line">    <span class="comment"># 新增片段</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_segments</span>(<span class="params">self, text, document_id</span>):</span></span><br><span class="line">        url = <span class="string">f&quot;<span class="subst">&#123;self.dataset_url&#125;</span><span class="subst">&#123;self.dataset_id&#125;</span>/documents/<span class="subst">&#123;document_id&#125;</span>/segments&quot;</span></span><br><span class="line">        payload = json.dumps(&#123;</span><br><span class="line">            <span class="string">&quot;segments&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;content&quot;</span>: text,</span><br><span class="line">                    <span class="string">&quot;keywords&quot;</span>: []</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;)</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">f&#x27;Bearer <span class="subst">&#123;self.api_key&#125;</span>&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Apifox/1.0.0 (https://apifox.com)&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detect_encoding</span>(<span class="params">self, file_path</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            result = chardet.detect(f.read())</span><br><span class="line">        <span class="keyword">return</span> result[<span class="string">&#x27;encoding&#x27;</span>]</span><br><span class="line">    <span class="comment"># 读取标签库</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_label_file</span>(<span class="params">self, file_path</span>):</span></span><br><span class="line">        <span class="comment"># 读取 Excel 文件</span></span><br><span class="line">        df = pd.read_excel(file_path, engine=<span class="string">&#x27;openpyxl&#x27;</span>)</span><br><span class="line">        data = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> index, row <span class="keyword">in</span> df.iterrows():</span><br><span class="line">            name = <span class="string">f&quot;<span class="subst">&#123;row[<span class="string">&#x27;类别&#x27;</span>]&#125;</span>-<span class="subst">&#123;row[<span class="string">&#x27;标签&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line">            document_id = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="comment"># 标签</span></span><br><span class="line">            label_name = row[<span class="string">&#x27;标签&#x27;</span>]</span><br><span class="line">            <span class="comment"># 类别</span></span><br><span class="line">            label_category = row[<span class="string">&#x27;类别&#x27;</span>]</span><br><span class="line">            <span class="comment"># 标签描述</span></span><br><span class="line">            label_description = row[<span class="string">&#x27;标签描述&#x27;</span>]</span><br><span class="line">            <span class="comment"># 如果关键词描述的内容超过500个字符，则每500个字符做分段，并冗余20个字符</span></span><br><span class="line">            label_keywords = self.analyze_keywords(row[<span class="string">&#x27;关键词&#x27;</span>])</span><br><span class="line">            <span class="comment"># label_keywords = json.loads(row[&#x27;关键词&#x27;])</span></span><br><span class="line">            <span class="comment"># 标签类型</span></span><br><span class="line">            label_type = row[<span class="string">&#x27;标签分类&#x27;</span>]</span><br><span class="line">            <span class="keyword">for</span> keyword <span class="keyword">in</span> label_keywords:</span><br><span class="line">                <span class="keyword">if</span> document_id == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                    row_data = self.build_document_block(label_name, label_category, label_description, keyword,</span><br><span class="line">                                                 label_type)</span><br><span class="line">                    document_id = self.create_by_text(name, row_data)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    row_data = self.build_document_block(label_name, label_category, label_description, keyword,</span><br><span class="line">                                                         label_type)</span><br><span class="line">                    self.add_segments(row_data, document_id)</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line">    <span class="comment"># 组装文档块</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build_document_block</span>(<span class="params">self, label_name, label_category, label_description, label_keywords, label_type</span>):</span></span><br><span class="line">        block = &#123;</span><br><span class="line">            <span class="string">&quot;label_name&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_name&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;label_category&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_category&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;label_description&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_description&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;label_keywords&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_keywords&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;label_type&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_type&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(block)</span><br><span class="line">        <span class="keyword">return</span> block</span><br><span class="line">    <span class="comment"># 分析关键词内容</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">analyze_keywords</span>(<span class="params">self, label_keywords</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(label_keywords, <span class="built_in">int</span>) <span class="keyword">or</span> <span class="built_in">isinstance</span>(label_keywords, <span class="built_in">float</span>):  <span class="comment"># 检查数据是否为整数或浮点数</span></span><br><span class="line">            <span class="keyword">return</span> [<span class="built_in">str</span>(label_keywords)]  <span class="comment"># 如果是整数或浮点数，转换为字符串</span></span><br><span class="line">        <span class="keyword">if</span> pd.isna(label_keywords) <span class="keyword">or</span> label_keywords == <span class="literal">None</span> <span class="keyword">or</span> label_keywords == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> [<span class="string">&quot;无&quot;</span>]</span><br><span class="line">        new_keywords_list = []</span><br><span class="line">        <span class="comment"># 直接将标签列表截取为多个段</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(label_keywords) &gt; <span class="number">500</span>:</span><br><span class="line">            <span class="comment"># 获取关键词描述的每个字符</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(label_keywords), <span class="number">500</span>):</span><br><span class="line">                <span class="comment"># 获取每个字符的索引</span></span><br><span class="line">                start = i</span><br><span class="line">                <span class="keyword">if</span> i != <span class="number">0</span>:</span><br><span class="line">                    start = i - <span class="number">20</span></span><br><span class="line">                end = i + <span class="number">500</span></span><br><span class="line">                <span class="comment"># 获取每个字符</span></span><br><span class="line">                segment = label_keywords[start:end]</span><br><span class="line">                new_keywords_list.append(segment)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            new_keywords_list.append(label_keywords)</span><br><span class="line">        <span class="keyword">return</span> new_keywords_list</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    commodity_knowledge = CommodityKnowledge()</span><br><span class="line">    file_path = <span class="string">&quot;C:\\Users\\niuwa.SYOUNGGROUP\\Desktop\\商品评价分类及其关键词.xlsx&quot;</span></span><br><span class="line">    text = commodity_knowledge.read_label_file(file_path)</span><br><span class="line">    <span class="built_in">print</span>(text)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> dify </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客操作说明文档</title>
      <link href="/2024/07/03/hello-world/"/>
      <url>/2024/07/03/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>部署prometheus</title>
      <link href="/2022/02/09/%E9%83%A8%E7%BD%B2prometheus/"/>
      <url>/2022/02/09/%E9%83%A8%E7%BD%B2prometheus/</url>
      
        <content type="html"><![CDATA[<h1 id="材料准备"><a href="#材料准备" class="headerlink" title="材料准备"></a>材料准备</h1><ul><li>prometheus安装包：<a href="https://github.com/prometheus/prometheus/releases/download/v2.33.1/prometheus-2.33.1.linux-amd64.tar.gz">https://github.com/prometheus/prometheus/releases/download/v2.33.1/prometheus-2.33.1.linux-amd64.tar.gz</a></li></ul><h1 id="准备安装"><a href="#准备安装" class="headerlink" title="准备安装"></a>准备安装</h1><ol><li><p>解压安装包，得到如下目录结构：</p><p><img src="image-20220209103225489.png" alt="image-20220209103225489"></p></li><li><p>运行prometheus</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./prometheus --config.file=your_config.yml</span><br></pre></td></tr></table></figure></li><li><p>配置文件</p><p>这是默认自带的配置文件</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my global config</span></span><br><span class="line"><span class="attr">global:</span></span><br><span class="line">  <span class="attr">scrape_interval:</span> <span class="string">15s</span> <span class="comment"># Set the scrape interval to every 15 seconds. Default is every 1 minute.</span></span><br><span class="line">  <span class="attr">evaluation_interval:</span> <span class="string">15s</span> <span class="comment"># Evaluate rules every 15 seconds. The default is every 1 minute.</span></span><br><span class="line">  <span class="comment"># scrape_timeout is set to the global default (10s).</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Alertmanager configuration</span></span><br><span class="line"><span class="attr">alerting:</span></span><br><span class="line">  <span class="attr">alertmanagers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">static_configs:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">targets:</span></span><br><span class="line">          <span class="comment"># - alertmanager:9093</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load rules once and periodically evaluate them according to the global &#x27;evaluation_interval&#x27;.</span></span><br><span class="line"><span class="attr">rule_files:</span></span><br><span class="line">  <span class="comment"># - &quot;first_rules.yml&quot;</span></span><br><span class="line">  <span class="comment"># - &quot;second_rules.yml&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A scrape configuration containing exactly one endpoint to scrape:</span></span><br><span class="line"><span class="comment"># Here it&#x27;s Prometheus itself.</span></span><br><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="comment"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&quot;prometheus&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># metrics_path defaults to &#x27;/metrics&#x27;</span></span><br><span class="line">    <span class="comment"># scheme defaults to &#x27;http&#x27;.</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&quot;localhost:9090&quot;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>下面是我部署时的配置文件</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">global:</span></span><br><span class="line">  <span class="attr">scrape_interval:</span>     <span class="string">15s</span> <span class="comment"># Set the scrape interval to every 15 seconds. Default is every 1 minute.</span></span><br><span class="line">  <span class="attr">evaluation_interval:</span> <span class="string">15s</span> <span class="comment"># Evaluate rules every 15 seconds. The default is every 1 minute.</span></span><br><span class="line">  <span class="comment"># scrape_timeout is set to the global default (10s).</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load rules once and periodically evaluate them according to the global &#x27;evaluation_interval&#x27;.</span></span><br><span class="line"><span class="attr">rule_files:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;rules/*_rule.yml&quot;</span></span><br><span class="line">  <span class="comment"># - &quot;first_rules.yml&quot;</span></span><br><span class="line">  <span class="comment"># - &quot;second_rules.yml&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">alerting:</span></span><br><span class="line">  <span class="attr">alertmanagers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">172.26</span><span class="number">.42</span><span class="number">.215</span><span class="string">:9093</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A scrape configuration containing exactly one endpoint to scrape:</span></span><br><span class="line"><span class="comment"># Here it&#x27;s Prometheus itself.</span></span><br><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="comment"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;prometheus&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=PROMETHEUS</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;node&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=NODE</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;redis&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=REDIS</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=MYSQL</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;cadvisor&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=CADVISOR</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">minio-job</span></span><br><span class="line">    <span class="attr">bearer_token:</span> <span class="string">eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJleHAiOjQ3ODczNjE1MDEsImlzcyI6InByb21ldGhldXMiLCJzdWIiOiJtaW5pb2FkbWluIn0.Sw6Mcmwmx8J3-uU2MAX3BCmMOZyQuugWmwcjE4a2tJ66d8ZG7n85xZBd7kv33iQFz9l5d3ZOoKQi2KvJNd0Klw</span></span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">/minio/v2/metrics/cluster</span></span><br><span class="line">    <span class="attr">scheme:</span> <span class="string">http</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.18.40.91:9000&#x27;</span>]</span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;k8s-node&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.18.40.81:32222&#x27;</span>]</span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;blackbox-exporter&#x27;</span></span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">/probe</span></span><br><span class="line">    <span class="attr">params:</span></span><br><span class="line">      <span class="attr">module:</span> [<span class="string">icmp</span>]  <span class="comment"># Look for a HTTP 200 response.</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.18.40.111&#x27;</span>,<span class="string">&#x27;172.18.40.40&#x27;</span>,<span class="string">&#x27;172.18.40.41&#x27;</span>,<span class="string">&#x27;172.18.40.42&#x27;</span>,<span class="string">&#x27;172.18.40.43&#x27;</span>,<span class="string">&#x27;172.18.40.44&#x27;</span>,<span class="string">&#x27;172.18.40.45&#x27;</span>,<span class="string">&#x27;172.18.40.46&#x27;</span>,<span class="string">&#x27;172.18.40.47&#x27;</span>,<span class="string">&#x27;172.18.40.48&#x27;</span>,<span class="string">&#x27;172.18.40.49&#x27;</span>]</span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">          <span class="attr">group:</span> <span class="string">&#x27;172.26.42.215&#x27;</span></span><br><span class="line">    <span class="attr">relabel_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__address__</span>]</span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">__param_target</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__param_target</span>]</span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">instance</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">target_label:</span> <span class="string">__address__</span></span><br><span class="line">        <span class="attr">replacement:</span> <span class="number">172.26</span><span class="number">.42</span><span class="number">.215</span><span class="string">:9115</span>  <span class="comment"># The blackbox exporter&#x27;s real hostname:port.</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;alertmanager&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=ALERTMANAGER</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;consul-prometheus&#x27;</span></span><br><span class="line">    <span class="attr">consul_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">server:</span> <span class="string">&#x27;172.26.42.215:8500&#x27;</span></span><br><span class="line">      <span class="attr">services:</span> []  </span><br><span class="line">    <span class="attr">relabel_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__meta_consul_tags</span>]</span><br><span class="line">        <span class="attr">regex:</span> <span class="string">.*test.*</span></span><br><span class="line">        <span class="attr">action:</span> <span class="string">keep</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">regex:</span> <span class="string">__meta_consul_service_metadata_(.+)</span></span><br><span class="line">        <span class="attr">action:</span> <span class="string">labelmap</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> prometheus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一次使用k8s部署mysql引发的错误排查历程</title>
      <link href="/2022/01/28/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8k8s%E9%83%A8%E7%BD%B2mysql%E5%BC%95%E5%8F%91%E7%9A%84%E9%94%99%E8%AF%AF%E6%8E%92%E6%9F%A5%E5%8E%86%E7%A8%8B/"/>
      <url>/2022/01/28/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8k8s%E9%83%A8%E7%BD%B2mysql%E5%BC%95%E5%8F%91%E7%9A%84%E9%94%99%E8%AF%AF%E6%8E%92%E6%9F%A5%E5%8E%86%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>问题描述，这是最开始不知道如何排查问题时，看到的最开始的错误如下：</p><blockquote><p>0/3 nodes are available: 1 node(s) had taint {node-role.kubernetes.io/master: }, that the pod didn’t tolerate, 2 node(s) had taint {node.kubernetes.io/not-ready: }, that the pod didn’t tolerate.</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">补充：这是自认为k8s集群已经部署好了的情况下，去部署mysql遇到的错误，通过 kubectl describe pod mysql 查看到的错误</span><br></pre></td></tr></table></figure><p>接下来的一系列操作：</p><blockquote><ol><li><p>查看各节点的节点亲和度</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe node k8s-hostname-1 | grep Taints</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/jgdPCq4V2FEnmQ5.png" alt="image-20220127172204944"></p><p>其中 k8s-hostname-1 为各节点的hostname</p></li><li><p>总共三个节点（一个master，2个node），发现全部都是<code>NoSchedule</code>状态</p></li><li><p>尝试去除污点</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint nodes k8s-hostname-1 node-role.kubernetes.io/master:NoSchedule-</span><br></pre></td></tr></table></figure><p> <img src="https://s2.loli.net/2022/01/28/rHynk3KvifVUuOq.png" alt="image-20220127172504118"></p></li><li><p>虽然提示去除了污点，但是再去查看时，污点依然存在<br><img src="https://s2.loli.net/2022/01/28/WEF8jCXByxdzm9D.png" alt="image-20220127172550251"></p></li><li><p>最后发现，所有的节点状态都是处于 NotReady ，查看其中一个node的详细情况</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get nodes</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/3KymMpNVhzFxGoa.png" alt="image-20220128102317301"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe node k8s-hostname-1</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/3bmdpRXHY4gN7Qi.png" alt="image-20220128102410103"></p></li><li><p>从节点的详情查看到节点的cni插件没有被初始化，网卡的插件没有准备好，导致节点都处于NotReady状态</p></li><li><p>使用 <em>systemctl status kubelet</em> 也可以查看到问题所在<br><img src="https://s2.loli.net/2022/01/28/XTwYnDcgCafbtUQ.png" alt="image-20220128102750449"></p></li><li><p>最后解决办法是重启 containerd 即可</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart containerd</span><br></pre></td></tr></table></figure></li><li><p>此时再看node的污点已经没有了<br><img src="https://s2.loli.net/2022/01/28/ZjxvfaKANOYEM8P.png" alt="image-20220128110644548"></p></li></ol></blockquote><p>到这里，k8s集群 才算是正常的搭建好了，下面继续部署mysql</p><blockquote><ol><li><p>准备好了mysql的pv和deployment的配置文件<br><img src="https://s2.loli.net/2022/01/28/nG3hmJLUCMPFbWa.png" alt="image-20220128111422781"></p></li><li><p>准备安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f mysql-pv.yaml</span><br><span class="line">kubectl apply -f mysql-deployment.yaml</span><br></pre></td></tr></table></figure></li><li><p>随后查看mysql的pod状态，处于ImagePullBackOff</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pod</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/r5x4oVtpayKjWlE.png" alt="image-20220128111558033"></p></li><li><p>查看详情后，发现是镜像无法拉取，这里用的是内部自己搭建的镜像仓库<code>harbor</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe pod mysql-765868998c-9cdxw</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/eCQHihOrsUf43ba.png" alt="image-20220128111959878"></p></li><li><p>通过查询资料，基本都是说的要创建 <code>secret</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create secret docker-registry default --docker-server=harbor.core.powercloud.com --docker-username=admin --docker-password=rootxxx</span><br></pre></td></tr></table></figure></li><li><p>但是创建完成后，依旧无法拉取进行镜像</p></li><li><p>无法拉取私有镜像仓库中的镜像，是需要对containerd进行相应的配置，在找containerd的配置文件时，发现是我将 <code>/etc/containerd/config.toml</code> 文件给删了，通过如下方式可以创建一个默认的文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">containerd config default &gt; /etc/containerd/config.toml</span><br></pre></td></tr></table></figure></li><li></li></ol><p>（待完善）</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用sealos一行命令安装K8S集群</title>
      <link href="/2022/01/26/%E4%BD%BF%E7%94%A8sealos%E4%B8%80%E8%A1%8C%E5%91%BD%E4%BB%A4%E5%AE%89%E8%A3%85K8S%E9%9B%86%E7%BE%A4/"/>
      <url>/2022/01/26/%E4%BD%BF%E7%94%A8sealos%E4%B8%80%E8%A1%8C%E5%91%BD%E4%BB%A4%E5%AE%89%E8%A3%85K8S%E9%9B%86%E7%BE%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="安装前的准备"><a href="#安装前的准备" class="headerlink" title="安装前的准备"></a>安装前的准备</h1><h2 id="材料"><a href="#材料" class="headerlink" title="材料"></a>材料</h2><ul><li>sealos 二进制文件: <a href="https://sealyun.oss-cn-beijing.aliyuncs.com/latest/sealos">https://sealyun.oss-cn-beijing.aliyuncs.com/latest/sealos</a></li><li>离线资源包 kube1.22.0.tar.gz: <a href="https://sealyun.oss-cn-beijing.aliyuncs.com/05a3db657821277f5f3b92d834bbaf98-v1.22.0/kube1.22.0.tar.gz">https://sealyun.oss-cn-beijing.aliyuncs.com/05a3db657821277f5f3b92d834bbaf98-v1.22.0/kube1.22.0.tar.gz</a></li></ul><h2 id="执行安装"><a href="#执行安装" class="headerlink" title="执行安装"></a>执行安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./sealos init --passwd &#x27;root$123&#x27; --master 172.18.40.x1 --node 172.18.40.x2 --node 172.18.40.x3 --pkg-url /root/kube1.22.0.tar.gz --version v1.22.0</span><br></pre></td></tr></table></figure><blockquote><p>其中：</p><p>–passwd 指定服务器的root用户密码</p><p>–master 指定需要安装master节点的服务器</p><p>–node 指定需要安装node节点的服务器</p><p>–pkg-url 指定离线资源包的路径</p><p>–version 指定当前安装的版本（这个需要与离线资源包的版本对应）</p></blockquote><p>等待执行完成后，最终会显示如下信息，至此则表示k8s集群已经安装完成：<br><img src="https://s2.loli.net/2022/01/26/RGCQZ37Xg2qFej8.png" alt="20220126144120"></p><p>如后续还需继续添加节点或删除节点，可以参考如下网址：<br>Swalos的github官网：<a href="https://github.com/fanux/sealos">https://github.com/fanux/sealos</a></p><h1 id="安装中遇到的问题"><a href="#安装中遇到的问题" class="headerlink" title="安装中遇到的问题"></a>安装中遇到的问题</h1><h2 id="系统目录下找不到-crictl"><a href="#系统目录下找不到-crictl" class="headerlink" title="系统目录下找不到 crictl"></a>系统目录下找不到 crictl</h2><p>问题描述：</p><blockquote><p>ERROR FileExisting-crictl]: crictl not found in system path</p></blockquote><p>解决办法：</p><blockquote><p>在github中下载相应版本的 cri-tools，并将下载的压缩包，解压到 <code>/usr/bin/</code> 目录即可</p></blockquote><p>下载目录：<a href="https://github.com/kubernetes-sigs/cri-tools/releases">https://github.com/kubernetes-sigs/cri-tools/releases</a></p><h2 id="unknown-service-runtime-v1alpha2-RuntimeService"><a href="#unknown-service-runtime-v1alpha2-RuntimeService" class="headerlink" title="unknown service runtime.v1alpha2.RuntimeService"></a>unknown service runtime.v1alpha2.RuntimeService</h2><p>问题描述：</p><blockquote><p>[ERROR CRI]: container runtime is not running: output: time=”2022-01-26T14:19:38+08:00” level=fatal msg=”getting status of runtime: rpc error: code = Unimplemented desc = unknown service runtime.v1alpha2.RuntimeService”</p></blockquote><p>解决办法：</p><blockquote><p>rm /etc/containerd/config.toml<br>systemctl restart containerd</p></blockquote><p>参考网址：<a href="https://github.com/kubernetes-sigs/cri-tools/issues/710">https://github.com/kubernetes-sigs/cri-tools/issues/710</a></p><h2 id="node节点中查看node信息报错"><a href="#node节点中查看node信息报错" class="headerlink" title="node节点中查看node信息报错"></a>node节点中查看node信息报错</h2><p>问题描述：</p><blockquote><p>The connection to the server localhost:8080 was refused - did you specify the right host or port?<br><img src="https://s2.loli.net/2022/01/27/pocLw9PCyX4buGi.png" alt="20220127160004"></p></blockquote><p>解决办法：</p><blockquote><p>在master主节点中找到文件<code>/etc/kubernetes/admin.conf</code><br>并将该文件拷贝到 node节点的 <code>$HOME/.kube/config</code> 文件中<br><img src="https://s2.loli.net/2022/01/27/e9mglQG7LvB8NVD.png" alt="20220127160251"></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> sealos </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于中台的初步认识</title>
      <link href="/2022/01/25/%E5%85%B3%E4%BA%8E%E4%B8%AD%E5%8F%B0%E7%9A%84%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/"/>
      <url>/2022/01/25/%E5%85%B3%E4%BA%8E%E4%B8%AD%E5%8F%B0%E7%9A%84%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="背景知识"><a href="#背景知识" class="headerlink" title="背景知识"></a>背景知识</h1><p>根据时间线来探索中台的兴起：<br><strong>2003年</strong>，阿里巴巴成立了淘宝事业部<br><strong>2008年</strong>，阿里巴巴成立了天猫，最初期叫淘宝商城，当时是从淘宝团队中抽调一拨人，作为淘宝事业部中的一个部门进行运营；随着天猫业务的蓬勃发展，没过多久就单独成立了天猫事业部，成为跟淘宝并驾齐驱的两大电商事业部。此时也出现了两个问题：</p><ul><li>淘宝的技术团队同时支持两大电商的业务，淘宝业务需求满足的优先级高于天猫，严重影响了天猫的业务发展</li><li>当时淘宝和天猫是完全独立的两套体系，具备商品、交易、评价、支付等相同的功能</li></ul><p><strong>2009年</strong>，共享业务事业部应运而生，同时支持淘宝和天猫的业务，也将两套电商的业务做了梳理和沉淀，将两个平台中公共的、通用的业务功能沉淀到了共享业务事业部，避免有些功能的重复建设和维护，更合理的利用技术资源。</p><p>但是共享业务事业部的发展事与愿违，在两大业务部门的业务需求下艰难的生存。</p><p><strong>2010年</strong>，聚划算的出现，展现了它强大的流量吸引的威力，据不完全统计，不管是淘宝还是天猫商品，一旦进入聚划算平台，销售额会在短时间内至少增长25倍，随后大家纷纷对接聚划算平台，1688也参与其中，洪流般的业务对接需求让当时成立不久的聚划算团队应接不暇。</p><p>随后集团要求三大电商平台与聚划算平台进行业务对接，必须通过共享业务事业部。</p><p>阿里巴巴“厚平台、薄应用”架构形态逐渐清晰。</p><p>前端业务中公共、通用的业务也沉淀到了这个事业部，包含了用户中心、商品中心、交易中心等。</p><p><strong>2015年</strong>，阿里巴巴带领</p><h1 id="什么是中台"><a href="#什么是中台" class="headerlink" title="什么是中台"></a>什么是中台</h1><h1 id="为什么需要中台"><a href="#为什么需要中台" class="headerlink" title="为什么需要中台"></a>为什么需要中台</h1><h1 id="中台的分类"><a href="#中台的分类" class="headerlink" title="中台的分类"></a>中台的分类</h1>]]></content>
      
      
      
        <tags>
            
            <tag> 中台 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kubernetes 入门&amp;进阶实战</title>
      <link href="/2022/01/25/Kubernetes-%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/"/>
      <url>/2022/01/25/Kubernetes-%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[<p>作为初学者，这篇文章可以很好的入门<br>参考文章：<a href="https://mp.weixin.qq.com/s/mUF0AEncu3T2yDqKyt-0Ow">https://mp.weixin.qq.com/s/mUF0AEncu3T2yDqKyt-0Ow</a></p><p>思维导图：<br><img src="https://s2.loli.net/2022/01/25/gGyXmJ6ortpLW9Q.png" alt="K8S"></p>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java代理模式</title>
      <link href="/2022/01/16/java%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
      <url>/2022/01/16/java%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h1><p>代理模式是一种比较好理解的设计模式，简单来说就是通过代理，可以提到对真是对象的访问，这样就可以在不修改真实对象的情况下，提供额外的功能，扩展目标对象<br>举个例子：<br>你找外卖小哥帮你取餐，外卖小哥就是你的代理对象，代理的行为就是取餐</p><p>代理模式分为：静态代理和动态代理两种实现方式<br>思维导图整理：<br><img src="https://s2.loli.net/2022/01/16/5x4BQIhZVKSGrsb.png" alt="代理模式"></p>]]></content>
      
      
      
        <tags>
            
            <tag> java基础知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>推荐一款超好用的IDEA插件:Sequencediagram</title>
      <link href="/2022/01/12/%E6%8E%A8%E8%8D%90%E4%B8%80%E6%AC%BE%E8%B6%85%E5%A5%BD%E7%94%A8%E7%9A%84IDEA%E6%8F%92%E4%BB%B6-Sequencediagram/"/>
      <url>/2022/01/12/%E6%8E%A8%E8%8D%90%E4%B8%80%E6%AC%BE%E8%B6%85%E5%A5%BD%E7%94%A8%E7%9A%84IDEA%E6%8F%92%E4%BB%B6-Sequencediagram/</url>
      
        <content type="html"><![CDATA[<h1 id="在IDEA中搜索插件并安装"><a href="#在IDEA中搜索插件并安装" class="headerlink" title="在IDEA中搜索插件并安装"></a>在IDEA中搜索插件并安装</h1><p><img src="https://s2.loli.net/2022/01/12/qZKXPfFxYgRLGUN.png" alt="20220112094600"></p><p>插件的访问地址：<a href="https://vanco.github.io/SequencePlugin">https://vanco.github.io/SequencePlugin</a></p><p>插件功能介绍：</p><ul><li>生成简单序列图</li><li>通过单击图表形状来导航代码</li><li>从关系图中删除类</li><li>将图表导出为图像</li><li>将图表导出为Plantuml文件</li><li>也可以通过设置从图表中排除类</li><li>序列图</li><li>智能接口（实验）ambda表达式（实验）</li><li>Kotlin支持（实验性，无代码导航）</li></ul><h1 id="插件的使用"><a href="#插件的使用" class="headerlink" title="插件的使用"></a>插件的使用</h1><ol><li><p>在自己的工程中找到需要生成序列图的方法，右键鼠标<br><img src="https://s2.loli.net/2022/01/12/InYDXkZ5cWRJOgE.png" alt="20220112094952"></p></li><li><p>选择IDEA主界面右上角的<br><img src="https://s2.loli.net/2022/01/12/1oAXb8EVjCtaS4T.png" alt="20220112095037"><br>按钮，或右键鼠标后显示的 Sequence Diagram…选项，即可得到该方法的序列图<br><img src="https://s2.loli.net/2022/01/12/Y4ZEqJ3NawPLsb5.png" alt="20220112095221"></p></li><li><p>选择序列图左边菜单的图片按钮，即可将序列图导出图片<br><img src="https://s2.loli.net/2022/01/12/Ski5aQAKjsJP7lC.png" alt="20220112095319"></p></li><li><p>最终可以得到如下的图片<br><img src="https://s2.loli.net/2022/01/12/ZmEuJrcLalsNVjg.png" alt="HostMoniterServiceImpl_searchBasHostMoniterData"></p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> 好物推荐 </tag>
            
            <tag> IDEA插件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java-String学习</title>
      <link href="/2022/01/11/java-String%E5%AD%A6%E4%B9%A0/"/>
      <url>/2022/01/11/java-String%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="String、StringBuffer和StringBuilder的区别"><a href="#String、StringBuffer和StringBuilder的区别" class="headerlink" title="String、StringBuffer和StringBuilder的区别"></a>String、StringBuffer和StringBuilder的区别</h1><p>从以下几个方面来说：</p><h2 id="可变性"><a href="#可变性" class="headerlink" title="可变性"></a>可变性</h2><p>String 类中使用 final 关键字修饰字符数组来保存字符串，private final char value[]，所以 String 对象是不可变的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span>&lt;<span class="title">String</span>&gt;, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">    <span class="comment">/** The value is used for character storage. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">char</span> value[];</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>而 StringBuilder 与 StringBuffer 都继承自 AbstractStringBuilder 类，在 AbstractStringBuilder 中也是使用字符数组保存字符串char[]value 但是没有用 final 关键字修饰，所以这两种对象都是可变的。</p><blockquote><p>补充：在 Java 9 之后，String 、StringBuilder 与 StringBuffer 的实现改用 byte 数组存储字符串 private final byte[] value</p></blockquote><p>StringBuilder 与 StringBuffer 的构造方法都是调用父类构造方法也就是 AbstractStringBuilder 实现的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBuffer</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractStringBuilder</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">CharSequence</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A cache of the last value returned by toString. Cleared</span></span><br><span class="line"><span class="comment">     * whenever the StringBuffer is modified.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">char</span>[] toStringCache;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** use serialVersionUID from JDK 1.0.2 for interoperability */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">3388685877147921107L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs a string buffer with no characters in it and an</span></span><br><span class="line"><span class="comment">     * initial capacity of 16 characters.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StringBuffer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBuilder</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractStringBuilder</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">CharSequence</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** use serialVersionUID for interoperability */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">4383685877147921099L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs a string builder with no characters in it and an</span></span><br><span class="line"><span class="comment">     * initial capacity of 16 characters.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractStringBuilder</span> <span class="keyword">implements</span> <span class="title">Appendable</span>, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The value is used for character storage.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">char</span>[] value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The count is the number of characters used.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This no-arg constructor is necessary for serialization of subclasses.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    AbstractStringBuilder() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates an AbstractStringBuilder of the specified capacity.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    AbstractStringBuilder(<span class="keyword">int</span> capacity) &#123;</span><br><span class="line">        value = <span class="keyword">new</span> <span class="keyword">char</span>[capacity];</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="线程安全"><a href="#线程安全" class="headerlink" title="线程安全"></a>线程安全</h2><p>String 中的对象是不可变的，也就可以理解为常量，线程安全。</p><p>AbstractStringBuilder 是 StringBuilder 与 StringBuffer 的公共父类，定义了一些字符串的基本操作，如 expandCapacity、append、insert、indexOf 等公共方法。</p><p>StringBuffer 对方法加了同步锁或者对调用的方法加了同步锁，所以是线程安全的。</p><p>StringBuilder 并没有对方法进行加同步锁，所以是非线程安全的。</p><h2 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h2><p>每次对 String 类型进行改变的时候，都会生成一个新的 String 对象，然后将指针指向新的 String 对象。</p><p>StringBuffer 每次都会对 StringBuffer 对象本身进行操作，而不是生成新的对象并改变对象引用。</p><p>相同情况下使用 StringBuilder 相比使用 StringBuffer 仅能获得 10%~15% 左右的性能提升，但却要冒多线程不安全的风险。</p><h2 id="对于三者使用的总结："><a href="#对于三者使用的总结：" class="headerlink" title="对于三者使用的总结："></a>对于三者使用的总结：</h2><p>操作少量的数据: 适用 String<br>单线程操作字符串缓冲区下操作大量数据: 适用 StringBuilder<br>多线程操作字符串缓冲区下操作大量数据: 适用 StringBuffer</p>]]></content>
      
      
      
        <tags>
            
            <tag> java基础知识 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手把手教你如何快速搭建个人博客</title>
      <link href="/2022/01/11/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
      <url>/2022/01/11/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<p>准备中：参考网址<a href="https://segmentfault.com/a/1190000017986794">https://segmentfault.com/a/1190000017986794</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java多线程学习-思维导图</title>
      <link href="/2022/01/10/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AD%A6%E4%B9%A0-%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/"/>
      <url>/2022/01/10/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AD%A6%E4%B9%A0-%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2022/01/10/YxtHcFRTW2uv1qi.png" alt="Java高并发核心编程"></p>]]></content>
      
      
      
        <tags>
            
            <tag> java基础知识 </tag>
            
            <tag> 多线程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>温习springboot</title>
      <link href="/2022/01/10/%E6%B8%A9%E4%B9%A0springboot/"/>
      <url>/2022/01/10/%E6%B8%A9%E4%B9%A0springboot/</url>
      
        <content type="html"><![CDATA[<h1 id="什么是springboot"><a href="#什么是springboot" class="headerlink" title="什么是springboot"></a>什么是springboot</h1><p>Spring Boot 是 Spring 开源组织下的子项目，是 Spring 组件一站式解决方案，主要是简化了使用 Spring 的难度，简省了繁重的配置，提供了各种启动器，开发者能快速上手。</p><h1 id="为什么要用springboot"><a href="#为什么要用springboot" class="headerlink" title="为什么要用springboot"></a>为什么要用springboot</h1><p>Spring Boot 优点非常多，如：</p><p>独立运行<br>简化配置<br>自动配置<br>无代码生成和XML配置<br>应用监控<br>上手容易<br>…<br>Spring Boot 集这么多优点于一身，为什么不用？</p><h1 id="Spring-Boot-的核心配置文件有哪几个？它们的区别是什么？"><a href="#Spring-Boot-的核心配置文件有哪几个？它们的区别是什么？" class="headerlink" title="Spring Boot 的核心配置文件有哪几个？它们的区别是什么？"></a>Spring Boot 的核心配置文件有哪几个？它们的区别是什么？</h1><p>Spring Boot 的核心配置文件是 application 和 bootstrap 配置文件。</p><p>application 配置文件这个容易理解，主要用于 Spring Boot 项目的自动化配置。</p><p>bootstrap 配置文件有以下几个应用场景。</p><ul><li>使用 Spring Cloud Config 配置中心时，这时需要在 bootstrap 配置文件中添加连接到配置中心的配置属性来加载外部配置中心的配置信息；</li><li>一些固定的不能被覆盖的属性；</li><li>一些加密/解密的场景；</li></ul><h1 id="Spring-Boot-的配置文件有哪几种格式？它们有什么区别？"><a href="#Spring-Boot-的配置文件有哪几种格式？它们有什么区别？" class="headerlink" title="Spring Boot 的配置文件有哪几种格式？它们有什么区别？"></a>Spring Boot 的配置文件有哪几种格式？它们有什么区别？</h1><p>.properties 和 .yml，它们的区别主要是书写格式不同。</p><p>1).properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">app.user.name</span> = <span class="string">javastack</span></span><br></pre></td></tr></table></figure><p>2).yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">app:</span></span><br><span class="line">  <span class="attr">user:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">javastack</span></span><br></pre></td></tr></table></figure><p>另外，.yml 格式不支持 @PropertySource 注解导入配置。</p><h1 id="Spring-Boot-的核心注解是哪个？它主要由哪几个注解组成的？"><a href="#Spring-Boot-的核心注解是哪个？它主要由哪几个注解组成的？" class="headerlink" title="Spring Boot 的核心注解是哪个？它主要由哪几个注解组成的？"></a>Spring Boot 的核心注解是哪个？它主要由哪几个注解组成的？</h1><p>启动类上面的注解是@SpringBootApplication，它也是 Spring Boot 的核心注解，主要组合包含了以下 3 个注解：</p><p>@SpringBootConfiguration：组合了 @Configuration 注解，实现配置文件的功能。</p><p>@EnableAutoConfiguration：打开自动配置的功能，也可以关闭某个自动配置的选项，如关闭数据源自动配置功能： @SpringBootApplication(exclude = { DataSourceAutoConfiguration.class })。</p><p>@ComponentScan：Spring组件扫描。</p><h1 id="开启-Spring-Boot-特性有哪几种方式？"><a href="#开启-Spring-Boot-特性有哪几种方式？" class="headerlink" title="开启 Spring Boot 特性有哪几种方式？"></a>开启 Spring Boot 特性有哪几种方式？</h1><p>1）继承spring-boot-starter-parent项目</p><p>2）导入spring-boot-dependencies项目依赖</p><h1 id="Spring-Boot-需要独立的容器运行吗？"><a href="#Spring-Boot-需要独立的容器运行吗？" class="headerlink" title="Spring Boot 需要独立的容器运行吗？"></a>Spring Boot 需要独立的容器运行吗？</h1><p>可以不需要，内置了 Tomcat/ Jetty 等容器。</p><h1 id="运行-Spring-Boot-有哪几种方式？"><a href="#运行-Spring-Boot-有哪几种方式？" class="headerlink" title="运行 Spring Boot 有哪几种方式？"></a>运行 Spring Boot 有哪几种方式？</h1><p>1）打包用命令或者放到容器中运行</p><p>2）用 Maven/ Gradle 插件运行</p><p>3）直接执行 main 方法运行</p><h1 id="Spring-Boot-自动配置原理是什么？"><a href="#Spring-Boot-自动配置原理是什么？" class="headerlink" title="Spring Boot 自动配置原理是什么？"></a>Spring Boot 自动配置原理是什么？</h1><p>注解 @EnableAutoConfiguration, @Configuration, @ConditionalOnClass 就是自动配置的核心，首先它得是一个配置文件，其次根据类路径下是否有这个类去自动配置。</p><h1 id="Spring-Boot-的目录结构是怎样的？"><a href="#Spring-Boot-的目录结构是怎样的？" class="headerlink" title="Spring Boot 的目录结构是怎样的？"></a>Spring Boot 的目录结构是怎样的？</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+- javaproject</span><br><span class="line">    +- MyApplication.java</span><br><span class="line">    |</span><br><span class="line">    +- customer</span><br><span class="line">    |   +- Customer.java</span><br><span class="line">    |   +- CustomerController.java</span><br><span class="line">    |   +- CustomerService.java</span><br><span class="line">    |   +- CustomerRepository.java</span><br><span class="line">    |</span><br><span class="line">    +- order</span><br><span class="line">        +- Order.java</span><br><span class="line">        +- OrderController.java</span><br><span class="line">        +- OrderService.java</span><br><span class="line">        +- OrderRepository.java</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这个目录结构是主流及推荐的做法，而在主入口类上加上 @SpringBootApplication 注解来开启 Spring Boot 的各项能力，如自动配置、组件扫描等。</p><h1 id="你如何理解-Spring-Boot-中的-Starters？"><a href="#你如何理解-Spring-Boot-中的-Starters？" class="headerlink" title="你如何理解 Spring Boot 中的 Starters？"></a>你如何理解 Spring Boot 中的 Starters？</h1><p>Starters可以理解为启动器，它包含了一系列可以集成到应用里面的依赖包，你可以一站式集成 Spring 及其他技术，而不需要到处找示例代码和依赖包。如你想使用 Spring JPA 访问数据库，只要加入 spring-boot-starter-data-jpa 启动器依赖就能使用了。</p><p>Starters包含了许多项目中需要用到的依赖，它们能快速持续的运行，都是一系列得到支持的管理传递性依赖。</p><h1 id="如何在-Spring-Boot-启动的时候运行一些特定的代码？"><a href="#如何在-Spring-Boot-启动的时候运行一些特定的代码？" class="headerlink" title="如何在 Spring Boot 启动的时候运行一些特定的代码？"></a>如何在 Spring Boot 启动的时候运行一些特定的代码？</h1><p>可以实现接口 ApplicationRunner 或者 CommandLineRunner，这两个接口实现方式一样，它们都只提供了一个 run 方法.</p><h1 id="Spring-Boot-有哪几种读取配置的方式？"><a href="#Spring-Boot-有哪几种读取配置的方式？" class="headerlink" title="Spring Boot 有哪几种读取配置的方式？"></a>Spring Boot 有哪几种读取配置的方式？</h1><p>Spring Boot 可以通过 @PropertySource,@Value,@Environment, @ConfigurationProperties 来绑定变量.</p><h1 id="Spring-Boot-支持哪些日志框架？推荐和默认的日志框架是哪个？"><a href="#Spring-Boot-支持哪些日志框架？推荐和默认的日志框架是哪个？" class="headerlink" title="Spring Boot 支持哪些日志框架？推荐和默认的日志框架是哪个？"></a>Spring Boot 支持哪些日志框架？推荐和默认的日志框架是哪个？</h1><p>Spring Boot 支持 Java Util Logging, Log4j2, Lockback 作为日志框架，如果你使用 Starters 启动器，Spring Boot 将使用 Logback 作为默认日志框架</p><h1 id="SpringBoot-实现热部署有哪几种方式？"><a href="#SpringBoot-实现热部署有哪几种方式？" class="headerlink" title="SpringBoot 实现热部署有哪几种方式？"></a>SpringBoot 实现热部署有哪几种方式？</h1><p>主要有两种方式：</p><p>Spring Loaded<br>Spring-boot-devtools</p><h1 id="你如何理解-Spring-Boot-配置加载顺序？"><a href="#你如何理解-Spring-Boot-配置加载顺序？" class="headerlink" title="你如何理解 Spring Boot 配置加载顺序？"></a>你如何理解 Spring Boot 配置加载顺序？</h1><p>在 Spring Boot 里面，可以使用以下几种方式来加载配置。</p><p>1）properties文件；</p><p>2）YAML文件；</p><p>3）系统环境变量；</p><p>4）命令行参数；<br>…</p><h1 id="Spring-Boot-如何定义多套不同环境配置？"><a href="#Spring-Boot-如何定义多套不同环境配置？" class="headerlink" title="Spring Boot 如何定义多套不同环境配置？"></a>Spring Boot 如何定义多套不同环境配置？</h1><p>提供多套配置文件，如：</p><p>applcation.properties</p><p>application-dev.properties</p><p>application-test.properties</p><p>application-prod.properties<br>运行时指定具体的配置文件</p><h1 id="Spring-Boot-可以兼容老-Spring-项目吗，如何做？"><a href="#Spring-Boot-可以兼容老-Spring-项目吗，如何做？" class="headerlink" title="Spring Boot 可以兼容老 Spring 项目吗，如何做？"></a>Spring Boot 可以兼容老 Spring 项目吗，如何做？</h1><p>可以兼容，使用 @ImportResource 注解导入老 Spring 项目配置文件。</p><h1 id="保护-Spring-Boot-应用有哪些方法？"><a href="#保护-Spring-Boot-应用有哪些方法？" class="headerlink" title="保护 Spring Boot 应用有哪些方法？"></a>保护 Spring Boot 应用有哪些方法？</h1><p>在生产中使用HTTPS<br>使用Snyk检查你的依赖关系<br>升级到最新版本<br>启用CSRF保护<br>使用内容安全策略防止XSS攻击<br>…</p><h1 id="Spring-Boot-2-X-有什么新特性？与-1-X-有什么区别？"><a href="#Spring-Boot-2-X-有什么新特性？与-1-X-有什么区别？" class="headerlink" title="Spring Boot 2.X 有什么新特性？与 1.X 有什么区别？"></a>Spring Boot 2.X 有什么新特性？与 1.X 有什么区别？</h1><p>配置变更<br>JDK 版本升级<br>第三方类库升级<br>响应式 Spring 编程支持<br>HTTP/2 支持<br>配置属性绑定<br>更多改进与加强…</p>]]></content>
      
      
      
        <tags>
            
            <tag> springboot学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcode刷题——有效三角形的个数</title>
      <link href="/2022/01/10/Leetcode%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94%E6%9C%89%E6%95%88%E4%B8%89%E8%A7%92%E5%BD%A2%E7%9A%84%E4%B8%AA%E6%95%B0/"/>
      <url>/2022/01/10/Leetcode%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94%E6%9C%89%E6%95%88%E4%B8%89%E8%A7%92%E5%BD%A2%E7%9A%84%E4%B8%AA%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* 给定一个包含非负整数的数组，你的任务是统计其中可以组成三角形三条边的三元组个数。</span><br><span class="line"> *</span><br><span class="line"> * 示例 1:</span><br><span class="line"> * 输入: [2,2,3,4]</span><br><span class="line"> * 输出: 3</span><br><span class="line"> * 解释:</span><br><span class="line"> * 有效的组合是:</span><br><span class="line"> * 2,3,4 (使用第一个 2)</span><br><span class="line"> * 2,3,4 (使用第二个 2)</span><br><span class="line"> * 2,2,3</span><br><span class="line"> *</span><br><span class="line"> * 注意:</span><br><span class="line"> * 数组长度不超过1000。</span><br><span class="line"> * 数组里整数的范围为 [0, 1000]。</span><br><span class="line"> */</span><br></pre></td></tr></table></figure><h1 id="解答"><a href="#解答" class="headerlink" title="解答"></a>解答</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yefan.leetcode;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: zq</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/8/4 09:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 有效三角形的个数</span></span><br><span class="line"><span class="comment">public class NumberOfValidTriangles &#123;</span></span><br><span class="line"><span class="comment">    /*</span></span><br><span class="line"><span class="comment">        二分查找</span></span><br><span class="line"><span class="comment">        首先对数组排序。</span></span><br><span class="line"><span class="comment">        固定最短的两条边，二分查找最后一个小于两边之和的位置。可以求得固定两条边长之和满足条件的结果。枚举结束后，总和就是答案。</span></span><br><span class="line"><span class="comment">        时间复杂度为 O(n^2logn)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">triangleNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">2</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">                <span class="keyword">int</span> s = nums[i] + nums[j];</span><br><span class="line">                <span class="keyword">int</span> l = j + <span class="number">1</span>, r = n - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">                    <span class="keyword">int</span> mid = l + r + <span class="number">1</span> &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (nums[mid] &lt; s) l = mid;</span><br><span class="line">                    <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (nums[r] &lt; s) &#123;</span><br><span class="line">                    res += r - j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Leetcode刷题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVA—反射</title>
      <link href="/2022/01/10/JAVA%E2%80%94%E5%8F%8D%E5%B0%84/"/>
      <url>/2022/01/10/JAVA%E2%80%94%E5%8F%8D%E5%B0%84/</url>
      
        <content type="html"><![CDATA[<h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><blockquote><p>反射(Reflection)是 Java 程序开发语言的特征之一，它允许运行中的 Java 程序获取自身的信息，并且可以操作类或对象的内部属性。</p></blockquote><p><img src="https://s2.loli.net/2022/01/10/lTh9IUbarvERyFw.png" alt="20220110173650"></p><p>举个例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//正常的调用</span></span><br><span class="line">        Apple apple = <span class="keyword">new</span> Apple();</span><br><span class="line">        apple.setPrice(<span class="number">5</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Apple Price:&quot;</span> + apple.getPrice());</span><br><span class="line">        <span class="comment">//使用反射调用</span></span><br><span class="line">        Class clz = Class.forName(<span class="string">&quot;com.chenshuyi.api.Apple&quot;</span>);</span><br><span class="line">        Method setPriceMethod = clz.getMethod(<span class="string">&quot;setPrice&quot;</span>, <span class="keyword">int</span>.class);</span><br><span class="line">        Constructor appleConstructor = clz.getConstructor();</span><br><span class="line">        Object appleObj = appleConstructor.newInstance();</span><br><span class="line">        setPriceMethod.invoke(appleObj, <span class="number">14</span>);</span><br><span class="line">        Method getPriceMethod = clz.getMethod(<span class="string">&quot;getPrice&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Apple Price:&quot;</span> + getPriceMethod.invoke(appleObj));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="获取反射中的Class对象"><a href="#获取反射中的Class对象" class="headerlink" title="获取反射中的Class对象"></a>获取反射中的Class对象</h1><p>在反射中，要获取一个类或调用一个类的方法，我们首先需要获取到该类的 Class 对象。</p><p>在 Java API 中，获取 Class 类对象有三种方法：</p><p><strong>第一种，使用 Class.forName 静态方法。当你知道该类的全路径名时，你可以使用该方法获取 Class 类对象。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Class.forName(<span class="string">&quot;java.lang.String&quot;</span>);</span><br></pre></td></tr></table></figure><p><strong>第二种，使用 .class 方法</strong></p><p>这种方法只适合在编译前就知道操作的 Class。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class clz = String.class;</span><br></pre></td></tr></table></figure><p><strong>第三种，使用类对象的 getClass() 方法。</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="keyword">new</span> String(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">Class clz = str.getClass();</span><br></pre></td></tr></table></figure><h1 id="通过反射创建对象"><a href="#通过反射创建对象" class="headerlink" title="通过反射创建对象"></a>通过反射创建对象</h1><p>通过反射创建类对象主要有两种方式：通过 Class 对象的 newInstance() 方法、通过 Constructor 对象的 newInstance() 方法。</p><p>第一种：通过 Class 对象的 newInstance() 方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Apple apple = (Apple)clz.newInstance();</span><br></pre></td></tr></table></figure><p>第二种：通过 Constructor 对象的 newInstance() 方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Constructor constructor = clz.getConstructor();</span><br><span class="line">Apple apple = (Apple)constructor.newInstance();</span><br></pre></td></tr></table></figure><p>通过 Constructor 对象创建类对象可以选择特定构造方法，而通过 Class 对象则只能使用默认的无参数构造方法。下面的代码就调用了一个有参数的构造方法进行了类对象的初始化。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Constructor constructor = clz.getConstructor(String.class, <span class="keyword">int</span>.class);</span><br><span class="line">Apple apple = (Apple)constructor.newInstance(<span class="string">&quot;红富士&quot;</span>, <span class="number">15</span>);</span><br></pre></td></tr></table></figure><h1 id="通过反射获取类属性、方法、构造器"><a href="#通过反射获取类属性、方法、构造器" class="headerlink" title="通过反射获取类属性、方法、构造器"></a>通过反射获取类属性、方法、构造器</h1><p>我们通过 Class 对象的 getFields() 方法可以获取 Class 类的属性，但无法获取私有属性。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Field[] fields = clz.getFields();</span><br><span class="line"><span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">    System.out.println(field.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果是：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">price</span><br></pre></td></tr></table></figure><p>而如果使用 Class 对象的 getDeclaredFields() 方法则可以获取包括私有属性在内的所有属性：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Field[] fields = clz.getDeclaredFields();</span><br><span class="line"><span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">    System.out.println(field.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果是：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name</span><br><span class="line">price</span><br></pre></td></tr></table></figure><p>与获取类属性一样，当我们去获取类方法、类构造器时，如果要获取私有方法或私有构造器，则必须使用有 declared 关键字的方法。</p>]]></content>
      
      
      
        <tags>
            
            <tag> java基础知识 </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginx访问速度与并发数的限制</title>
      <link href="/2022/01/10/nginx%E8%AE%BF%E9%97%AE%E9%80%9F%E5%BA%A6%E4%B8%8E%E5%B9%B6%E5%8F%91%E6%95%B0%E7%9A%84%E9%99%90%E5%88%B6/"/>
      <url>/2022/01/10/nginx%E8%AE%BF%E9%97%AE%E9%80%9F%E5%BA%A6%E4%B8%8E%E5%B9%B6%E5%8F%91%E6%95%B0%E7%9A%84%E9%99%90%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="限制并发数"><a href="#限制并发数" class="headerlink" title="限制并发数"></a>限制并发数</h1><p>在nginx的配置文件中添加如下配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">http&#123;</span><br><span class="line">    limit_conn_zone $binary_remote_addr zone=one:10m;</span><br><span class="line">    ...</span><br><span class="line">    service&#123;</span><br><span class="line">        ...</span><br><span class="line">        location xxx&#123;</span><br><span class="line">            limit_conn one 1;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/10/zdIQgU5R2BDPyoG.png" alt="20220110133505"><br>这里设置的并发数为 1，表示同一个ip的并发访问数为1 配置好后，重启nginx即可。</p><h1 id="限制访问速度"><a href="#限制访问速度" class="headerlink" title="限制访问速度"></a>限制访问速度</h1><p>在nginx配置文件中添加如下配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location xxx &#123;</span><br><span class="line">    limit_rate 100k;</span><br><span class="line">    ...</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/10/HusKzPQwWaByOgc.png" alt="20220110133605"><br>重启nginx后，可以发现下载速度，确实被限制在 100k/s 左右<br><img src="https://s2.loli.net/2022/01/10/GvflQEUB6p8F7r9.png" alt="20220110133620"></p><h1 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h1><p>这里介绍的是对单个ip进行访问限制，如果说想对总的访问进行限制，可以尝试使用如下方式：</p><blockquote><p>通过nginx的请求转发功能，将所有的请求转发到另外一个端口，而后直接对图示中8889端口进行如上的限制即可<br><img src="https://s2.loli.net/2022/01/10/1awvyOJbl4WqIRM.png" alt="20220110133657"></p></blockquote><p>配置入下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">limit_conn_zone $binary_remote_addr zone=one:10m;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 8888;</span><br><span class="line">        server_name localhost;</span><br><span class="line">    ...</span><br><span class="line">        location ~/grouptest/M0[0-9] &#123;</span><br><span class="line">            proxy_pass http://&lt;本机ip&gt;:8889;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    server &#123;</span><br><span class="line">        listen 8889;</span><br><span class="line">        server_name localhost;</span><br><span class="line">        location xxx &#123;</span><br><span class="line">            limit_conn one 1;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>各中间件的exporter监控对接到prometheus</title>
      <link href="/2022/01/10/%E5%90%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84exporter%E7%9B%91%E6%8E%A7%E5%AF%B9%E6%8E%A5%E5%88%B0prometheus/"/>
      <url>/2022/01/10/%E5%90%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84exporter%E7%9B%91%E6%8E%A7%E5%AF%B9%E6%8E%A5%E5%88%B0prometheus/</url>
      
        <content type="html"><![CDATA[<h1 id="各中间件exporter对接到prometheus的方式"><a href="#各中间件exporter对接到prometheus的方式" class="headerlink" title="各中间件exporter对接到prometheus的方式"></a>各中间件exporter对接到prometheus的方式</h1><p>监控原理：使用prometheus监控各类中间件，则需要部署对应中间件的exporter，再将exporter暴露的指标地址告知prometheus即可<br>首先我们需要知道如何将暴露的地址告知prometheus，主要有如下集中方式：</p><ol><li>修改prometheus配置文件的方式</li><li>修改静态文件的方式</li><li>使用httpd方式</li><li>使用注册中心的方式</li></ol><p>这里只提到修改prometheus配置文件的方式和静态文件的方式（其他方式可以阅读prometheus的官网）</p><p>修改prometheus配置文件如下内容:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;node_exporter&#x27;</span> </span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">8s</span>     <span class="comment"># 采集时间间隔</span></span><br><span class="line">    <span class="attr">file_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">files:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">node_exporter.json</span>  <span class="comment"># 指定静态配置文件</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">10s</span> <span class="comment"># 刷新配置文件</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;redis_exporter&#x27;</span> </span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">8s</span>     <span class="comment"># 采集时间间隔</span></span><br><span class="line">    <span class="attr">file_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">files:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_exporter.json</span>  <span class="comment"># 指定静态配置文件</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">10s</span> <span class="comment"># 刷新配置文件</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;mysql_exporter&#x27;</span> </span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">8s</span>     <span class="comment"># 采集时间间隔</span></span><br><span class="line">    <span class="attr">file_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">files:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_exporter.json</span>  <span class="comment"># 指定静态配置文件</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">10s</span> <span class="comment"># 刷新配置文件</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;zookeeper_exporter&#x27;</span> </span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">8s</span>     <span class="comment"># 采集时间间隔</span></span><br><span class="line">    <span class="attr">file_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">files:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">zookeeper_exporter.json</span>  <span class="comment"># 指定静态配置文件</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">10s</span> <span class="comment"># 刷新配置文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ....以此类推，得出其他中间件exporter的配置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 其中特殊exporter的配置如下</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;blackbox-exporter&#x27;</span></span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">/probe</span></span><br><span class="line">    <span class="attr">params:</span></span><br><span class="line">      <span class="attr">module:</span> [<span class="string">icmp</span>]  <span class="comment"># 网络探测类型</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line"><span class="comment"># 探测目标节点</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.18.40.xxx&#x27;</span>,<span class="string">&#x27;172.18.40.xx1&#x27;</span>,<span class="string">&#x27;172.18.40.xx3&#x27;</span>,<span class="string">&#x27;172.18.40.xx4&#x27;</span>,<span class="string">&#x27;172.18.40.xx5&#x27;</span>]</span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">          <span class="attr">group:</span> <span class="string">&#x27;172.26.42.123&#x27;</span>  <span class="comment"># 自定义标签</span></span><br><span class="line">    <span class="attr">relabel_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__address__</span>]</span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">__param_target</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__param_target</span>]</span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">instance</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">target_label:</span> <span class="string">__address__</span></span><br><span class="line">        <span class="attr">replacement:</span> <span class="number">172.26</span><span class="number">.42</span><span class="number">.123</span><span class="string">:9115</span>  <span class="comment"># blackbox-exporter 真实部署的服务器地址 ip:port</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>而这些静态配置文件的格式如下：这里以node_exporter.json为例</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;targets&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;172.18.40.xxx:9100&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">&quot;labels&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;acc&quot;</span>: <span class="string">&quot;acc1/acc2&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;targets&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;172.18.40.xx1:9100&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">&quot;labels&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;acc&quot;</span>: <span class="string">&quot;acc2/acc3&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>以上将部署的exporter服务告知prometheus的配置方式，配置好后，重启prometheus即可。</p><h1 id="部署各类中间件的exporter"><a href="#部署各类中间件的exporter" class="headerlink" title="部署各类中间件的exporter"></a>部署各类中间件的exporter</h1><h2 id="Mysql-exporter"><a href="#Mysql-exporter" class="headerlink" title="Mysql-exporter"></a>Mysql-exporter</h2><ul><li><strong>部署启动</strong>  首先填写mysql相关的配置，保存在 my.cnf文件中  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">client</span>]</span><br><span class="line"><span class="string">host=127.0.0.1</span></span><br><span class="line"><span class="string">port=3306</span></span><br><span class="line"><span class="string">user=exporter</span></span><br><span class="line"><span class="string">password=123456</span></span><br></pre></td></tr></table></figure>  然后，启动mysql-exporter，并通过config.my-cnf指定上面的配置文件  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认参数启动</span></span><br><span class="line"><span class="string">./mysqld_exporter</span>  <span class="string">--config.my-cnf=/usr/local/prometheus/mysqld_exporter-0.12.1.linux-amd64/my.cnf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 详细的参数</span></span><br><span class="line"><span class="string">./mysqld_exporter</span> <span class="string">--web.listen-address=0.0.0.0:9104</span> <span class="string">--config.my-cnf=/usr/local/prometheus/mysqld_exporter-0.12.1.linux-amd64/my.cnf</span> <span class="string">--collect.slave_status</span> <span class="string">--collect.slave_hosts</span> <span class="string">--log.level=error</span>  <span class="string">--collect.info_schema.processlist</span> <span class="string">--collect.info_schema.innodb_metrics</span> <span class="string">--collect.info_schema.innodb_tablespaces</span> <span class="string">--collect.info_schema.innodb_cmp</span> <span class="string">--collect.info_schema.innodb_cmpmem</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="redis-exporter"><a href="#redis-exporter" class="headerlink" title="redis-exporter"></a>redis-exporter</h2><p><strong>部署启动</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis_exporter  -redis.addr 127.0.0.1:6379  -redis.password 123456 -web.listen-address 0.0.0.0:9121</span><br></pre></td></tr></table></figure><h2 id="nginx-prometheus-exporter"><a href="#nginx-prometheus-exporter" class="headerlink" title="nginx-prometheus-exporter"></a>nginx-prometheus-exporter</h2><p><strong>前提条件</strong></p><p>使用nginx-prometheus-exporter监控nginx时，该nginx必须要开启stub_status功能</p><p>开启 NGINX stub_status 功能</p><ol><li>开源 Nginx 提供一个简单页面用于展示状态数据，该页面由 <a href="http://nginx.org/en/docs/http/ngx_http_stub_status_module.html">tub_status</a> 模块提供。执行以下命令检查 Nginx 是否已经开启了该模块： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -V 2&gt;&amp;1 | grep -o with-http_stub_status_module</span><br></pre></td></tr></table></figure><ul><li>如果在终端中输出 <code>with-http_stub_status_module</code> ，则说明 Nginx 已启用 tub_status 模块。</li><li>如果未输出任何结果，则可以使用 <code>-with-http_stub_status_module</code> 参数从源码重新配置编译一个 Nginx。示例如下：  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./configure \</span><br><span class="line">… \</span><br><span class="line">--with-http_stub_status_module</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure></li></ul></li><li>确认 stub_status 模块启用之后，修改 Nginx 的配置文件指定 status 页面的 URL。示例如下： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    location /nginx_status &#123;</span><br><span class="line">        stub_status;</span><br><span class="line"></span><br><span class="line">        access_log off;</span><br><span class="line">        allow 127.0.0.1;</span><br><span class="line">        deny all;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>检查并重新加载 nginx 的配置使其生效。 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx -t</span><br><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure></li><li>完成上述步之后，可以通过配置的 URL 查看 Nginx 的指标： <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Active connections: 45</span><br><span class="line">server accepts handled requests</span><br><span class="line">1056958 1156958 4491319</span><br><span class="line">Reading: 0 Writing: 25 Waiting : 7</span><br></pre></td></tr></table></figure></li></ol><p><strong>部署启动</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx-prometheus-exporter -nginx.scrape-uri=http://&lt;nginx&gt;:8080/stub_status</span><br></pre></td></tr></table></figure><h2 id="zookeeper-exporter"><a href="#zookeeper-exporter" class="headerlink" title="zookeeper-exporter"></a>zookeeper-exporter</h2><p><strong>启动</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./zookeeper_exporter -zookeeper 127.0.0.1:2181 -bind-addr :9143</span><br></pre></td></tr></table></figure><h2 id="elasticsearch-exporter"><a href="#elasticsearch-exporter" class="headerlink" title="elasticsearch-exporter"></a>elasticsearch-exporter</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 参数说明：</span></span><br><span class="line">--es.uri         　　　　默认http://localhost:9200，连接到的Elasticsearch节点的地址（主机和端口）。 这可以是本地节点（例如localhost：9200），也可以是远程Elasticsearch服务器的地址</span><br><span class="line">--es.all                默认flase，如果为<span class="literal">true</span>，则查询群集中所有节点的统计信息，而不仅仅是查询我们连接到的节点。</span><br><span class="line">--es.cluster_settings   默认flase，如果为<span class="literal">true</span>，请在统计信息中查询集群设置</span><br><span class="line">--es.indices            默认flase，如果为<span class="literal">true</span>，则查询统计信息以获取集群中的所有索引。</span><br><span class="line">--es.indices_settings   默认flase，如果为<span class="literal">true</span>，则查询集群中所有索引的设置统计信息。</span><br><span class="line">--es.shards             默认flase，如果为<span class="literal">true</span>，则查询集群中所有索引的统计信息，包括分片级统计信息（意味着es.indices = <span class="literal">true</span>）。</span><br><span class="line">--es.snapshots          默认flase，如果为<span class="literal">true</span>，则查询集群快照的统计信息。</span><br></pre></td></tr></table></figure><p><strong>部署启动</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># es集群1：10.xxx.xxx.10:9200</span></span><br><span class="line">./elasticsearch_exporter --es.all --es.indices --es.cluster_settings --es.indices_settings --es.shards --es.snapshots --es.timeout=10s --web.listen-address=<span class="string">&quot;:9114&quot;</span> --web.telemetry-path=<span class="string">&quot;/metrics&quot;</span> --es.uri http://10.xxx.xxx.10:9200</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果es集群开启了x-pack验证则可以使用如下</span></span><br><span class="line">./elasticsearch_exporter --es.all --es.indices --es.cluster_settings --es.indices_settings --es.shards --es.snapshots  --es.uri http://用户名:密码@111.xxx.xxx.6:9200</span><br></pre></td></tr></table></figure><h2 id="kafka-exporter"><a href="#kafka-exporter" class="headerlink" title="kafka-exporter"></a>kafka-exporter</h2><p><strong>部署启动</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kafka_exporter --web.listen-address=9308 --kafka.server=kafka:9092 [--kafka.server=another-server ...]</span><br></pre></td></tr></table></figure><p>Grafana Dashboard ID: 7589, name: Kafka Exporter Overview.</p><h2 id="postgresql-exporter"><a href="#postgresql-exporter" class="headerlink" title="postgresql-exporter"></a>postgresql-exporter</h2><p><strong>部署启动</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">./postgres_exporter &lt;flags&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 举例</span></span><br><span class="line"><span class="comment"># 设置环境变量</span></span><br><span class="line">DATA_SOURCE_NAME=<span class="string">&quot;postgresql://postgres:password@localhost:5432/postgres?sslmode=disable&quot;</span></span><br><span class="line"><span class="comment"># 启动，指定端口</span></span><br><span class="line">./postgres_exporter --web.listen-address=9187</span><br></pre></td></tr></table></figure><h3 id="Flags"><a href="#Flags" class="headerlink" title="Flags"></a><strong>Flags</strong></h3><ul><li><code>help</code> Show context-sensitive help (also try –help-long and –help-man).</li><li><code>web.listen-address</code> Address to listen on for web interface and telemetry. Default is <code>:9187</code>.</li><li><code>web.telemetry-path</code> Path under which to expose metrics. Default is <code>/metrics</code>.</li><li><code>disable-default-metrics</code> Use only metrics supplied from <code>queries.yaml</code> via <code>-extend.query-path</code>.</li><li><code>disable-settings-metrics</code> Use the flag if you don’t want to scrape <code>pg_settings</code>.</li><li><code>auto-discover-databases</code> Whether to discover the databases on a server dynamically.</li><li><code>extend.query-path</code> Path to a YAML file containing custom queries to run. Check out <code>[queries.yaml](https://github.com/prometheus-community/postgres_exporter/blob/master/queries.yaml)</code> for examples of the format.</li><li><code>dumpmaps</code> Do not run - print the internal representation of the metric maps. Useful when debugging a custom queries file.</li><li><code>constantLabels</code> Labels to set in all metrics. A list of <code>label=value</code> pairs, separated by commas.</li><li><code>version</code> Show application version.</li><li><code>exclude-databases</code> A list of databases to remove when autoDiscoverDatabases is enabled.</li><li><code>include-databases</code> A list of databases to only include when autoDiscoverDatabases is enabled.</li><li><code>log.level</code> Set logging level: one of <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code>.</li><li><code>log.format</code> Set the log format: one of <code>logfmt</code>, <code>json</code>.</li><li><code>web.config.file</code> Configuration file to use TLS and/or basic authentication. The format of the file is described <a href="https://github.com/prometheus/exporter-toolkit/blob/master/docs/web-configuration.md">in the exporter-toolkit repository</a>.</li></ul><h3 id="Environment-Variables"><a href="#Environment-Variables" class="headerlink" title="Environment Variables"></a><strong>Environment Variables</strong></h3><p>The following environment variables configure the exporter:</p><ul><li><code>DATA_SOURCE_NAME</code> the default legacy format. Accepts URI form and key=value form arguments. The URI may contain the username and password to connect with.</li><li><code>DATA_SOURCE_URI</code> an alternative to <code>DATA_SOURCE_NAME</code> which exclusively accepts the hostname without a username and password component. For example, <code>my_pg_hostname</code> or <code>my_pg_hostname?sslmode=disable</code>.</li><li><code>DATA_SOURCE_URI_FILE</code> The same as above but reads the URI from a file.</li><li><code>DATA_SOURCE_USER</code> When using <code>DATA_SOURCE_URI</code>, this environment variable is used to specify the username.</li><li><code>DATA_SOURCE_USER_FILE</code> The same, but reads the username from a file.</li><li><code>DATA_SOURCE_PASS</code> When using <code>DATA_SOURCE_URI</code>, this environment variable is used to specify the password to connect with.</li><li><code>DATA_SOURCE_PASS_FILE</code> The same as above but reads the password from a file.</li><li><code>PG_EXPORTER_WEB_LISTEN_ADDRESS</code> Address to listen on for web interface and telemetry. Default is <code>:9187</code>.</li><li><code>PG_EXPORTER_WEB_TELEMETRY_PATH</code> Path under which to expose metrics. Default is <code>/metrics</code>.</li><li><code>PG_EXPORTER_DISABLE_DEFAULT_METRICS</code> Use only metrics supplied from <code>queries.yaml</code>. Value can be <code>true</code> or <code>false</code>. Default is <code>false</code>.</li><li><code>PG_EXPORTER_DISABLE_SETTINGS_METRICS</code> Use the flag if you don’t want to scrape <code>pg_settings</code>. Value can be <code>true</code> or <code>false</code>. Default is <code>false</code>.</li><li><code>PG_EXPORTER_AUTO_DISCOVER_DATABASES</code> Whether to discover the databases on a server dynamically. Value can be <code>true</code> or <code>false</code>. Default is <code>false</code>.</li><li><code>PG_EXPORTER_EXTEND_QUERY_PATH</code> Path to a YAML file containing custom queries to run. Check out <code>[queries.yaml](https://github.com/prometheus-community/postgres_exporter/blob/master/queries.yaml)</code> for examples of the format.</li><li><code>PG_EXPORTER_CONSTANT_LABELS</code> Labels to set in all metrics. A list of <code>label=value</code> pairs, separated by commas.</li><li><code>PG_EXPORTER_EXCLUDE_DATABASES</code> A comma-separated list of databases to remove when autoDiscoverDatabases is enabled. Default is empty string.</li><li><code>PG_EXPORTER_INCLUDE_DATABASES</code> A comma-separated list of databases to only include when autoDiscoverDatabases is enabled. Default is empty string, means allow all.</li><li><code>PG_EXPORTER_METRIC_PREFIX</code> A prefix to use for each of the default metrics exported by postgres-exporter. Default is <code>pg</code></li></ul><h2 id="bind-exporter"><a href="#bind-exporter" class="headerlink" title="bind-exporter"></a>bind-exporter</h2><p><strong>部署启动</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">./bind_exporter \</span><br><span class="line">    --bind.pid-file=/var/run/named/named.pid \</span><br><span class="line">    --bind.timeout=20s \</span><br><span class="line">    --web.listen-address=0.0.0.0:9153 \</span><br><span class="line">    --web.telemetry-path=/metrics \</span><br><span class="line">    --bind.stats-url=http://localhost:8053/ \</span><br><span class="line">    --bind.stats-groups=server,view,tasks</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> 云监控 </tag>
            
            <tag> exporter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo butterfly 主题搜索框问题解决</title>
      <link href="/2022/01/10/hexo-butterfly-%E4%B8%BB%E9%A2%98%E6%90%9C%E7%B4%A2%E6%A1%86%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"/>
      <url>/2022/01/10/hexo-butterfly-%E4%B8%BB%E9%A2%98%E6%90%9C%E7%B4%A2%E6%A1%86%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<h1 id="问题说明"><a href="#问题说明" class="headerlink" title="问题说明"></a>问题说明</h1><p>hexo 本地启动个人博客，访问没有任何问题，但是发布到github后，就会出现搜索框跑到界面的最下方<br><img src="https://s2.loli.net/2022/01/10/w8VWauQoRDkdi2p.png" alt="20220110085037"></p><h1 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h1><p>通过查询资料，发现是自己没有在本地执行 <code>hexo clean</code>操作导致的；<br>参考网址：<a href="https://github.com/jerryc127/hexo-theme-butterfly/issues/101">https://github.com/jerryc127/hexo-theme-butterfly/issues/101</a><br><img src="https://s2.loli.net/2022/01/10/u587eHsJTXi9tOK.png" alt="20220110084225"></p>]]></content>
      
      
      
        <tags>
            
            <tag> 个人博客问题 </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>picgo配合SMMS构建自己免费的图床</title>
      <link href="/2022/01/07/picgo%E9%85%8D%E5%90%88SMMS%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E5%85%8D%E8%B4%B9%E7%9A%84%E5%9B%BE%E5%BA%8A/"/>
      <url>/2022/01/07/picgo%E9%85%8D%E5%90%88SMMS%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E5%85%8D%E8%B4%B9%E7%9A%84%E5%9B%BE%E5%BA%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="在SMMS中注册账户"><a href="#在SMMS中注册账户" class="headerlink" title="在SMMS中注册账户"></a>在SMMS中注册账户</h1><ol><li><p>注册账户，smms的访问地址： <a href="https://sm.ms/">https://sm.ms/</a></p></li><li><p>注册好之后，获取smms中的token值<br><img src="https://s2.loli.net/2022/01/07/ha8fmXuCFEv5QBg.png" alt="20220107171943"></p></li></ol><h1 id="在vsCode中使用picGo"><a href="#在vsCode中使用picGo" class="headerlink" title="在vsCode中使用picGo"></a>在vsCode中使用picGo</h1><ol><li><p>安装picGo插件<br><img src="https://s2.loli.net/2022/01/07/deWqRhsKSLGtYcC.png" alt="20220107172133"></p></li><li><p>修改配置，搜索smms，填写自己的smms中的token值<br><img src="https://s2.loli.net/2022/01/07/1qBlGF5Wj9N2cyQ.png" alt="20220107172339"></p></li><li><p>保存后，即可上传文件，操作如下：</p><p> ① 截图操作后，图片保存在了粘贴板中</p><p> ② mac 用户的上传图片的快捷键是：option + command + u </p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">windowns 用户上传图片的快捷键：ctrl + alt + u</span><br></pre></td></tr></table></figure><p> ③ 上传后，vscode界面的又下角可看到如下浮动窗口<br> <img src="https://s2.loli.net/2022/01/07/UCAwFmLlMVyqbvE.png" alt="20220107173047"></p><p> ④ 并在smms中可以看到上传的图片<br> <img src="https://s2.loli.net/2022/01/07/TxtDJSEngwjsbXo.png" alt="20220107173128"></p></li></ol><h1 id="参考网址"><a href="#参考网址" class="headerlink" title="参考网址"></a>参考网址</h1><p>【图床搭配 PicGo：打造高效的图片处理工作流】<a href="https://sspai.com/post/65716">https://sspai.com/post/65716</a><br>【比PicGo更好用的是VSCode里的PicGo插件】<a href="https://kouss.com/2019-7-11">https://kouss.com/2019-7-11</a><br>【SMMS网址】<a href="https://sm.ms/">https://sm.ms/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> picgo </tag>
            
            <tag> 图床 </tag>
            
            <tag> SMMS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>【BUG记录】Java连接mysql数据库报错：Communications link failure</title>
      <link href="/2022/01/07/Java%E8%BF%9E%E6%8E%A5mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%A5%E9%94%99%EF%BC%9ACommunications-link-failure/"/>
      <url>/2022/01/07/Java%E8%BF%9E%E6%8E%A5mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%A5%E9%94%99%EF%BC%9ACommunications-link-failure/</url>
      
        <content type="html"><![CDATA[<h1 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h1><p>java项目（springboot）连接mysql出现如下错误：</p><p><img src="image-20220107152352681.png" alt="image-20220107152352681"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caused by: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure</span><br></pre></td></tr></table></figure><p>项目中配置的jdbc连接地址如下：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">druid.url</span>=<span class="string">jdbc:log4jdbc:mysql://172.18.xxx.xxx:3306/xxxxdb?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=UTC</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>但是通过navicat等工具可以正常的连接</p><p><img src="image-20220107152618747.png" alt="image-20220107152618747"></p><h1 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h1><p>查了很多资料，发现在MySQL5.7之前的版本，安全性较低，存在任何用户都可以连接上的 test 库，所以官方在5.7版本加大了对隐私的保护。并且采用了默认 useSSL = true值防止对数据库的随意修改，到了8.0版本，仍然保留了SSL，并且默认值为 true，所以只要将 “?useSSL= false” 放在url表名后即可</p><h1 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h1><p>在配置的jdbc连接地址末尾带上如下参数即可：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&amp;useSSL</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure><p>例如：</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">druid.url</span>=<span class="string">jdbc:log4jdbc:mysql://172.18.xxx.xxx:3306/xxxxdb?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=UTC&amp;useSSL=false</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> jdbc </tag>
            
            <tag> BUG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>各系统下无限重置IDEA试用版本</title>
      <link href="/2022/01/07/%E5%90%84%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%97%A0%E9%99%90%E9%87%8D%E7%BD%AEIDEA%E8%AF%95%E7%94%A8%E7%89%88%E6%9C%AC/"/>
      <url>/2022/01/07/%E5%90%84%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%97%A0%E9%99%90%E9%87%8D%E7%BD%AEIDEA%E8%AF%95%E7%94%A8%E7%89%88%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h1 id="在Ubuntu（linux）下重置"><a href="#在Ubuntu（linux）下重置" class="headerlink" title="在Ubuntu（linux）下重置"></a>在Ubuntu（linux）下重置</h1><p>先说一下原理，在2021.2.3版本之前，我们本机使用IDEA是不需要登录什么账户的，因此IDEA无法讲试用时间的限制放在云端，也就是说，IDEA的试用时间的限制数据是放在我们本地的，只需要找到IDEA存放在我们<strong>本地的时间限制数据</strong>，并删掉就可以重置试用时间；下面就开始吧。</p><ol><li><p>第一步，我们需要找到IDEA 的数据存放在哪儿</p><p>经过一番寻找，终于到找了，数据目录在我们用户目录下的 .config/JetBrains/ 目录下：</p><p><img src="image-20220107120704640.png" alt="image-20220107120704640"></p></li><li><p><del>由于没办法区分那些文件是用来存放时间限制的，我们可以一把全部删掉，相当于重新安装</del></p><p><img src="image-20220107120725543.png" alt="image-20220107120725543"></p></li><li><p>最新发现，只需要删除 <code>/home/yefan/.config/JetBrains/IntelliJIdea2021.2/eval</code> 目录下的文件即可</p><p><img src="image-20220107120746900.png" alt="image-20220107120746900"></p></li><li><p>删除后再重启IDEA，就可以发现IDEA跟新安装一样</p></li></ol><p>evaluation.key</p><ol start="5"><li>到这里就完成了重置</li></ol><p>这种方式同样适用于所有 <code>JetBrains</code> 的其他产品，但是要求版本是在  2021.2 版本以前</p><h1 id="在windows下重置"><a href="#在windows下重置" class="headerlink" title="在windows下重置"></a>在windows下重置</h1><p>路径如下：</p><p>C:\Users\zq\AppData\Roaming\JetBrains\IntelliJIdea2021.1\eval</p><p><img src="image-20220107120806097.png" alt="image-20220107120806097"></p><p>把.key的文件 重命名为其他的名字就可以重新选择试用</p><p>如果无法找到路径，可以在 C盘根目录下进行使用搜索，关键词为：evaluation.key</p><h1 id="在Mac-下重置"><a href="#在Mac-下重置" class="headerlink" title="在Mac 下重置"></a>在Mac 下重置</h1><p>脚本如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment"># reset jetbrains ide evals for now</span></span><br><span class="line"></span><br><span class="line">OS_NAME=$(uname -s)</span><br><span class="line">JB_PRODUCTS=<span class="string">&quot;IntelliJIdea CLion PhpStorm GoLand PyCharm WebStorm Rider DataGrip RubyMine AppCode&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$OS_NAME</span>&quot;</span> = <span class="string">&quot;Darwin&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;macOS:&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> PRD <span class="keyword">in</span> <span class="variable">$JB_PRODUCTS</span>; <span class="keyword">do</span></span><br><span class="line">    rm -rf ~/Library/Preferences/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line">    rm -rf ~/Library/Application\\ Support/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line">    rm -rf ~/Library/Application\\ Support/JetBrains/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$OS_NAME</span>&quot;</span> = <span class="string">&quot;Linux&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;Linux:&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> PRD <span class="keyword">in</span> <span class="variable">$JB_PRODUCTS</span>; <span class="keyword">do</span></span><br><span class="line">  rm -rf ~/.<span class="variable">$&#123;PRD&#125;</span>*/config/<span class="built_in">eval</span></span><br><span class="line">    rm -rf ~/.config/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line">    rm -rf ~/.config/JetBrains/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;unsupported&#x27;</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;done.&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> IDEA </tag>
            
            <tag> 软件破解 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bind-exporter的部署</title>
      <link href="/2022/01/07/bind-exporter%E7%9A%84%E9%83%A8%E7%BD%B2/"/>
      <url>/2022/01/07/bind-exporter%E7%9A%84%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="安装部署exporter"><a href="#安装部署exporter" class="headerlink" title="安装部署exporter"></a>安装部署exporter</h2><h3 id="下载exporter二进制包"><a href="#下载exporter二进制包" class="headerlink" title="下载exporter二进制包"></a>下载exporter二进制包</h3><p>根据不同的环境，选择不同的二进制包</p><p>下载地址：<a href="https://github.com/prometheus-community/bind_exporter/releases/tag/v0.5.0">https://github.com/prometheus-community/bind_exporter/releases/tag/v0.5.0</a></p><p>我这里使用的是这个包【bind_exporter-0.5.0.linux-amd64.tar.gz】</p><p><a href="https://github.com/prometheus-community/bind_exporter/releases/download/v0.5.0/bind_exporter-0.5.0.linux-amd64.tar.gz">https://github.com/prometheus-community/bind_exporter/releases/download/v0.5.0/bind_exporter-0.5.0.linux-amd64.tar.gz</a></p><h3 id="解压安装包"><a href="#解压安装包" class="headerlink" title="解压安装包"></a>解压安装包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf bind_exporter-0.5.0.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure><p><img src="image-20220104161539352.png" alt="image-20220104161539352"></p><p>解压之后的目录结构如下：</p><p><img src="image-20220104161634390.png" alt="image-20220104161634390"></p><h3 id="运行exporter"><a href="#运行exporter" class="headerlink" title="运行exporter"></a>运行exporter</h3><p>进入解压的目录，运行二进制文件 bind_exporter</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bind_exporter --bind.pid-file=/var/run/named/named.pid --bind.timeout=20s --web.listen-address=0.0.0.0:9119 --web.telemetry-path=/metrics --bind.stats-url=http://localhost:53/ --bind.stats-groups=server,view,tasks</span><br></pre></td></tr></table></figure><blockquote><p>注意：</p><p>① 其中的localhost，是指被监控的bind所在的服务器地址，我这里是本机，因此可以直接使用localhost替代</p></blockquote><p>启动结果如下：</p><p><img src="image-20220104161949523.png" alt="image-20220104161949523"></p><h2 id="对接prometheus"><a href="#对接prometheus" class="headerlink" title="对接prometheus"></a>对接prometheus</h2><p>我这里采用的http_sd_config的方式发现服务，需要了解的可以查阅《prometheus服务动态发现之<code>http_sd_config</code>》这篇文章</p><ol><li><p>在prometheus中添加如下配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;bind&#x27;</span></span><br><span class="line">  <span class="attr">http_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.26.62.xx:12000/prometheus/getTargetByType?exporterType=BIND</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="image-20220104170356350.png" alt="image-20220104170356350"></p><ol start="2"><li>重启或reload一下prometheus即可</li></ol><blockquote><p>注意：</p><p>①  配置中的url填写的是自己提供的服务地址，prometheus会自动调用该接口获取服务节点信息，该接口返回的的结果如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">&quot;targets&quot;</span>:[</span><br><span class="line">         <span class="string">&quot;172.18.40.xx:9119&quot;</span></span><br><span class="line">     ],</span><br><span class="line">     <span class="attr">&quot;labels&quot;</span>:&#123;</span><br><span class="line">         <span class="attr">&quot;job&quot;</span>:<span class="string">&quot;bind&quot;</span></span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></blockquote><ol start="3"><li>查看节点是否注册上去</li></ol><h2 id="使用grafana查看监控大盘"><a href="#使用grafana查看监控大盘" class="headerlink" title="使用grafana查看监控大盘"></a>使用grafana查看监控大盘</h2><p>这里使用的是<code>1666</code>的监控大盘，访问地址如下：</p><p><a href="https://grafana.com/grafana/dashboards/1666">https://grafana.com/grafana/dashboards/1666</a></p><p><img src="image-20220104164022200.png" alt="image-20220104164022200"></p><p>最终呈现的监控大盘如下：</p><h2 id="bind-exporter监控的指标"><a href="#bind-exporter监控的指标" class="headerlink" title="bind_exporter监控的指标"></a>bind_exporter监控的指标</h2><p>通过访问exporter暴露出来的指标访问地址，可以查看到当前采集监控数据：</p><p><a href="http://172.18.40.88:9119/metrics">http://172.18.40.88:9119/metrics</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h2 id="问题分析"><a href="#问题分析" class="headerlink" title="问题分析"></a>问题分析</h2><p>在部署的的过程中出现了如下的问题：</p><h3 id="Couldn’t-retrieve-BIND-stats"><a href="#Couldn’t-retrieve-BIND-stats" class="headerlink" title="Couldn’t retrieve BIND stats"></a>Couldn’t retrieve BIND stats</h3><p>问题说明：</p><p>bind_exporter启动后，无法成功访问bind，从而导致无法获取监控数据</p><p><img src="image-20220104164953642.png" alt="image-20220104164953642"></p><p>解决办法：</p><p>参考网址如下：</p><p><a href="https://github.com/prometheus-community/bind_exporter/issues/118">https://github.com/prometheus-community/bind_exporter/issues/118</a></p><p><a href="https://github.com/prometheus-community/bind_exporter/issues/69">https://github.com/prometheus-community/bind_exporter/issues/69</a></p><p>分析结论是：</p><p>这个问题是bind与bind_exporter的版本问题导致的，目前暂时只适用于 bind 9.17.20 和 bind_exporter 0.5.0</p><p>最终解决问题的操作如下：</p><p>我当前版本为<code>暂时没有切换bind的版本，没有验证该结果</code></p><p><img src="image-20220104170912736.png" alt="image-20220104170912736"></p>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> 云监控 </tag>
            
            <tag> bind-exporter </tag>
            
            <tag> 云计算 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>elasticsearch-exporter的部署</title>
      <link href="/2022/01/07/elasticsearch-exporter%E7%9A%84%E9%83%A8%E7%BD%B2/"/>
      <url>/2022/01/07/elasticsearch-exporter%E7%9A%84%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="安装部署exporter"><a href="#安装部署exporter" class="headerlink" title="安装部署exporter"></a>安装部署exporter</h2><h3 id="下载exporter二进制包"><a href="#下载exporter二进制包" class="headerlink" title="下载exporter二进制包"></a>下载exporter二进制包</h3><p>根据不同的环境，选择不同的二进制包</p><p>下载地址：<a href="https://github.com/prometheus-community/elasticsearch_exporter/releases/tag/v1.3.0">https://github.com/prometheus-community/elasticsearch_exporter/releases/tag/v1.3.0</a></p><p>我这里使用的是这个包【elasticsearch_exporter-1.3.0.linux-amd64.tar.gz】</p><p><a href="https://github.com/prometheus-community/elasticsearch_exporter/releases/download/v1.3.0/elasticsearch_exporter-1.3.0.linux-amd64.tar.gz">https://github.com/prometheus-community/elasticsearch_exporter/releases/download/v1.3.0/elasticsearch_exporter-1.3.0.linux-amd64.tar.gz</a></p><h3 id="解压安装包"><a href="#解压安装包" class="headerlink" title="解压安装包"></a>解压安装包</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf elasticsearch_exporter-1.3.0.linux-amd64.tar.gz </span><br></pre></td></tr></table></figure><p><img src="image-20220104145334774.png" alt="image-20220104145334774"></p><p>解压之后的目录结构如下：</p><p><img src="image-20220104145445891.png" alt="image-20220104145445891"></p><h3 id="运行exporter"><a href="#运行exporter" class="headerlink" title="运行exporter"></a>运行exporter</h3><p>进入解压的目录，运行二进制文件 elasticsearch_exporter</p><p>根据被监控的elasticsearch是否用户密码，需要分为以下两种情况进行运行：</p><ol><li><p>不需要用户名和密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./elasticsearch_exporter --web.listen-address &quot;:9109&quot;  --es.uri http://localhost:9200</span><br></pre></td></tr></table></figure><blockquote><p>注意：</p><p>① 其中的localhost，是指被监控的elasticsearch所在的服务器地址，我这里是本机，因此可以直接使用localhost替代</p><p>② 如果启动是出现如下错误：</p><p>caller=clusterinfo.go:188 msg=”failed to retrieve cluster info from ES” err=”HTTP Request failed with code 401”</p><p>很显然是表示没有权限，需要使用用户名和密码访问elasticsearch，需要使用下面第二种方式进行启动即可</p></blockquote></li><li><p>需要用户名和密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./elasticsearch_exporter --web.listen-address &quot;:9109&quot;  --es.uri http://elastic:elastic@localhost:9200</span><br></pre></td></tr></table></figure></li></ol><h2 id="对接prometheus"><a href="#对接prometheus" class="headerlink" title="对接prometheus"></a>对接prometheus</h2><p>我这里采用的http_sd_config的方式发现服务，需要了解的可以查阅《prometheus服务动态发现之<code>http_sd_config</code>》这篇文章</p><ol><li><p>在prometheus中添加如下配置：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;elasticsearch&#x27;</span></span><br><span class="line">  <span class="attr">http_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.26.62.99:12000/prometheus/getTargetByType?exporterType=ELASTICSEARCH</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="image-20220104151110867.png" alt="image-20220104151110867"></p><ol start="2"><li>重启或reload一下prometheus即可</li></ol><blockquote><p>注意：</p><p>①  配置中的url填写的是自己提供的服务地址，prometheus会自动调用该接口获取服务节点信息，该接口返回的的结果如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">&quot;targets&quot;</span>:[</span><br><span class="line">         <span class="string">&quot;172.18.40.xx:9109&quot;</span></span><br><span class="line">     ],</span><br><span class="line">     <span class="attr">&quot;labels&quot;</span>:&#123;</span><br><span class="line">         <span class="attr">&quot;job&quot;</span>:<span class="string">&quot;elasticsearch&quot;</span></span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></blockquote><ol start="3"><li><p>查看节点是否注册上去</p><p><img src="image-20220104151553748.png" alt="image-20220104151553748"></p></li></ol><h2 id="使用grafana查看监控大盘"><a href="#使用grafana查看监控大盘" class="headerlink" title="使用grafana查看监控大盘"></a>使用grafana查看监控大盘</h2><p>这里使用的是<code>6483</code>的监控大盘，访问地址如下：</p><p><a href="https://grafana.com/grafana/dashboards/6483">https://grafana.com/grafana/dashboards/6483</a></p><p><img src="image-20220104160409120.png" alt="image-20220104160409120"></p><p>最终呈现的监控大盘如下：</p><p><img src="image-20220104160329215.png" alt="image-20220104160329215"></p><h2 id="elasticsearch-exporter监控的指标"><a href="#elasticsearch-exporter监控的指标" class="headerlink" title="elasticsearch_exporter监控的指标"></a>elasticsearch_exporter监控的指标</h2><p>通过访问exporter暴露出来的指标访问地址，可以查看到当前采集监控数据：</p><p><a href="http://172.18.40.xx:9109/metrics">http://172.18.40.xx:9109/metrics</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br></pre></td><td class="code"><pre><span class="line"># HELP elasticsearch_breakers_estimated_size_bytes Estimated size in bytes of breaker</span><br><span class="line"># TYPE elasticsearch_breakers_estimated_size_bytes gauge</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;accounting&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.1915479e+07</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;fielddata&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 47232</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;in_flight_requests&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 41421</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;parent&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.2004132e+07</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;request&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_breakers_limit_size_bytes Limit size in bytes for breaker</span><br><span class="line"># TYPE elasticsearch_breakers_limit_size_bytes gauge</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;accounting&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.112618496e+09</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;fielddata&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.267571097e+09</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;in_flight_requests&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.112618496e+09</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;parent&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.478832947e+09</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;request&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.267571097e+09</span><br><span class="line"># HELP elasticsearch_breakers_overhead Overhead of circuit breakers</span><br><span class="line"># TYPE elasticsearch_breakers_overhead counter</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;accounting&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;fielddata&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.03</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;in_flight_requests&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;parent&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;request&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_breakers_tripped tripped for breaker</span><br><span class="line"># TYPE elasticsearch_breakers_tripped counter</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;accounting&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;fielddata&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;in_flight_requests&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;parent&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;request&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_active_primary_shards The number of primary shards in your cluster. This is an aggregate total across all indices.</span><br><span class="line"># TYPE elasticsearch_cluster_health_active_primary_shards gauge</span><br><span class="line">elasticsearch_cluster_health_active_primary_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 4236</span><br><span class="line"># HELP elasticsearch_cluster_health_active_shards Aggregate total of all shards across all indices, which includes replica shards.</span><br><span class="line"># TYPE elasticsearch_cluster_health_active_shards gauge</span><br><span class="line">elasticsearch_cluster_health_active_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 4236</span><br><span class="line"># HELP elasticsearch_cluster_health_delayed_unassigned_shards Shards delayed to reduce reallocation overhead</span><br><span class="line"># TYPE elasticsearch_cluster_health_delayed_unassigned_shards gauge</span><br><span class="line">elasticsearch_cluster_health_delayed_unassigned_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_initializing_shards Count of shards that are being freshly created.</span><br><span class="line"># TYPE elasticsearch_cluster_health_initializing_shards gauge</span><br><span class="line">elasticsearch_cluster_health_initializing_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_json_parse_failures Number of errors while parsing JSON.</span><br><span class="line"># TYPE elasticsearch_cluster_health_json_parse_failures counter</span><br><span class="line">elasticsearch_cluster_health_json_parse_failures 0</span><br><span class="line"># HELP elasticsearch_cluster_health_number_of_data_nodes Number of data nodes in the cluster.</span><br><span class="line"># TYPE elasticsearch_cluster_health_number_of_data_nodes gauge</span><br><span class="line">elasticsearch_cluster_health_number_of_data_nodes&#123;cluster=&quot;powercloud_log&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_cluster_health_number_of_in_flight_fetch The number of ongoing shard info requests.</span><br><span class="line"># TYPE elasticsearch_cluster_health_number_of_in_flight_fetch gauge</span><br><span class="line">elasticsearch_cluster_health_number_of_in_flight_fetch&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_number_of_nodes Number of nodes in the cluster.</span><br><span class="line"># TYPE elasticsearch_cluster_health_number_of_nodes gauge</span><br><span class="line">elasticsearch_cluster_health_number_of_nodes&#123;cluster=&quot;powercloud_log&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_cluster_health_number_of_pending_tasks Cluster level changes which have not yet been executed</span><br><span class="line"># TYPE elasticsearch_cluster_health_number_of_pending_tasks gauge</span><br><span class="line">elasticsearch_cluster_health_number_of_pending_tasks&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_relocating_shards The number of shards that are currently moving from one node to another node.</span><br><span class="line"># TYPE elasticsearch_cluster_health_relocating_shards gauge</span><br><span class="line">elasticsearch_cluster_health_relocating_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_status Whether all primary and replica shards are allocated.</span><br><span class="line"># TYPE elasticsearch_cluster_health_status gauge</span><br><span class="line">elasticsearch_cluster_health_status&#123;cluster=&quot;powercloud_log&quot;,color=&quot;green&quot;&#125; 1</span><br><span class="line">elasticsearch_cluster_health_status&#123;cluster=&quot;powercloud_log&quot;,color=&quot;red&quot;&#125; 0</span><br><span class="line">elasticsearch_cluster_health_status&#123;cluster=&quot;powercloud_log&quot;,color=&quot;yellow&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_task_max_waiting_in_queue_millis Tasks max time waiting in queue.</span><br><span class="line"># TYPE elasticsearch_cluster_health_task_max_waiting_in_queue_millis gauge</span><br><span class="line">elasticsearch_cluster_health_task_max_waiting_in_queue_millis&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_total_scrapes Current total ElasticSearch cluster health scrapes.</span><br><span class="line"># TYPE elasticsearch_cluster_health_total_scrapes counter</span><br><span class="line">elasticsearch_cluster_health_total_scrapes 86</span><br><span class="line"># HELP elasticsearch_cluster_health_unassigned_shards The number of shards that exist in the cluster state, but cannot be found in the cluster itself.</span><br><span class="line"># TYPE elasticsearch_cluster_health_unassigned_shards gauge</span><br><span class="line">elasticsearch_cluster_health_unassigned_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_up Was the last scrape of the ElasticSearch cluster health endpoint successful.</span><br><span class="line"># TYPE elasticsearch_cluster_health_up gauge</span><br><span class="line">elasticsearch_cluster_health_up 1</span><br><span class="line"># HELP elasticsearch_clusterinfo_last_retrieval_failure_ts Timestamp of the last failed cluster info retrieval</span><br><span class="line"># TYPE elasticsearch_clusterinfo_last_retrieval_failure_ts gauge</span><br><span class="line">elasticsearch_clusterinfo_last_retrieval_failure_ts&#123;url=&quot;http://localhost:9200&quot;&#125; 1.641279194e+09</span><br><span class="line"># HELP elasticsearch_clusterinfo_last_retrieval_success_ts Timestamp of the last successful cluster info retrieval</span><br><span class="line"># TYPE elasticsearch_clusterinfo_last_retrieval_success_ts gauge</span><br><span class="line">elasticsearch_clusterinfo_last_retrieval_success_ts&#123;url=&quot;http://localhost:9200&quot;&#125; 1.641279789e+09</span><br><span class="line"># HELP elasticsearch_clusterinfo_up Up metric for the cluster info collector</span><br><span class="line"># TYPE elasticsearch_clusterinfo_up gauge</span><br><span class="line">elasticsearch_clusterinfo_up&#123;url=&quot;http://localhost:9200&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_clusterinfo_version_info Constant metric with ES version information as labels</span><br><span class="line"># TYPE elasticsearch_clusterinfo_version_info gauge</span><br><span class="line">elasticsearch_clusterinfo_version_info&#123;build_date=&quot;2020-10-16T09:09:46.555371Z&quot;,build_hash=&quot;be13c69&quot;,cluster=&quot;powercloud_log&quot;,cluster_uuid=&quot;YHZNY2gQRwSdApY_N5ZRGg&quot;,lucene_version=&quot;7.7.3&quot;,version=&quot;6.8.13&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_exporter_build_info A metric with a constant &#x27;1&#x27; value labeled by version, revision, branch, and goversion from which elasticsearch_exporter was built.</span><br><span class="line"># TYPE elasticsearch_exporter_build_info gauge</span><br><span class="line">elasticsearch_exporter_build_info&#123;branch=&quot;HEAD&quot;,goversion=&quot;go1.16.9&quot;,revision=&quot;5b2e5c7e0e5059c5e2c8046802fa59fb88b30773&quot;,version=&quot;1.3.0&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_filesystem_data_available_bytes Available space on block device in bytes</span><br><span class="line"># TYPE elasticsearch_filesystem_data_available_bytes gauge</span><br><span class="line">elasticsearch_filesystem_data_available_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,mount=&quot;/ (rootfs)&quot;,name=&quot;node-65&quot;,path=&quot;/mysql/es/nodes/0&quot;&#125; 7.907373056e+09</span><br><span class="line"># HELP elasticsearch_filesystem_data_free_bytes Free space on block device in bytes</span><br><span class="line"># TYPE elasticsearch_filesystem_data_free_bytes gauge</span><br><span class="line">elasticsearch_filesystem_data_free_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,mount=&quot;/ (rootfs)&quot;,name=&quot;node-65&quot;,path=&quot;/mysql/es/nodes/0&quot;&#125; 7.907373056e+09</span><br><span class="line"># HELP elasticsearch_filesystem_data_size_bytes Size of block device in bytes</span><br><span class="line"># TYPE elasticsearch_filesystem_data_size_bytes gauge</span><br><span class="line">elasticsearch_filesystem_data_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,mount=&quot;/ (rootfs)&quot;,name=&quot;node-65&quot;,path=&quot;/mysql/es/nodes/0&quot;&#125; 1.3407092736e+10</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_operations_count Count of disk operations</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_operations_count counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_operations_count&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 4.24902462e+08</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_read_operations_count Count of disk read operations</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_read_operations_count counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_read_operations_count&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 173739</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_read_size_kilobytes_sum Total kilobytes read from disk</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_read_size_kilobytes_sum counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_read_size_kilobytes_sum&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 5.766904e+06</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_write_operations_count Count of disk write operations</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_write_operations_count counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_write_operations_count&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 4.24728723e+08</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_write_size_kilobytes_sum Total kilobytes written to disk</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_write_size_kilobytes_sum counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_write_size_kilobytes_sum&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.996657082e+09</span><br><span class="line"># HELP elasticsearch_indices_completion_size_in_bytes Completion in bytes</span><br><span class="line"># TYPE elasticsearch_indices_completion_size_in_bytes counter</span><br><span class="line">elasticsearch_indices_completion_size_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_docs Count of documents on this node</span><br><span class="line"># TYPE elasticsearch_indices_docs gauge</span><br><span class="line">elasticsearch_indices_docs&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.844747e+06</span><br><span class="line"># HELP elasticsearch_indices_docs_deleted Count of deleted documents on this node</span><br><span class="line"># TYPE elasticsearch_indices_docs_deleted gauge</span><br><span class="line">elasticsearch_indices_docs_deleted&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 31972</span><br><span class="line"># HELP elasticsearch_indices_fielddata_evictions Evictions from field data</span><br><span class="line"># TYPE elasticsearch_indices_fielddata_evictions counter</span><br><span class="line">elasticsearch_indices_fielddata_evictions&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_fielddata_memory_size_bytes Field data cache memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_fielddata_memory_size_bytes gauge</span><br><span class="line">elasticsearch_indices_fielddata_memory_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 47232</span><br><span class="line"># HELP elasticsearch_indices_filter_cache_evictions Evictions from filter cache</span><br><span class="line"># TYPE elasticsearch_indices_filter_cache_evictions counter</span><br><span class="line">elasticsearch_indices_filter_cache_evictions&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_filter_cache_memory_size_bytes Filter cache memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_filter_cache_memory_size_bytes gauge</span><br><span class="line">elasticsearch_indices_filter_cache_memory_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_flush_time_seconds Cumulative flush time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_flush_time_seconds counter</span><br><span class="line">elasticsearch_indices_flush_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1281.583</span><br><span class="line"># HELP elasticsearch_indices_flush_total Total flushes</span><br><span class="line"># TYPE elasticsearch_indices_flush_total counter</span><br><span class="line">elasticsearch_indices_flush_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 88700</span><br><span class="line"># HELP elasticsearch_indices_get_exists_time_seconds Total time get exists in seconds</span><br><span class="line"># TYPE elasticsearch_indices_get_exists_time_seconds counter</span><br><span class="line">elasticsearch_indices_get_exists_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7334.63</span><br><span class="line"># HELP elasticsearch_indices_get_exists_total Total get exists operations</span><br><span class="line"># TYPE elasticsearch_indices_get_exists_total counter</span><br><span class="line">elasticsearch_indices_get_exists_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.09638173e+08</span><br><span class="line"># HELP elasticsearch_indices_get_missing_time_seconds Total time of get missing in seconds</span><br><span class="line"># TYPE elasticsearch_indices_get_missing_time_seconds counter</span><br><span class="line">elasticsearch_indices_get_missing_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.69</span><br><span class="line"># HELP elasticsearch_indices_get_missing_total Total get missing</span><br><span class="line"># TYPE elasticsearch_indices_get_missing_total counter</span><br><span class="line">elasticsearch_indices_get_missing_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 978</span><br><span class="line"># HELP elasticsearch_indices_get_time_seconds Total get time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_get_time_seconds counter</span><br><span class="line">elasticsearch_indices_get_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7336.32</span><br><span class="line"># HELP elasticsearch_indices_get_total Total get</span><br><span class="line"># TYPE elasticsearch_indices_get_total counter</span><br><span class="line">elasticsearch_indices_get_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.09639151e+08</span><br><span class="line"># HELP elasticsearch_indices_indexing_delete_time_seconds_total Total time indexing delete in seconds</span><br><span class="line"># TYPE elasticsearch_indices_indexing_delete_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_indexing_delete_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_indexing_delete_total Total indexing deletes</span><br><span class="line"># TYPE elasticsearch_indices_indexing_delete_total counter</span><br><span class="line">elasticsearch_indices_indexing_delete_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_indexing_index_time_seconds_total Cumulative index time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_indexing_index_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_indexing_index_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 47008.786</span><br><span class="line"># HELP elasticsearch_indices_indexing_index_total Total index calls</span><br><span class="line"># TYPE elasticsearch_indices_indexing_index_total counter</span><br><span class="line">elasticsearch_indices_indexing_index_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 8.7126405e+07</span><br><span class="line"># HELP elasticsearch_indices_indexing_is_throttled Indexing throttling</span><br><span class="line"># TYPE elasticsearch_indices_indexing_is_throttled gauge</span><br><span class="line">elasticsearch_indices_indexing_is_throttled&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_indexing_throttle_time_seconds_total Cumulative indexing throttling time</span><br><span class="line"># TYPE elasticsearch_indices_indexing_throttle_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_indexing_throttle_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_merges_current Current merges</span><br><span class="line"># TYPE elasticsearch_indices_merges_current gauge</span><br><span class="line">elasticsearch_indices_merges_current&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_merges_current_size_in_bytes Size of a current merges in bytes</span><br><span class="line"># TYPE elasticsearch_indices_merges_current_size_in_bytes gauge</span><br><span class="line">elasticsearch_indices_merges_current_size_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_merges_docs_total Cumulative docs merged</span><br><span class="line"># TYPE elasticsearch_indices_merges_docs_total counter</span><br><span class="line">elasticsearch_indices_merges_docs_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 5.91988704e+08</span><br><span class="line"># HELP elasticsearch_indices_merges_total Total merges</span><br><span class="line"># TYPE elasticsearch_indices_merges_total counter</span><br><span class="line">elasticsearch_indices_merges_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.595759e+06</span><br><span class="line"># HELP elasticsearch_indices_merges_total_size_bytes_total Total merge size in bytes</span><br><span class="line"># TYPE elasticsearch_indices_merges_total_size_bytes_total counter</span><br><span class="line">elasticsearch_indices_merges_total_size_bytes_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.77768194134e+11</span><br><span class="line"># HELP elasticsearch_indices_merges_total_throttled_time_seconds_total Total throttled time of merges in seconds</span><br><span class="line"># TYPE elasticsearch_indices_merges_total_throttled_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_merges_total_throttled_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_merges_total_time_seconds_total Total time spent merging in seconds</span><br><span class="line"># TYPE elasticsearch_indices_merges_total_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_merges_total_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 13919.644</span><br><span class="line"># HELP elasticsearch_indices_query_cache_cache_size Query cache cache size</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_cache_size gauge</span><br><span class="line">elasticsearch_indices_query_cache_cache_size&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_cache_total Query cache cache count</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_cache_total counter</span><br><span class="line">elasticsearch_indices_query_cache_cache_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_count Query cache count</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_count counter</span><br><span class="line">elasticsearch_indices_query_cache_count&#123;cache=&quot;hit&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_evictions Evictions from query cache</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_evictions counter</span><br><span class="line">elasticsearch_indices_query_cache_evictions&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_memory_size_bytes Query cache memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_memory_size_bytes gauge</span><br><span class="line">elasticsearch_indices_query_cache_memory_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_total Query cache total count</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_total counter</span><br><span class="line">elasticsearch_indices_query_cache_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_miss_count Query miss count</span><br><span class="line"># TYPE elasticsearch_indices_query_miss_count counter</span><br><span class="line">elasticsearch_indices_query_miss_count&#123;cache=&quot;miss&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_refresh_time_seconds_total Total time spent refreshing in seconds</span><br><span class="line"># TYPE elasticsearch_indices_refresh_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_refresh_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 321386.712</span><br><span class="line"># HELP elasticsearch_indices_refresh_total Total refreshes</span><br><span class="line"># TYPE elasticsearch_indices_refresh_total counter</span><br><span class="line">elasticsearch_indices_refresh_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 6.0047433e+07</span><br><span class="line"># HELP elasticsearch_indices_request_cache_count Request cache count</span><br><span class="line"># TYPE elasticsearch_indices_request_cache_count counter</span><br><span class="line">elasticsearch_indices_request_cache_count&#123;cache=&quot;hit&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 959</span><br><span class="line"># HELP elasticsearch_indices_request_cache_evictions Evictions from request cache</span><br><span class="line"># TYPE elasticsearch_indices_request_cache_evictions counter</span><br><span class="line">elasticsearch_indices_request_cache_evictions&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_request_cache_memory_size_bytes Request cache memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_request_cache_memory_size_bytes gauge</span><br><span class="line">elasticsearch_indices_request_cache_memory_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 97920</span><br><span class="line"># HELP elasticsearch_indices_request_miss_count Request miss count</span><br><span class="line"># TYPE elasticsearch_indices_request_miss_count counter</span><br><span class="line">elasticsearch_indices_request_miss_count&#123;cache=&quot;miss&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2431</span><br><span class="line"># HELP elasticsearch_indices_search_fetch_time_seconds Total search fetch time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_search_fetch_time_seconds counter</span><br><span class="line">elasticsearch_indices_search_fetch_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 235.096</span><br><span class="line"># HELP elasticsearch_indices_search_fetch_total Total number of fetches</span><br><span class="line"># TYPE elasticsearch_indices_search_fetch_total counter</span><br><span class="line">elasticsearch_indices_search_fetch_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.892078e+06</span><br><span class="line"># HELP elasticsearch_indices_search_query_time_seconds Total search query time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_search_query_time_seconds counter</span><br><span class="line">elasticsearch_indices_search_query_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 44106.837</span><br><span class="line"># HELP elasticsearch_indices_search_query_total Total number of queries</span><br><span class="line"># TYPE elasticsearch_indices_search_query_total counter</span><br><span class="line">elasticsearch_indices_search_query_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.52018903e+08</span><br><span class="line"># HELP elasticsearch_indices_search_scroll_time_seconds Total scroll time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_search_scroll_time_seconds counter</span><br><span class="line">elasticsearch_indices_search_scroll_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_search_scroll_total Total number of scrolls</span><br><span class="line"># TYPE elasticsearch_indices_search_scroll_total counter</span><br><span class="line">elasticsearch_indices_search_scroll_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_search_suggest_time_seconds Total suggest time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_search_suggest_time_seconds counter</span><br><span class="line">elasticsearch_indices_search_suggest_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_search_suggest_total Total number of suggests</span><br><span class="line"># TYPE elasticsearch_indices_search_suggest_total counter</span><br><span class="line">elasticsearch_indices_search_suggest_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_segments_count Count of index segments on this node</span><br><span class="line"># TYPE elasticsearch_indices_segments_count gauge</span><br><span class="line">elasticsearch_indices_segments_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 25317</span><br><span class="line"># HELP elasticsearch_indices_segments_doc_values_memory_in_bytes Count of doc values memory</span><br><span class="line"># TYPE elasticsearch_indices_segments_doc_values_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_doc_values_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 6.907292e+06</span><br><span class="line"># HELP elasticsearch_indices_segments_fixed_bit_set_memory_in_bytes Count of fixed bit set</span><br><span class="line"># TYPE elasticsearch_indices_segments_fixed_bit_set_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_fixed_bit_set_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_segments_index_writer_memory_in_bytes Count of memory for index writer on this node</span><br><span class="line"># TYPE elasticsearch_indices_segments_index_writer_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_index_writer_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.0151996e+07</span><br><span class="line"># HELP elasticsearch_indices_segments_memory_bytes Current memory size of segments in bytes</span><br><span class="line"># TYPE elasticsearch_indices_segments_memory_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_memory_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.1915479e+07</span><br><span class="line"># HELP elasticsearch_indices_segments_norms_memory_in_bytes Count of memory used by norms</span><br><span class="line"># TYPE elasticsearch_indices_segments_norms_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_norms_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 669440</span><br><span class="line"># HELP elasticsearch_indices_segments_points_memory_in_bytes Point values memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_segments_points_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_points_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 268735</span><br><span class="line"># HELP elasticsearch_indices_segments_stored_fields_memory_in_bytes Count of stored fields memory</span><br><span class="line"># TYPE elasticsearch_indices_segments_stored_fields_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_stored_fields_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.991504e+06</span><br><span class="line"># HELP elasticsearch_indices_segments_term_vectors_memory_in_bytes Term vectors memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_segments_term_vectors_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_term_vectors_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_segments_terms_memory_in_bytes Count of terms in memory for this node</span><br><span class="line"># TYPE elasticsearch_indices_segments_terms_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_terms_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.6078508e+07</span><br><span class="line"># HELP elasticsearch_indices_segments_version_map_memory_in_bytes Version map memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_segments_version_map_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_version_map_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 12348</span><br><span class="line"># HELP elasticsearch_indices_store_size_bytes Current size of stored index data in bytes</span><br><span class="line"># TYPE elasticsearch_indices_store_size_bytes gauge</span><br><span class="line">elasticsearch_indices_store_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 6.10025718e+08</span><br><span class="line"># HELP elasticsearch_indices_store_throttle_time_seconds_total Throttle time for index store in seconds</span><br><span class="line"># TYPE elasticsearch_indices_store_throttle_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_store_throttle_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_translog_operations Total translog operations</span><br><span class="line"># TYPE elasticsearch_indices_translog_operations counter</span><br><span class="line">elasticsearch_indices_translog_operations&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.788237e+06</span><br><span class="line"># HELP elasticsearch_indices_translog_size_in_bytes Total translog size in bytes</span><br><span class="line"># TYPE elasticsearch_indices_translog_size_in_bytes counter</span><br><span class="line">elasticsearch_indices_translog_size_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.161283492e+09</span><br><span class="line"># HELP elasticsearch_indices_warmer_time_seconds_total Total warmer time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_warmer_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_warmer_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 766.68</span><br><span class="line"># HELP elasticsearch_indices_warmer_total Total warmer count</span><br><span class="line"># TYPE elasticsearch_indices_warmer_total counter</span><br><span class="line">elasticsearch_indices_warmer_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 5.1882607e+07</span><br><span class="line"># HELP elasticsearch_jvm_buffer_pool_used_bytes JVM buffer currently used</span><br><span class="line"># TYPE elasticsearch_jvm_buffer_pool_used_bytes gauge</span><br><span class="line">elasticsearch_jvm_buffer_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;direct&quot;&#125; 1.35439297e+08</span><br><span class="line">elasticsearch_jvm_buffer_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;mapped&quot;&#125; 5.61244239e+08</span><br><span class="line"># HELP elasticsearch_jvm_gc_collection_seconds_count Count of JVM GC runs</span><br><span class="line"># TYPE elasticsearch_jvm_gc_collection_seconds_count counter</span><br><span class="line">elasticsearch_jvm_gc_collection_seconds_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,gc=&quot;old&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 349475</span><br><span class="line">elasticsearch_jvm_gc_collection_seconds_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,gc=&quot;young&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.310973e+06</span><br><span class="line"># HELP elasticsearch_jvm_gc_collection_seconds_sum GC run time in seconds</span><br><span class="line"># TYPE elasticsearch_jvm_gc_collection_seconds_sum counter</span><br><span class="line">elasticsearch_jvm_gc_collection_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,gc=&quot;old&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 29972.916</span><br><span class="line">elasticsearch_jvm_gc_collection_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,gc=&quot;young&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 35169.164</span><br><span class="line"># HELP elasticsearch_jvm_memory_committed_bytes JVM memory currently committed by area</span><br><span class="line"># TYPE elasticsearch_jvm_memory_committed_bytes gauge</span><br><span class="line">elasticsearch_jvm_memory_committed_bytes&#123;area=&quot;heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.112618496e+09</span><br><span class="line">elasticsearch_jvm_memory_committed_bytes&#123;area=&quot;non-heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.94031616e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_max_bytes JVM memory max</span><br><span class="line"># TYPE elasticsearch_jvm_memory_max_bytes gauge</span><br><span class="line">elasticsearch_jvm_memory_max_bytes&#123;area=&quot;heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.112618496e+09</span><br><span class="line"># HELP elasticsearch_jvm_memory_pool_max_bytes JVM memory max by pool</span><br><span class="line"># TYPE elasticsearch_jvm_memory_pool_max_bytes counter</span><br><span class="line">elasticsearch_jvm_memory_pool_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;old&quot;&#125; 1.798569984e+09</span><br><span class="line">elasticsearch_jvm_memory_pool_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;survivor&quot;&#125; 3.4865152e+07</span><br><span class="line">elasticsearch_jvm_memory_pool_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;young&quot;&#125; 2.7918336e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_pool_peak_max_bytes JVM memory peak max by pool</span><br><span class="line"># TYPE elasticsearch_jvm_memory_pool_peak_max_bytes counter</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;old&quot;&#125; 1.798569984e+09</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;survivor&quot;&#125; 3.4865152e+07</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;young&quot;&#125; 2.7918336e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_pool_peak_used_bytes JVM memory peak used by pool</span><br><span class="line"># TYPE elasticsearch_jvm_memory_pool_peak_used_bytes counter</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;old&quot;&#125; 1.79310328e+09</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;survivor&quot;&#125; 3.4865152e+07</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;young&quot;&#125; 2.7918336e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_pool_used_bytes JVM memory currently used by pool</span><br><span class="line"># TYPE elasticsearch_jvm_memory_pool_used_bytes gauge</span><br><span class="line">elasticsearch_jvm_memory_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;old&quot;&#125; 1.749747304e+09</span><br><span class="line">elasticsearch_jvm_memory_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;survivor&quot;&#125; 2.7390528e+07</span><br><span class="line">elasticsearch_jvm_memory_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;young&quot;&#125; 2.570478e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_used_bytes JVM memory currently used by area</span><br><span class="line"># TYPE elasticsearch_jvm_memory_used_bytes gauge</span><br><span class="line">elasticsearch_jvm_memory_used_bytes&#123;area=&quot;heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.034185632e+09</span><br><span class="line">elasticsearch_jvm_memory_used_bytes&#123;area=&quot;non-heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.80895256e+08</span><br><span class="line"># HELP elasticsearch_node_stats_json_parse_failures Number of errors while parsing JSON.</span><br><span class="line"># TYPE elasticsearch_node_stats_json_parse_failures counter</span><br><span class="line">elasticsearch_node_stats_json_parse_failures 0</span><br><span class="line"># HELP elasticsearch_node_stats_total_scrapes Current total ElasticSearch node scrapes.</span><br><span class="line"># TYPE elasticsearch_node_stats_total_scrapes counter</span><br><span class="line">elasticsearch_node_stats_total_scrapes 86</span><br><span class="line"># HELP elasticsearch_node_stats_up Was the last scrape of the ElasticSearch nodes endpoint successful.</span><br><span class="line"># TYPE elasticsearch_node_stats_up gauge</span><br><span class="line">elasticsearch_node_stats_up 1</span><br><span class="line"># HELP elasticsearch_nodes_roles Node roles</span><br><span class="line"># TYPE elasticsearch_nodes_roles gauge</span><br><span class="line">elasticsearch_nodes_roles&#123;cluster=&quot;powercloud_log&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,role=&quot;client&quot;&#125; 1</span><br><span class="line">elasticsearch_nodes_roles&#123;cluster=&quot;powercloud_log&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,role=&quot;data&quot;&#125; 1</span><br><span class="line">elasticsearch_nodes_roles&#123;cluster=&quot;powercloud_log&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,role=&quot;ingest&quot;&#125; 1</span><br><span class="line">elasticsearch_nodes_roles&#123;cluster=&quot;powercloud_log&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,role=&quot;master&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_os_cpu_percent Percent CPU used by OS</span><br><span class="line"># TYPE elasticsearch_os_cpu_percent gauge</span><br><span class="line">elasticsearch_os_cpu_percent&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 25</span><br><span class="line"># HELP elasticsearch_os_load1 Shortterm load average</span><br><span class="line"># TYPE elasticsearch_os_load1 gauge</span><br><span class="line">elasticsearch_os_load1&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0.47</span><br><span class="line"># HELP elasticsearch_os_load15 Longterm load average</span><br><span class="line"># TYPE elasticsearch_os_load15 gauge</span><br><span class="line">elasticsearch_os_load15&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.04</span><br><span class="line"># HELP elasticsearch_os_load5 Midterm load average</span><br><span class="line"># TYPE elasticsearch_os_load5 gauge</span><br><span class="line">elasticsearch_os_load5&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0.91</span><br><span class="line"># HELP elasticsearch_os_mem_actual_free_bytes Amount of free physical memory in bytes</span><br><span class="line"># TYPE elasticsearch_os_mem_actual_free_bytes gauge</span><br><span class="line">elasticsearch_os_mem_actual_free_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_os_mem_actual_used_bytes Amount of used physical memory in bytes</span><br><span class="line"># TYPE elasticsearch_os_mem_actual_used_bytes gauge</span><br><span class="line">elasticsearch_os_mem_actual_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_os_mem_free_bytes Amount of free physical memory in bytes</span><br><span class="line"># TYPE elasticsearch_os_mem_free_bytes gauge</span><br><span class="line">elasticsearch_os_mem_free_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 4.4890112e+08</span><br><span class="line"># HELP elasticsearch_os_mem_used_bytes Amount of used physical memory in bytes</span><br><span class="line"># TYPE elasticsearch_os_mem_used_bytes gauge</span><br><span class="line">elasticsearch_os_mem_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.752511488e+09</span><br><span class="line"># HELP elasticsearch_process_cpu_percent Percent CPU used by process</span><br><span class="line"># TYPE elasticsearch_process_cpu_percent gauge</span><br><span class="line">elasticsearch_process_cpu_percent&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 11</span><br><span class="line"># HELP elasticsearch_process_cpu_time_seconds_sum Process CPU time in seconds</span><br><span class="line"># TYPE elasticsearch_process_cpu_time_seconds_sum counter</span><br><span class="line">elasticsearch_process_cpu_time_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;sys&quot;&#125; 0</span><br><span class="line">elasticsearch_process_cpu_time_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;total&quot;&#125; 3.33384018e+06</span><br><span class="line">elasticsearch_process_cpu_time_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;user&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_process_max_files_descriptors Max file descriptors</span><br><span class="line"># TYPE elasticsearch_process_max_files_descriptors gauge</span><br><span class="line">elasticsearch_process_max_files_descriptors&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 131072</span><br><span class="line"># HELP elasticsearch_process_mem_resident_size_bytes Resident memory in use by process in bytes</span><br><span class="line"># TYPE elasticsearch_process_mem_resident_size_bytes gauge</span><br><span class="line">elasticsearch_process_mem_resident_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_process_mem_share_size_bytes Shared memory in use by process in bytes</span><br><span class="line"># TYPE elasticsearch_process_mem_share_size_bytes gauge</span><br><span class="line">elasticsearch_process_mem_share_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_process_mem_virtual_size_bytes Total virtual memory used in bytes</span><br><span class="line"># TYPE elasticsearch_process_mem_virtual_size_bytes gauge</span><br><span class="line">elasticsearch_process_mem_virtual_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.020691456e+09</span><br><span class="line"># HELP elasticsearch_process_open_files_count Open file descriptors</span><br><span class="line"># TYPE elasticsearch_process_open_files_count gauge</span><br><span class="line">elasticsearch_process_open_files_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 9494</span><br><span class="line"># HELP elasticsearch_thread_pool_active_count Thread Pool threads active</span><br><span class="line"># TYPE elasticsearch_thread_pool_active_count gauge</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 1</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_thread_pool_completed_count Thread Pool operations completed</span><br><span class="line"># TYPE elasticsearch_thread_pool_completed_count counter</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 364</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 177298</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 4.17230997e+08</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 2.8834648e+07</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 2.8825882e+07</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 2.7632481e+07</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 3.89357528e+08</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 607</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 6.07410367e+08</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 7.75406281e+08</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 6.7644324e+07</span><br><span class="line"># HELP elasticsearch_thread_pool_largest_count Thread Pool largest threads count</span><br><span class="line"># TYPE elasticsearch_thread_pool_largest_count gauge</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 8</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 128</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 4</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 4</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 5</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 80</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 7</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 4</span><br><span class="line"># HELP elasticsearch_thread_pool_queue_count Thread Pool operations queued</span><br><span class="line"># TYPE elasticsearch_thread_pool_queue_count gauge</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_thread_pool_rejected_count Thread Pool operations rejected</span><br><span class="line"># TYPE elasticsearch_thread_pool_rejected_count counter</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_thread_pool_threads_count Thread Pool current threads count</span><br><span class="line"># TYPE elasticsearch_thread_pool_threads_count gauge</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 1</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 128</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 4</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 4</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 5</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 80</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 7</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 4</span><br><span class="line"># HELP elasticsearch_transport_rx_packets_total Count of packets received</span><br><span class="line"># TYPE elasticsearch_transport_rx_packets_total counter</span><br><span class="line">elasticsearch_transport_rx_packets_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_transport_rx_size_bytes_total Total number of bytes received</span><br><span class="line"># TYPE elasticsearch_transport_rx_size_bytes_total counter</span><br><span class="line">elasticsearch_transport_rx_size_bytes_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_transport_tx_packets_total Count of packets sent</span><br><span class="line"># TYPE elasticsearch_transport_tx_packets_total counter</span><br><span class="line">elasticsearch_transport_tx_packets_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_transport_tx_size_bytes_total Total number of bytes sent</span><br><span class="line"># TYPE elasticsearch_transport_tx_size_bytes_total counter</span><br><span class="line">elasticsearch_transport_tx_size_bytes_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.</span><br><span class="line"># TYPE go_gc_duration_seconds summary</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;0&quot;&#125; 3.6794e-05</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;0.25&quot;&#125; 6.2783e-05</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;0.5&quot;&#125; 8.6707e-05</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;0.75&quot;&#125; 0.00011003</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;1&quot;&#125; 0.015864101</span><br><span class="line">go_gc_duration_seconds_sum 0.02416966</span><br><span class="line">go_gc_duration_seconds_count 40</span><br><span class="line"># HELP go_goroutines Number of goroutines that currently exist.</span><br><span class="line"># TYPE go_goroutines gauge</span><br><span class="line">go_goroutines 19</span><br><span class="line"># HELP go_info Information about the Go environment.</span><br><span class="line"># TYPE go_info gauge</span><br><span class="line">go_info&#123;version=&quot;go1.16.9&quot;&#125; 1</span><br><span class="line"># HELP go_memstats_alloc_bytes Number of bytes allocated and still in use.</span><br><span class="line"># TYPE go_memstats_alloc_bytes gauge</span><br><span class="line">go_memstats_alloc_bytes 3.887952e+06</span><br><span class="line"># HELP go_memstats_alloc_bytes_total Total number of bytes allocated, even if freed.</span><br><span class="line"># TYPE go_memstats_alloc_bytes_total counter</span><br><span class="line">go_memstats_alloc_bytes_total 9.1755768e+07</span><br><span class="line"># HELP go_memstats_buck_hash_sys_bytes Number of bytes used by the profiling bucket hash table.</span><br><span class="line"># TYPE go_memstats_buck_hash_sys_bytes gauge</span><br><span class="line">go_memstats_buck_hash_sys_bytes 1.458561e+06</span><br><span class="line"># HELP go_memstats_frees_total Total number of frees.</span><br><span class="line"># TYPE go_memstats_frees_total counter</span><br><span class="line">go_memstats_frees_total 884448</span><br><span class="line"># HELP go_memstats_gc_cpu_fraction The fraction of this program&#x27;s available CPU time used by the GC since the program started.</span><br><span class="line"># TYPE go_memstats_gc_cpu_fraction gauge</span><br><span class="line">go_memstats_gc_cpu_fraction 2.339386189125989e-05</span><br><span class="line"># HELP go_memstats_gc_sys_bytes Number of bytes used for garbage collection system metadata.</span><br><span class="line"># TYPE go_memstats_gc_sys_bytes gauge</span><br><span class="line">go_memstats_gc_sys_bytes 5.026296e+06</span><br><span class="line"># HELP go_memstats_heap_alloc_bytes Number of heap bytes allocated and still in use.</span><br><span class="line"># TYPE go_memstats_heap_alloc_bytes gauge</span><br><span class="line">go_memstats_heap_alloc_bytes 3.887952e+06</span><br><span class="line"># HELP go_memstats_heap_idle_bytes Number of heap bytes waiting to be used.</span><br><span class="line"># TYPE go_memstats_heap_idle_bytes gauge</span><br><span class="line">go_memstats_heap_idle_bytes 6.1202432e+07</span><br><span class="line"># HELP go_memstats_heap_inuse_bytes Number of heap bytes that are in use.</span><br><span class="line"># TYPE go_memstats_heap_inuse_bytes gauge</span><br><span class="line">go_memstats_heap_inuse_bytes 5.185536e+06</span><br><span class="line"># HELP go_memstats_heap_objects Number of allocated objects.</span><br><span class="line"># TYPE go_memstats_heap_objects gauge</span><br><span class="line">go_memstats_heap_objects 16097</span><br><span class="line"># HELP go_memstats_heap_released_bytes Number of heap bytes released to OS.</span><br><span class="line"># TYPE go_memstats_heap_released_bytes gauge</span><br><span class="line">go_memstats_heap_released_bytes 6.0555264e+07</span><br><span class="line"># HELP go_memstats_heap_sys_bytes Number of heap bytes obtained from system.</span><br><span class="line"># TYPE go_memstats_heap_sys_bytes gauge</span><br><span class="line">go_memstats_heap_sys_bytes 6.6387968e+07</span><br><span class="line"># HELP go_memstats_last_gc_time_seconds Number of seconds since 1970 of last garbage collection.</span><br><span class="line"># TYPE go_memstats_last_gc_time_seconds gauge</span><br><span class="line">go_memstats_last_gc_time_seconds 1.6412798140310771e+09</span><br><span class="line"># HELP go_memstats_lookups_total Total number of pointer lookups.</span><br><span class="line"># TYPE go_memstats_lookups_total counter</span><br><span class="line">go_memstats_lookups_total 0</span><br><span class="line"># HELP go_memstats_mallocs_total Total number of mallocs.</span><br><span class="line"># TYPE go_memstats_mallocs_total counter</span><br><span class="line">go_memstats_mallocs_total 900545</span><br><span class="line"># HELP go_memstats_mcache_inuse_bytes Number of bytes in use by mcache structures.</span><br><span class="line"># TYPE go_memstats_mcache_inuse_bytes gauge</span><br><span class="line">go_memstats_mcache_inuse_bytes 4800</span><br><span class="line"># HELP go_memstats_mcache_sys_bytes Number of bytes used for mcache structures obtained from system.</span><br><span class="line"># TYPE go_memstats_mcache_sys_bytes gauge</span><br><span class="line">go_memstats_mcache_sys_bytes 16384</span><br><span class="line"># HELP go_memstats_mspan_inuse_bytes Number of bytes in use by mspan structures.</span><br><span class="line"># TYPE go_memstats_mspan_inuse_bytes gauge</span><br><span class="line">go_memstats_mspan_inuse_bytes 84456</span><br><span class="line"># HELP go_memstats_mspan_sys_bytes Number of bytes used for mspan structures obtained from system.</span><br><span class="line"># TYPE go_memstats_mspan_sys_bytes gauge</span><br><span class="line">go_memstats_mspan_sys_bytes 98304</span><br><span class="line"># HELP go_memstats_next_gc_bytes Number of heap bytes when next garbage collection will take place.</span><br><span class="line"># TYPE go_memstats_next_gc_bytes gauge</span><br><span class="line">go_memstats_next_gc_bytes 5.69084e+06</span><br><span class="line"># HELP go_memstats_other_sys_bytes Number of bytes used for other system allocations.</span><br><span class="line"># TYPE go_memstats_other_sys_bytes gauge</span><br><span class="line">go_memstats_other_sys_bytes 856207</span><br><span class="line"># HELP go_memstats_stack_inuse_bytes Number of bytes in use by the stack allocator.</span><br><span class="line"># TYPE go_memstats_stack_inuse_bytes gauge</span><br><span class="line">go_memstats_stack_inuse_bytes 688128</span><br><span class="line"># HELP go_memstats_stack_sys_bytes Number of bytes obtained from system for stack allocator.</span><br><span class="line"># TYPE go_memstats_stack_sys_bytes gauge</span><br><span class="line">go_memstats_stack_sys_bytes 688128</span><br><span class="line"># HELP go_memstats_sys_bytes Number of bytes obtained from system.</span><br><span class="line"># TYPE go_memstats_sys_bytes gauge</span><br><span class="line">go_memstats_sys_bytes 7.4531848e+07</span><br><span class="line"># HELP go_threads Number of OS threads created.</span><br><span class="line"># TYPE go_threads gauge</span><br><span class="line">go_threads 9</span><br><span class="line"># HELP process_cpu_seconds_total Total user and system CPU time spent in seconds.</span><br><span class="line"># TYPE process_cpu_seconds_total counter</span><br><span class="line">process_cpu_seconds_total 0.87</span><br><span class="line"># HELP process_max_fds Maximum number of open file descriptors.</span><br><span class="line"># TYPE process_max_fds gauge</span><br><span class="line">process_max_fds 131072</span><br><span class="line"># HELP process_open_fds Number of open file descriptors.</span><br><span class="line"># TYPE process_open_fds gauge</span><br><span class="line">process_open_fds 13</span><br><span class="line"># HELP process_resident_memory_bytes Resident memory size in bytes.</span><br><span class="line"># TYPE process_resident_memory_bytes gauge</span><br><span class="line">process_resident_memory_bytes 1.5499264e+07</span><br><span class="line"># HELP process_start_time_seconds Start time of the process since unix epoch in seconds.</span><br><span class="line"># TYPE process_start_time_seconds gauge</span><br><span class="line">process_start_time_seconds 1.64127828876e+09</span><br><span class="line"># HELP process_virtual_memory_bytes Virtual memory size in bytes.</span><br><span class="line"># TYPE process_virtual_memory_bytes gauge</span><br><span class="line">process_virtual_memory_bytes 7.31824128e+08</span><br><span class="line"># HELP process_virtual_memory_max_bytes Maximum amount of virtual memory available in bytes.</span><br><span class="line"># TYPE process_virtual_memory_max_bytes gauge</span><br><span class="line">process_virtual_memory_max_bytes 1.8446744073709552e+19</span><br><span class="line"># HELP promhttp_metric_handler_requests_in_flight Current number of scrapes being served.</span><br><span class="line"># TYPE promhttp_metric_handler_requests_in_flight gauge</span><br><span class="line">promhttp_metric_handler_requests_in_flight 1</span><br><span class="line"># HELP promhttp_metric_handler_requests_total Total number of scrapes by HTTP status code.</span><br><span class="line"># TYPE promhttp_metric_handler_requests_total counter</span><br><span class="line">promhttp_metric_handler_requests_total&#123;code=&quot;200&quot;&#125; 85</span><br><span class="line">promhttp_metric_handler_requests_total&#123;code=&quot;500&quot;&#125; 0</span><br><span class="line">promhttp_metric_handler_requests_total&#123;code=&quot;503&quot;&#125; 0</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> 云监控 </tag>
            
            <tag> 云计算 </tag>
            
            <tag> elasticsearch-exporter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>prometheus监控之node各项指标</title>
      <link href="/2022/01/06/prometheus%E7%9B%91%E6%8E%A7%E4%B9%8Bnode%E5%90%84%E9%A1%B9%E6%8C%87%E6%A0%87/"/>
      <url>/2022/01/06/prometheus%E7%9B%91%E6%8E%A7%E4%B9%8Bnode%E5%90%84%E9%A1%B9%E6%8C%87%E6%A0%87/</url>
      
        <content type="html"><![CDATA[<h1 id="根据node-exporter采集的指标得到想要的指标"><a href="#根据node-exporter采集的指标得到想要的指标" class="headerlink" title="根据node-exporter采集的指标得到想要的指标"></a>根据node-exporter采集的指标得到想要的指标</h1><ol><li><p>所有node节点的磁盘大小总和</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">type：Singlestat</span><br><span class="line">Unit： bytes</span><br><span class="line">metrics:</span><br><span class="line">sum(node_filesystem_size_bytes&#123;device=~&quot;/.*&quot;&#125;)</span><br></pre></td></tr></table></figure></li><li><p>所有node节点的内存大小总和</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">type：Singlestat</span><br><span class="line">Unit： bytes</span><br><span class="line">metrics:</span><br><span class="line">sum(node_memory_MemTotal_bytes)</span><br></pre></td></tr></table></figure></li><li><p>所有node节点的CPU大小总和</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">type：Singlestat</span><br><span class="line">Unit： bytes</span><br><span class="line">metrics:</span><br><span class="line">count(node_cpu_seconds_total&#123;mode=&#x27;system&#x27;&#125;)</span><br></pre></td></tr></table></figure></li><li></li></ol><h1 id="node-exporter采集的指标"><a href="#node-exporter采集的指标" class="headerlink" title="node-exporter采集的指标"></a>node-exporter采集的指标</h1>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> node-exporter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>img-test</title>
      <link href="/2022/01/06/img-test/"/>
      <url>/2022/01/06/img-test/</url>
      
        <content type="html"><![CDATA[<p>用于测试图片是否可以正常展示</p><img src="/2022/01/06/img-test/image-20220106104706904.png" class="" title="This is an image"><p><img src="image-20220106105728993.png" alt="image-20220106105728993"></p><p>操作步骤：</p><ol><li>在_config.yml 中修改如下配置为 true<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">post_asset_folder: true</span><br></pre></td></tr></table></figure></li><li>文章中使用图片</li></ol><ul><li>第一种可以使用，makedown的格式  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![image-20220106105728993](image-20220106105728993.png)</span><br></pre></td></tr></table></figure></li><li>第二种 使用如下方式  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% asset_img image-20220106104706904.png This is an image %&#125;</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>注意：其中的 image-20220106104706904.png 为需要展示的图片名称，该图片会放在与当前博客同名的目录下面</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>新的第一篇博客</title>
      <link href="/2022/01/06/my-first-blog/"/>
      <url>/2022/01/06/my-first-blog/</url>
      
        <content type="html"><![CDATA[<h1 id="开始新的博客"><a href="#开始新的博客" class="headerlink" title="开始新的博客"></a>开始新的博客</h1><p>这里使用github+hexo搭建了自己的博客，参考了如下的博客文章：<br>[GitHub Pages + Hexo搭建个人博客网站，史上最全教程] <a href="https://blog.csdn.net/yaorongke/article/details/119089190">https://blog.csdn.net/yaorongke/article/details/119089190</a></p><h1 id="hexo操作"><a href="#hexo操作" class="headerlink" title="hexo操作"></a>hexo操作</h1><ol><li>创建新博客文档<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &#x27;博客文章标题&#x27;</span><br></pre></td></tr></table></figure></li><li>生成html文件<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure></li><li>发布到github<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure></li><li>启动本地<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure></li></ol><h1 id="在不同机器上更新博客"><a href="#在不同机器上更新博客" class="headerlink" title="在不同机器上更新博客"></a>在不同机器上更新博客</h1><ol><li><p>在新机器上安装npm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 这里根据不同的系统进行安装</span><br></pre></td></tr></table></figure></li><li><p>安装hexo</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure></li><li><p>拉取github上面的项目</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:xxxxx/xxx.git</span><br></pre></td></tr></table></figure></li></ol><p>然后即可在博客的根目录下使用hexo进行操作</p>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>prometheus服务动态发现之http_sd_config</title>
      <link href="/2021/12/22/prometheus%E6%9C%8D%E5%8A%A1%E5%8A%A8%E6%80%81%E5%8F%91%E7%8E%B0%E4%B9%8Bhttp_sd_config/"/>
      <url>/2021/12/22/prometheus%E6%9C%8D%E5%8A%A1%E5%8A%A8%E6%80%81%E5%8F%91%E7%8E%B0%E4%B9%8Bhttp_sd_config/</url>
      
        <content type="html"><![CDATA[<p>prometheus提供了多种动态服务发现的方式，这里讲一下<code>http_sd_config</code>的配置方法</p><h2 id="官方说明"><a href="#官方说明" class="headerlink" title="官方说明"></a>官方说明</h2><p>先来看下prometheus官方文档的说明</p><p><img src="image-20211222181659426.png" alt="image-20211222181659426"></p><p>大致就是说：需要自己提供一个http访问地址，prometheus能够通过访问该地址得到需要发现的服务节点的数据，并且该地址返回的json数据结构要与图中保持一致。</p><h2 id="配置说明"><a href="#配置说明" class="headerlink" title="配置说明"></a>配置说明</h2><p>再来看下关于该选项有哪些配置项：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取目标服务的地址</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">&lt;string&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 刷新频率，间隔多久再次调用url获取目标服务</span></span><br><span class="line">[ <span class="attr">refresh_interval:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">60s</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># API服务器的身份验证信息，用于访问url时验证身份用</span></span><br><span class="line"><span class="comment"># 下面这几项 `basic_auth`, `authorization` 、`oauth2` 是互斥的，也就是说只需要根据具体情况配一项身份验证的方式就可以</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可选的HTTP基本认证信息。其中 `password` and `password_file` 这两项是互斥的</span></span><br><span class="line"><span class="attr">basic_auth:</span></span><br><span class="line">  [ <span class="attr">username:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line">  [ <span class="attr">password:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line">  [ <span class="attr">password_file:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可选的“授权”头配置。</span></span><br><span class="line"><span class="attr">authorization:</span></span><br><span class="line">  <span class="comment"># Sets the authentication type.</span></span><br><span class="line">  [ <span class="attr">type:</span> <span class="string">&lt;string&gt;</span> <span class="string">|</span> <span class="attr">default:</span> <span class="string">Bearer</span> ]</span><br><span class="line">  <span class="comment"># Sets the credentials. It is mutually exclusive with</span></span><br><span class="line">  <span class="comment"># `credentials_file`.</span></span><br><span class="line">  [ <span class="attr">credentials:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line">  <span class="comment"># Sets the credentials to the credentials read from the configured file.</span></span><br><span class="line">  <span class="comment"># It is mutually exclusive with `credentials`.</span></span><br><span class="line">  [ <span class="attr">credentials_file:</span> <span class="string">&lt;filename&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># #可选OAuth 2.0配置。</span></span><br><span class="line"><span class="attr">oauth2:</span></span><br><span class="line">  [ <span class="string">&lt;oauth2&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional proxy URL.</span></span><br><span class="line">[ <span class="attr">proxy_url:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure whether HTTP requests follow HTTP 3xx redirects.</span></span><br><span class="line">[ <span class="attr">follow_redirects:</span> <span class="string">&lt;bool&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">true</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># TLS configuration.</span></span><br><span class="line"><span class="attr">tls_config:</span></span><br><span class="line">  [ <span class="string">&lt;tls_config&gt;</span> ]</span><br></pre></td></tr></table></figure><p>如果自己提供的接口不用验证身份，那么只需要配置url和刷新频率即可；</p><h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><p><strong>前提：</strong></p><ul><li>已经部署好了prometheus和各exporter的节点</li><li>其中prometheus最好是最新版（2.30版本及以前的版本好像不支持）</li></ul><h3 id="开发动态获取服务的接口"><a href="#开发动态获取服务的接口" class="headerlink" title="开发动态获取服务的接口"></a>开发动态获取服务的接口</h3><p>我这里用的java开发的一个后端程序，controller的代码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/prometheus&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrometheusController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/getTarget&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTarget</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List exporterList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        Map target = <span class="keyword">new</span> HashMap();</span><br><span class="line">        <span class="comment">// 服务节点地址</span></span><br><span class="line">        List targetList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        targetList.add(<span class="string">&quot;172.18.40.40:9100&quot;</span>);</span><br><span class="line">        targetList.add(<span class="string">&quot;172.18.40.91:9100&quot;</span>);</span><br><span class="line">        <span class="comment">// 标签</span></span><br><span class="line">        Map labelsMap = <span class="keyword">new</span> HashMap();</span><br><span class="line">        labelsMap.put(<span class="string">&quot;acc&quot;</span> , <span class="string">&quot;acc1&quot;</span>);</span><br><span class="line">        labelsMap.put(<span class="string">&quot;uuid&quot;</span> , <span class="string">&quot;123123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        target.put(<span class="string">&quot;targets&quot;</span> , targetList);</span><br><span class="line">        target.put(<span class="string">&quot;labels&quot;</span> , labelsMap);</span><br><span class="line"></span><br><span class="line">        exporterList.add(target);</span><br><span class="line">        <span class="keyword">return</span> JSONObject.toJSONString(exporterList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在浏览器中，访问该接口，查看返回的数据如下：</p><p><img src="image-20211222184806273.png" alt="image-20211222184806273"></p><h3 id="修改prometheus的配置"><a href="#修改prometheus的配置" class="headerlink" title="修改prometheus的配置"></a>修改prometheus的配置</h3><p>prometheus的配置如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;test-node&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.26.62.xx:12000/prometheus/getTarget</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br></pre></td></tr></table></figure><blockquote><p>配置说明：</p><p><a href="http://172.26.62.xx:12000/prometheus/getTarget%EF%BC%9A%E8%AF%A5%E5%9C%B0%E5%9D%80%E6%98%AF%E5%90%8E%E7%AB%AF%E7%A8%8B%E5%BA%8F%E6%8F%90%E4%BE%9B%E7%9A%84">http://172.26.62.xx:12000/prometheus/getTarget：该地址是后端程序提供的</a></p></blockquote><p>修改完prometheus的配置后，重启prometheus或调用prometheus的reload的接口(<a href="http://ip:port/-/reload">http://ip:port/-/reload</a>)</p><h3 id="检查"><a href="#检查" class="headerlink" title="检查"></a>检查</h3><p>访问prometheus的界面，查看我后端接口提供的服务是否被发现</p><p><img src="image-20211222184910138.png" alt="image-20211222184910138"></p><p>可以发现，prometheus已经成功监控到了提供的服务；</p><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>修改接口提供的数据，在不重启和不重新加载prometheus的情况下，观察prometheus会不会变化监控的节点</p><ol><li>我在后端服务接口中，添加了一个不存在的节点</li></ol><p><img src="image-20211222185422933.png" alt="image-20211222185422933"></p><ol start="2"><li>等待几秒钟后，可以发现prometheus发现了该节点，但还没有去访问该节点去获取监控数据，因此状态为UNKNOWN</li></ol><p><img src="image-20211222185438507.png" alt="image-20211222185438507"></p><ol start="3"><li>在等几秒，prometheus去访问该几点时，发现服务是不存在的，调整状态为DOWN</li></ol><p><img src="image-20211222185501042.png" alt="image-20211222185501042"></p><ol start="4"><li>从prometheus的日志也可以看出，每隔 5s 就掉一次我的后端服务</li></ol><p><img src="image-20211222191259320.png" alt="image-20211222191259320"></p>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> 云监控 </tag>
            
            <tag> 云计算 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginx访问限制配置</title>
      <link href="/2021/12/15/Nginx%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6%E9%85%8D%E7%BD%AE/"/>
      <url>/2021/12/15/Nginx%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="限制下载速度"><a href="#限制下载速度" class="headerlink" title="限制下载速度"></a>限制下载速度</h1><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location xxx &#123;</span><br><span class="line">            limit_rate 100k;</span><br><span class="line">...</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p><img src="image-20220107120229415.png" alt="image-20220107120229415"></p><p>重启nginx后，可以发现下载速度，确实被限制在 100k/s 左右</p><p><img src="image-20220107120250231.png" alt="image-20220107120250231"></p><h1 id="限制并发数"><a href="#限制并发数" class="headerlink" title="限制并发数"></a>限制并发数</h1><p>添加如下两行参数</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http&#123;</span><br><span class="line">limit_conn_zone $binary_remote_addr zone=one:10m;</span><br><span class="line">...</span><br><span class="line">service&#123;</span><br><span class="line">...</span><br><span class="line">location xxx&#123;</span><br><span class="line">limit_conn one <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="image-20220107120309413.png" alt="image-20220107120309413"></p>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Prometheus学习记录</title>
      <link href="/2021/10/10/Prometheus%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
      <url>/2021/10/10/Prometheus%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><ol><li>Prometheus 是什么；</li><li>我们为什么要去了解Prometheus ；</li><li>为什么是Prometheus 而不是其他的监控系统；Prometheus 与 目前 相对比较活跃的其他监控系统有哪些 优势；</li><li>了解Prometheus 的基本架构，以及Prometheus 是如何运作的；</li></ol><h2 id="Prometheus-是什么？"><a href="#Prometheus-是什么？" class="headerlink" title="Prometheus 是什么？"></a>Prometheus 是什么？</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Prometheus受启发于Google的Brogmon监控系统（相似的Kubernetes是从Google的Brog系统演变而来），从2012年开始由前Google工程师在Soundcloud以开源软件的形式进行研发，并且于2015年早期对外发布早期版本。2016年5月继Kubernetes之后成为第二个正式加入CNCF基金会的项目，同年6月正式发布1.0版本。2017年底发布了基于全新存储层的2.0版本，能更好地与容器平台、云平台配合。</p><p><img src="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/prometheus-release-roadmaps.png" alt="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/prometheus-release-roadmaps.png"></p><p>Prometheus简史</p><p>Prometheus作为新一代的云原生监控系统，目前已经有超过650+位贡献者参与到Prometheus的研发工作上，并且超过120+项的第三方集成。</p><p>目前的社区活跃度：从如下在github上的截图可以看出其活跃度 (截图时间2021.9.2)<br><img src="https://s2.loli.net/2022/01/10/vA58OKX3NgrDjkz.png" alt="20220110223828"></p><h3 id="监控目标"><a href="#监控目标" class="headerlink" title="监控目标"></a>监控目标</h3><ul><li>长期趋势分析：通过对监控样本数据的持续收集和统计，对监控指标进行长期趋势分析。例如，通过对磁盘空间增长率的判断，我们可以提前预测在未来什么时间节点上需要对资源进行扩容。（<strong>实际就是使用PromQL表达式（内置的函数）对采集的监控数据进行数学分析（统计学）</strong> ）</li><li>对照分析：两个版本的系统运行资源使用情况的差异如何？在不同容量情况下系统的并发和负载变化如何？通过监控能够方便的对系统进行跟踪和比较。（<strong>同样是基于监控数据，例如：两个相同应用在不同的系统资源下的并发和负载变化对比</strong>）</li><li>告警：当系统出现或者即将出现故障时，监控系统需要迅速反应并通知管理员，从而能够对问题进行快速的处理或者提前预防问题的发生，避免出现对业务的影响。（）  <strong>Prometheus 服务端产生告警，由Alertmanager进行处理</strong></li><li>故障分析与定位：当问题发生后，需要对问题进行调查和处理。通过对不同监控监控以及历史数据的分析，能够找到并解决根源问题。（<strong>分析监控数据</strong>）</li><li>数据可视化：通过可视化仪表盘能够直接获取系统的运行状态、资源使用情况、以及服务运行状态等直观的信息。（<strong>Prometheus 自带数据可视化UI ， 但是比较简单</strong>）</li></ul><p>这里还是只是对Prometheus 进行了一个简单的介绍，我们可以简单的将其类比和宇云的 monitor(云监控中心)</p><h2 id="为什么要去了解Prometheus"><a href="#为什么要去了解Prometheus" class="headerlink" title="为什么要去了解Prometheus"></a>为什么要去了解Prometheus</h2><p>或者说为什么要了解其他的 监控系统，我们的平台已经有了 云监控中心；</p><p>个人认为有如下几个原因：</p><ol><li>了解其他的监控系统，学习它们的优点，对 我们平台的云监控进行优化，例如 监控指标的完善与优化</li><li>目前我们的云监控中心是基于虚拟机的监控，对容器的监控还没有涉足，需要学习这些优秀产品的经验，为后期和宇云进军k8s做准备</li></ol><p>当然针对不同的需求，还需要具体分析</p><h2 id="各监控系统的对比"><a href="#各监控系统的对比" class="headerlink" title="各监控系统的对比"></a>各监控系统的对比</h2><p>目前市面上相对比较活跃的监控系统：</p><ul><li>Prometheus</li><li>Zabbix</li><li>Nagios</li></ul><h3 id="Prometheus-与-Zabbix-对比"><a href="#Prometheus-与-Zabbix-对比" class="headerlink" title="Prometheus 与 Zabbix 对比"></a>Prometheus 与 Zabbix 对比</h3><h3 id="架构对比"><a href="#架构对比" class="headerlink" title="架构对比"></a>架构对比</h3><p>prometheus:<br><img src="https://s2.loli.net/2022/01/10/4XbgTnJldGeV6vF.png" alt="20220110224409"></p><p>zabbix:<br><img src="https://s2.loli.net/2022/01/10/5msuDeH1y2polVK.png" alt="20220110224548"></p><h3 id="综合对比"><a href="#综合对比" class="headerlink" title="综合对比"></a>综合对比</h3><p><img src="https://s2.loli.net/2022/01/10/d6bKIP7oscNl4Oy.png" alt="20220110224609"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>我们要对容器进行兼容，则需要学习Prometheus。</p><h3 id="Prometheus-与-Nagios-对比"><a href="#Prometheus-与-Nagios-对比" class="headerlink" title="Prometheus 与 Nagios 对比"></a>Prometheus 与 Nagios 对比</h3><h3 id="架构对比-1"><a href="#架构对比-1" class="headerlink" title="架构对比"></a>架构对比</h3><p><img src="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/nagios-platform.png" alt="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/nagios-platform.png"></p><p>Nagios监控系统</p><p>Nagios的主要功能是监控服务和主机。Nagios软件需要安装在一台独立的服务器上运行，该服务器称为监控中心。每一台被监控的硬件主机或者服务都需要运行一个与监控中心服务器进行通信的Nagios软件后台程序，可以理解为Agent或者插件；</p><p><img src="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/nagios-ui.png" alt="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/nagios-ui.png"></p><p>Nagios主机监控页面</p><p>首先对于Nagios而言，大部分的监控能力都是围绕系统的一些边缘性的问题，主要针对系统服务和资源的状态以及应用程序的可用性。 例如：Nagios通过check_disk插件可以用于检查磁盘空间，check_load用于检查CPU负载等。这些插件会返回4种Nagios可识别的状态，0(OK)表示正常，1(WARNING)表示警告，2(CRITTCAL)表示错误，3(UNKNOWN)表示未知错误，并通过Web UI显示出来。</p><p>对于Nagios这类系统而言，其核心是采用了测试和告警(check&amp;alert)的监控系统模型。 对于基于这类模型的监控系统而言往往存在以下问题：</p><ul><li>与业务脱离的监控：监控系统获取到的监控指标与业务本身也是一种分离的关系。好比客户可能关注的是服务的可用性、服务的SLA等级，而监控系统却只能根据系统负载去产生告警；</li><li>运维管理难度大：Nagios这一类监控系统本身运维管理难度就比较大，需要有专业的人员进行安装，配置和管理，而且过程并不简单；</li><li>可扩展性低： 监控系统自身难以扩展，以适应监控规模的变化；</li><li>问题定位难度大：当问题产生之后（比如主机负载异常增加）对于用户而言，他们看到的依然是一个黑盒，他们无法了解主机上服务真正的运行情况，因此当故障发生后，这些告警信息并不能有效的支持用户对于故障根源问题的分析和定位。</li></ul><p>nagios现在用的相对比较少了，数据展示太不友好，还需要插件实现，ui也不够美观；自动化批量监控也掉链子。</p><h3 id="Prometheus-的优势"><a href="#Prometheus-的优势" class="headerlink" title="Prometheus 的优势"></a>Prometheus 的优势</h3><p>Prometheus是一个开源的完整监控解决方案，其对传统监控系统的测试和告警模型进行了彻底的颠覆，形成了基于中央化的规则计算、统一分析和告警的新模型。 相比于传统监控系统Prometheus具有以下优点：</p><ul><li><strong>易于管理</strong>  Prometheus基于Pull模型的架构方式，可以在任何地方（本地电脑，开发环境，测试环境）搭建我们的监控系统。对于一些复杂的情况，还可以使用Prometheus服务发现(Service Discovery)的能力动态管理监控目标。</li><li><strong>监控服务的内部运行状态</strong>  Pometheus鼓励用户监控服务的内部状态，基于Prometheus丰富的Client库，用户可以轻松的<strong>在应用程序中添加对Prometheus的支持</strong>，从而让用户可以获取服务和应用内部真正的运行状态。<br>  <img src="https://s2.loli.net/2022/01/10/TF1wfWp6UDcgCzY.png" alt="20220110224102"></li><li><strong>强大的数据模型</strong>  所有采集的监控数据均以指标(metric)的形式保存在内置的时间序列数据库当中(TSDB)。所有的样本除了基本的指标名称以外，还包含一组用于描述该样本特征的标签。  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http_request_status&#123;code=&#x27;200&#x27;,content_path=&#x27;/api/path&#x27;, environment=&#x27;produment&#x27;&#125; =&gt; [value1@timestamp1,value2@timestamp2...]</span><br><span class="line">http_request_status&#123;code=&#x27;200&#x27;,content_path=&#x27;/api/path2&#x27;, environment=&#x27;produment&#x27;&#125; =&gt; [value1@timestamp1,value2@timestamp2...]</span><br></pre></td></tr></table></figure></li><li><strong>强大的查询语言PromQL</strong>  Prometheus内置了一个强大的数据查询语言PromQL。 通过PromQL可以实现对监控数据的查询、聚合。同时PromQL也被应用于数据可视化(如Grafana)以及告警当中。</li><li><strong>高效</strong>  对于监控系统而言，大量的监控任务必然导致有大量的数据产生。而Prometheus可以高效地处理这些数据，对于单一Prometheus Server实例而言它可以处理：<ul><li>数以百万的监控指标</li><li><code>每秒处理数十万的数据点</code></li></ul></li><li><strong>可扩展</strong>  Prometheus是如此简单，因此你可以在每个数据中心、每个团队运行独立的Prometheus Sevrer。Prometheus对于联邦集群的支持，可以让多个Prometheus实例产生一个逻辑集群，当单实例Prometheus Server处理的任务量过大时，通过使用功能分区(sharding)+联邦集群(federation)可以对其进行扩展。</li><li><strong>易于集成</strong>  使用Prometheus可以快速搭建监控服务，并且可以非常方便地在应用程序中进行集成。目前支持： Java， JMX， Python， Go，Ruby， .Net， Node.js等等语言的客户端SDK，基于这些SDK可以快速让应用程序纳入到Prometheus的监控当中，或者开发自己的监控数据收集程序。同时这些客户端收集的监控数据，不仅仅支持Prometheus，还能支持Graphite这些其他的监控工具。  同时Prometheus还支持与其他的监控系统进行集成：Graphite， Statsd， Collected， Scollector， muini， Nagios等。  Prometheus社区还提供了大量第三方实现的监控数据采集支持：JMX， CloudWatch， EC2， MySQL， PostgresSQL， Haskell， Bash， SNMP， Consul， Haproxy， Mesos， Bind， CouchDB， Django， Memcached， RabbitMQ， Redis， RethinkDB， Rsyslog等等。</li><li><strong>可视化</strong>  Prometheus Server中自带了一个Prometheus UI，通过这个UI可以方便地直接对数据进行查询，并且支持直接以图形化的形式展示数据。同时Prometheus还提供了一个独立的基于Ruby On Rails的Dashboard解决方案Promdash。最新的Grafana可视化工具也已经提供了完整的Prometheus支持，基于Grafana可以创建更加精美的监控图标。基于Prometheus提供的API还可以实现自己的监控可视化UI。</li><li><strong>开放性</strong>  通常来说当我们需要监控一个应用程序时，一般需要该应用程序提供对相应监控系统协议的支持。因此应用程序会与所选择的监控系统进行绑定。为了减少这种绑定所带来的限制。对于决策者而言要么你就直接在应用中集成该监控系统的支持，要么就在外部创建单独的服务来适配不同的监控系统。  而对于Prometheus来说，使用Prometheus的client library的输出格式不止支持Prometheus的格式化数据，也可以输出支持其它监控系统的格式化数据，比如Graphite。  <strong>因此你甚至可以在不使用Prometheus的情况下，采用Prometheus的client library来让你的应用程序支持监控数据采集。</strong></li></ul><p>可以说 Prometheus 是一个监控告警系统，也是一个时序数据库</p><p>了解了 Prometheus 是什么，也分析了 为什么要了解 Prometheus ， 现在来 看看 Prometheus 是怎么做的</p><h2 id="Prometheus-解析"><a href="#Prometheus-解析" class="headerlink" title="Prometheus 解析"></a>Prometheus 解析</h2><h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><p><img src="https://s2.loli.net/2022/01/10/lWZISmsc35DgNyi.png" alt="20220110161226"></p><h3 id="三大套件"><a href="#三大套件" class="headerlink" title="三大套件"></a>三大套件</h3><ul><li>Prometheus Server 主要负责数据采集和存储，提供PromQL查询语言的支持。</li><li>Alertmanager 警告管理器，用来进行报警，告警信息推送。</li><li>Push Gateway 支持临时性Job主动推送指标的中间网关。<br><img src="https://s2.loli.net/2022/01/10/g3KtPwJfuSvm59F.png" alt="20220110224903"></li></ul><h3 id="Prometheus-Server"><a href="#Prometheus-Server" class="headerlink" title="Prometheus Server"></a>Prometheus Server</h3><h3 id="Prometheus-是如何采集监控数据"><a href="#Prometheus-是如何采集监控数据" class="headerlink" title="Prometheus 是如何采集监控数据"></a>Prometheus 是如何采集监控数据</h3><p>监控数据的获取有如下两种方式：</p><ul><li>Pull 的方式  通过定时抓取 目标上的Metrics数据，每个抓取目标都需要暴露一个HTTP服务接口用于Prometheus定时抓取，这种调用被监控对象获取监控数据的方式被称为Pull  <img src="https://s2.loli.net/2022/01/10/2FbqXkZROdJUYfB.png" alt="20210902134110181.png"></li><li>Push的方式  Prometheus提供对PushGateway的支持，这些系统主动推送metrics到PushGateway，而Prometheus只是定时去Gateway上抓取数据。<br>  <img src="https://s2.loli.net/2022/01/10/spdMak7KgcI1Pui.png" alt="20220110225032"></li></ul><p>什么情况下会用到 Push的方式呢？</p><ul><li>Prometheus 采用定时 Pull 模式，可能由于子网络或者防火墙的原因，不能直接拉取各个 Target 的指标数据，此时可以采用各个 Target 往 PushGateway 上 Push 数据，然后 Prometheus 去 PushGateway 上定时 pull。</li><li>其次在监控各个业务数据时，需要将各个不同的业务数据进行统一汇总，此时也可以采用 PushGateway 来统一收集，然后 Prometheus 来统一拉取。</li></ul><p>采集数据的主要流程如下：</p><ul><li>Prometheus server 定期从静态配置的主机或服务发现的 targets 拉取数据(zookeeper，consul，DNS SRV Lookup等方式)</li><li>当新拉取的数据大于配置内存缓存区的时候（或者 超过了设定的时间窗口的时间），Prometheus会将数据持久化到磁盘，也可以远程持久化到云端。</li><li>Prometheus通过PromQL、API、Console和其他可视化组件如Grafana、Promdash展示数据。</li><li>Prometheus 可以配置rules，然后定时查询数据，当条件触发的时候，会将告警推送到配置的Alertmanager。</li><li>Alertmanager收到告警的时候，会根据配置，聚合，去重，降噪，最后发出警告， Alertmanager是独立于Prometheus的一个组件，可以支持Prometheus的查询语句，提供十分灵活的报警方式。</li></ul><p>指标数据的样式如下：</p><p><a href="http://172.26.65.49:9100/metrics">http://172.26.65.49:9100/metrics</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># HELP node_cpu_guest_seconds_total Seconds the CPUs spent in guests (VMs) for each mode.</span><br><span class="line"># TYPE node_cpu_guest_seconds_total counter</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;0&quot;,mode=&quot;nice&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;0&quot;,mode=&quot;user&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;1&quot;,mode=&quot;nice&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;1&quot;,mode=&quot;user&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;2&quot;,mode=&quot;nice&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;2&quot;,mode=&quot;user&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;3&quot;,mode=&quot;nice&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;3&quot;,mode=&quot;user&quot;&#125; 0</span><br><span class="line"># HELP node_cpu_package_throttles_total Number of times this CPU package has been throttled.</span><br><span class="line"># TYPE node_cpu_package_throttles_total counter</span><br><span class="line">node_cpu_package_throttles_total&#123;package=&quot;0&quot;&#125; 0</span><br><span class="line"># HELP node_cpu_scaling_frequency_hertz Current scaled CPU thread frequency in hertz.</span><br><span class="line"># TYPE node_cpu_scaling_frequency_hertz gauge</span><br><span class="line">node_cpu_scaling_frequency_hertz&#123;cpu=&quot;0&quot;&#125; 2.44895e+09</span><br><span class="line">node_cpu_scaling_frequency_hertz&#123;cpu=&quot;1&quot;&#125; 2.402221e+09</span><br><span class="line">node_cpu_scaling_frequency_hertz&#123;cpu=&quot;2&quot;&#125; 2.415515e+09</span><br><span class="line">node_cpu_scaling_frequency_hertz&#123;cpu=&quot;3&quot;&#125; 2.200134e+09</span><br><span class="line"># HELP node_cpu_scaling_frequency_max_hertz Maximum scaled CPU thread frequency in hertz.</span><br><span class="line"># TYPE node_cpu_scaling_frequency_max_hertz gauge</span><br><span class="line">node_cpu_scaling_frequency_max_hertz&#123;cpu=&quot;0&quot;&#125; 2.7e+09</span><br><span class="line">node_cpu_scaling_frequency_max_hertz&#123;cpu=&quot;1&quot;&#125; 2.7e+09</span><br><span class="line">node_cpu_scaling_frequency_max_hertz&#123;cpu=&quot;2&quot;&#125; 2.7e+09</span><br><span class="line">node_cpu_scaling_frequency_max_hertz&#123;cpu=&quot;3&quot;&#125; 2.7e+09</span><br><span class="line"># HELP node_cpu_scaling_frequency_min_hertz Minimum scaled CPU thread frequency in hertz.</span><br><span class="line"># TYPE node_cpu_scaling_frequency_min_hertz gauge</span><br><span class="line">node_cpu_scaling_frequency_min_hertz&#123;cpu=&quot;0&quot;&#125; 5e+08</span><br><span class="line">node_cpu_scaling_frequency_min_hertz&#123;cpu=&quot;1&quot;&#125; 5e+08</span><br><span class="line">node_cpu_scaling_frequency_min_hertz&#123;cpu=&quot;2&quot;&#125; 5e+08</span><br><span class="line">node_cpu_scaling_frequency_min_hertz&#123;cpu=&quot;3&quot;&#125; 5e+08</span><br></pre></td></tr></table></figure><h3 id="Metric类型（指标类型）"><a href="#Metric类型（指标类型）" class="headerlink" title="Metric类型（指标类型）"></a>Metric类型（指标类型）</h3><p>Prometheus定义了4种不同的指标类型(metric type)：Counter（计数器）、Gauge（仪表盘）、Histogram（直方图）、Summary（摘要）</p><p><strong>Counter：只增不减的计数器</strong></p><p>Counter类型的指标其工作方式和计数器一样，只增不减（除非系统发生重置）。</p><p>常见的监控指标，如http_requests_total，node_cpu都是Counter类型的监控指标。 一般在定义Counter类型指标的名称时推荐使用_total作为后缀。</p><p><strong>Gauge：可增可减的仪表盘</strong></p><p>Gauge类型的指标侧重于反应系统的当前状态。</p><p>常见指标如：node_memory_MemFree（主机当前空闲的内容大小）、node_memory_MemAvailable（可用内存大小）都是Gauge类型的监控指标。</p><p><strong>使用Histogram和Summary分析数据分布情况</strong></p><p>除了Counter和Gauge类型的监控指标以外，Prometheus还定义了Histogram和Summary的指标类型。Histogram和Summary主用用于统计和分析样本的分布情况</p><p>在大多数情况下人们都倾向于使用某些量化指标的平均值，例如CPU的平均使用率、页面的平均响应时间。这种方式的问题很明显，以系统API调用的平均响应时间为例：如果大多数API请求都维持在100ms的响应时间范围内，而个别请求的响应时间需要5s，那么就会导致某些WEB页面的响应时间落到中位数的情况，而这种现象被称为长尾问题。</p><p>为了区分是平均的慢还是长尾的慢，最简单的方式就是按照请求延迟的范围进行分组。例如，统计延迟在010ms之间的请求数有多少而1020ms之间的请求数又有多少。通过这种方式可以快速分析系统慢的原因。Histogram和Summary都是为了能够解决这样问题的存在，通过Histogram和Summary类型的监控指标，我们可以快速了解监控样本的分布情况。</p><p>例如： wal_fsync处理的处理时间 (Summary类型)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># HELP prometheus_tsdb_wal_fsync_duration_seconds Duration of WAL fsync.</span><br><span class="line"># TYPE prometheus_tsdb_wal_fsync_duration_seconds summary</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds&#123;quantile=&quot;0.5&quot;&#125; 0.012352463</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds&#123;quantile=&quot;0.9&quot;&#125; 0.014458005</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds&#123;quantile=&quot;0.99&quot;&#125; 0.017316173</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds_sum 2.888716127000002</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds_count 216</span><br></pre></td></tr></table></figure><h3 id="Exporter-详解"><a href="#Exporter-详解" class="headerlink" title="Exporter 详解"></a>Exporter 详解</h3><p>广义上讲所有可以向Prometheus提供监控样本数据的程序都可以被称为一个Exporter，而Exporter的一个实例称为target。</p><p>Exporter 是 安装在被监控的目标（主机或服务）上，用于采集目标上相应的监控数据，同时会暴露出Http的接口，普罗米修斯通过HTTP协议使用Pull的方式周期性拉取相应的数据。</p><p><img src="https://static.sitestack.cn/projects/prometheus-book/exporter/static/prometheus-exporter.png" alt="https://static.sitestack.cn/projects/prometheus-book/exporter/static/prometheus-exporter.png"></p><p><strong>Exporter的来源</strong></p><p>从Exporter的来源上来讲，主要分为两类：</p><ul><li>社区提供的  Prometheus社区提供了丰富的Exporter实现，涵盖了从基础设施，中间件以及网络等各个方面的监控功能。这些Exporter可以实现大部分通用的监控需求。下表列举一些社区中常用的Exporter：(<a href="https://prometheus.io/docs/instrumenting/exporters/">Exporters and integrations | Prometheus</a>官网)  <a href="https://www.notion.so/9c3a22421d0f4e92a7eecd761c6a9a72">Untitled</a></li><li>用户自定义的  除了直接使用社区提供的Exporter程序以外，用户还可以基于Prometheus提供的Client Library创建自己的Exporter程序，目前Promthues社区官方提供了对以下编程语言的支持：Go、Java/Scala、Python、Ruby。同时还有第三方实现的如：Bash、C++、Common Lisp、Erlang,、Haskeel、Lua、Node.js、PHP、Rust等。  【使用Client Java构建Exporter程序】<a href="https://www.bookstack.cn/read/prometheus-book/exporter-client_library_java.md">https://www.bookstack.cn/read/prometheus-book/exporter-client_library_java.md</a></li></ul><h3 id="Prometheus监控数据的存储"><a href="#Prometheus监控数据的存储" class="headerlink" title="Prometheus监控数据的存储"></a>Prometheus监控数据的存储</h3><p>数据存储的方式分为如下两种：</p><ul><li>一种是本地存储。通过Prometheus自带的时序数据库将数据保存到本地磁盘，为了性能考虑，建议使用SSD。但本地存储的容量毕竟有限，建议不要保存超过一个月的数据。</li><li>另一种是远程存储，适用于存储大量监控数据。通过中间层的适配器的转化，目前Prometheus支持OpenTSDB、InfluxDB、Elasticsearch等后端存储，通过适配器实现Prometheus存储的remote write和remote read接口，便可以接入Prometheus作为远端存储使用。</li></ul><p><strong>本地存储</strong><br><img src="https://s2.loli.net/2022/01/10/AiXPxNTDVLsmWlz.png" alt="20220110225208"></p><p>特点：</p><p>① 自身运维和管理的复杂度低</p><p>Prometheus 2.x 采用自定义的存储格式将样本数据保存在本地磁盘当中。如下所示，按照两个小时为一个时间窗口，将两小时内产生的数据存储在一个块(Block)中，每一个块中包含该时间窗口内的所有样本数据(chunks)，元数据文件(meta.json)以及索引文件(index)。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">t0            t1             t2             now</span><br><span class="line"> ┌───────────┐  ┌───────────┐  ┌───────────┐</span><br><span class="line"> │           │  │           │  │           │                 ┌────────────┐</span><br><span class="line"> │           │  │           │  │  mutable  │ &lt;─── write ──── ┤ Prometheus │</span><br><span class="line"> │           │  │           │  │           │                 └────────────┘</span><br><span class="line"> └───────────┘  └───────────┘  └───────────┘                        ^</span><br><span class="line">       └──────────────┴───────┬──────┘                              │</span><br><span class="line">                              │                                   query</span><br><span class="line">                              │                                     │</span><br><span class="line">                            merge ──────────────────────────────────┘</span><br></pre></td></tr></table></figure><p>当前时间窗口内正在收集的样本数据，<strong>Prometheus则会直接将数据保存在内存当中</strong>。为了确保此期间如果Prometheus发生崩溃或者重启时能够恢复数据，<strong>Prometheus启动时会从写入日志(WAL)进行重播，从而恢复数据</strong>。此期间如果通过API删除时间序列，删除记录也会保存在单独的逻辑文件当中(tombstone)。</p><p>在文件系统中这些块保存在单独的目录当中，Prometheus保存块数据的目录结构如下所示：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">./data</span><br><span class="line">   |- 01BKGV7JBM69T2G1BGBGM6KB12 # 块</span><br><span class="line">      |- meta.json  # 元数据</span><br><span class="line">      |- wal        # 写入日志</span><br><span class="line">        |- 000002</span><br><span class="line">        |- 000001</span><br><span class="line">   |- 01BKGTZQ1SYQJTR4PB43C8PD98  # 块</span><br><span class="line">      |- meta.json  #元数据</span><br><span class="line">      |- index   # 索引文件</span><br><span class="line">      |- chunks  # 样本数据</span><br><span class="line">        |- 000001</span><br><span class="line">      |- tombstones # 逻辑数据</span><br><span class="line">   |- 01BKGTZQ1HHWHV8FBJXW1Y3W0K</span><br><span class="line">      |- meta.json</span><br><span class="line">      |- wal</span><br><span class="line">        |-000001</span><br></pre></td></tr></table></figure><p>本地存储配置：<br><img src="https://s2.loli.net/2022/01/10/LTGFmsN2awX1Sk3.png" alt="20220110225415"></p><p>对Prometheus Server的本地磁盘空间做容量规划时，可以通过以下公式计算：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">needed_disk_space = retention_time_seconds * ingested_samples_per_second * bytes_per_sample</span><br></pre></td></tr></table></figure><p>其中：保留时间(retention_time_seconds)、每秒获取样本数(ingested_samples_per_second)、样本大小(bytes_per_sample)</p><p>减少本地磁盘的容量需求，可以通过 减少 每秒获取样本数 这个数值 的方式 ；有两种手段，一是减少时间序列的数量，二是增加采集样本的时间间隔。考虑到Prometheus会对时间序列进行压缩效率，减少时间序列的数量效果更明显。</p><p><strong>远程存储</strong><br><img src="https://s2.loli.net/2022/01/10/fW85C4wrsaqTFom.png" alt="20220110225442"></p><p>特点：</p><p>① 可以持久化大量历史数据</p><p>② 灵活扩展</p><p>③ 方便迁移</p><p>为了保持Prometheus的简单性，Prometheus并没有尝试在自身中解决以上问题，而是通过定义两个标准接口(remote_write/remote_read)，让用户可以基于这两个接口对接将数据保存到任意第三方的存储服务中，这种方式在Promthues中称为Remote Storage。</p><p>【Remote Write】（远程写）</p><p>用户可以在Prometheus配置文件中指定Remote Write(远程写)的URL地址，一旦设置了该配置项，Prometheus将采集到的样本数据通过HTTP的形式发送给适配器(Adaptor)。而用户则可以在适配器中对接外部任意的服务。外部服务可以是真正的存储系统，公有云的存储服务，也可以是消息队列等任意形式。</p><p><img src="https://static.sitestack.cn/projects/prometheus-book/ha/static/remote-write-path-2.png" alt="https://static.sitestack.cn/projects/prometheus-book/ha/static/remote-write-path-2.png"></p><p>Remote Write</p><p>【Remote Read】（远程读）</p><p>Promthues的Remote Read(远程读)也通过了一个适配器实现。在远程读的流程当中，当用户发起查询请求后，Promthues将向remote_read中配置的URL发起查询请求(matchers,ranges)，Adaptor根据请求条件从第三方存储服务中获取响应的数据。同时将数据转换为Promthues的原始样本数据返回给Prometheus Server。</p><p>当获取到样本数据后，Promthues在本地使用PromQL对样本数据进行二次处理</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注意：启用远程读设置后，只在数据查询时有效，对于规则文件的处理，以及Metadata API的处理都只基于Prometheus本地存储完成。</span><br></pre></td></tr></table></figure><p><img src="https://static.sitestack.cn/projects/prometheus-book/ha/static/remote_read_path-2.png" alt="https://static.sitestack.cn/projects/prometheus-book/ha/static/remote_read_path-2.png"></p><p>Remote Read</p><p><strong>适配器：需要部署到数据库所在的服务器，暴露HTTP服务，并且将数据写入数据库中</strong></p><p>远程读写配置：</p><p>Prometheus配置文件中添加remote_write和remote_read配置，其中url用于指定远程读/写的HTTP服务地址。如果该URL启动了认证则可以通过<strong>basic_auth</strong>进行安全认证配置。对于https的支持需要设定<strong>tls_concig</strong>。<strong>proxy_url</strong>主要用于Prometheus无法直接访问适配器服务的情况下。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The URL of the endpoint to send samples to.</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">&lt;string&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Timeout for requests to the remote write endpoint.</span></span><br><span class="line">[ <span class="attr">remote_timeout:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">30s</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Custom HTTP headers to be sent along with each remote write request.</span></span><br><span class="line"><span class="comment"># Be aware that headers that are set by Prometheus itself can&#x27;t be overwritten.</span></span><br><span class="line"><span class="attr">headers:</span></span><br><span class="line">  [ <span class="string">&lt;string&gt;:</span> <span class="string">&lt;string&gt;</span> <span class="string">...</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># List of remote write relabel configurations.</span></span><br><span class="line"><span class="attr">write_relabel_configs:</span></span><br><span class="line">  [ <span class="bullet">-</span> <span class="string">&lt;relabel_config&gt;</span> <span class="string">...</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Name of the remote write config, which if specified must be unique among remote write configs.</span></span><br><span class="line"><span class="comment"># The name will be used in metrics and logging in place of a generated value to help users distinguish between</span></span><br><span class="line"><span class="comment"># remote write configs.</span></span><br><span class="line">[ <span class="attr">name:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Enables sending of exemplars over remote write. Note that exemplar storage itself must be enabled for exemplars to be scraped in the first place.</span></span><br><span class="line">[ <span class="attr">send_exemplars:</span> <span class="string">&lt;boolean&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">false</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sets the `Authorization` header on every remote write request with the</span></span><br><span class="line"><span class="comment"># configured username and password.</span></span><br><span class="line"><span class="comment"># password and password_file are mutually exclusive.</span></span><br><span class="line"><span class="attr">basic_auth:</span></span><br><span class="line">  [ <span class="attr">username:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line">  [ <span class="attr">password:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line">  [ <span class="attr">password_file:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional `Authorization` header configuration.</span></span><br><span class="line"><span class="attr">authorization:</span></span><br><span class="line">  <span class="comment"># Sets the authentication type.</span></span><br><span class="line">  [ <span class="attr">type:</span> <span class="string">&lt;string&gt;</span> <span class="string">|</span> <span class="attr">default:</span> <span class="string">Bearer</span> ]</span><br><span class="line">  <span class="comment"># Sets the credentials. It is mutually exclusive with</span></span><br><span class="line">  <span class="comment"># `credentials_file`.</span></span><br><span class="line">  [ <span class="attr">credentials:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line">  <span class="comment"># Sets the credentials to the credentials read from the configured file.</span></span><br><span class="line">  <span class="comment"># It is mutually exclusive with `credentials`.</span></span><br><span class="line">  [ <span class="attr">credentials_file:</span> <span class="string">&lt;filename&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optionally configures AWS&#x27;s Signature Verification 4 signing process to</span></span><br><span class="line"><span class="comment"># sign requests. Cannot be set at the same time as basic_auth, authorization, or oauth2.</span></span><br><span class="line"><span class="comment"># To use the default credentials from the AWS SDK, use `sigv4: &#123;&#125;`.</span></span><br><span class="line"><span class="attr">sigv4:</span></span><br><span class="line">  <span class="comment"># The AWS region. If blank, the region from the default credentials chain</span></span><br><span class="line">  <span class="comment"># is used.</span></span><br><span class="line">  [ <span class="attr">region:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># The AWS API keys. If blank, the environment variables `AWS_ACCESS_KEY_ID`</span></span><br><span class="line">  <span class="comment"># and `AWS_SECRET_ACCESS_KEY` are used.</span></span><br><span class="line">  [ <span class="attr">access_key:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line">  [ <span class="attr">secret_key:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Named AWS profile used to authenticate.</span></span><br><span class="line">  [ <span class="attr">profile:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># AWS Role ARN, an alternative to using AWS API keys.</span></span><br><span class="line">  [ <span class="attr">role_arn:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional OAuth 2.0 configuration.</span></span><br><span class="line"><span class="comment"># Cannot be used at the same time as basic_auth, authorization, or sigv4.</span></span><br><span class="line"><span class="attr">oauth2:</span></span><br><span class="line">  [ <span class="string">&lt;oauth2&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configures the remote write request&#x27;s TLS settings.</span></span><br><span class="line"><span class="attr">tls_config:</span></span><br><span class="line">  [ <span class="string">&lt;tls_config&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional proxy URL.</span></span><br><span class="line">[ <span class="attr">proxy_url:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure whether HTTP requests follow HTTP 3xx redirects.</span></span><br><span class="line">[ <span class="attr">follow_redirects:</span> <span class="string">&lt;bool&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">true</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configures the queue used to write to remote storage.</span></span><br><span class="line"><span class="attr">queue_config:</span></span><br><span class="line">  <span class="comment"># Number of samples to buffer per shard before we block reading of more</span></span><br><span class="line">  <span class="comment"># samples from the WAL. It is recommended to have enough capacity in each</span></span><br><span class="line">  <span class="comment"># shard to buffer several requests to keep throughput up while processing</span></span><br><span class="line">  <span class="comment"># occasional slow remote requests.</span></span><br><span class="line">  [ <span class="attr">capacity:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">2500</span> ]</span><br><span class="line">  <span class="comment"># Maximum number of shards, i.e. amount of concurrency.</span></span><br><span class="line">  [ <span class="attr">max_shards:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">200</span> ]</span><br><span class="line">  <span class="comment"># Minimum number of shards, i.e. amount of concurrency.</span></span><br><span class="line">  [ <span class="attr">min_shards:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">1</span> ]</span><br><span class="line">  <span class="comment"># Maximum number of samples per send.</span></span><br><span class="line">  [ <span class="attr">max_samples_per_send:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">500</span>]</span><br><span class="line">  <span class="comment"># Maximum time a sample will wait in buffer.</span></span><br><span class="line">  [ <span class="attr">batch_send_deadline:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">5s</span> ]</span><br><span class="line">  <span class="comment"># Initial retry delay. Gets doubled for every retry.</span></span><br><span class="line">  [ <span class="attr">min_backoff:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">30ms</span> ]</span><br><span class="line">  <span class="comment"># Maximum retry delay.</span></span><br><span class="line">  [ <span class="attr">max_backoff:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">5s</span> ]</span><br><span class="line">  <span class="comment"># Retry upon receiving a 429 status code from the remote-write storage.</span></span><br><span class="line">  <span class="comment"># This is experimental and might change in the future.</span></span><br><span class="line">  [ <span class="attr">retry_on_http_429:</span> <span class="string">&lt;boolean&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">false</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configures the sending of series metadata to remote storage.</span></span><br><span class="line"><span class="comment"># Metadata configuration is subject to change at any point</span></span><br><span class="line"><span class="comment"># or be removed in future releases.</span></span><br><span class="line"><span class="attr">metadata_config:</span></span><br><span class="line">  <span class="comment"># Whether metric metadata is sent to remote storage or not.</span></span><br><span class="line">  [ <span class="attr">send:</span> <span class="string">&lt;boolean&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">true</span> ]</span><br><span class="line">  <span class="comment"># How frequently metric metadata is sent to remote storage.</span></span><br><span class="line">  [ <span class="attr">send_interval:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">1m</span> ]</span><br><span class="line">  <span class="comment"># Maximum number of samples per send.</span></span><br><span class="line">  [ <span class="attr">max_samples_per_send:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">500</span>]</span><br></pre></td></tr></table></figure><p>自定义Remote Storage Adaptor（自定义适配器）</p><p>详情见：<a href="https://www.bookstack.cn/read/prometheus-book/ha-prometheus-remote-storage.md">https://www.bookstack.cn/read/prometheus-book/ha-prometheus-remote-storage.md</a></p><p>目前Prometheus社区也提供了部分对于第三方数据库的Remote Storage支持：<br><img src="https://s2.loli.net/2022/01/10/oOcUiTAahxPEg1Q.png" alt="20220110225757"></p><p>自定义Remote Storage Adaptor（自定义适配器）以及 使用Influxdb作为Remote Storage的案例</p><p>详情见：<a href="https://www.bookstack.cn/read/prometheus-book/ha-prometheus-remote-storage.md">https://www.bookstack.cn/read/prometheus-book/ha-prometheus-remote-storage.md</a></p><h3 id="Prometheus-高可用部署方案"><a href="#Prometheus-高可用部署方案" class="headerlink" title="Prometheus 高可用部署方案"></a>Prometheus 高可用部署方案</h3><p>Prometheus的本地存储给Prometheus带来了简单高效的使用体验，可以让Promthues在单节点的情况下满足大部分用户的监控需求。但是本地存储也同时限制了Prometheus的可扩展性，带来了数据持久化等一系列的问题。通过Prometheus的Remote Storage特性可以解决这一系列问题，包括Promthues的动态扩展，以及历史数据的存储。</p><p>而除了数据持久化问题以外，影响Promthues性能表现的另外一个重要因素就是数据采集任务量，以及单台Promthues能够处理的时间序列数。因此当监控规模大到Promthues单台无法有效处理的情况下，可以选择利用Promthues的联邦集群的特性，将Promthues的监控任务划分到不同的实例当中。</p><h3 id="基本HA：服务可用性"><a href="#基本HA：服务可用性" class="headerlink" title="基本HA：服务可用性"></a>基本HA：服务可用性</h3><p>由于Promthues的Pull机制的设计，为了确保Promthues服务的可用性，用户只需要部署多套Prometheus Server实例，并且采集相同的Exporter目标即可。</p><p><img src="https://s2.loli.net/2022/01/11/xDUuMBghdOrAY3z.png" alt="20220111102211"></p><p>基本的HA模式只能确保Promthues服务的可用性问题，但是不解决Prometheus Server之间的数据一致性问题以及持久化问题(数据丢失后无法恢复)，也无法进行动态的扩展。因此这种部署方式适合监控规模不大，Promthues Server也不会频繁发生迁移的情况，并且只需要保存短周期监控数据的场景。</p><h3 id="基本HA-远程存储"><a href="#基本HA-远程存储" class="headerlink" title="基本HA + 远程存储"></a>基本HA + 远程存储</h3><p>在基本HA模式的基础上通过添加Remote Storage存储支持，将监控数据保存在第三方存储服务上。</p><p><img src="https://s2.loli.net/2022/01/11/Bis1wHDNqLT2mEv.png" alt="20220111102237"></p><p>在解决了Promthues服务可用性的基础上，同时确保了数据的持久化，当Promthues Server发生宕机或者数据丢失的情况下，可以快速的恢复。 同时Promthues Server可能很好的进行迁移。因此，该方案适用于用户监控规模不大，但是希望能够将监控数据持久化，同时能够确保Promthues Server的可迁移性的场景。</p><h3 id="基本HA-远程存储-联邦集群"><a href="#基本HA-远程存储-联邦集群" class="headerlink" title="基本HA + 远程存储 + 联邦集群"></a>基本HA + 远程存储 + 联邦集群</h3><p>当单台Promthues Server无法处理大量的采集任务时，用户可以考虑基于Prometheus联邦集群的方式将监控采集任务划分到不同的Promthues实例当中即在任务级别功能分区。<br><img src="https://s2.loli.net/2022/01/11/6DW5ZoFQC41qr3w.png" alt="20220111102254"></p><p>这种部署方式一般适用于两种场景：</p><p>场景一：单数据中心 + 大量的采集任务</p><p>这种场景下Promthues的性能瓶颈主要在于大量的采集任务，因此用户需要利用Prometheus联邦集群的特性，将不同类型的采集任务划分到不同的Promthues子服务中，从而实现功能分区。例如一个Promthues Server负责采集基础设施相关的监控指标，另外一个Prometheus Server负责采集应用监控指标。再有上层Prometheus Server实现对数据的汇聚。</p><p>场景二：多数据中心</p><p>这种模式也适合与多数据中心的情况，当Promthues Server无法直接与数据中心中的Exporter进行通讯时，在每一个数据中部署一个单独的Promthues Server负责当前数据中心的采集任务是一个不错的方式。这样可以避免用户进行大量的网络配置，只需要确保主Promthues Server实例能够与当前数据中心的Prometheus Server通讯即可。 中心Promthues Server负责实现对多数据中心数据的聚合。</p><h3 id="告警处理Alertmanager"><a href="#告警处理Alertmanager" class="headerlink" title="告警处理Alertmanager"></a>告警处理Alertmanager</h3><p>如下所示，通过在Prometheus中定义AlertRule（告警规则），Prometheus会周期性的对告警规则进行计算，如果满足告警触发条件就会向Alertmanager发送告警信息。<br><img src="https://s2.loli.net/2022/01/10/8cJPyEwRiqXGOFL.png" alt="20220110225920"></p><h3 id="自定义Prometheus告警规则"><a href="#自定义Prometheus告警规则" class="headerlink" title="自定义Prometheus告警规则"></a>自定义Prometheus告警规则</h3><p>定义告警规则：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">groups:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">example</span></span><br><span class="line">    <span class="attr">rules:</span>  <span class="comment"># Alert for any instance that is unreachable for &gt;5 minutes.  </span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">InstanceDown</span>    </span><br><span class="line">        <span class="attr">expr:</span> <span class="string">up</span> <span class="string">==</span> <span class="number">0</span>    </span><br><span class="line">        <span class="attr">for:</span> <span class="string">5m</span>    </span><br><span class="line">        <span class="attr">labels:</span>      </span><br><span class="line">        <span class="attr">severity:</span> <span class="string">page</span>    </span><br><span class="line">        <span class="attr">annotations:</span>      </span><br><span class="line">        <span class="attr">summary:</span> <span class="string">&quot;Instance <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span> down&quot;</span>      </span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span> of job <span class="template-variable">&#123;&#123; $labels.job &#125;&#125;</span> has been down for more than 5 minutes.&quot;</span>  <span class="comment"># Alert for any instance that has a median request latency &gt;1s.  </span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">APIHighRequestLatency</span>    </span><br><span class="line">        <span class="attr">expr:</span> <span class="string">api_http_request_latencies_second&#123;quantile=&quot;0.5&quot;&#125;</span> <span class="string">&gt;</span> <span class="number">1</span>    </span><br><span class="line">        <span class="attr">for: 10m    annotations:</span>      </span><br><span class="line">        <span class="attr">summary:</span> <span class="string">&quot;High request latency on <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span>&quot;</span>      </span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span> has a median request latency above 1s (current value: <span class="template-variable">&#123;&#123; $value &#125;&#125;</span>s)&quot;</span></span><br></pre></td></tr></table></figure><p>在告警规则文件中，我们可以将一组相关的规则设置定义在一个group下。在每一个group中我们可以定义多个告警规则(rule)。一条告警规则主要由以下几部分组成：</p><ul><li>alert：告警规则的名称。</li><li>expr：基于PromQL表达式告警触发条件，用于计算是否有时间序列满足该条件。</li><li>for：评估等待时间，可选参数。用于表示只有当触发条件持续一段时间后才发送告警。在等待期间新产生告警的状态为pending。</li><li>labels：自定义标签，允许用户指定要附加到告警上的一组附加标签。</li><li>annotations：用于指定一组附加信息，比如用于描述告警详细信息的文字等，annotations的内容在告警产生时会一同作为参数发送到Alertmanager。</li></ul><h3 id="监控数据的可视化"><a href="#监控数据的可视化" class="headerlink" title="监控数据的可视化"></a>监控数据的可视化</h3><h3 id="Prometheus自带的数据可视化界面"><a href="#Prometheus自带的数据可视化界面" class="headerlink" title="Prometheus自带的数据可视化界面"></a>Prometheus自带的数据可视化界面</h3><p><a href="http://172.26.65.49:9090/graph">http://172.26.65.49:9090/graph</a></p><p>例子：指标 prometheus_http_requests_total<br><img src="https://s2.loli.net/2022/01/10/7MBT8fGxvpcukt3.png" alt="20220110230003"></p><h3 id="使用Grafana展示数据"><a href="#使用Grafana展示数据" class="headerlink" title="使用Grafana展示数据"></a>使用Grafana展示数据</h3><p><a href="http://172.26.65.49:3000/?orgId=1">http://172.26.65.49:3000/?orgId=1</a><br><img src="https://s2.loli.net/2022/01/10/lQte3FBZvSaVf8R.png" alt="20220110230024"></p><p>网图：</p><p><img src="https://img-blog.csdnimg.cn/20210713100126346.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzUwNzQxMA==,size_16,color_FFFFFF,t_70" alt="https://img-blog.csdnimg.cn/20210713100126346.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzUwNzQxMA==,size_16,color_FFFFFF,t_70"></p><p>在这里插入图片描述</p><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><h3 id="监控Mysql"><a href="#监控Mysql" class="headerlink" title="监控Mysql"></a>监控Mysql</h3><p>前提条件：</p><ol><li>prometheus和grafana环境已搭建</li><li>docker环境已搭建</li><li>mysqld-exporter 所部署的机器上需要存在 mysql实例</li></ol><p>操作步骤如下：</p><ol><li>下载 <strong>prom/mysqld-exporter</strong> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull prom/mysqld-exporter</span><br></pre></td></tr></table></figure></li><li>在grafana上下载mysql监控数据展示模板 （ID：11323） <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://grafana.com/grafana/dashboards/11323</span><br></pre></td></tr></table></figure></li><li>运行mysqld-exporter <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d  --name mysql_exporter   --restart always  -e DATA_SOURCE_NAME=&#x27;root:root$123@(172.26.65.49:3306)/&#x27; --network host  prom/mysqld-exporter</span><br></pre></td></tr></table></figure></li><li>在prometheus的配置中添加 mysql_exporter 的job <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;MySQL&#x27;</span>    </span><br><span class="line">   <span class="attr">static_configs:</span>      </span><br><span class="line">       <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.26.65.49:9104&#x27;</span>]        </span><br><span class="line">       <span class="attr">labels:</span>          </span><br><span class="line">       <span class="attr">instance:</span> <span class="number">172.26</span><span class="number">.65</span><span class="number">.49</span><span class="string">:3306</span>    </span><br><span class="line">       <span class="attr">metrics_path:</span> <span class="string">&#x27;/metrics&#x27;</span></span><br></pre></td></tr></table></figure> <img src="https://s2.loli.net/2022/01/10/ZC3JpAKfBLTvihF.png" alt="20220110230129"></li><li>重启prometheus</li></ol><p>数据展示：<br><img src="https://s2.loli.net/2022/01/10/ozgLXB3p8kZ5tDm.png" alt="20220110230146"></p><p><img src="https://s2.loli.net/2022/01/10/A5vSMPGzU3Fjrhb.png" alt="20220110230202"></p><p><img src="https://s2.loli.net/2022/01/10/v1yXg4aoTQ3i5fZ.png" alt="20220110230224"></p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><h3 id="什么是时序数据库？"><a href="#什么是时序数据库？" class="headerlink" title="什么是时序数据库？"></a>什么是时序数据库？</h3><p>时间序列数据库主要用于指处理带时间标签（按照时间的顺序变化，即时间序列化）的数据，带时间标签的数据也称为时间序列数据。</p><p>例如：InfluxDB 、 ElasticSearch 等</p><p>es存时序数据如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;results&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;series&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;cpu_load_short&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;columns&quot;</span>: [</span><br><span class="line">                        <span class="string">&quot;time&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;value&quot;</span></span><br><span class="line">                    ],</span><br><span class="line">                    <span class="attr">&quot;values&quot;</span>: [</span><br><span class="line">                        [</span><br><span class="line">                            <span class="string">&quot;2015-06-11T20:46:02Z&quot;</span>,</span><br><span class="line">                            <span class="number">0.64</span></span><br><span class="line">                        ]</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> 云监控 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>

<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ä½¿ç”¨LangGraphæ„å»ºæ™ºèƒ½èŠå¤©æœºå™¨äººæŠ€æœ¯è§£æ</title>
      <link href="/2025/03/25/%E4%BD%BF%E7%94%A8LangGraph%E6%9E%84%E5%BB%BA%E6%99%BA%E8%83%BD%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90/"/>
      <url>/2025/03/25/%E4%BD%BF%E7%94%A8LangGraph%E6%9E%84%E5%BB%BA%E6%99%BA%E8%83%BD%E8%81%8A%E5%A4%A9%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%8A%80%E6%9C%AF%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="ğŸš€-ä½¿ç”¨LangGraphæ„å»ºæ™ºèƒ½èŠå¤©æœºå™¨äººæŠ€æœ¯è§£æ"><a href="#ğŸš€-ä½¿ç”¨LangGraphæ„å»ºæ™ºèƒ½èŠå¤©æœºå™¨äººæŠ€æœ¯è§£æ" class="headerlink" title="ğŸš€ ä½¿ç”¨LangGraphæ„å»ºæ™ºèƒ½èŠå¤©æœºå™¨äººæŠ€æœ¯è§£æ"></a>ğŸš€ ä½¿ç”¨LangGraphæ„å»ºæ™ºèƒ½èŠå¤©æœºå™¨äººæŠ€æœ¯è§£æ</h1><p><img src="https://example.com/banner.jpg" alt="LangGraph Banner"> <!-- å¯æ›¿æ¢ä¸ºå®é™…å›¾ç‰‡é“¾æ¥ --></p><p>æœ¬æ–‡å°†å¸¦æ‚¨é€æ­¥å®ç°ä¸€ä¸ªå…·å¤‡å¤šæ¨¡æ€èƒ½åŠ›çš„æ™ºèƒ½èŠå¤©æœºå™¨äººï¼Œæ¶µç›–<strong>çŠ¶æ€ç®¡ç†</strong>ã€<strong>å·¥å…·è°ƒç”¨</strong>ã€<strong>æŒä¹…åŒ–è®°å¿†</strong>å’Œ<strong>äººæœºåä½œ</strong>ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆè§£æï¼š</p><hr><h2 id="ğŸ“š-ç›®å½•"><a href="#ğŸ“š-ç›®å½•" class="headerlink" title="ğŸ“š ç›®å½•"></a>ğŸ“š ç›®å½•</h2><ol><li><a href="#-%E6%9E%B6%E6%9E%84%E6%A6%82%E8%BF%B0">æ¶æ„æ¦‚è¿°</a></li><li><a href="#%EF%B8%8F-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">ç¯å¢ƒé…ç½®</a></li><li><a href="#-%E5%9F%BA%E7%A1%80%E5%AF%B9%E8%AF%9D%E5%AE%9E%E7%8E%B0">åŸºç¡€å¯¹è¯å®ç°</a></li><li><a href="#-%E5%A2%9E%E5%BC%BA%E6%90%9C%E7%B4%A2%E8%83%BD%E5%8A%9B">å¢å¼ºæœç´¢èƒ½åŠ›</a> </li><li><a href="#-%E8%AE%B0%E5%BF%86%E6%8C%81%E4%B9%85%E5%8C%96">è®°å¿†æŒä¹…åŒ–</a></li><li><a href="#-%E4%BA%BA%E5%B7%A5%E5%AE%A1%E6%A0%B8%E6%9C%BA%E5%88%B6">äººå·¥å®¡æ ¸æœºåˆ¶</a></li><li><a href="#-%E7%8A%B6%E6%80%81%E7%83%AD%E6%9B%B4%E6%96%B0">çŠ¶æ€çƒ­æ›´æ–°</a></li><li><a href="#-%E9%83%A8%E7%BD%B2%E5%BB%BA%E8%AE%AE">éƒ¨ç½²å»ºè®®</a></li></ol><hr><h2 id="ğŸ—ï¸-æ¶æ„æ¦‚è¿°"><a href="#ğŸ—ï¸-æ¶æ„æ¦‚è¿°" class="headerlink" title="ğŸ—ï¸ æ¶æ„æ¦‚è¿°"></a>ğŸ—ï¸ æ¶æ„æ¦‚è¿°</h2><p><img src="https://example.com/architecture.png" alt="ç³»ç»Ÿæ¶æ„å›¾"> <!-- å¯æ›¿æ¢ä¸ºå®é™…æ¶æ„å›¾ --></p><p>æœ¬ç³»ç»Ÿå®ç°ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š</p><ul><li>âœ… å¤šè½®æ¬¡å¯¹è¯çŠ¶æ€ç®¡ç†</li><li>âœ… å®æ—¶ç½‘ç»œæœç´¢é›†æˆ</li><li>âœ… å¯¹è¯å†å²æŒä¹…åŒ–</li><li>âœ… äººå·¥å®¡æ ¸ä»‹å…¥æœºåˆ¶</li><li>âœ… è¿è¡Œæ—¶çŠ¶æ€çƒ­æ›´æ–°</li></ul><hr><h2 id="âš™ï¸-ç¯å¢ƒé…ç½®"><a href="#âš™ï¸-ç¯å¢ƒé…ç½®" class="headerlink" title="âš™ï¸ ç¯å¢ƒé…ç½®"></a>âš™ï¸ ç¯å¢ƒé…ç½®</h2><h3 id="ä¾èµ–å®‰è£…"><a href="#ä¾èµ–å®‰è£…" class="headerlink" title="ä¾èµ–å®‰è£…"></a>ä¾èµ–å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%%capture --no-stderr</span><br><span class="line">%pip install -U langgraph langsmith</span><br><span class="line">%pip install -U langchain_anthropic</span><br><span class="line">%pip install -U tavily-python</span><br></pre></td></tr></table></figure><h3 id="APIå¯†é’¥è®¾ç½®"><a href="#APIå¯†é’¥è®¾ç½®" class="headerlink" title="APIå¯†é’¥è®¾ç½®"></a>APIå¯†é’¥è®¾ç½®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> getpass</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_set_env</span>(<span class="params">var: <span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.environ.get(var):</span><br><span class="line">        os.environ[var] = getpass.getpass(<span class="string">f&quot;<span class="subst">&#123;var&#125;</span>: &quot;</span>)</span><br><span class="line"></span><br><span class="line">_set_env(<span class="string">&quot;ANTHROPIC_API_KEY&quot;</span>)</span><br><span class="line">_set_env(<span class="string">&quot;LANGSMITH_API_KEY&quot;</span>)</span><br><span class="line">_set_env(<span class="string">&quot;TAVILY_API_KEY&quot;</span>)</span><br><span class="line"></span><br><span class="line">os.environ[<span class="string">&quot;LANGCHAIN_TRACING_V2&quot;</span>] = <span class="string">&quot;true&quot;</span></span><br><span class="line">os.environ[<span class="string">&quot;LANGCHAIN_PROJECT&quot;</span>] = <span class="string">&quot;LangGraphé«˜çº§æ•™ç¨‹&quot;</span></span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ¤–-åŸºç¡€å¯¹è¯å®ç°"><a href="#ğŸ¤–-åŸºç¡€å¯¹è¯å®ç°" class="headerlink" title="ğŸ¤– åŸºç¡€å¯¹è¯å®ç°"></a>ğŸ¤– åŸºç¡€å¯¹è¯å®ç°</h2><h3 id="çŠ¶æ€æœºå®šä¹‰"><a href="#çŠ¶æ€æœºå®šä¹‰" class="headerlink" title="çŠ¶æ€æœºå®šä¹‰"></a>çŠ¶æ€æœºå®šä¹‰</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Annotated</span><br><span class="line"><span class="keyword">from</span> langgraph.graph <span class="keyword">import</span> StateGraph</span><br><span class="line"><span class="keyword">from</span> langgraph.graph.message <span class="keyword">import</span> add_messages</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChatState</span>(<span class="params">TypedDict</span>):</span></span><br><span class="line">    messages: Annotated[<span class="built_in">list</span>, add_messages]</span><br><span class="line"></span><br><span class="line">graph_builder = StateGraph(ChatState)</span><br></pre></td></tr></table></figure><h3 id="å¯¹è¯èŠ‚ç‚¹é…ç½®"><a href="#å¯¹è¯èŠ‚ç‚¹é…ç½®" class="headerlink" title="å¯¹è¯èŠ‚ç‚¹é…ç½®"></a>å¯¹è¯èŠ‚ç‚¹é…ç½®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_anthropic <span class="keyword">import</span> ChatAnthropic</span><br><span class="line"></span><br><span class="line">llm = ChatAnthropic(model=<span class="string">&quot;claude-3-haiku-20240307&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">chatbot_node</span>(<span class="params">state: ChatState</span>):</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;messages&quot;</span>: [llm.invoke(state[<span class="string">&quot;messages&quot;</span>])]&#125;</span><br><span class="line"></span><br><span class="line">graph_builder.add_node(<span class="string">&quot;chatbot&quot;</span>, chatbot_node)</span><br><span class="line">graph_builder.add_edge(<span class="string">&quot;chatbot&quot;</span>, END)</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ”-å¢å¼ºæœç´¢èƒ½åŠ›"><a href="#ğŸ”-å¢å¼ºæœç´¢èƒ½åŠ›" class="headerlink" title="ğŸ” å¢å¼ºæœç´¢èƒ½åŠ›"></a>ğŸ” å¢å¼ºæœç´¢èƒ½åŠ›</h2><h3 id="æœç´¢å·¥å…·é›†æˆ"><a href="#æœç´¢å·¥å…·é›†æˆ" class="headerlink" title="æœç´¢å·¥å…·é›†æˆ"></a>æœç´¢å·¥å…·é›†æˆ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.tools.tavily_search <span class="keyword">import</span> TavilySearchResults</span><br><span class="line"></span><br><span class="line">search_tool = TavilySearchResults(max_results=<span class="number">3</span>)</span><br><span class="line">llm_with_tools = llm.bind_tools([search_tool])</span><br></pre></td></tr></table></figure><h3 id="å·¥å…·è·¯ç”±æœºåˆ¶"><a href="#å·¥å…·è·¯ç”±æœºåˆ¶" class="headerlink" title="å·¥å…·è·¯ç”±æœºåˆ¶"></a>å·¥å…·è·¯ç”±æœºåˆ¶</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langgraph.prebuilt <span class="keyword">import</span> ToolNode, tools_condition</span><br><span class="line"></span><br><span class="line">tool_node = ToolNode([search_tool])</span><br><span class="line">graph_builder.add_node(<span class="string">&quot;search&quot;</span>, tool_node)</span><br><span class="line"></span><br><span class="line">graph_builder.add_conditional_edges(</span><br><span class="line">    <span class="string">&quot;chatbot&quot;</span>,</span><br><span class="line">    tools_condition,</span><br><span class="line">    &#123; <span class="string">&quot;search&quot;</span>: <span class="string">&quot;search&quot;</span>, <span class="string">&quot;END&quot;</span>: END &#125;</span><br><span class="line">)</span><br><span class="line">graph_builder.add_edge(<span class="string">&quot;search&quot;</span>, <span class="string">&quot;chatbot&quot;</span>)</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ§ -è®°å¿†æŒä¹…åŒ–"><a href="#ğŸ§ -è®°å¿†æŒä¹…åŒ–" class="headerlink" title="ğŸ§  è®°å¿†æŒä¹…åŒ–"></a>ğŸ§  è®°å¿†æŒä¹…åŒ–</h2><h3 id="è®°å¿†å­˜å‚¨æ–¹æ¡ˆ"><a href="#è®°å¿†å­˜å‚¨æ–¹æ¡ˆ" class="headerlink" title="è®°å¿†å­˜å‚¨æ–¹æ¡ˆ"></a>è®°å¿†å­˜å‚¨æ–¹æ¡ˆ</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langgraph.checkpoint.sqlite <span class="keyword">import</span> SqliteSaver</span><br><span class="line"></span><br><span class="line">memory = SqliteSaver.from_conn_string(<span class="string">&quot;:memory:&quot;</span>)</span><br><span class="line">graph = graph_builder.<span class="built_in">compile</span>(checkpointer=memory)</span><br></pre></td></tr></table></figure><h3 id="å¤šä¼šè¯ç®¡ç†"><a href="#å¤šä¼šè¯ç®¡ç†" class="headerlink" title="å¤šä¼šè¯ç®¡ç†"></a>å¤šä¼šè¯ç®¡ç†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæ–°ä¼šè¯</span></span><br><span class="line">config = &#123;<span class="string">&quot;configurable&quot;</span>: &#123;<span class="string">&quot;thread_id&quot;</span>: <span class="string">&quot;session_01&quot;</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¢å¤å†å²ä¼šè¯</span></span><br><span class="line">history = graph.get_state(config)</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ‘¥-äººå·¥å®¡æ ¸æœºåˆ¶"><a href="#ğŸ‘¥-äººå·¥å®¡æ ¸æœºåˆ¶" class="headerlink" title="ğŸ‘¥ äººå·¥å®¡æ ¸æœºåˆ¶"></a>ğŸ‘¥ äººå·¥å®¡æ ¸æœºåˆ¶</h2><h3 id="å®¡æ ¸ç‚¹é…ç½®"><a href="#å®¡æ ¸ç‚¹é…ç½®" class="headerlink" title="å®¡æ ¸ç‚¹é…ç½®"></a>å®¡æ ¸ç‚¹é…ç½®</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">graph = graph_builder.<span class="built_in">compile</span>(</span><br><span class="line">    checkpointer=memory,</span><br><span class="line">    interrupt_before=[<span class="string">&quot;search&quot;</span>],</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="äººå·¥å®¡æ‰¹æµç¨‹"><a href="#äººå·¥å®¡æ‰¹æµç¨‹" class="headerlink" title="äººå·¥å®¡æ‰¹æµç¨‹"></a>äººå·¥å®¡æ‰¹æµç¨‹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">human_approve</span>(<span class="params">action</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¾…å®¡æ ¸æ“ä½œï¼š<span class="subst">&#123;action&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">input</span>(<span class="string">&quot;æ˜¯å¦æ‰¹å‡†ï¼Ÿ(y/n): &quot;</span>).lower() == <span class="string">&quot;y&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> human_approve(pending_action):</span><br><span class="line">    graph.update_state(config, approved_response)</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ”§-çŠ¶æ€çƒ­æ›´æ–°"><a href="#ğŸ”§-çŠ¶æ€çƒ­æ›´æ–°" class="headerlink" title="ğŸ”§ çŠ¶æ€çƒ­æ›´æ–°"></a>ğŸ”§ çŠ¶æ€çƒ­æ›´æ–°</h2><h3 id="å®æ—¶çŠ¶æ€ä¿®æ”¹"><a href="#å®æ—¶çŠ¶æ€ä¿®æ”¹" class="headerlink" title="å®æ—¶çŠ¶æ€ä¿®æ”¹"></a>å®æ—¶çŠ¶æ€ä¿®æ”¹</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_core.messages <span class="keyword">import</span> AIMessage, ToolMessage</span><br><span class="line"></span><br><span class="line">new_messages = [</span><br><span class="line">    ToolMessage(</span><br><span class="line">        content=updated_info,</span><br><span class="line">        tool_call_id=existing_call</span><br><span class="line">    ),</span><br><span class="line">    AIMessage(content=approved_response)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">graph.update_state(</span><br><span class="line">    config,</span><br><span class="line">    &#123;<span class="string">&quot;messages&quot;</span>: new_messages&#125;,</span><br><span class="line">    as_node=<span class="string">&quot;chatbot&quot;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸš€-éƒ¨ç½²å»ºè®®"><a href="#ğŸš€-éƒ¨ç½²å»ºè®®" class="headerlink" title="ğŸš€ éƒ¨ç½²å»ºè®®"></a>ğŸš€ éƒ¨ç½²å»ºè®®</h2><ol><li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong></p><ul><li>å¯ç”¨Redisç¼“å­˜å±‚</li><li>å®ç°å¼‚æ­¥å¤„ç†é˜Ÿåˆ—</li><li>æ·»åŠ é™æµç†”æ–­æœºåˆ¶</li></ul></li><li><p><strong>å®‰å…¨å¢å¼º</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•æ„Ÿè¯è¿‡æ»¤ç¤ºä¾‹</span></span><br><span class="line">SAFETY_FILTER = SafetyFilter()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">safe_response</span>(<span class="params">state</span>):</span></span><br><span class="line">    response = llm.invoke(state)</span><br><span class="line">    <span class="keyword">return</span> SAFETY_FILTER.scan(response)</span><br></pre></td></tr></table></figure></li><li><p><strong>ç›‘æ§æ–¹æ¡ˆ</strong></p><ul><li>æ¥å…¥PrometheusæŒ‡æ ‡</li><li>å®ç°LangSmithå…¨é“¾è·¯è¿½è¸ª</li><li>é…ç½®å¼‚å¸¸æŠ¥è­¦æœºåˆ¶</li></ul></li></ol><hr><h2 id="ğŸ“Œ-èµ„æºæ¨è"><a href="#ğŸ“Œ-èµ„æºæ¨è" class="headerlink" title="ğŸ“Œ èµ„æºæ¨è"></a>ğŸ“Œ èµ„æºæ¨è</h2><ul><li><a href="https://langchain.ai/langgraph">LangGraphå®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://docs.anthropic.com/">Claude APIæ–‡æ¡£</a></li><li><a href="https://tavily.com/docs">Tavilyæœç´¢API</a></li></ul><blockquote><p>æç¤ºï¼šæ‰€æœ‰ä»£ç ç¤ºä¾‹éœ€åœ¨å®é™…ç¯å¢ƒä¸­æµ‹è¯•åä½¿ç”¨ï¼Œå»ºè®®é€šè¿‡LangSmithè¿›è¡Œå…¨æµç¨‹è°ƒè¯•</p></blockquote><p>é€šè¿‡æœ¬æ–¹æ¡ˆï¼Œæ‚¨å¯ä»¥æ„å»ºå‡ºå…·å¤‡æŒç»­å­¦ä¹ èƒ½åŠ›å’Œå®‰å…¨ç®¡æ§çš„ä¼ä¸šçº§å¯¹è¯ç³»ç»Ÿã€‚æ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµå®æˆ˜ç»éªŒï¼ ğŸ’¬</p>]]></content>
      
      
      
        <tags>
            
            <tag> LangGraph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LEFT JOIN ä¸­ `ON` ä¸ `WHERE` è¿‡æ»¤æ¡ä»¶çš„åŒºåˆ«åˆ†æ</title>
      <link href="/2025/02/25/left-join-%E4%B8%8E-where-%E6%9D%A1%E4%BB%B6%E8%BF%87%E6%BB%A4%E5%8C%BA%E5%88%AB/"/>
      <url>/2025/02/25/left-join-%E4%B8%8E-where-%E6%9D%A1%E4%BB%B6%E8%BF%87%E6%BB%A4%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<h3 id="LEFT-JOIN-ä¸­-ON-ä¸-WHERE-è¿‡æ»¤æ¡ä»¶çš„åŒºåˆ«åˆ†æ"><a href="#LEFT-JOIN-ä¸­-ON-ä¸-WHERE-è¿‡æ»¤æ¡ä»¶çš„åŒºåˆ«åˆ†æ" class="headerlink" title="LEFT JOIN ä¸­ ON ä¸ WHERE è¿‡æ»¤æ¡ä»¶çš„åŒºåˆ«åˆ†æ"></a>LEFT JOIN ä¸­ <code>ON</code> ä¸ <code>WHERE</code> è¿‡æ»¤æ¡ä»¶çš„åŒºåˆ«åˆ†æ</h3><p>å‡è®¾æœ‰ä¸¤è¡¨ï¼š  </p><ul><li><p><strong>è¡¨ a</strong>  </p><table><thead><tr><th>x</th><th>y</th><th>z</th></tr></thead><tbody><tr><td>1</td><td>2</td><td>4</td></tr><tr><td>2</td><td>3</td><td>5</td></tr></tbody></table></li><li><p><strong>è¡¨ b</strong>  </p><table><thead><tr><th>x</th><th>z</th></tr></thead><tbody><tr><td>1</td><td>4</td></tr><tr><td>2</td><td>3</td></tr></tbody></table></li></ul><hr><h4 id="SQL1-a-LEFT-JOIN-b-ON-a-x-b-x-AND-b-z-3"><a href="#SQL1-a-LEFT-JOIN-b-ON-a-x-b-x-AND-b-z-3" class="headerlink" title="SQL1: a LEFT JOIN b ON a.x = b.x AND b.z = 3"></a><strong>SQL1</strong>: <code>a LEFT JOIN b ON a.x = b.x AND b.z = 3</code></h4><p><strong>é€»è¾‘</strong>ï¼š  </p><ul><li>å·¦è¿æ¥è¿‡ç¨‹ä¸­ï¼Œ<strong>åŒæ—¶</strong>åŒ¹é… <code>a.x = b.x</code> <strong>ä¸”</strong> <code>b.z = 3</code> çš„è¡Œã€‚  </li><li><strong>ç»“æœç‰¹ç‚¹</strong>ï¼š  <ul><li>ä¿ç•™è¡¨ <code>a</code> <strong>æ‰€æœ‰è¡Œ</strong>ï¼ˆæ— è®ºæ˜¯å¦åŒ¹é…åˆ° <code>b</code>ï¼‰ã€‚  </li><li><code>b</code> è¡¨çš„åŒ¹é…è¡Œéœ€æ»¡è¶³ <code>b.z = 3</code>ï¼Œå¦åˆ™å¡«å…… <code>NULL</code>ã€‚  </li></ul></li></ul><p><strong>ç»“æœç¤ºä¾‹</strong>:  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a.x | a.y | a.z | b.x | b.z</span><br><span class="line">-----------------------------</span><br><span class="line">1   | 2   | 4   | NULL| NULL  -- b.z=4 ä¸æ»¡è¶³æ¡ä»¶ï¼Œå¡«å……NULL</span><br><span class="line">2   | 3   | 5   | 2   | 3     -- åŒ¹é…æˆåŠŸ</span><br></pre></td></tr></table></figure><hr><h4 id="SQL2-a-LEFT-JOIN-b-ON-a-x-b-x-WHERE-b-z-3"><a href="#SQL2-a-LEFT-JOIN-b-ON-a-x-b-x-WHERE-b-z-3" class="headerlink" title="SQL2: a LEFT JOIN b ON a.x = b.x WHERE b.z = 3"></a><strong>SQL2</strong>: <code>a LEFT JOIN b ON a.x = b.x WHERE b.z = 3</code></h4><p><strong>é€»è¾‘</strong>:  </p><ol><li>å…ˆæ‰§è¡Œå·¦è¿æ¥ï¼ˆä»…åŒ¹é… <code>a.x = b.x</code>ï¼Œä¸é™åˆ¶ <code>b.z</code>ï¼‰ã€‚  </li><li>åœ¨è¿æ¥åçš„ç»“æœä¸­ï¼Œè¿‡æ»¤å‡º <code>b.z = 3</code> çš„è¡Œã€‚  </li></ol><p><strong>å‰¯ä½œç”¨</strong>ï¼š  </p><ul><li><code>WHERE</code> æ¡ä»¶ä¼šæ’é™¤ <code>b</code> è¡¨æœªåŒ¹é…çš„è¡Œï¼ˆå³ <code>b.z</code> ä¸º <code>NULL</code> çš„è¡Œï¼‰ã€‚  </li><li>æœ€ç»ˆç»“æœç­‰ä»·äº<strong>å†…è¿æ¥</strong> (<code>INNER JOIN</code>)ã€‚  </li></ul><p><strong>ç»“æœç¤ºä¾‹</strong>:  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a.x | a.y | a.z | b.x | b.z</span><br><span class="line">-----------------------------</span><br><span class="line">2   | 3   | 5   | 2   | 3     -- ä»…ä¿ç•™æ»¡è¶³ WHERE æ¡ä»¶çš„è¡Œ</span><br></pre></td></tr></table></figure><hr><h3 id="å…³é”®åŒºåˆ«æ€»ç»“"><a href="#å…³é”®åŒºåˆ«æ€»ç»“" class="headerlink" title="å…³é”®åŒºåˆ«æ€»ç»“"></a><strong>å…³é”®åŒºåˆ«æ€»ç»“</strong></h3><table><thead><tr><th>å·®å¼‚ç‚¹</th><th>SQL1 (<code>ON ... AND b.z=3</code>)</th><th>SQL2 (<code>WHERE b.z=3</code>)</th></tr></thead><tbody><tr><td><strong>ä¿ç•™ <code>a</code> æ‰€æœ‰è¡Œ</strong></td><td>æ˜¯ï¼ˆå³è¡¨æœªåŒ¹é…åˆ™å¡«å…… <code>NULL</code>ï¼‰</td><td>å¦ï¼ˆ<code>WHERE</code> è¿‡æ»¤æ‰ <code>NULL</code>ï¼Œç­‰æ•ˆå†…è¿æ¥ï¼‰</td></tr><tr><td><strong>è¿‡æ»¤æ—¶æœº</strong></td><td>è¿æ¥æ—¶è¿‡æ»¤å³è¡¨ (<code>b</code>)</td><td>è¿æ¥åè¿‡æ»¤æ•´ä¸ªç»“æœé›†</td></tr><tr><td><strong>ç»“æœèŒƒå›´</strong></td><td>æ˜¾ç¤º <code>a</code> è¡¨å…¨éƒ¨æ•°æ®ï¼Œå³è¡¨å¯èƒ½ä¸º <code>NULL</code></td><td>ä»…æ˜¾ç¤ºåŒæ—¶æ»¡è¶³ <code>a.x=b.x</code> å’Œ <code>b.z=3</code> çš„è¡Œ</td></tr></tbody></table><hr><h3 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a><strong>ç»“è®º</strong></h3><ul><li>è‹¥éœ€ä¿ç•™ <code>a</code> è¡¨æ‰€æœ‰è¡Œ<strong>å¹¶ç­›é€‰ <code>b</code> çš„åŒ¹é…æ¡ä»¶</strong>ï¼Œç”¨ <strong>SQL1</strong>ï¼ˆæ¡ä»¶åœ¨ <code>ON</code> ä¸­ï¼‰ã€‚  </li><li>è‹¥ä»…éœ€ <code>a</code> å’Œ <code>b</code> åŒæ—¶æ»¡è¶³ <code>x</code> ç›¸ç­‰ä¸” <code>b.z=3</code> çš„è¡Œï¼Œç”¨ <strong>SQL2</strong>ï¼ˆå®é™…æ•ˆæœç­‰ä»·äº <code>INNER JOIN</code>ï¼‰ã€‚  </li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å±€åŸŸç½‘è®¿é—®wslä¸Šçš„æœåŠ¡</title>
      <link href="/2025/02/18/%E5%B1%80%E5%9F%9F%E7%BD%91%E8%AE%BF%E9%97%AEwsl%E4%B8%8A%E7%9A%84%E6%9C%8D%E5%8A%A1/"/>
      <url>/2025/02/18/%E5%B1%80%E5%9F%9F%E7%BD%91%E8%AE%BF%E9%97%AEwsl%E4%B8%8A%E7%9A%84%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="å±€åŸŸç½‘è®¿é—®-wsl-ä¸Šçš„æœåŠ¡"><a href="#å±€åŸŸç½‘è®¿é—®-wsl-ä¸Šçš„æœåŠ¡" class="headerlink" title="å±€åŸŸç½‘è®¿é—® wsl ä¸Šçš„æœåŠ¡"></a>å±€åŸŸç½‘è®¿é—® wsl ä¸Šçš„æœåŠ¡</h1><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>åœ¨ windows çš„å­ç³»ç»Ÿï¼ˆubuntuï¼‰ä¸­å¯åŠ¨äº†ä¸€ä¸ªæœåŠ¡ï¼Œä½†æ˜¯åœ¨ windows ä¸Šå¯ä»¥ä½¿ç”¨ localhost è¿›è¡Œè®¿é—®ï¼Œä½†æ˜¯æ²¡åŠæ³•é€šè¿‡ windows çš„ ip è¿›è¡Œè®¿é—®ï¼Œ</p><p>ä¾‹å¦‚ï¼š</p><p>windows çš„ ip ä¸ºï¼š172.19.2.xxx</p><p>wsl ä¸Šçš„ ip ä¸ºï¼š172.29.131.8</p><p>åœ¨ wsl ä¸Šå¯åŠ¨çš„æœåŠ¡ç«¯å£ä¸ºï¼š9090 æˆ‘åœ¨ windows ä¸Šä½¿ç”¨ 172.19.2.xxx:9090 æ— æ³•è®¿é—®ï¼Œ</p><p>ä½†æ˜¯å¯ä»¥ä½¿ç”¨ï¼š<a href="http://localhost:9090/">http://localhost:9090/</a> å’Œ <a href="http://172.29.131.8:9090/">http://172.29.131.8/</a> è¿›è¡Œè®¿é—®ï¼Œ</p><p>åœ¨å±€åŸŸç½‘çš„å…¶ä»–ç”µè„‘ä¸èƒ½ä½¿ç”¨ <a href="http://172.29.131.8:9090/">http://172.29.131.8/</a> è¿›è¡Œè®¿é—®ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ <a href="http://172.19.2.xxx:9090/">http://172.19.2.xxx:9090</a> è®¿é—®</p><p>å¦‚æœæˆ‘æ˜¯åœ¨ windows ä¸Šå¯åŠ¨è¿™ä¸ªæœåŠ¡ï¼Œå°±å¯ä»¥ä½¿ç”¨ <a href="http://172.19.2.xxx:9090/">http://172.19.2.xxx:9090</a> è®¿é—®ï¼Œå¹¶ä¸”å±€åŸŸç½‘ä¹Ÿèƒ½ä½¿ç”¨ <a href="http://172.19.2.xxx:9090/">http://172.19.2.xxx:9090</a> è®¿é—®</p><h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h1><p>å¦‚ä½•åœ¨å®¿ä¸»æœº window ä¸Šæˆ–å±€åŸŸç½‘å…¶ä»–ç”µè„‘ï¼Œä½¿ç”¨ <a href="http://172.19.2.xxx:9090/">http://172.19.2.xxx:9090</a> è®¿é—®æˆ‘ wsl ä¸Šå¯åŠ¨çš„æœåŠ¡</p><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><p>ä¸ºäº†åœ¨å®¿ä¸»æœº Windows æˆ–å±€åŸŸç½‘å…¶ä»–ç”µè„‘é€šè¿‡ <a href="http://172.19.2.xxx:9090/">http://172.19.2.xxx:9090</a> è®¿é—® WSL ä¸­çš„æœåŠ¡ï¼Œéœ€è§£å†³ WSL2 ç½‘ç»œéš”ç¦»å’Œé˜²ç«å¢™è§„åˆ™é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æ­¥éª¤ï¼š</p><h3 id="1-ç¡®ä¿æœåŠ¡ç»‘å®šåˆ°-0-0-0-0"><a href="#1-ç¡®ä¿æœåŠ¡ç»‘å®šåˆ°-0-0-0-0" class="headerlink" title="1. ç¡®ä¿æœåŠ¡ç»‘å®šåˆ° 0.0.0.0"></a>1. ç¡®ä¿æœåŠ¡ç»‘å®šåˆ° <code>0.0.0.0</code></h3><p>åœ¨ WSL çš„ Ubuntu ä¸­ï¼Œç¡®è®¤æœåŠ¡ç›‘å¬çš„åœ°å€æ˜¯ <code>0.0.0.0</code>ï¼ˆæ‰€æœ‰æ¥å£ï¼‰ï¼Œè€Œé <code>127.0.0.1</code>ï¼ˆä»…æœ¬åœ°ï¼‰ã€‚</p><p>æ£€æŸ¥å‘½ä»¤ï¼ˆä»¥ Python æœåŠ¡ä¸ºä¾‹ï¼‰ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -tuln | grep 9090</span><br></pre></td></tr></table></figure><p>è‹¥è¾“å‡ºæ˜¾ç¤º <code>0.0.0.0:9090</code> æˆ– <code>:::9090</code>ï¼ˆIPv6ï¼‰ï¼Œåˆ™å·²æ­£ç¡®ç»‘å®šã€‚å¦åˆ™éœ€è°ƒæ•´æœåŠ¡é…ç½®ã€‚</p><h3 id="2-é…ç½®-Windows-é˜²ç«å¢™å…è®¸å…¥ç«™"><a href="#2-é…ç½®-Windows-é˜²ç«å¢™å…è®¸å…¥ç«™" class="headerlink" title="2. é…ç½® Windows é˜²ç«å¢™å…è®¸å…¥ç«™"></a>2. é…ç½® Windows é˜²ç«å¢™å…è®¸å…¥ç«™</h3><p>å…è®¸å¤–éƒ¨è®¿é—® Windows çš„ 9090 ç«¯å£ï¼š</p><ol><li>æ‰“å¼€ Windows Defender é˜²ç«å¢™ â†’ é«˜çº§è®¾ç½® â†’ å…¥ç«™è§„åˆ™ â†’ æ–°å»ºè§„åˆ™ã€‚</li><li>é€‰æ‹© ç«¯å£ â†’ TCP â†’ ç‰¹å®šç«¯å£ <code>9090</code> â†’ å…è®¸è¿æ¥ â†’ åº”ç”¨æ‰€æœ‰ç½‘ç»œç±»å‹ã€‚</li><li>å‘½åè§„åˆ™ï¼ˆå¦‚ <code>WSL 9090</code>ï¼‰å¹¶å®Œæˆã€‚</li></ol><h3 id="3-è®¾ç½®ç«¯å£è½¬å‘ï¼ˆå…³é”®æ­¥éª¤ï¼‰"><a href="#3-è®¾ç½®ç«¯å£è½¬å‘ï¼ˆå…³é”®æ­¥éª¤ï¼‰" class="headerlink" title="3. è®¾ç½®ç«¯å£è½¬å‘ï¼ˆå…³é”®æ­¥éª¤ï¼‰"></a>3. è®¾ç½®ç«¯å£è½¬å‘ï¼ˆå…³é”®æ­¥éª¤ï¼‰</h3><p>ç”±äº WSL2 ä½¿ç”¨è™šæ‹Ÿç½‘ç»œï¼Œéœ€å°† Windows çš„ç«¯å£æµé‡è½¬å‘åˆ° WSLï¼š</p><p>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShellï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ ç«¯å£è½¬å‘è§„åˆ™ï¼ˆæ›¿æ¢ä¸ºä½ çš„WSL IPï¼‰_</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">$</span><span class="bash">wsl_ip = <span class="string">&quot;172.29.131.8&quot;</span></span></span><br><span class="line"></span><br><span class="line">netsh interface portproxy add v4tov4 listenport=9090 listenaddress=0.0.0.0 connectport=9090 connectaddress=$wsl_ip</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> éªŒè¯è§„åˆ™_</span></span><br><span class="line"></span><br><span class="line">netsh interface portproxy show all</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼š</p><ul><li><code>listenaddress=0.0.0.0</code> å…è®¸æ‰€æœ‰å¤–éƒ¨ IP è®¿é—®ã€‚</li><li>å¦‚æœ WSL IP é‡å¯åå˜åŒ–ï¼Œéœ€æ›´æ–°è½¬å‘è§„åˆ™ï¼ˆè§ä¸‹æ–‡ è‡ªåŠ¨åŒ–è„šæœ¬ï¼‰ã€‚</li></ul><p><img src="Wyxzb3gUvo88Muxk5lWcW6iGnzb.png"></p><h3 id="4-å…è®¸-Hyper-V-è™šæ‹Ÿäº¤æ¢æœºé€šè¿‡é˜²ç«å¢™ï¼ˆå¯é€‰ï¼‰"><a href="#4-å…è®¸-Hyper-V-è™šæ‹Ÿäº¤æ¢æœºé€šè¿‡é˜²ç«å¢™ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="4. å…è®¸ Hyper-V è™šæ‹Ÿäº¤æ¢æœºé€šè¿‡é˜²ç«å¢™ï¼ˆå¯é€‰ï¼‰"></a>4. å…è®¸ Hyper-V è™šæ‹Ÿäº¤æ¢æœºé€šè¿‡é˜²ç«å¢™ï¼ˆå¯é€‰ï¼‰</h3><p>å¦‚æœä»æ— æ³•è®¿é—®ï¼Œå¯èƒ½éœ€è¦å…è®¸ Hyper-V è™šæ‹Ÿäº¤æ¢æœºçš„é˜²ç«å¢™è§„åˆ™ï¼š</p><ol><li>æ‰“å¼€ æ§åˆ¶é¢æ¿ â†’ ç³»ç»Ÿå’Œå®‰å…¨ â†’ Windows Defender é˜²ç«å¢™ â†’ å…è®¸åº”ç”¨é€šè¿‡é˜²ç«å¢™ã€‚</li><li>æ‰¾åˆ° Hyper-V Management å¹¶å‹¾é€‰ ä¸“ç”¨ å’Œ å…¬ç”¨ã€‚</li></ol><h3 id="5-æµ‹è¯•è®¿é—®"><a href="#5-æµ‹è¯•è®¿é—®" class="headerlink" title="5. æµ‹è¯•è®¿é—®"></a>5. æµ‹è¯•è®¿é—®</h3><ol><li>å®¿ä¸»æœº Windowsï¼šè®¿é—®  <a href="http://172.19.2.xxx:9090/">http://172.19.2.xxx:9090</a></li><li>å±€åŸŸç½‘è®¾å¤‡ï¼šä½¿ç”¨ <code>http://[Windowsä¸»æœºçš„IP]:9090</code> è®¿é—®ã€‚</li></ol><h3 id="è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆåº”å¯¹-WSL-IP-å˜åŒ–ï¼‰"><a href="#è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆåº”å¯¹-WSL-IP-å˜åŒ–ï¼‰" class="headerlink" title="è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆåº”å¯¹ WSL IP å˜åŒ–ï¼‰"></a>è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆåº”å¯¹ WSL IP å˜åŒ–ï¼‰</h3><p>åˆ›å»º PowerShell è„šæœ¬ <code>wsl_port_forward.ps1</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> è·å–WSL2çš„IPåœ°å€_</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">$</span><span class="bash">wsl_ip = (wsl hostname -I).trim().split()[0]</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ é™¤æ—§è§„åˆ™_</span></span><br><span class="line"></span><br><span class="line">netsh interface portproxy delete v4tov4 listenport=9090 listenaddress=0.0.0.0</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ·»åŠ æ–°è§„åˆ™_</span></span><br><span class="line"></span><br><span class="line">netsh interface portproxy add v4tov4 listenport=9090 listenaddress=0.0.0.0 connectport=9090 connectaddress=$wsl_ip</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡ WSL é‡å¯åä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œæ­¤è„šæœ¬ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li>æœåŠ¡ç»‘å®šï¼šç¡®ä¿æœåŠ¡ç›‘å¬ <code>0.0.0.0:9090</code>ã€‚</li><li>é˜²ç«å¢™ï¼šå…è®¸ Windows çš„ 9090 ç«¯å£å…¥ç«™ã€‚</li><li>ç«¯å£è½¬å‘ï¼šä½¿ç”¨ <code>netsh</code> å°† Windows ç«¯å£è½¬å‘åˆ° WSLã€‚</li><li>IP å˜åŒ–å¤„ç†ï¼šé€šè¿‡è„šæœ¬åŠ¨æ€æ›´æ–°è½¬å‘è§„åˆ™ã€‚</li></ul><p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œå±€åŸŸç½‘è®¾å¤‡å³å¯é€šè¿‡ <a href="http://172.19.2.xxx:9090/">http://172.19.2.xxx:9090</a> è®¿é—® WSL æœåŠ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> wsl </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wsl </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ¬åœ°éƒ¨ç½²è§†é¢‘è½¬æ–‡å­—æ¨¡å‹</title>
      <link href="/2025/02/18/%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%E8%A7%86%E9%A2%91%E8%BD%AC%E6%96%87%E5%AD%97%E6%A8%A1%E5%9E%8B/"/>
      <url>/2025/02/18/%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%E8%A7%86%E9%A2%91%E8%BD%AC%E6%96%87%E5%AD%97%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ¬åœ°éƒ¨ç½²è§†é¢‘è½¬æ–‡å­—æ¨¡å‹"><a href="#æœ¬åœ°éƒ¨ç½²è§†é¢‘è½¬æ–‡å­—æ¨¡å‹" class="headerlink" title="æœ¬åœ°éƒ¨ç½²è§†é¢‘è½¬æ–‡å­—æ¨¡å‹"></a>æœ¬åœ°éƒ¨ç½²è§†é¢‘è½¬æ–‡å­—æ¨¡å‹</h1><h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>è·å–å“ç‰Œèµ„äº§ç§è‰çš„ä½œå“ï¼Œå¯¹åº”çš„è§†é¢‘ã€å›¾ç‰‡ã€æ–‡æœ¬çš„å†…å®¹ï¼Œæ ¹æ®è¿™äº›å†…å®¹åˆ¤æ–­ç§è‰çš„ä½œå“æ˜¯å¦åˆæ ¼</p><h1 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h1><ul><li>ubuntuï¼ˆæˆ‘çš„ï¼‰ï¼Œä¹Ÿæ”¯æŒ windowsï¼ŒmacOS</li><li>pythonï¼ˆæˆ‘ç”¨çš„ python12ï¼‰</li><li>ä¾èµ–åŒ…</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">addict==2.4.0</span><br><span class="line">aiohappyeyeballs==2.4.6</span><br><span class="line">aiohttp==3.11.12</span><br><span class="line">aiosignal==1.3.2</span><br><span class="line">aliyun-python-sdk-core==2.16.0</span><br><span class="line">aliyun-python-sdk-kms==2.16.5</span><br><span class="line">altair==5.5.0</span><br><span class="line">antlr4-python3-runtime==4.9.3</span><br><span class="line">attrs==25.1.0</span><br><span class="line">audioread==3.0.1</span><br><span class="line">blinker==1.9.0</span><br><span class="line">cachetools==5.5.1</span><br><span class="line">click==8.1.8</span><br><span class="line">crcmod==1.7</span><br><span class="line">datasets==3.3.0</span><br><span class="line">decorator==5.1.1</span><br><span class="line">dill==0.3.8</span><br><span class="line">editdistance==0.8.1</span><br><span class="line">filelock==3.17.0</span><br><span class="line">frozenlist==1.5.0</span><br><span class="line">fsspec==2024.12.0</span><br><span class="line">funasr==1.2.4</span><br><span class="line">gitdb==4.0.12</span><br><span class="line">GitPython==3.1.44</span><br><span class="line">huggingface-hub==0.28.1</span><br><span class="line">hydra-core==1.3.2</span><br><span class="line">jaconv==0.4.0</span><br><span class="line">jamo==0.4.1</span><br><span class="line">jieba==0.42.1</span><br><span class="line">Jinja2==3.1.5</span><br><span class="line">jmespath==0.10.0</span><br><span class="line">joblib==1.4.2</span><br><span class="line">jsonpointer==2.1</span><br><span class="line">jsonschema==4.23.0</span><br><span class="line">jsonschema-specifications==2024.10.1</span><br><span class="line">kaldiio==2.18.0</span><br><span class="line">lazy_loader==0.4</span><br><span class="line">librosa==0.10.2.post1</span><br><span class="line">llvmlite==0.44.0</span><br><span class="line">MarkupSafe==3.0.2</span><br><span class="line">modelscope==1.22.3</span><br><span class="line">mpmath==1.3.0</span><br><span class="line">msgpack==1.1.0</span><br><span class="line">multidict==6.1.0</span><br><span class="line">multiprocess==0.70.16</span><br><span class="line">narwhals==1.26.0</span><br><span class="line">networkx==3.4.2</span><br><span class="line">numba==0.61.0</span><br><span class="line">numpy==2.1.3</span><br><span class="line">nvidia-cublas-cu12==12.4.5.8</span><br><span class="line">nvidia-cuda-cupti-cu12==12.4.127</span><br><span class="line">nvidia-cuda-nvrtc-cu12==12.4.127</span><br><span class="line">nvidia-cuda-runtime-cu12==12.4.127</span><br><span class="line">nvidia-cudnn-cu12==9.1.0.70</span><br><span class="line">nvidia-cufft-cu12==11.2.1.3</span><br><span class="line">nvidia-curand-cu12==10.3.5.147</span><br><span class="line">nvidia-cusolver-cu12==11.6.1.9</span><br><span class="line">nvidia-cusparse-cu12==12.3.1.170</span><br><span class="line">nvidia-cusparselt-cu12==0.6.2</span><br><span class="line">nvidia-nccl-cu12==2.21.5</span><br><span class="line">nvidia-nvjitlink-cu12==12.4.127</span><br><span class="line">nvidia-nvtx-cu12==12.4.127</span><br><span class="line">omegaconf==2.3.0</span><br><span class="line">oss2==2.19.1</span><br><span class="line">pandas==2.2.3</span><br><span class="line">pillow==11.1.0</span><br><span class="line">pooch==1.8.2</span><br><span class="line">propcache==0.2.1</span><br><span class="line">protobuf==5.29.3</span><br><span class="line">pyarrow==19.0.0</span><br><span class="line">pycryptodome==3.21.0</span><br><span class="line">pydeck==0.9.1</span><br><span class="line">pynndescent==0.5.13</span><br><span class="line">python-dateutil==2.9.0.post0</span><br><span class="line">pytorch-wpe==0.0.1</span><br><span class="line">pytz==2025.1</span><br><span class="line">PyYAML==6.0.2</span><br><span class="line">referencing==0.36.2</span><br><span class="line">rpds-py==0.22.3</span><br><span class="line">scikit-learn==1.6.1</span><br><span class="line">scipy==1.15.2</span><br><span class="line">sentencepiece==0.2.0</span><br><span class="line">setuptools==75.8.0</span><br><span class="line">simplejson==3.20.1</span><br><span class="line">six==1.17.0</span><br><span class="line">smmap==5.0.2</span><br><span class="line">sortedcontainers==2.4.0</span><br><span class="line">soundfile==0.13.1</span><br><span class="line">soxr==0.5.0.post1</span><br><span class="line">streamlit==1.42.0</span><br><span class="line">sympy==1.13.1</span><br><span class="line">tenacity==9.0.0</span><br><span class="line">tensorboardX==2.6.2.2</span><br><span class="line">threadpoolctl==3.5.0</span><br><span class="line">toml==0.10.2</span><br><span class="line">torch==2.6.0</span><br><span class="line">torch-complex==0.4.4</span><br><span class="line">torchaudio==2.6.0</span><br><span class="line">tornado==6.4.2</span><br><span class="line">triton==3.2.0</span><br><span class="line">tzdata==2025.1</span><br><span class="line">umap-learn==0.5.7</span><br><span class="line">watchdog==6.0.0</span><br><span class="line">wheel==0.45.1</span><br><span class="line">xxhash==3.5.0</span><br><span class="line">yarl==1.18.3</span><br></pre></td></tr></table></figure><h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h1><blockquote><p>å®ç°æ–¹å¼ï¼šæœ¬åœ°éƒ¨ç½²äº†é­”æ­å¹³å°ä¸Šçš„ã€SenseVoice å¤šè¯­è¨€è¯­éŸ³ç†è§£æ¨¡å‹ Smallï¼ˆ<a href="https://www.modelscope.cn/models/iic/SenseVoiceSmall">https://www.modelscope.cn/models/iic/SenseVoiceSmall</a>ï¼‰ã€‘æ¨¡å‹</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> modelscope.pipelines <span class="keyword">import</span> pipeline</span><br><span class="line"><span class="keyword">from</span> modelscope.utils.constant <span class="keyword">import</span> Tasks</span><br><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§†é¢‘è½¬æ–‡æœ¬</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">video_to_text</span>(<span class="params">video_url</span>):</span></span><br><span class="line">Â  Â  inference_pipeline = pipeline(</span><br><span class="line">Â  Â  Â  Â  task=Tasks.auto_speech_recognition,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  model=<span class="string">&#x27;iic/SenseVoiceSmall&#x27;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  model_revision=<span class="string">&quot;master&quot;</span>,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  device=<span class="string">&quot;cuda:0&quot;</span>,)</span><br><span class="line"></span><br><span class="line">Â  Â  rec_result = inference_pipeline(video_url)</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">return</span> rec_result</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ‡é¢˜</span></span><br><span class="line">st.title(<span class="string">&#x27;è§†é¢‘è½¬æ–‡æœ¬&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥è§†é¢‘url</span></span><br><span class="line">video_url = st.text_input(<span class="string">&#x27;è¯·è¾“å…¥è§†é¢‘url&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‰é’®ï¼Œæ·»åŠ åŠ è½½è¿‡ç¨‹</span></span><br><span class="line"><span class="keyword">if</span> st.button(<span class="string">&#x27;å¼€å§‹è½¬æ–‡æœ¬&#x27;</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">with</span> st.spinner(<span class="string">&#x27;æ­£åœ¨è½¬æ–‡æœ¬...&#x27;</span>):</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># è°ƒç”¨è§†é¢‘è½¬æ–‡æœ¬å‡½æ•°</span></span><br><span class="line">Â  Â  Â  Â  rec_result = video_to_text(video_url)</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  <span class="comment"># è¾“å‡ºç»“æœ</span></span><br><span class="line">Â  Â  Â  Â  st.write(rec_result)</span><br></pre></td></tr></table></figure><h1 id="æ•ˆæœå±•ç¤º"><a href="#æ•ˆæœå±•ç¤º" class="headerlink" title="æ•ˆæœå±•ç¤º"></a>æ•ˆæœå±•ç¤º</h1><p><img src="TbqPbrpBGoVIw5xkWaZcDNB0nVe.jpg"></p><h1 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h1><h2 id="No-such-file-or-directory-â€˜ffmpegâ€™"><a href="#No-such-file-or-directory-â€˜ffmpegâ€™" class="headerlink" title="No such file or directory: â€˜ffmpegâ€™"></a>No such file or directory: â€˜ffmpegâ€™</h2><ol><li><p><strong>å®‰è£… FFmpeg:</strong></p><ul><li><strong>Windows:</strong><ol><li>ä¸‹è½½ FFmpeg Windows ç‰ˆæœ¬ï¼ˆZIP æ–‡ä»¶ï¼‰ï¼Œé“¾æ¥å¯ä»¥ä»å®˜æ–¹ç½‘ç«™è·å–ï¼š<a href="https://ffmpeg.org/download.html%E3%80%82">https://ffmpeg.org/download.htmlã€‚</a></li><li>è§£å‹ä¸‹è½½çš„æ–‡ä»¶åˆ°ä¸€ä¸ªç›®å½•ï¼Œä¾‹å¦‚Â <code>C:\ffmpeg</code>ã€‚</li><li>å°†Â <code>C:\ffmpeg\bin</code>Â æ·»åŠ åˆ°ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡Â <code>PATH</code>Â ä¸­ï¼š<ul><li>å³é”®ç‚¹å‡»â€œæ­¤ç”µè„‘â€æˆ–â€œæˆ‘çš„ç”µè„‘â€ï¼Œé€‰æ‹©â€œå±æ€§â€ã€‚</li><li>é€‰æ‹©â€œé«˜çº§ç³»ç»Ÿè®¾ç½®â€ï¼Œç„¶åç‚¹å‡»â€œç¯å¢ƒå˜é‡â€ã€‚</li><li>åœ¨â€œç³»ç»Ÿå˜é‡â€ä¸­æ‰¾åˆ°Â <code>Path</code>ï¼Œç„¶åç‚¹å‡»â€œç¼–è¾‘â€ã€‚</li><li>ç‚¹å‡»â€œæ–°å»ºâ€ï¼Œå¹¶è¾“å…¥ FFmpeg çš„ bin ç›®å½•è·¯å¾„ã€‚</li></ul></li></ol></li><li><strong>MacOS:</strong><ul><li>ä½¿ç”¨ Homebrew å®‰è£… FFmpegã€‚å¦‚æœä½ æ²¡æœ‰ Homebrewï¼Œå…ˆé€šè¿‡Â <code>/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;</code>Â å®‰è£…å®ƒã€‚</li><li>è¿è¡Œå‘½ä»¤Â <code>brew install ffmpeg</code>ã€‚</li></ul></li><li><strong>Linux:</strong><ul><li>å¯¹äºå¤§å¤šæ•°åŸºäº Debian çš„ç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤Â <code>sudo apt update</code>Â ç„¶åÂ <code>sudo apt install ffmpeg</code>ã€‚</li><li>å¯¹äºåŸºäº Red Hat çš„ç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤Â <code>sudo yum install ffmpeg</code>Â æˆ–è€…é€šè¿‡å¯ç”¨ RPM Fusion ä»“åº“åå®‰è£…ã€‚</li></ul></li></ul></li><li><p><strong>éªŒè¯å®‰è£…:</strong></p><ul><li>è¿è¡Œå‘½ä»¤Â <code>ffmpeg -version</code>Â æ¥éªŒè¯ FFmpeg æ˜¯å¦æ­£ç¡®å®‰è£…å’Œé…ç½®ã€‚å¦‚æœå®‰è£…æˆåŠŸï¼Œä½ åº”èƒ½çœ‹åˆ° FFmpeg çš„ç‰ˆæœ¬ä¿¡æ¯è¾“å‡ºã€‚</li></ul></li></ol><p>å®Œæˆè¿™äº›æ­¥éª¤åï¼Œé‡æ–°è¿è¡Œä½ çš„ç¨‹åºï¼Œ<code>ffmpeg</code> åº”è¯¥èƒ½è¢«æ­£ç¡®è¯†åˆ«å¹¶æ‰§è¡Œã€‚å¦‚æœä½ åœ¨è®¾ç½® <code>PATH</code> æ—¶é‡åˆ°é—®é¢˜ï¼Œè¯·ç¡®ä¿å·²ç»æ­£ç¡®è¾“å…¥äº†è·¯å¾„ä¸”ä¿å­˜äº†æ›´æ”¹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¤§æ¨¡å‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Leetcodeåˆ·é¢˜ã€‘ä¸¤ä¸ªéé‡å å­æ•°ç»„çš„æœ€å¤§å’Œ</title>
      <link href="/2024/12/26/%E3%80%90Leetcode%E5%88%B7%E9%A2%98%E3%80%91%E4%B8%A4%E4%B8%AA%E9%9D%9E%E9%87%8D%E5%8F%A0%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%9C%80%E5%A4%A7%E5%92%8C/"/>
      <url>/2024/12/26/%E3%80%90Leetcode%E5%88%B7%E9%A2%98%E3%80%91%E4%B8%A4%E4%B8%AA%E9%9D%9E%E9%87%8D%E5%8F%A0%E5%AD%90%E6%95%B0%E7%BB%84%E7%9A%84%E6%9C%80%E5%A4%A7%E5%92%8C/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®åœ°å€ï¼š<a href="https://leetcode.cn/problems/maximum-sum-of-two-non-overlapping-subarrays/description/">https://leetcode.cn/problems/maximum-sum-of-two-non-overlapping-subarrays/description/</a></p><h1 id="æˆ‘çš„æ€è·¯"><a href="#æˆ‘çš„æ€è·¯" class="headerlink" title="æˆ‘çš„æ€è·¯"></a>æˆ‘çš„æ€è·¯</h1><blockquote><p>å®ç°æ¯”è¾ƒéº»çƒ¦ï¼Œè®¡ç®—å¤æ‚</p></blockquote><ol><li>å…ˆè®¡ç®—å‡º firstLen é•¿åº¦çš„æœ€å¤§å’Œçš„å­é›†ï¼Œå†ä»å‰©ä½™çš„æ•°ç»„ä¸­è®¡ç®— secondLen é•¿åº¦çš„æœ€å¤§å’Œçš„å­é›† ï¼Œç„¶åç›¸åŠ   </li><li>å†è®¡ç®—å‡º secondLen é•¿åº¦çš„æœ€å¤§å’Œçš„å­é›†ï¼Œå†ä»å‰©ä½™çš„æ•°ç»„ä¸­è®¡ç®— firstLen é•¿åº¦çš„æœ€å¤§å’Œçš„å­é›† ï¼Œç„¶åç›¸åŠ   </li><li>æ¯”è¾ƒä¸¤ä¸ªç»“æœï¼Œå–æœ€å¤§å€¼</li></ol><h1 id="å®˜æ–¹æ€è·¯"><a href="#å®˜æ–¹æ€è·¯" class="headerlink" title="å®˜æ–¹æ€è·¯"></a>å®˜æ–¹æ€è·¯</h1><blockquote><p>åŠ¨æ€è§„åˆ’ + æ»‘åŠ¨çª—å£  </p></blockquote><p>é¦–å…ˆé¢˜ç›®ç»™å‡ºä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ numsã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦è¿”å›ä¸¤ä¸ªé•¿åº¦åˆ†åˆ«ä¸º firstLen å’Œ secondLen çš„éé‡å çš„å­æ•°ç»„çš„æœ€å¤§å’Œï¼ŒfirstLen+secondLenâ‰¤nï¼Œå…¶ä¸­è¿™ä¸¤æ®µå­æ•°ç»„çš„å‰åé¡ºåºæ²¡æœ‰è¦æ±‚ã€‚</p><p>ç”±äºä¸¤æ®µå­æ•°ç»„çš„å‰åé¡ºåºæ²¡æœ‰åŒºåˆ«ï¼Œæ‰€ä»¥ç°åœ¨ä¸å¦¨è®¾é•¿åº¦ä¸º firstLen çš„å­æ•°ç»„åœ¨é•¿åº¦ä¸º secondLen çš„å­æ•°ç»„å‰æ¥è®¡ç®—æ­¤æ—¶çš„ä¸¤æ®µå­æ•°ç»„çš„æœ€å¤§å’Œã€‚é¦–å…ˆæˆ‘ä»¬ç”¨ nums[i,j] æ¥è¡¨ç¤º nums[i],nums[i+1],â€¦,nums[jâˆ’1] è¿™ä¸€æ®µå­æ•°ç»„ï¼Œå¹¶è®° sum(nums[l,r]) è¡¨ç¤ºå­æ•°ç»„ nums[l,r] çš„å’Œï¼Œdp[i] ä¸º nums[0,i+1] ä¸­é•¿åº¦ä¸º firstLen çš„æœ€å¤§å­æ•°ç»„å’Œï¼Œè‹¥ä¸å­˜åœ¨é•¿åº¦ä¸º firstLen çš„å­æ•°ç»„åˆ™ä¸º 0ã€‚é‚£ä¹ˆå¯¹äºæŸä¸€æ®µé•¿åº¦ä¸º secondLen çš„å­æ•°ç»„ nums[j,j+secondLen]ï¼Œ0â‰¤j&lt;j+secondLenâ‰¤nï¼Œæ‰€ä»¥æ­¤æ—¶çš„ä¸¤ä¸ªæ•°ç»„çš„æœ€å¤§å’Œä¸º</p><p>dp[jâˆ’1]+sum(nums[j,j+secondLen])</p><p>åˆå› ä¸º</p><p>dp[i]=max{dp[iâˆ’1],sum(nums[i+1âˆ’firstLen,i+1])}</p><p>ç”±äºç°åœ¨é•¿åº¦ä¸º secondLen åœ¨é•¿åº¦ä¸º firstLen çš„åé¢ï¼Œæ‰€ä»¥ç”¨ä¸¤ä¸ªå¤§å°ä¸º firstLen å’Œ secondLen çš„æ»‘åŠ¨çª—å£åˆ†åˆ«ä»ä½ç½® 0 å’Œ firstLen åŒæ—¶å¼€å§‹ä»å·¦å¾€å³æ»‘åŠ¨ï¼Œå¹¶åœ¨è¿‡ç¨‹ä¸­ç»´æŠ¤çª—å£ä¸­çš„å’Œã€‚å› ä¸ºå¯¹äº âˆ€i&lt;firstLenâˆ’1ï¼Œæœ‰ dp[i]=0ï¼Œå¹¶å½“ i=firstLenâˆ’1 æ—¶ä¸ºåˆå§‹ç¬¬ä¸€ä¸ªçª—å£çš„å’Œã€‚é‚£ä¹ˆåœ¨ä¸¤ä¸ªçª—å£ä»å·¦åˆ°å³ç§»åŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ç§»åŠ¨ç¬¬ä¸€ä¸ªçª—å£æ¥æ›´æ–° dp å€¼ï¼Œé€šè¿‡ç¬¬äºŒä¸ªçª—å£æ¥è®¡ç®—æ­¤æ—¶çš„æœ€å¤§å’Œï¼Œå¹¶è®°å½•ç§»åŠ¨è¿‡ç¨‹ä¸­çš„æœ€å¤§å€¼å³å¯ã€‚</p><p>åŒç†æˆ‘ä»¬å¯ä»¥å¾—åˆ°å½“ secondLen çš„å­æ•°ç»„åœ¨é•¿åº¦ä¸º firstLen çš„å­æ•°ç»„å‰æ—¶ï¼Œä¸¤æ®µå­æ•°ç»„çš„æœ€å¤§å’Œï¼Œä¸¤ç§æƒ…å†µå–è¾ƒå¤§å€¼å³ä¸ºæœ€ç»ˆçš„ç­”æ¡ˆã€‚ç”±äº dp[i] çš„æ±‚è§£åªä¸ dp[iâˆ’1] æœ‰å…³ï¼Œæ‰€ä»¥åœ¨å®ç°çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡ã€Œæ»šåŠ¨æ•°ç»„ã€æ¥è¿›è¡Œç©ºé—´ä¼˜åŒ–ã€‚</p><p>é¢˜è§£ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">maxSumTwoNoOverlap</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> firstLen, <span class="keyword">int</span> secondLen)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">return</span> Math.max(help(nums, firstLen, secondLen), help(nums, secondLen, firstLen));  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">help</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> firstLen, <span class="keyword">int</span> secondLen)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">int</span> lSum = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; firstLen; i++) &#123;  </span><br><span class="line">        lSum += nums[i];  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">int</span> rSum = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = firstLen; i &lt; firstLen + secondLen; i++) &#123;  </span><br><span class="line">        rSum += nums[i];  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">int</span> res = lSum + rSum;  </span><br><span class="line">    <span class="keyword">int</span> lMaxSum = lSum;  </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = firstLen + secondLen, j = firstLen; i &lt; nums.length; ++i, ++j) &#123;    </span><br><span class="line">    <span class="comment">// è¿™é‡Œå¿…é¡»ä½¿ç”¨lSumå­˜ï¼Œå› ä¸ºæ˜¯ç§»åŠ¨çª—å£ï¼Œå‰é¢åŠ ä¸€ä¸ªå…ƒç´ ï¼Œå°±å¿…é¡»æ˜¯åœ¨è¿ç»­çš„ä½ç½®ä¸Šå‡ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        lSum = lSum + nums[j] - nums[j - firstLen];  </span><br><span class="line">        lMaxSum = Math.max(lMaxSum, lSum);  </span><br><span class="line">        rSum = rSum + nums[i] - nums[i - secondLen];  </span><br><span class="line">        res = Math.max(res, lMaxSum + rSum);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> res;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Leetcodeåˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Leetcodeåˆ·é¢˜ã€‘æœ€è¿‘çš„æˆ¿é—´</title>
      <link href="/2024/12/16/%E3%80%90Leetcode%E5%88%B7%E9%A2%98%E3%80%91%E6%9C%80%E8%BF%91%E7%9A%84%E6%88%BF%E9%97%B4/"/>
      <url>/2024/12/16/%E3%80%90Leetcode%E5%88%B7%E9%A2%98%E3%80%91%E6%9C%80%E8%BF%91%E7%9A%84%E6%88%BF%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢˜ç›®è·¯å¾„"><a href="#é¢˜ç›®è·¯å¾„" class="headerlink" title="é¢˜ç›®è·¯å¾„"></a>é¢˜ç›®è·¯å¾„</h1><p><a href="https://leetcode.cn/problems/closest-room/description/">1847. æœ€è¿‘çš„æˆ¿é—´</a></p><h1 id="ä¸ªäººè§£æ³•"><a href="#ä¸ªäººè§£æ³•" class="headerlink" title="ä¸ªäººè§£æ³•"></a>ä¸ªäººè§£æ³•</h1><blockquote><p>å…³é”®ç‚¹ï¼š</p><ol><li>æ’åº</li><li>TreeSetï¼ˆäºŒåˆ†æŸ¥æ‰¾ï¼‰</li><li>æ•°æ®ç»“æ„</li></ol></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClosestRoom</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] closestRoom(<span class="keyword">int</span>[][] rooms, <span class="keyword">int</span>[][] queries) &#123;  </span><br><span class="line">        <span class="keyword">return</span> main(rooms , que);</span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**  </span></span><br><span class="line"><span class="comment">     * æ»¡è¶³æ¡ä»¶çš„æˆ¿é—´ id  </span></span><br><span class="line"><span class="comment">     * ä¾‹å­ï¼šrooms = [[2,2],[1,2],[3,2]]  </span></span><br><span class="line"><span class="comment">     *      queries = [[3,1],[3,3],[5,2]]     * ç»“æœï¼š[3,-1,3]    * <span class="doctag">@param</span> rooms  </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> querie  </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  </span></span><br><span class="line"><span class="comment">     */</span>  </span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">C1</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> size;  </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;  </span><br><span class="line">    <span class="comment">// ç±»å‹ï¼š0:æˆ¿é—´ï¼Œ1ï¼šè¯¢é—®  </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> type;  </span><br><span class="line">    <span class="comment">// è¯¢é—®çš„ä¸‹æ ‡  </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> querieIndex;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">C1</span><span class="params">(<span class="keyword">int</span> type, <span class="keyword">int</span> id, <span class="keyword">int</span> size)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">this</span>.type = type;  </span><br><span class="line">        <span class="keyword">this</span>.id = id;  </span><br><span class="line">        <span class="keyword">this</span>.size = size;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getSize</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.size;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isQuerie</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.type == <span class="number">1</span> ? <span class="keyword">true</span> : <span class="keyword">false</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.id;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setQuerieIndex</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">this</span>.querieIndex = index;  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getQuerieIndex</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.querieIndex;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span>[] main(<span class="keyword">int</span>[][] rooms, <span class="keyword">int</span>[][] queries) &#123;  </span><br><span class="line">    <span class="keyword">int</span>[] result = <span class="keyword">new</span> <span class="keyword">int</span>[queries.length];  </span><br><span class="line">    List&lt;C1&gt; c1List = <span class="keyword">new</span> ArrayList&lt;&gt;();  </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span>[] room : rooms) &#123;  </span><br><span class="line">        C1 c1 = <span class="keyword">new</span> C1(<span class="number">0</span>, room[<span class="number">0</span>], room[<span class="number">1</span>]);  </span><br><span class="line">        c1List.add(c1);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span>[] querie : queries) &#123;  </span><br><span class="line">        C1 c1 = <span class="keyword">new</span> C1(<span class="number">1</span>, querie[<span class="number">0</span>], querie[<span class="number">1</span>]);  </span><br><span class="line">        c1.setQuerieIndex(index);  </span><br><span class="line">        index++;  </span><br><span class="line">        c1List.add(c1);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// æŒ‰ç…§ size è¿›è¡Œæ’åº  </span></span><br><span class="line">    Collections.sort(c1List, <span class="keyword">new</span> Comparator&lt;C1&gt;() &#123;  </span><br><span class="line">        <span class="meta">@Override</span>  </span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(C1 o1, C1 o2)</span> </span>&#123;  </span><br><span class="line">            <span class="keyword">return</span> Integer.compare(o2.getSize(), o1.getSize());  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;);  </span><br><span class="line">  </span><br><span class="line">    TreeSet&lt;Integer&gt; roomIdTree = <span class="keyword">new</span> TreeSet&lt;&gt;();  </span><br><span class="line">    <span class="keyword">for</span> (C1 c1 : c1List) &#123;  </span><br><span class="line">        <span class="keyword">if</span> (!c1.isQuerie()) &#123;  </span><br><span class="line">            roomIdTree.add(c1.getId());  </span><br><span class="line">            <span class="keyword">continue</span>;  </span><br><span class="line">        &#125;  </span><br><span class="line">        result[c1.getQuerieIndex()] = getMinRoomId(roomIdTree, c1);  </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">return</span> result;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// æŸ¥æ‰¾æœ€å°çš„æˆ¿é—´å·  </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getMinRoomId</span><span class="params">(TreeSet&lt;Integer&gt; roomIdTree, C1 c1)</span> </span>&#123;  </span><br><span class="line">    <span class="keyword">if</span> (roomIdTree.isEmpty()) &#123;  </span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">        <span class="comment">// æ‰¾å‡ºå¤§äºç­‰äº c1.id çš„æœ€å°çš„æˆ¿é—´å·</span></span><br><span class="line">    Integer ceiling = roomIdTree.ceiling(c1.getId());  </span><br><span class="line">        <span class="comment">// æ‰¾å‡ºå°äºç­‰äº c1.id çš„æœ€å¤§çš„æˆ¿é—´å·</span></span><br><span class="line">    Integer floor = roomIdTree.floor(c1.getId());  </span><br><span class="line">    <span class="keyword">if</span> (ceiling == <span class="keyword">null</span>)&#123;  </span><br><span class="line">        <span class="keyword">return</span> floor;  </span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (floor == <span class="keyword">null</span>)&#123;  </span><br><span class="line">        <span class="keyword">return</span> ceiling;  </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;  </span><br><span class="line">        <span class="keyword">return</span> Math.abs(ceiling - c1.getId()) &gt;= Math.abs(floor - c1.getId()) ? floor : ceiling;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Leetcodeåˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Leetcodeåˆ·é¢˜ã€‘K æ¬¡ä¹˜è¿ç®—åçš„æœ€ç»ˆæ•°ç»„ I</title>
      <link href="/2024/12/13/%E3%80%90Leetcode%E5%88%B7%E9%A2%98%E3%80%91K-%E6%AC%A1%E4%B9%98%E8%BF%90%E7%AE%97%E5%90%8E%E7%9A%84%E6%9C%80%E7%BB%88%E6%95%B0%E7%BB%84-I/"/>
      <url>/2024/12/13/%E3%80%90Leetcode%E5%88%B7%E9%A2%98%E3%80%91K-%E6%AC%A1%E4%B9%98%E8%BF%90%E7%AE%97%E5%90%8E%E7%9A%84%E6%9C%80%E7%BB%88%E6%95%B0%E7%BB%84-I/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢˜ç›®è·¯å¾„ï¼š"><a href="#é¢˜ç›®è·¯å¾„ï¼š" class="headerlink" title="é¢˜ç›®è·¯å¾„ï¼š"></a>é¢˜ç›®è·¯å¾„ï¼š</h1><p><a href="https://leetcode.cn/problems/final-array-state-after-k-multiplication-operations-i/">3264. K æ¬¡ä¹˜è¿ç®—åçš„æœ€ç»ˆæ•°ç»„ I</a></p><h1 id="ä¸ªäººè§£æ³•"><a href="#ä¸ªäººè§£æ³•" class="headerlink" title="ä¸ªäººè§£æ³•"></a>ä¸ªäººè§£æ³•</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] getFinalState(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k, <span class="keyword">int</span> multiplier) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;i++)&#123;</span><br><span class="line">            fun1(nums,multiplier);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–æœ€å°å€¼å¹¶ä¹˜ä»¥ multiplier</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">fun1</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> multiplier)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[index] &gt; nums[i]) &#123;</span><br><span class="line">                index = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        nums[index] = nums[index] * multiplier;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Leetcodeåˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®åº“datetimeç±»å‹çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥ç›¸å·®8å°æ—¶</title>
      <link href="/2024/12/10/%E6%95%B0%E6%8D%AE%E5%BA%93datetime%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E5%87%BA%E6%9D%A5%E7%9B%B8%E5%B7%AE8%E5%B0%8F%E6%97%B6/"/>
      <url>/2024/12/10/%E6%95%B0%E6%8D%AE%E5%BA%93datetime%E7%B1%BB%E5%9E%8B%E7%9A%84%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E5%87%BA%E6%9D%A5%E7%9B%B8%E5%B7%AE8%E5%B0%8F%E6%97%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="èƒŒæ™¯è¯´æ˜"><a href="#èƒŒæ™¯è¯´æ˜" class="headerlink" title="èƒŒæ™¯è¯´æ˜"></a>èƒŒæ™¯è¯´æ˜</h1><p>ä¸€ä¸ªJAVAé¡¹ç›®ï¼Œä»MYSQLæ•°æ®åº“ä¸­æŸ¥è¯¢æ•°æ®æ—¶ï¼Œå‘ç°æ•°æ®åº“è¡¨ä¸­æ˜¾ç¤ºçš„Dateç±»å‹å­—æ®µçš„æ•°æ®ï¼Œä¸æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ç›¸å·®8å°æ—¶<br><img src="2020241210103808.png" alt="2020241210103808"></p><h1 id="æ’æŸ¥è¿‡ç¨‹"><a href="#æ’æŸ¥è¿‡ç¨‹" class="headerlink" title="æ’æŸ¥è¿‡ç¨‹"></a>æ’æŸ¥è¿‡ç¨‹</h1><ol><li>æŸ¥çœ‹æ‰§è¡Œçš„SQLæ—¥å¿—ï¼šSQLæ—¥å¿—ä¸­æ˜¾ç¤ºï¼ŒæŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ä¸æ•°æ®åº“ä¸€è‡´</li><li>æŸ¥çœ‹æ¥å£è¿”å›çš„æ•°æ®ï¼šå‘ç°è¿”å›çš„æ•°æ®ä¸æ•°æ®åº“ä¸­ç›¸å·®8å°æ—¶</li></ol><h1 id="ä¿®å¤è¿‡ç¨‹"><a href="#ä¿®å¤è¿‡ç¨‹" class="headerlink" title="ä¿®å¤è¿‡ç¨‹"></a>ä¿®å¤è¿‡ç¨‹</h1><ol><li>ã€æ— æ•ˆã€‘ç»™æ•°æ®åº“è¿æ¥æ·»åŠ äº†ï¼šserverTimezone=Asia/Shanghai</li><li>ã€æ— æ•ˆã€‘åœ¨é¡¹ç›®çš„å¯åŠ¨ç±»mainæ–¹æ³•ï¼Œæ·»åŠ å¦‚ä¸‹çš„ä»£ç ï¼šTimeZone.setDefault(TimeZone.getTimeZone(â€œGMT+8â€)); </li><li>ã€æ— æ•ˆã€‘å°†Dateç±»å‹çš„å¼•å…¥çš„åŒ…ä»ï¼šimport java.util.Date; æ”¹æˆ import java.sql.Date;</li><li>ã€æœ‰æ•ˆã€‘åœ¨å¯¹åº”å®ä½“ç±»çš„Dateç±»å‹çš„å­—æ®µæ·»åŠ æ³¨è§£ï¼š@JsonFormat(pattern = â€œyyyy-MM-dd HH:mm:ssâ€, timezone = â€œGMT+8â€)</li><li>ã€æœ‰æ•ˆã€‘ä½¿ç”¨å…¨å±€é…ç½®ï¼š <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring.jackson.date-format=yyyy-MM-dd HH:mm:ss</span><br><span class="line">spring.jackson.time-zone=GMT+8</span><br></pre></td></tr></table></figure></li><li>ã€æœ‰æ•ˆã€‘é…ç½®å…¨å±€çš„Jackson ObjectMapper<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.SerializationFeature;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.datatype.jsr310.JavaTimeModule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.TimeZone;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JacksonConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ObjectMapper <span class="title">objectMapper</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">ObjectMapper objectMapper = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ—¥æœŸæ ¼å¼_</span></span><br><span class="line"></span><br><span class="line">objectMapper.setDateFormat(<span class="keyword">new</span> SimpleDateFormat(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ—¶åŒº_</span></span><br><span class="line"></span><br><span class="line">objectMapper.setTimeZone(TimeZone.getTimeZone(<span class="string">&quot;GMT+8&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†ŒJavaTimeModuleä»¥æ”¯æŒJava 8æ—¥æœŸå’Œæ—¶é—´API_</span></span><br><span class="line"></span><br><span class="line">objectMapper.registerModule(<span class="keyword">new</span> JavaTimeModule());</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¦ç”¨æ—¶é—´æˆ³_</span></span><br><span class="line"></span><br><span class="line">objectMapper.disable(SerializationFeature.WRITE_DATES_AS_TIMESTAMPS);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> objectMapper;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h1 id="åˆ†æåŸå› "><a href="#åˆ†æåŸå› " class="headerlink" title="åˆ†æåŸå› "></a>åˆ†æåŸå› </h1><p>javaé»˜è®¤ä½¿ç”¨UTCæ—¶é—´ï¼Œè€Œå¤§å¤šæ•°æ•°æ®åº“ï¼ˆå¦‚MySQLï¼‰åœ¨ä¸­å›½åœ°åŒºé€šå¸¸è®¾ç½®ä¸ºä¸œå…«åŒºï¼ˆGMT+8ï¼‰ã€‚å› æ­¤ï¼Œå½“Javaä»æ•°æ®åº“ä¸­è¯»å–æ—¶é—´æ—¶ï¼Œå¦‚æœæ²¡æœ‰æ­£ç¡®è®¾ç½®æ—¶åŒºï¼Œå°±ä¼šå‡ºç°æ—¶é—´å·®å¼‚ã€‚</p><p>å› æ­¤åœ¨springé¡¹ç›®ä¸­ï¼ŒJacksonåœ¨å¤„ç†æ—¥æœŸå’Œæ—¶é—´æ—¶ï¼Œéœ€è¦æŒ‡å®šå¯¹åº”çš„æ—¶åŒº</p>]]></content>
      
      
      
        <tags>
            
            <tag> java </tag>
            
            <tag> é—®é¢˜æ’æŸ¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUE+Element æ­å»ºå‰ç«¯é¡¹ç›®</title>
      <link href="/2024/11/21/VUE-Element-%E6%90%AD%E5%BB%BA%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE/"/>
      <url>/2024/11/21/VUE-Element-%E6%90%AD%E5%BB%BA%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. å®‰è£…Nodejs </span><br><span class="line">2. å®‰è£…vue: </span><br><span class="line">npm install -g @vue/cli</span><br></pre></td></tr></table></figure><h1 id="æ­å»ºæ­¥éª¤"><a href="#æ­å»ºæ­¥éª¤" class="headerlink" title="æ­å»ºæ­¥éª¤"></a>æ­å»ºæ­¥éª¤</h1><ol><li><p>å®‰è£…cli-init</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g @vue/cli-init</span><br></pre></td></tr></table></figure></li><li><p>åˆå§‹åŒ–é¡¹ç›®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue init webpack &lt;é¡¹ç›®&gt;</span><br></pre></td></tr></table></figure><blockquote><p><img src="20241121162042.png" alt="20241121162042.png"></p></blockquote></li><li><p>è¿è¡Œé¡¹ç›®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &lt;é¡¹ç›®&gt;</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><blockquote><p><img src="20241121162206.png" alt="20241121162206.png"></p></blockquote></li><li><p>å®‰è£… cnpm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npmmirror.com</span><br></pre></td></tr></table></figure><blockquote><p><img src="20241121162416.png" alt="20241121162416.png"></p></blockquote></li><li><p>å®‰è£… element-ui æ¡†æ¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cnpm i element-ui -S</span><br><span class="line">npm install element-ui</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ element-ui</p></li></ol><ul><li><p>åœ¨main.jsä¸­å¼•å…¥elementç»„ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// The Vue build version to load with the `import` command</span><br><span class="line">// (runtime-only or standalone) has been set in webpack.base.conf with an alias.</span><br><span class="line">import Vue from &#x27;vue&#x27;</span><br><span class="line">import App from &#x27;./App&#x27;</span><br><span class="line">import router from &#x27;./router&#x27;</span><br><span class="line">/*å¼•å…¥elementç»„ä»¶*/</span><br><span class="line">import ElementUI from &#x27;element-ui&#x27;;</span><br><span class="line">import &#x27;element-ui/lib/theme-chalk/index.css&#x27;;</span><br><span class="line">Vue.use(ElementUI);</span><br><span class="line"> </span><br><span class="line">Vue.config.productionTip = false</span><br><span class="line"> </span><br><span class="line">/* eslint-disable no-new */</span><br><span class="line">new Vue(&#123;</span><br><span class="line">  el: &#x27;#app&#x27;,</span><br><span class="line">  router,</span><br><span class="line">  components: &#123; App &#125;,</span><br><span class="line">  template: &#x27;&lt;App/&gt;&#x27;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p>åœ¨ HelloWorld.vue ä¸­ä½¿ç”¨ç»„ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;hello&quot;&gt;</span><br><span class="line">    &lt;h1&gt;&#123;&#123; msg &#125;&#125;&lt;/h1&gt;</span><br><span class="line">    &lt;el-row&gt;</span><br><span class="line">      &lt;el-button&gt;é»˜è®¤æŒ‰é’®&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;primary&quot;&gt;ä¸»è¦æŒ‰é’®&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;success&quot;&gt;æˆåŠŸæŒ‰é’®&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;info&quot;&gt;ä¿¡æ¯æŒ‰é’®&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;warning&quot;&gt;è­¦å‘ŠæŒ‰é’®&lt;/el-button&gt;</span><br><span class="line">      &lt;el-button type=&quot;danger&quot;&gt;å±é™©æŒ‰é’®&lt;/el-button&gt;</span><br><span class="line">    &lt;/el-row&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"> </span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;HelloWorld&quot;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      msg: &quot;ä½¿ç”¨element-uiæµ‹è¯•&quot;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!-- Add &quot;scoped&quot; attribute to limit CSS to this component only --&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">h1,</span><br><span class="line">h2 &#123;</span><br><span class="line">  font-weight: normal;</span><br><span class="line">&#125;</span><br><span class="line">ul &#123;</span><br><span class="line">  list-style-type: none;</span><br><span class="line">  padding: 0;</span><br><span class="line">&#125;</span><br><span class="line">li &#123;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  margin: 0 10px;</span><br><span class="line">&#125;</span><br><span class="line">a &#123;</span><br><span class="line">  color: #42b983;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></li></ul><ol start="7"><li>æœ€ç»ˆæ•ˆæœ<br><img src="20241121162842.png" alt="20241121162842.png"></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
            <tag> vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨AIæ ¹æ®SONARå»ºè®®ä¿®æ”¹ä»£ç </title>
      <link href="/2024/11/20/%E5%88%A9%E7%94%A8AI%E6%A0%B9%E6%8D%AESONAR%E5%BB%BA%E8%AE%AE%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81/"/>
      <url>/2024/11/20/%E5%88%A9%E7%94%A8AI%E6%A0%B9%E6%8D%AESONAR%E5%BB%BA%E8%AE%AE%E4%BF%AE%E6%94%B9%E4%BB%A3%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¯æ¬¡å†™å®Œä»£ç å‘ç°sonarç»™çš„å»ºè®®ï¼Œæœ‰æ—¶å€™æ¯”è¾ƒéš¾ç†è§£ï¼Œä¸€çœ¼çœ‹è¿‡å»ï¼Œå¯èƒ½è¿˜ä¸çŸ¥é“å¦‚ä½•ä¿®æ”¹ä»£ç ï¼Œå¦‚æœè®©AIå¸®å¿™ç†è§£sonarçš„å»ºè®®ï¼Œå†æ ¹æ®æä¾›çš„ä»£ç ï¼Œè®©AIç›´æ¥æä¾›ä¿®æ”¹åçš„ä»£ç </span><br></pre></td></tr></table></figure><h1 id="è®¾è®¡è¿‡ç¨‹"><a href="#è®¾è®¡è¿‡ç¨‹" class="headerlink" title="è®¾è®¡è¿‡ç¨‹"></a>è®¾è®¡è¿‡ç¨‹</h1><ol><li>è®¿é—® sonarQube æœåŠ¡</li><li>è·å–å¯¹åº”æœåŠ¡Bugsçš„æ¥å£</li><li>è·å–Bugsè§¦å‘çš„sonarè§„åˆ™</li></ol><h2 id="Bugsæ¥å£åˆ—è¡¨"><a href="#Bugsæ¥å£åˆ—è¡¨" class="headerlink" title="Bugsæ¥å£åˆ—è¡¨"></a>Bugsæ¥å£åˆ—è¡¨</h2><ul><li>æ¥å£ï¼š/api/issues/search?componentKeys={componentKeys}&amp;s=FILE_LINE&amp;resolved=false&amp;types=BUG&amp;ps=100&amp;organization=default-organization&amp;facets=severities%2CsonarsourceSecurity%2Ctypes&amp;additionalFields=_all<blockquote><p>å…¶ä¸­çš„ componentKeys ä¸º ä½ çš„æœåŠ¡</p></blockquote></li></ul><p><img src="20241120105343.png" alt="20241120105343.png"></p><h2 id="è·å–SONARè§„åˆ™è¯¦æƒ…"><a href="#è·å–SONARè§„åˆ™è¯¦æƒ…" class="headerlink" title="è·å–SONARè§„åˆ™è¯¦æƒ…"></a>è·å–SONARè§„åˆ™è¯¦æƒ…</h2><ul><li>æ¥å£ï¼š/api/rules/show?key={rule}&amp;organization=default-organization<blockquote><p>å…¶ä¸­çš„<code>rule</code>è¡¨ç¤ºè§¦å‘çš„è§„åˆ™ç¼–ç </p></blockquote></li></ul><p><img src="20241120110042.png" alt="20241120110042.png"></p><h1 id="å…·ä½“å®ç°ä»£ç "><a href="#å…·ä½“å®ç°ä»£ç " class="headerlink" title="å…·ä½“å®ç°ä»£ç "></a>å…·ä½“å®ç°ä»£ç </h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span> utils.chat_utils <span class="keyword">import</span> ChatUtils  </span><br><span class="line"><span class="keyword">from</span> utils.prompt_utils <span class="keyword">import</span> PromptUtils  </span><br><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SonarAnalysisResult</span>:</span>  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, component, line, message, rule, rule_detail</span>):</span>  </span><br><span class="line">        self.component = component  </span><br><span class="line">        self.line = line  </span><br><span class="line">        self.message = message  </span><br><span class="line">        self.rule = rule  </span><br><span class="line">        self.rule_detail = rule_detail  </span><br><span class="line">        self.fix_suggestions = <span class="string">&quot;&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_fix_suggestions</span>(<span class="params">self, fix_suggestions</span>):</span>  </span><br><span class="line">        self.fix_suggestions = fix_suggestions  </span><br><span class="line">  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SonarService</span>:</span>  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        self.cookie = <span class="string">&#x27;LtpaToken=AAECAzY3MzU1Q0IyNxxxsP1MNIcSGzTxQR1TOVkg&#x27;</span>  </span><br><span class="line">        self.headers = &#123;  </span><br><span class="line">            <span class="string">&#x27;Cookie&#x27;</span>: self.cookie  </span><br><span class="line">        &#125;  </span><br><span class="line">        self.project_name = <span class="string">&quot;xxx-xxx-service&quot;</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, project_name, cookies</span>):</span>  </span><br><span class="line">        self.project_name = project_name  </span><br><span class="line">        self.cookie = cookies  </span><br><span class="line">        self.headers = &#123;  </span><br><span class="line">            <span class="string">&#x27;Cookie&#x27;</span>: self.cookie  </span><br><span class="line">        &#125;  </span><br><span class="line">      </span><br><span class="line">    <span class="comment"># è·å–è§„åˆ™è¯¦æƒ…  </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_rule_detail</span>(<span class="params">self, rule</span>):</span>  </span><br><span class="line">        url = <span class="string">f&quot;https://sonar.xxx.com/api/rules/show?key=<span class="subst">&#123;rule&#125;</span>&amp;organization=default-organization&quot;</span>  </span><br><span class="line">        response = requests.get(url, headers=self.headers)  </span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:  </span><br><span class="line">            result = response.json()  </span><br><span class="line">            rule = result.get(<span class="string">&quot;rule&quot;</span>)  </span><br><span class="line">            mdDesc = rule.get(<span class="string">&quot;mdDesc&quot;</span>)  </span><br><span class="line">            <span class="keyword">return</span> mdDesc  </span><br><span class="line">        <span class="keyword">else</span>:  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="comment"># è·å–sonaråˆ†æç»“æœ  </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_sonar_analysis_result</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        componentKeys = self.project_name  </span><br><span class="line">        url = <span class="string">f&quot;https://sonar.xxx.com/api/issues/search?componentKeys=<span class="subst">&#123;componentKeys&#125;</span>&amp;s=FILE_LINE&amp;resolved=false&amp;types=BUG&amp;ps=100&amp;organization=default-organization&amp;facets=severities%2CsonarsourceSecurity%2Ctypes&amp;additionalFields=_all&quot;</span>  </span><br><span class="line">        response = requests.get(url, headers=self.headers)  </span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:  </span><br><span class="line">            result = response.json()  </span><br><span class="line">            issues = result.get(<span class="string">&quot;issues&quot;</span>, [])  </span><br><span class="line">            <span class="keyword">return</span> issues  </span><br><span class="line">        <span class="keyword">else</span>:  </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span>  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_issues</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        sonar_analysis_result = []  </span><br><span class="line">        issues = self.get_sonar_analysis_result()  </span><br><span class="line">        <span class="keyword">for</span> issue <span class="keyword">in</span> issues:  </span><br><span class="line">            <span class="comment"># xxxx-service:xxxx-service/src/main/java/com/xxx/xxx/xxx/xxxx/application/xx/BxxdAxxxsageService.java  </span></span><br><span class="line">            component = issue.get(<span class="string">&quot;component&quot;</span>)  </span><br><span class="line">            <span class="comment"># 49  </span></span><br><span class="line">            line = issue.get(<span class="string">&quot;line&quot;</span>)  </span><br><span class="line">            <span class="comment"># Method com.yjh.xxx.xxx.xxx.xxx.command.BrandAxxxeService.cleaxxxsage() builds a list from one element using Arrays.asList rather than Collections.singletonList  </span></span><br><span class="line">            message = issue.get(<span class="string">&quot;message&quot;</span>)  </span><br><span class="line">            <span class="comment"># fb-contrib:LUI_USE_SINGLETON_LIST  </span></span><br><span class="line">            rule = issue.get(<span class="string">&quot;rule&quot;</span>)  </span><br><span class="line">            <span class="string">&#x27;&#x27;&#x27;  </span></span><br><span class="line"><span class="string">            &lt;p&gt;This method builds a list using Arrays.asList(foo), passing in a single element. Arrays.asList needs to first create an array from this one            element, and then build a List that wraps this array. It is simpler to use Collections.singletonList(foo), which does not create the array, and            produces a far simpler instance of List. Since both of these arrays are immutable (from the List&#x27;s point of view) they are equivalent from a usage            standpoint.            &lt;/p&gt;            &lt;p&gt;There is one difference between Array.asList and Collections.singletonList that you should be mindful of. The rarely used set(index, value) method is            allowed to be used with a List created by Array.asList, but not with Collections.singletonList. So if you do use the set(index, value) method            continue using Arrays.asList.            &#x27;&#x27;&#x27;</span>            </span><br><span class="line">            rule_detail = self.get_rule_detail(rule)  </span><br><span class="line">            sonar_analysis_result.append(SonarAnalysisResult(component, line, message, rule, rule_detail))  </span><br><span class="line">        <span class="keyword">return</span> sonar_analysis_result  </span><br><span class="line">      </span><br><span class="line">    <span class="comment"># è·å–æŒ‡å®šæ–‡ä»¶ï¼ŒæŒ‡å®šè¡Œæ•°çš„ä»£ç   </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_code</span>(<span class="params">self, component, line</span>):</span>  </span><br><span class="line">        start_line = line - <span class="number">20</span>  </span><br><span class="line">        end_line = line + <span class="number">20</span>  </span><br><span class="line">        url = <span class="string">f&quot;https://sonar.xxx.com/api/sources/lines?key=<span class="subst">&#123;component&#125;</span>&amp;from=<span class="subst">&#123;start_line&#125;</span>&amp;to=<span class="subst">&#123;end_line&#125;</span>&quot;</span>  </span><br><span class="line">        response = requests.get(url, headers=self.headers)  </span><br><span class="line">        code = <span class="string">&quot;&quot;</span>  </span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:  </span><br><span class="line">            result = response.json()  </span><br><span class="line">            sources = result.get(<span class="string">&quot;sources&quot;</span>, [])  </span><br><span class="line">            <span class="keyword">for</span> source <span class="keyword">in</span> sources:  </span><br><span class="line">                code = <span class="string">f&#x27;<span class="subst">&#123;code&#125;</span>\n<span class="subst">&#123;source.get(<span class="string">&quot;code&quot;</span>)&#125;</span>&#x27;</span>  </span><br><span class="line">        <span class="keyword">return</span> code  </span><br><span class="line">          </span><br><span class="line">    <span class="comment"># è®©AIæ ¹æ®ä»£ç å’Œè§„åˆ™è¯¦æƒ…ç»™å‡ºä¿®å¤å»ºè®®  </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_fix_suggestions</span>(<span class="params">self, code, rule_detail</span>):</span>  </span><br><span class="line">        prompt = PromptUtils.read_prompt(<span class="string">&quot;fix_suggestions.md&quot;</span>).replace(<span class="string">&#x27;$&#123;code&#125;&#x27;</span>, code).replace(<span class="string">&#x27;$&#123;rule_detail&#125;&#x27;</span>, rule_detail)  </span><br><span class="line">        <span class="comment"># è°ƒç”¨AIæ¥å£ï¼Œæ ¹æ®ä»£ç å’Œè§„åˆ™è¯¦æƒ…ç»™å‡ºä¿®å¤å»ºè®®  </span></span><br><span class="line">        <span class="keyword">return</span> ChatUtils.invoke(prompt).content  </span><br><span class="line">      </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        sonar_analysis_result = self.get_issues()  </span><br><span class="line">        <span class="keyword">for</span> sonar_analysis_result <span class="keyword">in</span> sonar_analysis_result:  </span><br><span class="line">            code = self.get_code(sonar_analysis_result.component, sonar_analysis_result.line)  </span><br><span class="line">            fix_suggestions = self.get_fix_suggestions(code, sonar_analysis_result.rule_detail)  </span><br><span class="line">            sonar_analysis_result.set_fix_suggestions(fix_suggestions)  </span><br><span class="line">            msg = <span class="string">f&quot;## æ–‡ä»¶ï¼š<span class="subst">&#123;class_name&#125;</span> \n[] æ–‡ä»¶è·¯å¾„ï¼š<span class="subst">&#123;sonar_analysis_result.component&#125;</span> \n è¡Œæ•°ï¼š<span class="subst">&#123;sonar_analysis_result.line&#125;</span> \n<span class="subst">&#123;sonar_analysis_result.fix_suggestions&#125;</span>&quot;</span></span><br><span class="line">            <span class="built_in">print</span>(msg)</span><br><span class="line">            <span class="comment"># ä½¿ç”¨streamlit æ‰“å°  </span></span><br><span class="line">            <span class="comment"># class_name = sonar_analysis_result.component.split(&quot;/&quot;)[-1]  </span></span><br><span class="line">            <span class="comment"># st.markdown(mgs)  </span></span><br><span class="line">            <span class="comment"># st.markdown(&quot;---&quot;)  </span></span><br><span class="line">        <span class="keyword">return</span> sonar_analysis_result  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:  </span><br><span class="line">    sonar_service = SonarService()  </span><br><span class="line">    sonar_service.main()</span><br></pre></td></tr></table></figure><h1 id="æœ€ç»ˆæ•ˆæœ"><a href="#æœ€ç»ˆæ•ˆæœ" class="headerlink" title="æœ€ç»ˆæ•ˆæœ"></a>æœ€ç»ˆæ•ˆæœ</h1><p><img src="20241120112018.png" alt="20241120112018.png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> sonar </tag>
            
            <tag> ai </tag>
            
            <tag> chatgpt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¬¡ä½¿ç”¨Nodeæ­å»ºå‰ç«¯é¡¹ç›®</title>
      <link href="/2024/11/15/%E5%88%9D%E6%AC%A1%E4%BD%BF%E7%94%A8Node%E6%90%AD%E5%BB%BA%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE/"/>
      <url>/2024/11/15/%E5%88%9D%E6%AC%A1%E4%BD%BF%E7%94%A8Node%E6%90%AD%E5%BB%BA%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. å®‰è£…Nodejs </span><br><span class="line">2. å®‰è£…vue: </span><br><span class="line">npm install -g @vue/cli</span><br></pre></td></tr></table></figure><h1 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h1><h2 id="åˆ›å»ºå‰ç«¯è„šæ‰‹æ¶"><a href="#åˆ›å»ºå‰ç«¯è„šæ‰‹æ¶" class="headerlink" title="åˆ›å»ºå‰ç«¯è„šæ‰‹æ¶"></a>åˆ›å»ºå‰ç«¯è„šæ‰‹æ¶</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm create vue@latest</span><br></pre></td></tr></table></figure><p><img src="20241114154111.png" alt="20241114154111.png"></p><h2 id="è¿è¡Œé¡¹ç›®"><a href="#è¿è¡Œé¡¹ç›®" class="headerlink" title="è¿è¡Œé¡¹ç›®"></a>è¿è¡Œé¡¹ç›®</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p><img src="20241114154225.png" alt="20241114154225.png"></p><h1 id="å‰ç«¯é¡¹ç›®æ¡†æ¶è¯´æ˜"><a href="#å‰ç«¯é¡¹ç›®æ¡†æ¶è¯´æ˜" class="headerlink" title="å‰ç«¯é¡¹ç›®æ¡†æ¶è¯´æ˜"></a>å‰ç«¯é¡¹ç›®æ¡†æ¶è¯´æ˜</h1><p><img src="20241114154406.png" alt="20241114154406.png"></p><h2 id="main-ts"><a href="#main-ts" class="headerlink" title="main.ts"></a>main.ts</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥å…¨å±€æ ·å¼æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/main.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥ Vue æ¡†æ¶çš„ createApp å‡½æ•°</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥æ ¹ç»„ä»¶ App</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥è·¯ç”±é…ç½®</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»º Vue åº”ç”¨å®ä¾‹ï¼Œå¹¶æŒ‚è½½åˆ° #app å…ƒç´ ä¸Š</span></span><br><span class="line">createApp(App)</span><br><span class="line">Â  .use(router) <span class="comment">// ä½¿ç”¨è·¯ç”±</span></span><br><span class="line">Â  .mount(<span class="string">&#x27;#app&#x27;</span>) <span class="comment">// æŒ‚è½½åº”ç”¨</span></span><br></pre></td></tr></table></figure><h2 id="router-index-ts"><a href="#router-index-ts" class="headerlink" title="router/index.ts"></a>router/index.ts</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ Vue Router çš„ createRouter å’Œ createWebHistory å‡½æ•°</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥è§†å›¾ç»„ä»¶</span></span><br><span class="line"><span class="keyword">import</span> HomePage <span class="keyword">from</span> <span class="string">&#x27;../views/HomePage.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> CodeGeneratorView <span class="keyword">from</span> <span class="string">&#x27;../views/CodeGeneratorView.vue&#x27;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè·¯ç”±å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">const</span> router = createRouter(&#123;</span><br><span class="line"></span><br><span class="line">Â  <span class="comment">// ä½¿ç”¨ HTML5 çš„å†å²æ¨¡å¼</span></span><br><span class="line">Â  <span class="attr">history</span>: createWebHistory(<span class="keyword">import</span>.meta.env.BASE_URL),</span><br><span class="line"></span><br><span class="line">Â  <span class="comment">// å®šä¹‰è·¯ç”±</span></span><br><span class="line">Â  <span class="attr">routes</span>: [</span><br><span class="line">Â  Â  &#123;</span><br><span class="line">Â  Â  Â  <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>, <span class="comment">// æ ¹è·¯å¾„</span></span><br><span class="line">Â  Â  Â  <span class="attr">name</span>: <span class="string">&#x27;home&#x27;</span>, <span class="comment">// è·¯ç”±åç§°</span></span><br><span class="line">Â  Â  Â  <span class="attr">component</span>: HomePage, <span class="comment">// å…³è”çš„ç»„ä»¶</span></span><br><span class="line">Â  Â  &#125;,</span><br><span class="line"></span><br><span class="line">Â  Â  &#123;</span><br><span class="line">Â  Â  Â  <span class="attr">path</span>: <span class="string">&#x27;/code-generator&#x27;</span>, <span class="comment">// ä»£ç ç”Ÿæˆå™¨è·¯å¾„</span></span><br><span class="line">Â  Â  Â  <span class="attr">name</span>: <span class="string">&#x27;code-generator&#x27;</span>, <span class="comment">// è·¯ç”±åç§°</span></span><br><span class="line">Â  Â  Â  <span class="attr">component</span>: CodeGeneratorView, <span class="comment">// å…³è”çš„ç»„ä»¶</span></span><br><span class="line">Â  Â  &#125;,</span><br><span class="line">Â  ],</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å‡ºè·¯ç”±å™¨å®ä¾‹</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure><h2 id="App-vue"><a href="#App-vue" class="headerlink" title="App.vue"></a>App.vue</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">Â  &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">Â  Â  &lt;router-view&gt;&lt;/router-view&gt;</span><br><span class="line">Â  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">Â  name: &#x27;App&#x27;,</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">/* æ ·å¼ */</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h2 id="views-HomePage-vue"><a href="#views-HomePage-vue" class="headerlink" title="views/HomePage.vue"></a>views/HomePage.vue</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"></span><br><span class="line">Â  &lt;div class=&quot;home-page&quot;&gt;</span><br><span class="line"></span><br><span class="line">Â  Â  &lt;h1&gt;å·¥å…·é€‰æ‹©&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">Â  Â  &lt;div class=&quot;button-grid&quot;&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  Â  &lt;router-link to=&quot;/code-generator&quot; class=&quot;tool-button&quot;&gt;ä»£ç ç”Ÿæˆå·¥å…·&lt;/router-link&gt;</span><br><span class="line">Â  Â  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">Â  &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line"></span><br><span class="line">Â  name: &#x27;HomePage&#x27;,</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">.home-page &#123;</span><br><span class="line"></span><br><span class="line">Â  text-align: center;</span><br><span class="line"></span><br><span class="line">Â  padding: 20px;</span><br><span class="line"></span><br><span class="line">Â  background-color: #f9f9f9;</span><br><span class="line"></span><br><span class="line">Â  font-family: &#x27;Arial&#x27;, sans-serif;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">.button-grid &#123;</span><br><span class="line"></span><br><span class="line">Â  display: flex;</span><br><span class="line"></span><br><span class="line">Â  flex-wrap: wrap;</span><br><span class="line"></span><br><span class="line">Â  gap: 20px;</span><br><span class="line"></span><br><span class="line">Â  justify-content: flex-start;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">.tool-button &#123;</span><br><span class="line"></span><br><span class="line">Â  display: inline-block;</span><br><span class="line"></span><br><span class="line">Â  padding: 20px 30px;</span><br><span class="line"></span><br><span class="line">Â  background-color: #4CAF50;</span><br><span class="line"></span><br><span class="line">Â  color: white;</span><br><span class="line"></span><br><span class="line">Â  text-decoration: none;</span><br><span class="line"></span><br><span class="line">Â  border-radius: 8px;</span><br><span class="line"></span><br><span class="line">Â  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);</span><br><span class="line"></span><br><span class="line">Â  transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;</span><br><span class="line"></span><br><span class="line">Â  flex: 1 1 calc(20% - 20px);</span><br><span class="line"></span><br><span class="line">Â  box-sizing: border-box;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">.tool-button:hover &#123;</span><br><span class="line"></span><br><span class="line">Â  background-color: #45a049;</span><br><span class="line"></span><br><span class="line">Â  transform: translateY(-2px);</span><br><span class="line"></span><br><span class="line">Â  box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h1 id="æ­£å¼é¡¹ç›®å¼€å‘"><a href="#æ­£å¼é¡¹ç›®å¼€å‘" class="headerlink" title="æ­£å¼é¡¹ç›®å¼€å‘"></a>æ­£å¼é¡¹ç›®å¼€å‘</h1><p>ä»viewsç›®å½•ä¸‹æ·»åŠ æ–°çš„vueï¼Œé€šè¿‡ï¼ˆindex.tsï¼‰é…ç½®è·¯ç”±è®¿é—®æ–°çš„vueç•Œé¢</p>]]></content>
      
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
            <tag> node </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonè°ƒç”¨æœ¬åœ°ollamaéƒ¨ç½²çš„æ¨¡å‹</title>
      <link href="/2024/11/12/python%E8%B0%83%E7%94%A8%E6%9C%AC%E5%9C%B0ollama%E9%83%A8%E7%BD%B2%E7%9A%84%E6%A8%A1%E5%9E%8B/"/>
      <url>/2024/11/12/python%E8%B0%83%E7%94%A8%E6%9C%AC%E5%9C%B0ollama%E9%83%A8%E7%BD%B2%E7%9A%84%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="ä½¿ç”¨langchainè°ƒç”¨ollamaéƒ¨ç½²çš„æ¨¡å‹"><a href="#ä½¿ç”¨langchainè°ƒç”¨ollamaéƒ¨ç½²çš„æ¨¡å‹" class="headerlink" title="ä½¿ç”¨langchainè°ƒç”¨ollamaéƒ¨ç½²çš„æ¨¡å‹"></a>ä½¿ç”¨langchainè°ƒç”¨ollamaéƒ¨ç½²çš„æ¨¡å‹</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> langchain_community.llms <span class="keyword">import</span> ollama</span><br><span class="line">host = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">port = <span class="string">&quot;11434&quot;</span></span><br><span class="line">URL_ADDRESS = <span class="string">f&quot;http://<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span>&quot;</span></span><br><span class="line">model = <span class="string">&quot;qwen2.5&quot;</span></span><br><span class="line">llm = ollama.Ollama(model=model, base_url=URL_ADDRESS, temperature=<span class="number">0</span>)</span><br><span class="line">res = llm.invoke(message)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨requestsè°ƒç”¨ollamaéƒ¨ç½²çš„æ¨¡å‹"><a href="#ä½¿ç”¨requestsè°ƒç”¨ollamaéƒ¨ç½²çš„æ¨¡å‹" class="headerlink" title="ä½¿ç”¨requestsè°ƒç”¨ollamaéƒ¨ç½²çš„æ¨¡å‹"></a>ä½¿ç”¨requestsè°ƒç”¨ollamaéƒ¨ç½²çš„æ¨¡å‹</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">host = <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">port = <span class="string">&quot;11434&quot;</span></span><br><span class="line">url = <span class="string">f&quot;http://<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span>/api/chat&quot;</span></span><br><span class="line">model = <span class="string">&quot;qwen2.5&quot;</span></span><br><span class="line">headers = &#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>&#125;</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;model&quot;</span>:model,<span class="comment">#æ¨¡å‹é€‰æ‹©</span></span><br><span class="line">    <span class="string">&quot;options&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;temperature&quot;</span>:<span class="number">0.</span><span class="comment">#ä¸º0è¡¨ç¤ºä¸è®©æ¨¡å‹è‡ªç”±å‘æŒ¥,è¾“å‡ºç»“æœç›¸å¯¹è¾ƒå›ºå®š,&gt;0çš„è¯,è¾“å‡ºçš„ç»“æœä¼šæ¯”è¾ƒæ”¾é£è‡ªæˆ‘</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;stream&quot;</span>:<span class="literal">False</span>,<span class="comment">#æµå¼è¾“å‡º</span></span><br><span class="line">    <span class="string">&quot;messages&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>,</span><br><span class="line">            <span class="string">&quot;content&quot;</span>:<span class="string">&quot;ä½ æ˜¯è°?&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]<span class="comment">#å¯¹è¯åˆ—è¡¨</span></span><br><span class="line">&#125;</span><br><span class="line">response=requests.post(url,json=data,headers=headers,timeout=<span class="number">60</span>)</span><br><span class="line">res=response.json()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDEAä¸­æ— æ³•æ‰“å¼€ç»ˆç«¯</title>
      <link href="/2024/10/08/IDEA%E4%B8%AD%E6%97%A0%E6%B3%95%E6%89%93%E5%BC%80%E7%BB%88%E7%AB%AF/"/>
      <url>/2024/10/08/IDEA%E4%B8%AD%E6%97%A0%E6%B3%95%E6%89%93%E5%BC%80%E7%BB%88%E7%AB%AF/</url>
      
        <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>åœ¨IDEAä¸­æ‰“å¼€ç»ˆç«¯ï¼Œå‡ºç°å¦‚ä¸‹çš„é”™è¯¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cannot open æœ¬åœ°</span><br><span class="line">Failed to start [C:\Windows\system32\cmd.exe] in ...</span><br></pre></td></tr></table></figure><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><ol><li>ç¦ç”¨æ³¨å†Œè¡¨é”®ï¼š<br>ç¦ç”¨ <code>terminal.use.conpty.on.windows</code> æ³¨å†Œè¡¨é”®ã€‚è¿™æ˜¯ä¸€ä¸ªä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼Œä½†å¯èƒ½ä¼šå½±å“ç»ˆç«¯çš„ä¸€äº›åŠŸèƒ½ã€‚</li><li>æ›´æ–°åˆ°2024.1.1ç‰ˆæœ¬æˆ–æ›´é«˜ç‰ˆæœ¬ï¼š<br>å¦‚æœå·²ç»æ›´æ–°åˆ°2024.1.1ç‰ˆæœ¬æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨æ›´å¥½çš„è§£å†³æ–¹æ¡ˆï¼š</li></ol><ul><li>åœ¨ä¸»èœå•ä¸­ï¼Œé€‰æ‹©â€œHelpâ€ -&gt; â€œEdit Custom VM Optionsâ€ã€‚</li><li>æ·»åŠ ä»¥ä¸‹è¡Œï¼š<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Dcom.pty4j.windows.disable.bundled.conpty=true</span><br></pre></td></tr></table></figure></li><li>é‡å¯IDEã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> IDEA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDEAå¼‚å¸¸é€€å‡ºå¯¼è‡´é¡¹ç›®å¯åŠ¨æŠ¥ç«¯å£è¢«å ç”¨</title>
      <link href="/2024/09/27/IDEA%E5%BC%82%E5%B8%B8%E9%80%80%E5%87%BA%E5%AF%BC%E8%87%B4%E9%A1%B9%E7%9B%AE%E5%90%AF%E5%8A%A8%E6%8A%A5%E7%AB%AF%E5%8F%A3%E8%A2%AB%E5%8D%A0%E7%94%A8/"/>
      <url>/2024/09/27/IDEA%E5%BC%82%E5%B8%B8%E9%80%80%E5%87%BA%E5%AF%BC%E8%87%B4%E9%A1%B9%E7%9B%AE%E5%90%AF%E5%8A%A8%E6%8A%A5%E7%AB%AF%E5%8F%A3%E8%A2%AB%E5%8D%A0%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><p>IDEAå¼‚å¸¸é€€å‡ºå¯¼è‡´é¡¹ç›®å¯åŠ¨æŠ¥ç«¯å£è¢«å ç”¨</p><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><ol><li>æ‰“å¼€ç»ˆç«¯</li><li>æŸ¥è¯¢å ç”¨ç«¯å£çš„è¿›ç¨‹<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano | findstr &quot;:&lt;port&gt;&quot;</span><br></pre></td></tr></table></figure></li><li>æ€æ­»è¿›ç¨‹<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill /pid &lt;pid&gt; /f</span><br></pre></td></tr></table></figure></li><li>é‡æ–°å¯åŠ¨é¡¹ç›®</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> IDEA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–‡æœ¬è½¬pdf</title>
      <link href="/2024/09/26/%E6%96%87%E6%9C%AC%E8%BD%ACpdf/"/>
      <url>/2024/09/26/%E6%96%87%E6%9C%AC%E8%BD%ACpdf/</url>
      
        <content type="html"><![CDATA[<h1 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h1><p>è¿™é‡Œéœ€è¦ä¸‹è½½ä¸€ä¸ªå­—ä½“æ–‡ä»¶ï¼Œä»£ç ä¸­çš„/root/simsun.ttcæ˜¯å­—ä½“æ–‡ä»¶ï¼Œéœ€è¦æå‰ä¸‹è½½å¥½ï¼Œå¹¶æ”¾åœ¨æŒ‡å®šçš„ç›®å½•ï¼Œè¿™é‡Œçš„/root/simsun.ttcæ˜¯å­—ä½“æ–‡ä»¶çš„è·¯å¾„ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹ã€‚<br>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/jiaxiaochu/font/blob/master/simsun.ttc">https://github.com/jiaxiaochu/font/blob/master/simsun.ttc</a></p><h1 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdfbox-tools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.sf.cssbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdf2dom<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itextpdf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itextpdf<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.5.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itextpdf.tool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xmlworker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.5.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-scratchpad<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.itextpdf.text.*;</span><br><span class="line"><span class="keyword">import</span> com.itextpdf.text.pdf.BaseFont;</span><br><span class="line"><span class="keyword">import</span> com.itextpdf.text.pdf.PdfWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * PdfUtil Pdfæ–‡ä»¶å·¥å…·</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> zq</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 2024/09/26 22:</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PdfUtil</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">createPdf</span><span class="params">(String content, String pdfPath)</span> <span class="keyword">throws</span> IOException, DocumentException </span>&#123;</span><br><span class="line">        Document pdfDoc = <span class="keyword">new</span> Document(PageSize.A4);</span><br><span class="line">        PdfWriter.getInstance(pdfDoc, <span class="keyword">new</span> FileOutputStream(pdfPath))</span><br><span class="line">                .setPdfVersion(PdfWriter.PDF_VERSION_1_7);</span><br><span class="line">        pdfDoc.open();</span><br><span class="line">        BaseFont bfChinese = BaseFont.createFont(<span class="string">&quot;/root/simsun.ttc,1&quot;</span>, BaseFont.IDENTITY_H, BaseFont.EMBEDDED);</span><br><span class="line">        Font myfont = <span class="keyword">new</span> Font(bfChinese, <span class="number">11</span>, Font.NORMAL);</span><br><span class="line">        pdfDoc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;\n&quot;</span>));</span><br><span class="line">        Paragraph para = <span class="keyword">new</span> Paragraph(content + <span class="string">&quot;\n&quot;</span>, myfont);</span><br><span class="line">        para.setAlignment(Element.ALIGN_JUSTIFIED);</span><br><span class="line">        pdfDoc.add(para);</span><br><span class="line">        pdfDoc.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">txt2pdf</span><span class="params">(String txtPath, String pdfPath)</span> <span class="keyword">throws</span> IOException, DocumentException </span>&#123;</span><br><span class="line">        Document pdfDoc = <span class="keyword">new</span> Document(PageSize.A4);</span><br><span class="line">        PdfWriter.getInstance(pdfDoc, <span class="keyword">new</span> FileOutputStream(pdfPath))</span><br><span class="line">                .setPdfVersion(PdfWriter.PDF_VERSION_1_7);</span><br><span class="line">        pdfDoc.open();</span><br><span class="line">        BaseFont bfChinese = BaseFont.createFont(<span class="string">&quot;/root/simsun.ttc,1&quot;</span>, BaseFont.IDENTITY_H, BaseFont.EMBEDDED);</span><br><span class="line">        Font myfont = <span class="keyword">new</span> Font(bfChinese, <span class="number">11</span>, Font.NORMAL);</span><br><span class="line">        pdfDoc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;\n&quot;</span>));</span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> FileReader(txtPath));</span><br><span class="line">        String strLine;</span><br><span class="line">        <span class="keyword">while</span> ((strLine = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            Paragraph para = <span class="keyword">new</span> Paragraph(strLine + <span class="string">&quot;\n&quot;</span>, myfont);</span><br><span class="line">            para.setAlignment(Element.ALIGN_JUSTIFIED);</span><br><span class="line">            pdfDoc.add(para);</span><br><span class="line">        &#125;</span><br><span class="line">        pdfDoc.close();</span><br><span class="line">        br.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åšå®¢æ“ä½œè¯´æ˜æ–‡æ¡£</title>
      <link href="/2024/09/18/hello-world/"/>
      <url>/2024/09/18/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è®©AIå¸®æˆ‘å¹²æ´»çš„ä¸€å¤©</title>
      <link href="/2024/08/02/%E8%AE%A9AI%E5%B8%AE%E6%88%91%E5%B9%B2%E6%B4%BB%E7%9A%84%E4%B8%80%E5%A4%A9/"/>
      <url>/2024/08/02/%E8%AE%A9AI%E5%B8%AE%E6%88%91%E5%B9%B2%E6%B4%BB%E7%9A%84%E4%B8%80%E5%A4%A9/</url>
      
        <content type="html"><![CDATA[<h1 id="è®©-AI-å¸®æˆ‘å¹²æ´»çš„ä¸€å¤©"><a href="#è®©-AI-å¸®æˆ‘å¹²æ´»çš„ä¸€å¤©" class="headerlink" title="è®© AI å¸®æˆ‘å¹²æ´»çš„ä¸€å¤©"></a>è®© AI å¸®æˆ‘å¹²æ´»çš„ä¸€å¤©</h1><h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h1><p><img src="JZzYbFIUto1UGFx3rgvcaHUQn39.png"></p><h1 id="AI-ç”Ÿæˆç»“æœä»£ç "><a href="#AI-ç”Ÿæˆç»“æœä»£ç " class="headerlink" title="AI ç”Ÿæˆç»“æœä»£ç "></a>AI ç”Ÿæˆç»“æœä»£ç </h1><p><img src="RhUCb27ZZox7D1xGYYicKtk4nUg.png"></p><h1 id="Agent-è¿‡ç¨‹"><a href="#Agent-è¿‡ç¨‹" class="headerlink" title="Agent è¿‡ç¨‹"></a>Agent è¿‡ç¨‹</h1><h2 id="æµç¨‹å›¾"><a href="#æµç¨‹å›¾" class="headerlink" title="æµç¨‹å›¾"></a>æµç¨‹å›¾</h2><p><img src="QPIYbCSwuoL96Qx2X4kcCS8Unnf.png"></p><h1 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h1><h2 id="æ–‡æ¡£å·¥å…·ç±»ä»£ç "><a href="#æ–‡æ¡£å·¥å…·ç±»ä»£ç " class="headerlink" title="æ–‡æ¡£å·¥å…·ç±»ä»£ç "></a>æ–‡æ¡£å·¥å…·ç±»ä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"><span class="keyword">import</span> fitz  <span class="comment"># PyMuPDF</span></span><br><span class="line"><span class="keyword">import</span> PyPDF2</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileUtils</span>:</span></span><br><span class="line">    <span class="comment"># è¯»å–txtæ–‡ä»¶</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_txt_file</span>(<span class="params">self, file_path</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            content = file.read()</span><br><span class="line">        <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å†™å…¥txtæ–‡ä»¶</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_to_txt_file</span>(<span class="params">self, file_path, content</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            file.write(content)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¯»å–markdownæ–‡ä»¶</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_md_file</span>(<span class="params">self, file_path</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            content = file.read()</span><br><span class="line">        <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸‹è½½é£ä¹¦åœ¨çº¿æ–‡æ¡£ï¼Œå¹¶è½¬æ¢ä¸º md æ–‡æ¡£ , è¿™é‡Œä½¿ç”¨äº†feishu2mdçš„å¼€æºé¡¹ç›®ï¼Œå¯ä»¥åœ¨githubä¸Šæœç´¢åˆ°</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">donwlode_feishu_doc</span>(<span class="params">self, feishu_file_url</span>):</span></span><br><span class="line">        <span class="comment"># æ‰§è¡Œå‘½ä»¤ feishu2md dl feishu_file_url</span></span><br><span class="line">        file_path = <span class="string">&quot;D:/python_code/tool-service/temp/&quot;</span></span><br><span class="line">        file_name = self.extract_token_from_feishu_url(feishu_file_url)</span><br><span class="line">        subprocess.run([<span class="string">&#x27;feishu2md&#x27;</span>, <span class="string">&#x27;dl&#x27;</span>, <span class="string">&#x27;-o&#x27;</span>, <span class="string">f&#x27;<span class="subst">&#123;file_path&#125;</span><span class="subst">&#123;file_name&#125;</span>&#x27;</span>, feishu_file_url])</span><br><span class="line">        <span class="keyword">return</span> file_name</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æå–å‡ºé£ä¹¦æ–‡æ¡£urlä¸­çš„token</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">extract_token_from_feishu_url</span>(<span class="params">self, feishu_file_url</span>):</span></span><br><span class="line">        <span class="comment"># æå–å‡ºé£ä¹¦æ–‡æ¡£urlä¸­çš„token</span></span><br><span class="line">        token = feishu_file_url.split(<span class="string">&#x27;?&#x27;</span>)[<span class="number">0</span>].split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> token</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¯»å–æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_file_in_dir</span>(<span class="params">self, dir_path</span>):</span></span><br><span class="line">        file_list = []</span><br><span class="line">        <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(dir_path):</span><br><span class="line">            <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">                file_list.append(os.path.join(root, file))</span><br><span class="line">        <span class="keyword">return</span> file_list</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_file_exist</span>(<span class="params">self, file_path</span>):</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(file_path):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure><h2 id="Agent-ä»£ç "><a href="#Agent-ä»£ç " class="headerlink" title="Agent ä»£ç "></a>Agent ä»£ç </h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Annotated, <span class="type">Literal</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> autogen <span class="keyword">import</span> ConversableAgent</span><br><span class="line"><span class="keyword">from</span> pydantic <span class="keyword">import</span> BaseModel, Field</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> autogent_test.file_utils <span class="keyword">import</span> FileUtils</span><br><span class="line"><span class="keyword">from</span> setting <span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨llmçš„é…ç½®</span></span><br><span class="line">llm_config = config.get(<span class="string">&quot;GPT4o&quot;</span>)</span><br><span class="line"></span><br><span class="line">file_util = FileUtils()</span><br><span class="line">CodeTypeOperator = <span class="type">Literal</span>[<span class="string">&quot;controller&quot;</span>, <span class="string">&quot;service&quot;</span>, <span class="string">&quot;dao&quot;</span>, <span class="string">&quot;mappings&quot;</span>, <span class="string">&quot;repository&quot;</span>, <span class="string">&quot;dto&quot;</span>, <span class="string">&quot;vo&quot;</span>]</span><br><span class="line"></span><br><span class="line">base_file_path = <span class="string">&quot;D:/python_code/tool-service/temp/&quot;</span></span><br><span class="line"><span class="comment"># é¡¹ç›®æ ¹ç›®å½•</span></span><br><span class="line">project_base_path = <span class="string">&quot;D:/my_code/aidemo/aidemo/&quot;</span></span><br><span class="line"><span class="comment"># ä»£ç æ ¹ç›®å½•</span></span><br><span class="line">project_code_path = <span class="string">&quot;D:/my_code/aidemo/aidemo/src/main/java/com/niuwa/aidemo/&quot;</span></span><br><span class="line"><span class="comment"># å¼€å‘äººå‘˜æç¤ºè¯</span></span><br><span class="line">dev_prompt = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            ä½ æ˜¯ä¸€åèµ„æ·±çš„Javaå¼€å‘å·¥ç¨‹å¸ˆï¼Œè¯·æ ¹æ®éœ€æ±‚å¼€å‘æ–‡æ¡£çš„åœ°å€ï¼ŒæŒ‰ç…§è¦æ±‚å®Œæˆå¼€å‘ä»»åŠ¡ï¼Œå¹¶è¾“å‡ºå¯¹åº”çš„å®ç°ä»£ç </span></span><br><span class="line"><span class="string">            ## å¼€å‘ä»»åŠ¡</span></span><br><span class="line"><span class="string">                1. æ ¹æ®è¡¨ç»“æ„è®¾è®¡ï¼Œå®Œæˆ entity ç±»çš„åˆ›å»º</span></span><br><span class="line"><span class="string">                2. æ¥å£å¼€å‘ï¼šæ ¹æ®æ¥å£å¼€å‘æ–‡æ¡£ï¼Œå®Œæˆä»¥ä¸‹å±‚æ¬¡çš„ä»£ç å¼€å‘ï¼š</span></span><br><span class="line"><span class="string">                    - mappings.xmlå±‚</span></span><br><span class="line"><span class="string">                    - daoå±‚</span></span><br><span class="line"><span class="string">                    - serviceå±‚</span></span><br><span class="line"><span class="string">                    - controllerå±‚</span></span><br><span class="line"><span class="string">                    - repositoryå±‚</span></span><br><span class="line"><span class="string">                    - voå±‚</span></span><br><span class="line"><span class="string">                4. VOç±»ï¼šå¼€å‘è¿‡ç¨‹ä¸­éœ€è¦ç”¨åˆ°VOï¼ˆè§†å›¾å¯¹è±¡ï¼‰ï¼Œè¯·åˆ›å»ºå•ç‹¬çš„ç±»ï¼Œå¹¶è¿›è¡Œå¼•ç”¨ã€‚</span></span><br><span class="line"><span class="string">                5. å¦‚æœæœ‰ä¸çŸ¥é“è¿™äº›ç±»çš„ä»£ç å¦‚ä½•å†™ï¼Œåˆ™å¯ä»¥æŸ¥çœ‹ä¸€äº›å¯¹åº”çš„ä»£ç æ¨¡æ¿</span></span><br><span class="line"><span class="string">            ## ä»£ç è§„èŒƒè¦æ±‚</span></span><br><span class="line"><span class="string">                1. å®ä½“ç±»ï¼šå®ä½“ç±»çš„å±æ€§éœ€è¦ä½¿ç”¨ `@ApiModelProperty` è¿›è¡Œè¯´æ˜ã€‚</span></span><br><span class="line"><span class="string">                2. Controllerå±‚ï¼š</span></span><br><span class="line"><span class="string">                    ä½¿ç”¨ `@GetMapping` å’Œ `@PostMapping` æŒ‡å®šè·¯å¾„ã€‚</span></span><br><span class="line"><span class="string">                    ä½¿ç”¨ `@ApiOperation` è¯´æ˜æ–¹æ³•çš„ä½œç”¨ã€‚</span></span><br><span class="line"><span class="string">                    ä½¿ç”¨ `@RequestBody` å’Œ `@RequestParam` æ ‡è¯†å‚æ•°ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="string">                3. é…ç½®æ–‡ä»¶ï¼šä¸éœ€è¦è¾“å‡º `application.properties` å’Œ `pom.xml` çš„é…ç½®ä¿¡æ¯ã€‚</span></span><br><span class="line"><span class="string">                4. å¯åŠ¨ç±»å’ŒSwaggeré…ç½®ï¼šä¸éœ€è¦è¾“å‡ºå¯åŠ¨ç±»å’ŒSwaggeré…ç½®ã€‚</span></span><br><span class="line"><span class="string">                5. æ–¹æ³•è¿”å›å€¼ï¼šæ–¹æ³•çš„è¿”å›å€¼æœ€å¥½ä½¿ç”¨DTOç±»è¿›è¡Œè¿”å›ï¼ˆæœ€å¥½èƒ½å¤ç”¨ï¼‰ï¼Œä¸è¦ä½¿ç”¨Mapï¼Œé˜²æ­¢å…¶ä»–å¼€å‘äººå‘˜ä¸äº†è§£è¿”å›å€¼çš„å†…å®¹ã€‚</span></span><br><span class="line"><span class="string">                6. SERVICEå±‚ï¼šä¸éœ€è¦ä½¿ç”¨æ¥å£ï¼Œç›´æ¥ä½¿ç”¨å®ç°ç±»å³å¯ã€‚</span></span><br><span class="line"><span class="string">            ## æŠ€æœ¯è¦æ±‚</span></span><br><span class="line"><span class="string">                1. å¼€å‘æ¡†æ¶ï¼šä½¿ç”¨Spring Bootã€‚</span></span><br><span class="line"><span class="string">                2. æ•°æ®åº“ï¼šä½¿ç”¨MySQLã€‚</span></span><br><span class="line"><span class="string">                3. æŒä¹…åŒ–å±‚ï¼šä½¿ç”¨MyBatisæ¡†æ¶ã€‚</span></span><br><span class="line"><span class="string">                4. æ’ä»¶ï¼šå¼•å…¥äº†Lombokæ’ä»¶ã€‚</span></span><br><span class="line"><span class="string">            ## é¡¹ç›®å·¥ç¨‹è·¯å¾„è¯´æ˜</span></span><br><span class="line"><span class="string">                1. é¡¹ç›®çš„æ ¹ç›®å½•ï¼š<span class="subst">&#123;project_base_path&#125;</span></span></span><br><span class="line"><span class="string">                2. ä»£ç çš„æ ¹ç›®å½•ï¼š<span class="subst">&#123;project_code_path&#125;</span></span></span><br><span class="line"><span class="string">                3. controllerå±‚ä»£ç ç›®å½•ï¼š<span class="subst">&#123;project_code_path&#125;</span>/web</span></span><br><span class="line"><span class="string">                4. serviceå±‚ä»£ç ç›®å½•ï¼š<span class="subst">&#123;project_code_path&#125;</span>/application/command</span></span><br><span class="line"><span class="string">                5. Repositoryå±‚ä»£ç ç›®å½•ï¼š<span class="subst">&#123;project_code_path&#125;</span>/domain/repository</span></span><br><span class="line"><span class="string">                6. daoå±‚ä»£ç ç›®å½•ï¼š<span class="subst">&#123;project_code_path&#125;</span>/infrastructure/dao</span></span><br><span class="line"><span class="string">                7. mappings.xmlå±‚ä»£ç ç›®å½•ï¼š<span class="subst">&#123;project_base_path&#125;</span>/src/main/resources/mappings</span></span><br><span class="line"><span class="string">                8. entityå±‚ä»£ç ç›®å½•ï¼š<span class="subst">&#123;project_code_path&#125;</span>/domain/model/entity</span></span><br><span class="line"><span class="string">                9. voå±‚ä»£ç ç›®å½•ï¼š<span class="subst">&#123;project_code_path&#125;</span>/dto/viewobject</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            ## ä»»åŠ¡ç»“æŸæ ‡è¯†</span></span><br><span class="line"><span class="string">                å¦‚æœä½ ç¡®ä¿æ‰€æœ‰çš„ä»£ç å·²ç»å¼€å‘å®Œæˆï¼Œå¹¶ä¸”å†™å…¥æ–‡ä»¶ï¼Œåˆ™å¯ä»¥è¾“å‡º&quot;TERMINATE&quot;ï¼Œè¡¨ç¤ºå·²ç»ç»“æŸå¼€å‘ã€‚</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReadFeishuDocInput</span>(<span class="params">BaseModel</span>):</span></span><br><span class="line">    feishu_file_url: Annotated[<span class="built_in">str</span>, Field(description=<span class="string">&quot;é£ä¹¦æ–‡æ¡£åœ°å€&quot;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WriteCodeInput</span>(<span class="params">BaseModel</span>):</span></span><br><span class="line">    file_name: Annotated[<span class="built_in">str</span>, Field(description=<span class="string">&quot;ä»£ç æ–‡ä»¶åç§°ï¼Œä¸åŒ…å«æ‰©å±•å&quot;</span>)]</span><br><span class="line">    code_content: Annotated[<span class="built_in">str</span>, Field(description=<span class="string">&quot;å…·ä½“çš„ä»£ç å®ç°å†…å®¹&quot;</span>)]</span><br><span class="line">    code_type: Annotated[</span><br><span class="line">        CodeTypeOperator, <span class="string">&quot;ä»£ç ç±»å‹é€‰é¡¹ï¼Œdao\service\controller\mappings\repository\vo\entityè¿™äº›ç±»å‹ï¼Œä¼šè¢«å†™å…¥åˆ°ä¸åŒçš„æ–‡ä»¶ä¸­&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReadCodeTemplateInput</span>(<span class="params">BaseModel</span>):</span></span><br><span class="line">    code_type: Annotated[</span><br><span class="line">        CodeTypeOperator, <span class="string">&quot;ä»£ç ç±»å‹é€‰é¡¹ï¼Œdao\service\controller\mappings\repository\vo\entityè¿™äº›ç±»å‹ï¼Œè¿”å›å¯¹åº”ç±»å‹ä»£ç çš„æ¨¡æ¿&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯»å–é£ä¹¦éœ€æ±‚æ–‡æ¡£å†…å®¹&quot;&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_feishu_doc</span>(<span class="params"><span class="built_in">input</span>: Annotated[ReadFeishuDocInput, <span class="string">&quot;è¾“å…¥é£ä¹¦æ–‡æ¡£åœ°å€ï¼Œè¿”å›é£ä¹¦æ–‡æ¡£å†…å®¹&quot;</span>]</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">    <span class="comment"># ä¸‹è½½é£ä¹¦æ–‡æ¡£</span></span><br><span class="line">    file_path_name = file_util.donwlode_feishu_doc(<span class="built_in">input</span>.feishu_file_url)</span><br><span class="line">    doc_file = file_util.read_file_in_dir(<span class="string">f&#x27;<span class="subst">&#123;base_file_path&#125;</span><span class="subst">&#123;file_path_name&#125;</span>&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    content = file_util.read_md_file(doc_file)</span><br><span class="line">    <span class="keyword">return</span> content</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™ä»£ç åˆ°æ–‡ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_code</span>(<span class="params"><span class="built_in">input</span>: Annotated[WriteCodeInput, <span class="string">&quot;å°†ä»£ç å†™å…¥åˆ°å…·ä½“çš„æ–‡ä»¶ä¸­ï¼Œå¹¶è¿”å›æ–‡ä»¶è·¯å¾„&quot;</span>]</span>) -&gt; <span class="built_in">str</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">input</span>.code_type == <span class="string">&quot;controller&quot;</span>:</span><br><span class="line">        file_path = <span class="string">f&quot;<span class="subst">&#123;project_code_path&#125;</span>/web/<span class="subst">&#123;<span class="built_in">input</span>.file_name&#125;</span>.java&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">input</span>.code_type == <span class="string">&quot;service&quot;</span>:</span><br><span class="line">        file_path = <span class="string">f&quot;<span class="subst">&#123;project_code_path&#125;</span>/application/command/<span class="subst">&#123;<span class="built_in">input</span>.file_name&#125;</span>.java&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">input</span>.code_type == <span class="string">&quot;repository&quot;</span>:</span><br><span class="line">        file_path = <span class="string">f&quot;<span class="subst">&#123;project_code_path&#125;</span>/domain/repository/<span class="subst">&#123;<span class="built_in">input</span>.file_name&#125;</span>.java&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">input</span>.code_type == <span class="string">&quot;dao&quot;</span>:</span><br><span class="line">        file_path = <span class="string">f&quot;<span class="subst">&#123;project_code_path&#125;</span>/infrastructure/dao/<span class="subst">&#123;<span class="built_in">input</span>.file_name&#125;</span>.java&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">input</span>.code_type == <span class="string">&quot;mappings&quot;</span>:</span><br><span class="line">        file_path = <span class="string">f&quot;<span class="subst">&#123;project_base_path&#125;</span>/src/main/resources/mappings/<span class="subst">&#123;<span class="built_in">input</span>.file_name&#125;</span>.xml&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">input</span>.code_type == <span class="string">&#x27;vo&#x27;</span>:</span><br><span class="line">        file_path = <span class="string">f&quot;<span class="subst">&#123;project_code_path&#125;</span>/dto/viewobject/<span class="subst">&#123;<span class="built_in">input</span>.file_name&#125;</span>.java&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">input</span>.code_type == <span class="string">&#x27;entity&#x27;</span>:</span><br><span class="line">        file_path = <span class="string">f&quot;<span class="subst">&#123;project_code_path&#125;</span>/domain/model/entity/<span class="subst">&#123;<span class="built_in">input</span>.file_name&#125;</span>.java&quot;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">input</span>.code_type == <span class="string">&#x27;dto&#x27;</span>:</span><br><span class="line">        file_path = <span class="string">f&quot;<span class="subst">&#123;project_code_path&#125;</span>/dto/<span class="subst">&#123;<span class="built_in">input</span>.file_name&#125;</span>.java&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> file_util.is_file_exist(file_path):</span><br><span class="line">        <span class="comment"># åˆ›å»ºæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">        directory = os.path.dirname(file_path)</span><br><span class="line">        <span class="comment"># å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºç›®å½•</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(directory):</span><br><span class="line">            os.makedirs(directory)</span><br><span class="line">    file_util.write_to_txt_file(file_path, <span class="built_in">input</span>.code_content)</span><br><span class="line">    <span class="keyword">return</span> file_path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å§‹å†™ä»£ç ã€‚</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">feishu_file_url</span>):</span></span><br><span class="line">    assistant = ConversableAgent(</span><br><span class="line">        <span class="string">&quot;assistant&quot;</span>,</span><br><span class="line">        system_message=dev_prompt,</span><br><span class="line">        llm_config=&#123;<span class="string">&quot;config_list&quot;</span>: [llm_config]&#125;,</span><br><span class="line">        human_input_mode=<span class="string">&quot;NEVER&quot;</span>,  <span class="comment"># Never ask for human input.</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    human_proxy = ConversableAgent(</span><br><span class="line">        <span class="string">&quot;human_proxy&quot;</span>,</span><br><span class="line">        llm_config=<span class="literal">False</span>,  <span class="comment"># no LLM used for human proxy</span></span><br><span class="line">        is_termination_msg=<span class="keyword">lambda</span> msg: msg.get(<span class="string">&quot;content&quot;</span>) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> <span class="string">&quot;TERMINATE&quot;</span> <span class="keyword">in</span> msg[<span class="string">&quot;content&quot;</span>],</span><br><span class="line">        human_input_mode=<span class="string">&quot;NEVER&quot;</span>,  <span class="comment"># always ask for human input</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Register the tool signature with the assistant agent.</span></span><br><span class="line">    assistant.register_for_llm(name=<span class="string">&quot;read_feishu_doc&quot;</span>, description=<span class="string">&quot;æ ¹æ®æä¾›çš„é£ä¹¦åœ¨çº¿æ–‡æ¡£URLï¼Œè¯»å–å¹¶è¿”å›æ–‡æ¡£å†…å®¹&quot;</span>)(read_feishu_doc)</span><br><span class="line">    assistant.register_for_llm(name=<span class="string">&quot;write_code&quot;</span>, description=<span class="string">&quot;å°†ç”Ÿæˆçš„ä»£ç å†™å…¥å¯¹åº”çš„æ–‡ä»¶ä¸­ï¼Œéœ€è¦ä¼ å…¥æ–‡ä»¶åç§°ã€ä»£ç å†…å®¹å’Œä»£ç ç±»å‹&quot;</span>)(write_code)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Register the tool function with the user proxy agent.</span></span><br><span class="line">    human_proxy.register_for_execution(name=<span class="string">&quot;read_feishu_doc&quot;</span>)(read_feishu_doc)</span><br><span class="line">    human_proxy.register_for_execution(name=<span class="string">&quot;write_code&quot;</span>)(write_code)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¼€å§‹æé—®</span></span><br><span class="line">    human_proxy.initiate_chat(assistant, message=<span class="string">f&quot;éœ€æ±‚æ–‡æ¡£åœ°å€ä¸ºï¼š<span class="subst">&#123;feishu_file_url&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main(<span class="string">&quot;&lt;é£ä¹¦äº‘æ–‡æ¡£&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨Pythonå°†é£ä¹¦æ–‡æ¡£è½¬æˆåšå®¢</title>
      <link href="/2024/07/13/%E5%88%A9%E7%94%A8Python%E5%B0%86%E9%A3%9E%E4%B9%A6%E6%96%87%E6%A1%A3%E8%BD%AC%E6%88%90%E5%8D%9A%E5%AE%A2/"/>
      <url>/2024/07/13/%E5%88%A9%E7%94%A8Python%E5%B0%86%E9%A3%9E%E4%B9%A6%E6%96%87%E6%A1%A3%E8%BD%AC%E6%88%90%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ©ç”¨-Python-å°†é£ä¹¦æ–‡æ¡£è½¬æˆåšå®¢"><a href="#åˆ©ç”¨-Python-å°†é£ä¹¦æ–‡æ¡£è½¬æˆåšå®¢" class="headerlink" title="åˆ©ç”¨ Python å°†é£ä¹¦æ–‡æ¡£è½¬æˆåšå®¢"></a>åˆ©ç”¨ Python å°†é£ä¹¦æ–‡æ¡£è½¬æˆåšå®¢</h1><h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h1><p>ç”±äºä¸ªäººå¹³å¸¸ç”¨é£ä¹¦æ–‡æ¡£æ¯”è¾ƒå¤šï¼Œè€Œä¸”é£ä¹¦å†™æ–‡æ¡£ç¡®å®ä¹ŸæŒºæ–¹ä¾¿ï¼Œ å¦‚æœèƒ½å°†é£ä¹¦çš„æ–‡æ¡£ç›´æ¥è½¬æ¢ä¸ºæˆ‘çš„åšå®¢æ–‡æ¡£ï¼Œé‚£å†™æ–‡æ¡£å°±æ–¹ä¾¿å¤šäº†ï¼Œå› æ­¤æˆ‘åˆ©ç”¨ python ä¸­ streamlitï¼Œå®ç°äº†å¯è§†åŒ–å°†é£ä¹¦æ–‡æ¡£è½¬æ¢ä¸ºåšå®¢æ–‡æ¡£</p><h1 id="å±•ç¤ºæ•ˆæœ"><a href="#å±•ç¤ºæ•ˆæœ" class="headerlink" title="å±•ç¤ºæ•ˆæœ"></a>å±•ç¤ºæ•ˆæœ</h1><h2 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">streamlit run feishu2blog.py</span><br></pre></td></tr></table></figure><p><img src="PkAPbgx8RoIgZkxhgwjcgm3bn5c.png">)</p><h2 id="ç•Œé¢å±•ç¤º"><a href="#ç•Œé¢å±•ç¤º" class="headerlink" title="ç•Œé¢å±•ç¤º"></a>ç•Œé¢å±•ç¤º</h2><p>ç¬¬ä¸€æ­¥ï¼šç”±äºéœ€è¦è¯»å–é£ä¹¦æ–‡æ¡£ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨é£ä¹¦åº”ç”¨è¿›è¡Œè¯»å–ï¼Œé£ä¹¦åº”ç”¨çš„åˆ›å»ºå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£</p><p><img src="XduPbOJT0oYBAtxAiLocsJY7nxc.png">)</p><p>ç¬¬äºŒæ­¥ï¼šå¡«å†™å¥½é£ä¹¦åº”ç”¨çš„ appId å’Œ appSecret åå°±ä¼šå‡ºç°å¦‚ä¸‹çš„ç•Œé¢</p><p><img src="ICMhbJa70oJet5x2t7McBgrpnV3.png">)</p><p>ç¬¬ä¸‰æ­¥ï¼šæ ¹æ®ç‚¹å‡» â€œç”Ÿæˆå¹¶å‘å¸ƒâ€</p><p><img src="J9f2bxZJWoJuVwxva1mcyKIsnDd.png">)</p><p>ç¬¬å››æ­¥ï¼šå®Œæˆå‘å¸ƒä¹‹åï¼Œå°±å¯ä»¥åœ¨ä¸ªäººçš„åšå®¢ç½‘ç«™ä¸ŠæŸ¥çœ‹åˆ°äº†</p><p><img src="KgNqb6AhwoMi6cxpJHAcYNVDngb.png">)<br><img src="M7I7bJmaQoHrzgxh4Nac8YgNnAw.png">)</p><p><img src="GKQpbo4veow437xSEmhcMwKGnac.png">)</p><h1 id="å…·ä½“å®ç°ä»£ç å¦‚ä¸‹"><a href="#å…·ä½“å®ç°ä»£ç å¦‚ä¸‹" class="headerlink" title="å…·ä½“å®ç°ä»£ç å¦‚ä¸‹"></a>å…·ä½“å®ç°ä»£ç å¦‚ä¸‹</h1><blockquote><p>è¯´æ˜ï¼š</p><ol><li>è¿™é‡Œä½¿ç”¨äº† <strong>feishu2md</strong> è¿™ä¸ªå¼€æºé¡¹ç›®ï¼ˆgithub å¯ä»¥æœç´¢åˆ°ï¼‰ï¼Œç”¨æ¥ä¸‹è½½é£ä¹¦çš„æ–‡æ¡£</li></ol></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">é£ä¹¦æ–‡æ¡£è½¬æˆåšå®¢æ–‡æ¡£</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> streamlit <span class="keyword">as</span> st</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Feishu2Blog</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.base_path = <span class="string">&quot;/cloudide/workspace/MyBlogRepository/MyBlogRepository/hexo-blog&quot;</span></span><br><span class="line">        self.blog_file_path = <span class="string">f&quot;<span class="subst">&#123;self.base_path&#125;</span>/source/_posts&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># é…ç½®feishu2md çš„é…ç½®</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">config_feishu2md</span>(<span class="params">self , app_id , app_secret</span>):</span></span><br><span class="line">        <span class="comment"># è¿›å…¥åŸºç¡€ç›®å½•</span></span><br><span class="line">        os.chdir(self.base_path)</span><br><span class="line">        <span class="comment"># æ‰§è¡Œå‘½ä»¤ï¼šfeishu2md config -a &lt;app_id&gt; -s &lt;app_secret&gt;</span></span><br><span class="line">        os.system(<span class="string">f&quot;./feishu2md config --appId <span class="subst">&#123;app_id&#125;</span> --appSecret <span class="subst">&#123;app_secret&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¯»å–æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_file_in_dir</span>(<span class="params">self, dir_path</span>):</span></span><br><span class="line">        file_list = []</span><br><span class="line">        <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(dir_path):</span><br><span class="line">            <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">                file_list.append(os.path.join(root, file))</span><br><span class="line">        <span class="keyword">return</span> file_list</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æå–å‡ºé£ä¹¦æ–‡æ¡£urlä¸­çš„token</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">extract_token_from_feishu_url</span>(<span class="params">self, feishu_file_url</span>):</span></span><br><span class="line">        <span class="comment"># æå–å‡ºé£ä¹¦æ–‡æ¡£urlä¸­çš„token</span></span><br><span class="line">        token = feishu_file_url.split(<span class="string">&#x27;?&#x27;</span>)[<span class="number">0</span>].split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> token</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¸‹è½½é£ä¹¦æ–‡æ¡£</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">download_feishu_doc</span>(<span class="params">self, doc_url, doc_name</span>):</span></span><br><span class="line">        token = self.extract_token_from_feishu_url(doc_url)</span><br><span class="line">        <span class="comment"># è¿›å…¥åŸºç¡€ç›®å½•</span></span><br><span class="line">        os.chdir(self.base_path)</span><br><span class="line">        <span class="comment"># æ‰§è¡Œå‘½ä»¤ï¼šfeishu2md dl &lt;é£ä¹¦æ–‡æ¡£åœ°å€&gt; -o &lt;ä¿å­˜è·¯å¾„&gt;</span></span><br><span class="line">        <span class="comment"># å¦‚æœä¸‹è½½å¤±è´¥éœ€è¦æŠ¥é”™</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            os.system(<span class="string">f&quot;./feishu2md dl -o <span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;token&#125;</span> <span class="subst">&#123;doc_url&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="comment"># æŠ¥é”™ä¿¡æ¯</span></span><br><span class="line">            st.error(<span class="string">f&quot;ä¸‹è½½å¤±è´¥ï¼š<span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># æ›´æ¢æ–‡ä»¶åï¼ŒåŸåå« file_name , æ–°æ–‡ä»¶åæ˜¯ doc_name</span></span><br><span class="line">        src_blog_file_name_list = self.read_file_in_dir(<span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;token&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># ç§»åŠ¨æ–‡ä»¶</span></span><br><span class="line">        os.rename(src_blog_file_name_list[<span class="number">0</span>], <span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;doc_name&#125;</span>.md&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å›¾ç‰‡ç›®å½•æ›´æ”¹ä¸ºåšå®¢åç§°ç›®å½•</span></span><br><span class="line">        image_static_file_name_list = self.read_file_in_dir(<span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;token&#125;</span>/static&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> image_static_file_name <span class="keyword">in</span> image_static_file_name_list:</span><br><span class="line">            imgage_name = image_static_file_name.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]</span><br><span class="line">            os.rename(image_static_file_name, <span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;doc_name&#125;</span>/<span class="subst">&#123;imgage_name&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆ é™¤ä¸´æ—¶ç›®å½•</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;token&#125;</span>/static&quot;</span>):</span><br><span class="line">            os.rmdir(<span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;token&#125;</span>/static&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;token&#125;</span>&quot;</span>):</span><br><span class="line">            os.rmdir(<span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;token&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;doc_name&#125;</span>.md&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä¿å­˜ä¸Šä¼ çš„å›¾ç‰‡åˆ°æœ¬åœ°</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save_uploaded_file</span>(<span class="params">self, uploaded_file, directory=<span class="string">&quot;uploaded_files&quot;</span></span>):</span></span><br><span class="line">        image_home_file_path = <span class="string">f&#x27;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;directory&#125;</span>&#x27;</span></span><br><span class="line">        <span class="comment"># å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(image_home_file_path):</span><br><span class="line">            os.makedirs(image_home_file_path)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è·å–å½“å‰æ—¶é—´æˆ³</span></span><br><span class="line">        timestamp = datetime.now().strftime(<span class="string">&quot;%Y%m%d%H%M%S&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‹¼æ¥æ–°çš„æ–‡ä»¶å</span></span><br><span class="line">        image_home_file_name = <span class="string">f&quot;<span class="subst">&#123;uploaded_file.name.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]&#125;</span>_<span class="subst">&#123;timestamp&#125;</span>.<span class="subst">&#123;uploaded_file.name.split(<span class="string">&#x27;.&#x27;</span>)[-<span class="number">1</span>]&#125;</span>&quot;</span></span><br><span class="line">        file_path = os.path.join(image_home_file_path, image_home_file_name)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ä¿å­˜æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(uploaded_file.getbuffer())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> image_home_file_name</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç¼–å†™åšå®¢æ–‡ä»¶çš„å¤´éƒ¨å’Œå†…å®¹</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">write_blog_header</span>(<span class="params">self, blog_title, blog_tags, blog_category, home_image_file_name</span>):</span></span><br><span class="line">        <span class="comment"># å¦‚æœ home_image_file_name ä¸ºNoneï¼Œåˆ™ä¸éœ€è¦ é…ç½® cover</span></span><br><span class="line">        <span class="comment"># date æ ¼å¼ä¸º yyyy-MM-dd HH:mm:ss</span></span><br><span class="line">        date = datetime.now().strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> home_image_file_name <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            blog_header = <span class="string">f&quot;---\ntitle: <span class="subst">&#123;blog_title&#125;</span>\ndate: <span class="subst">&#123;date&#125;</span>\ntags: <span class="subst">&#123;blog_tags&#125;</span>\ncategories: <span class="subst">&#123;blog_category&#125;</span>\n---\n&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            blog_header = <span class="string">f&quot;---\ntitle: <span class="subst">&#123;blog_title&#125;</span>\ndate: <span class="subst">&#123;date&#125;</span>\ntags: <span class="subst">&#123;blog_tags&#125;</span>\ncategories: <span class="subst">&#123;blog_category&#125;</span>\ncover: <span class="subst">&#123;home_image_file_name&#125;</span>\n---\n&quot;</span></span><br><span class="line">        <span class="keyword">return</span> blog_header</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ„å»ºåšå®¢æ­£æ–‡ï¼Œéœ€è¦æ›¿æ¢é£ä¹¦æ–‡æ¡£ä¸­çš„å›¾ç‰‡é“¾æ¥</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build_blog_content</span>(<span class="params">self, doc_content</span>):</span></span><br><span class="line">        <span class="comment"># æå–æ–‡æ¡£ä¸­æ‰€æœ‰å›¾ç‰‡</span></span><br><span class="line">        image_static_file_name_list = re.findall(<span class="string">r&#x27;!\[\]\(.*static/.*?\)&#x27;</span>, doc_content)</span><br><span class="line">        <span class="keyword">for</span> image_static_file_name <span class="keyword">in</span> image_static_file_name_list:</span><br><span class="line">            doc_content = doc_content.replace(image_static_file_name, <span class="string">f&quot;![](<span class="subst">&#123;image_static_file_name.split(<span class="string">&#x27;/&#x27;</span>)[-<span class="number">1</span>]&#125;</span>)&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> doc_content</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¯»å–ä¸‹è½½çš„é£ä¹¦æ–‡æ¡£</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_feishu_doc</span>(<span class="params">self, doc_path</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(doc_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            doc_content = f.read()</span><br><span class="line">        <span class="keyword">return</span> doc_content</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç”Ÿæˆåšå®¢æ–‡ä»¶</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">generate_blog_file</span>(<span class="params">self, blog_title, blog_tags, blog_category, home_image_file_name</span>):</span></span><br><span class="line">        blog_file = <span class="string">f&quot;<span class="subst">&#123;self.blog_file_path&#125;</span>/<span class="subst">&#123;blog_title&#125;</span>.md&quot;</span></span><br><span class="line">        doc_content = self.read_feishu_doc(doc_path=blog_file)</span><br><span class="line">        <span class="comment"># æ„å»ºåšå®¢æ–‡ä»¶å†…å®¹</span></span><br><span class="line">        blog_content = self.write_blog_header(blog_title, blog_tags, blog_category, home_image_file_name) + self.build_blog_content(doc_content)</span><br><span class="line">        <span class="comment"># å†™å…¥åšå®¢æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(blog_file, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(blog_content)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä½¿ç”¨Hexoåˆ›å»ºåšå®¢</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_blog</span>(<span class="params">self, blog_title</span>):</span></span><br><span class="line">        <span class="comment"># è¿›å…¥åˆ°åšå®¢ç›®å½•</span></span><br><span class="line">        os.chdir(self.base_path)</span><br><span class="line">        <span class="comment"># æ‰§è¡Œåˆ›å»ºå‘½ä»¤</span></span><br><span class="line">        os.system(<span class="string">f&quot;hexo new <span class="subst">&#123;blog_title&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿è¡Œå‘å¸ƒæµç¨‹</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">delopy</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># è¿›å…¥åˆ°åšå®¢ç›®å½•</span></span><br><span class="line">        os.chdir(self.base_path)</span><br><span class="line">        <span class="comment"># æ‰§è¡Œå‘å¸ƒå‘½ä»¤</span></span><br><span class="line">        os.system(<span class="string">&quot;hexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># è®¾ç½®é¡µé¢æ ‡é¢˜</span></span><br><span class="line">        st.title(<span class="string">&quot;é£ä¹¦æ–‡æ¡£åˆ°åšå®¢å‘å¸ƒå·¥å…·&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åœ¨ä¾§è¾¹æ æ·»åŠ è¾“å…¥æ¡†æ¥è¾“å…¥é£ä¹¦åº”ç”¨çš„ App ID å’Œ App Secret</span></span><br><span class="line">        app_id = st.sidebar.text_input(<span class="string">&quot;é£ä¹¦åº”ç”¨çš„ App ID&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;è¯·è¾“å…¥é£ä¹¦åº”ç”¨çš„ App ID&quot;</span>)</span><br><span class="line">        app_secret = st.sidebar.text_input(<span class="string">&quot;é£ä¹¦åº”ç”¨çš„ App Secret&quot;</span>, <span class="built_in">type</span>=<span class="string">&quot;password&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;è¯·è¾“å…¥é£ä¹¦åº”ç”¨çš„ App Secret&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># åˆ¤æ–­æ˜¯å¦å·²æä¾›æ­£ç¡®çš„ App ID å’Œ App Secret</span></span><br><span class="line">        <span class="keyword">if</span> app_id <span class="keyword">and</span> app_secret:</span><br><span class="line">            <span class="comment"># åœ¨ä¸»ç•Œé¢æ·»åŠ è¾“å…¥æ¡†</span></span><br><span class="line">            doc_url = st.text_input(<span class="string">&quot;è¯·è¾“å…¥é£ä¹¦æ–‡æ¡£ URL&quot;</span>)</span><br><span class="line">            blog_title = st.text_input(<span class="string">&quot;åšå®¢æ ‡é¢˜&quot;</span>)</span><br><span class="line">            home_image = st.file_uploader(<span class="string">&quot;ä¸»é¡µå›¾ç‰‡&quot;</span>, <span class="built_in">type</span>=[<span class="string">&quot;png&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>], accept_multiple_files=<span class="literal">False</span>)</span><br><span class="line">            blog_tags = st.text_input(<span class="string">&quot;åšå®¢æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰&quot;</span>)</span><br><span class="line">            blog_category = st.text_input(<span class="string">&quot;åšå®¢åˆ†ç±»ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># åœ¨ä¸»ç•Œé¢æ·»åŠ æŒ‰é’®</span></span><br><span class="line">            <span class="keyword">if</span> st.button(<span class="string">&quot;ç”Ÿæˆå¹¶å‘å¸ƒ&quot;</span>):</span><br><span class="line">                <span class="comment"># æ£€æŸ¥å¿…å¡«é¡¹æ˜¯å¦å·²å¡«å†™</span></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> doc_url <span class="keyword">or</span> <span class="keyword">not</span> blog_title:</span><br><span class="line">                    st.error(<span class="string">&quot;è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹ï¼šé£ä¹¦æ–‡æ¡£ URL å’Œ åšå®¢æ ‡é¢˜&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    home_image_file_name = <span class="literal">None</span></span><br><span class="line">                    <span class="keyword">if</span> home_image:</span><br><span class="line">                        <span class="comment"># ä¿å­˜ä¸Šä¼ çš„å›¾ç‰‡æ–‡ä»¶</span></span><br><span class="line">                        home_image_file_name = self.save_uploaded_file(home_image , blog_title)</span><br><span class="line">                    <span class="keyword">with</span> st.spinner(<span class="string">&#x27;ç”Ÿæˆå¹¶å‘å¸ƒåšå®¢ä¸­...&#x27;</span>):</span><br><span class="line">                        self.config_feishu2md(app_id, app_secret)</span><br><span class="line">                        self.create_blog(blog_title)</span><br><span class="line">                        <span class="comment"># ä¸‹è½½</span></span><br><span class="line">                        self.download_feishu_doc(doc_url, blog_title)</span><br><span class="line">                        <span class="comment"># ç”Ÿæˆåšå®¢</span></span><br><span class="line">                        self.generate_blog_file(blog_title , blog_tags, blog_category, home_image_file_name)</span><br><span class="line">                        <span class="comment"># å‘å¸ƒ</span></span><br><span class="line">                        self.delopy()</span><br><span class="line">                        st.success(<span class="string">&quot;åšå®¢å‘å¸ƒæˆåŠŸï¼&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            st.error(<span class="string">&quot;è¯·è¾“å…¥é£ä¹¦åº”ç”¨çš„ App ID å’Œ App Secret&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    feishu2blog = Feishu2Blog()</span><br><span class="line">    feishu2blog.main()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å²ä¸Šæœ€ç¡¬æ ¸çš„ä¸ªäººåšå®¢ç½‘ç«™åå°ç®¡ç†å¹³å°</title>
      <link href="/2024/07/09/%E5%8F%B2%E4%B8%8A%E6%9C%80%E7%A1%AC%E6%A0%B8%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/"/>
      <url>/2024/07/09/%E5%8F%B2%E4%B8%8A%E6%9C%80%E7%A1%AC%E6%A0%B8%E7%9A%84%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>ä¸ºä»€ä¹ˆè¯´è¿™æ˜¯å²ä¸Šæœ€ç¡¬æ ¸çš„ä¸ªäººåšå®¢ç½‘ç«™åå°å‘¢ï¼Œå› ä¸ºå°±æ˜¯ä»£ç ç®¡ç†çš„åå°ï¼Œé€šè¿‡ä½¿ç”¨hexoå¯ä»¥åœ¨æœ¬åœ°æ­å»ºä¸ªäººåšå®¢ï¼Œç„¶åé€šè¿‡github pagesè¿›è¡Œéƒ¨ç½²ï¼Œä¸éœ€è¦è´­ä¹°æœåŠ¡å™¨ï¼Œä¸éœ€è¦è´­ä¹°åŸŸåï¼Œä¸éœ€è¦è´­ä¹°æ•°æ®åº“ï¼Œåªéœ€è¦ä¸€å°ç”µè„‘å°±å¯ä»¥å®Œæˆä¸ªäººåšå®¢çš„æ­å»ºï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡githubè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œæ–¹ä¾¿ä»¥åè¿›è¡Œåšå®¢çš„æ›´æ–°å’Œç»´æŠ¤ã€‚</p><p>ä½†æ˜¯ï¼ï¼ï¼</p><p>ä½ éœ€è¦åœ¨ä¸€ä¸ªå›ºå®šçš„ç”µè„‘ä¸Šï¼Œæ­å»ºhexoã€gitç­‰ç­‰ä¸€ç³»åˆ—çš„ç¯å¢ƒï¼Œæ‰èƒ½å¼€å§‹å†™ä½ çš„åšå®¢ï¼Œä¸€æ—¦è„±ç¦»äº†è¿™ä¸ªç”µè„‘ï¼Œä½ å°±æ— æ³•åœ¨è¿™ä¸ªåšå®¢ç½‘ç«™ä¸Šå†™åšæ–‡äº†ï¼Œè™½ç„¶æˆ‘è®²æ„å»ºåšå®¢çš„ä»£ç ä¸€èµ·æ”¾åœ¨githubçš„å¦å¤–ä»“åº“è¿›è¡Œæ‰˜ç®¡ï¼Œä½†æ˜¯æˆ‘æ¢ç”µè„‘ï¼Œå°±éœ€è¦åœ¨æ–°ç”µè„‘ä¸Šå®‰è£…å¿…è¦çš„ç¯å¢ƒï¼Œæ‰èƒ½ç»§ç»­ä½¿ç”¨ï¼Œè¿™ä¸ªå®‰è£…å¤ªè¿‡äºç¹çï¼Œå› æ­¤æˆ‘çš„åšæ–‡å·²ç»å¾ˆä¹…æ²¡æœ‰æ›´æ–°äº†</p><p>ä½†æ˜¯ï¼ï¼ï¼</p><p>æœ€è¿‘å‘ç°äº†ä¸€ä¸ªå¹³å°</p><p>å°±æ˜¯è¿™ä¸ªï¼š <a href="https://docs.marscode.cn/introduction#%E8%B1%86%E5%8C%85-marscode-ide">MarsCode IDE</a></p><p>æ˜¯å®ƒè®©æˆ‘å¯ä»¥é‡æ–°ä½¿ç”¨è‡ªå·±çš„åšå®¢ï¼š<a href="https://qi-zou.github.io/">https://qi-zou.github.io/</a></p><p>ä¸ºä»€ä¹ˆè¯´å®ƒæ‹¯æ•‘äº†æˆ‘çš„åšå®¢ç½‘ç«™å‘¢ï¼Œä¸‹é¢æˆ‘å°±ä»‹ç»ä¸€ä¸‹æˆ‘çš„æ“ä½œæµç¨‹ï¼š</p><h1 id="æ“ä½œæµç¨‹"><a href="#æ“ä½œæµç¨‹" class="headerlink" title="æ“ä½œæµç¨‹"></a>æ“ä½œæµç¨‹</h1><ol><li><p>é¦–å…ˆè¿›å…¥ <a href="https://www.marscode.cn/dashboard">è±†åŒ…IDEå·¥ä½œå°</a>ï¼Œæ­£å¸¸æ³¨å†Œç™»å½•å°±è¡Œ</p></li><li><p>åˆ›å»ºé¡¹ç›®ï¼Œé€‰æ‹©ä»githubä¸Šå¯¼å…¥ä½ çš„é¡¹ç›®ï¼Œè¿™é‡Œæˆ‘ç›´æ¥é€‰æ‹©æˆ‘çš„åšå®¢ç½‘ç«™æºä»£ç ä»“åº“ï¼š<br><img src="image2.png" alt="alt text"></p></li><li><p>åˆ›å»ºå®Œæˆåï¼Œå°±å¯ä»¥ç›´æ¥è¿›å…¥åˆ°ä½ çš„é¡¹ç›®äº†ï¼Œåœ¨è¿™é‡Œä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç±»ä¼¼äºVSCodeåœ¨çº¿ç¼–è¾‘å™¨ï¼Œç›¸å½“äºæä¾›äº†ä¸€ä¸ªå…è´¹çš„åœ¨çº¿æœåŠ¡å™¨ç»™ä½ <br><img src="image3.png" alt="alt text"></p></li><li><p>åé¢å°±å¯ä»¥æŒ‰ç…§hexoçš„æ•™ç¨‹ï¼Œå»åˆ›å»ºæ–‡æ¡£ï¼Œå†™åšå®¢ï¼Œå‘å¸ƒï¼Œç„¶åå°±ä¼šçœ‹åˆ°ä½ çš„åšå®¢æ›´æ–°äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &quot;åšå®¢æ–‡ç« &quot;</span><br></pre></td></tr></table></figure><p><img src="image4.png" alt="alt text"></p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># æ¸…ç†</span><br><span class="line">hexo clean</span><br><span class="line"></span><br><span class="line"># ç”Ÿæˆ</span><br><span class="line">hexo generate</span><br><span class="line"></span><br><span class="line"># æœ¬åœ°è¿è¡Œ</span><br><span class="line">hexo s</span><br><span class="line"></span><br><span class="line"># å‘å¸ƒ</span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><ol start="5"><li>ç„¶åå°±å¯ä»¥é€šè¿‡è®¿é—®ä½ çš„åšå®¢ç½‘ç«™ï¼ŒæŸ¥çœ‹ä½ çš„åšå®¢äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿å‘¢<br><img src="image5.png" alt="alt text"></li></ol><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>é€šè¿‡ä½¿ç”¨MarsCode IDEï¼Œæˆ‘é‡æ–°ä½¿ç”¨äº†è‡ªå·±çš„åšå®¢ç½‘ç«™ï¼Œè€Œä¸”ä¸éœ€è¦åœ¨æœ¬åœ°æ­å»ºç¯å¢ƒï¼Œåªéœ€è¦ä¸€ä¸ªæµè§ˆå™¨å°±å¯ä»¥å¼€å§‹å†™åšå®¢äº†ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡githubè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œæ–¹ä¾¿ä»¥åè¿›è¡Œåšå®¢çš„æ›´æ–°å’Œç»´æŠ¤ï¼Œå¸Œæœ›è¿™ä¸ªå¹³å°èƒ½å¤Ÿå¸®åŠ©åˆ°æ›´å¤šçš„äººï¼Œè®©æ›´å¤šçš„äººèƒ½å¤Ÿä½¿ç”¨è‡ªå·±çš„åšå®¢ç½‘ç«™ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åšå®¢æ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pythonä»£ç åˆ›å»ºdifyçŸ¥è¯†åº“</title>
      <link href="/2024/07/08/python%E4%BB%A3%E7%A0%81%E5%88%9B%E5%BB%BAdify%E7%9F%A5%E8%AF%86%E5%BA%93/"/>
      <url>/2024/07/08/python%E4%BB%A3%E7%A0%81%E5%88%9B%E5%BB%BAdify%E7%9F%A5%E8%AF%86%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½¿ç”¨pythonä»£ç å®ç°difyçŸ¥è¯†åº“çš„æ­å»ºæ¡ˆä¾‹"><a href="#ä½¿ç”¨pythonä»£ç å®ç°difyçŸ¥è¯†åº“çš„æ­å»ºæ¡ˆä¾‹" class="headerlink" title="ä½¿ç”¨pythonä»£ç å®ç°difyçŸ¥è¯†åº“çš„æ­å»ºæ¡ˆä¾‹"></a>ä½¿ç”¨pythonä»£ç å®ç°difyçŸ¥è¯†åº“çš„æ­å»ºæ¡ˆä¾‹</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ç”±äºdifyä¸Šæ„å»ºçŸ¥è¯†åº“æ—¶ï¼Œåˆ†å‰²æ–‡æœ¬å—ä¸å¤ªå¯æ§ï¼Œå¹¶ä¸”æ— æ³•è¯»å–ç±»ä¼¼é£ä¹¦æ–‡æ¡£è¿™ç§åœ¨çº¿æ–‡æ¡£çš„å†…å®¹ï¼Œå› æ­¤è¿™é‡Œæä¾›äº†å¯ä»¥ä½¿ç”¨pythonä»£ç å®Œæˆå†difyä¸Šæ„å»ºçŸ¥è¯†åº“</p><blockquote><p>å°çŸ¥è¯†ï¼šæƒ³è¦è¯»å–é£ä¹¦æ–‡æ¡£ï¼Œå¤§å®¶å¯ä»¥è¯•è¯•feishu2mdè¿™ä¸ªå¼€æºé¡¹ç›®ï¼Œè¿™ä¸ªé¡¹ç›®å¯ä»¥å°†åœ¨çº¿çš„é£ä¹¦æ–‡æ¡£ç›´æ¥ä¸‹è½½æˆmarkdownæ ¼å¼çš„æ–‡æ¡£ï¼Œå¹¶ä¸”è¿˜èƒ½ä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°ï¼Œå¹¶ä¸”markdownæ ¼å¼çš„æ–‡æ¡£åšåˆ†å‰²éå¸¸æ–¹ä¾¿</p><p>å¼€æºé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/Wsine/feishu2md">GitHub - Wsine/feishu2md: ä¸€é”®å‘½ä»¤ä¸‹è½½é£ä¹¦æ–‡æ¡£ä¸º Markdown</a></p></blockquote><h1 id="å®ç°ä»£ç "><a href="#å®ç°ä»£ç " class="headerlink" title="å®ç°ä»£ç "></a>å®ç°ä»£ç </h1><p>ä¸‹é¢å°±æ˜¯æˆ‘å®é™…ä½¿ç”¨çš„ä»£ç ï¼Œå°†æœ¬åœ°çš„æ–‡æœ¬è¯»å–ï¼Œå¹¶å¯¼å…¥åˆ°çŸ¥è¯†åº“ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">è¯»å–æ¸ é“å±¥çº¦æä¾›çš„æ ‡ç­¾åº“ï¼Œå¯¼å…¥åˆ°çŸ¥è¯†åº“ä¸­</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> chardet</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommodityKnowledge</span>:</span></span><br><span class="line">    <span class="comment"># æœ¬åœ°</span></span><br><span class="line">    api_key = <span class="string">&quot;dataset-tkRjxM0CmA4Vot3Y4K79xxx&quot;</span></span><br><span class="line">    dataset_url = <span class="string">&quot;http://172.xxx/v1/datasets/&quot;</span></span><br><span class="line">    <span class="comment"># çº¿ä¸Š</span></span><br><span class="line">    <span class="comment"># api_key = &quot;dataset-vpVceWuVyZFoYZGe46c9xxx&quot;</span></span><br><span class="line">    <span class="comment"># dataset_url = &quot;http://dify.xxx.com/v1/datasets/&quot;</span></span><br><span class="line">    dataset_name = <span class="string">&quot;å•†å“æ ‡ç­¾åº“&quot;</span></span><br><span class="line">    dataset_id = <span class="string">&quot;7d99fecf-39cb-48f4-885b-8b1eb74xxx&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># æ ¹æ®æ–‡æœ¬åˆ›å»ºæ–‡æœ¬</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_by_text</span>(<span class="params">self, name, text</span>):</span></span><br><span class="line">        url = <span class="string">f&quot;<span class="subst">&#123;self.dataset_url&#125;</span><span class="subst">&#123;self.dataset_id&#125;</span>/document/create_by_text&quot;</span></span><br><span class="line">        payload = json.dumps(&#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">            <span class="string">&quot;text&quot;</span>: text,</span><br><span class="line">            <span class="string">&quot;indexing_technique&quot;</span>: <span class="string">&quot;high_quality&quot;</span>,</span><br><span class="line">            <span class="string">&quot;process_rule&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;custom&quot;</span>,</span><br><span class="line">                <span class="string">&quot;rules&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;pre_processing_rules&quot;</span>: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="string">&quot;id&quot;</span>: <span class="string">&quot;remove_extra_spaces&quot;</span>,</span><br><span class="line">                            <span class="string">&quot;enabled&quot;</span>: <span class="literal">True</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    ],</span><br><span class="line">                    <span class="string">&quot;segmentation&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;separator&quot;</span>: <span class="string">&quot;\n&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;max_tokens&quot;</span>: <span class="number">1000</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">f&#x27;Bearer <span class="subst">&#123;self.api_key&#125;</span>&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Apifox/1.0.0 (https://apifox.com)&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">        result_json = json.loads(response.text)</span><br><span class="line">        document_id = result_json[<span class="string">&quot;document&quot;</span>][<span class="string">&quot;id&quot;</span>]</span><br><span class="line">        <span class="keyword">return</span> document_id</span><br><span class="line">    <span class="comment"># æ–°å¢ç‰‡æ®µ</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_segments</span>(<span class="params">self, text, document_id</span>):</span></span><br><span class="line">        url = <span class="string">f&quot;<span class="subst">&#123;self.dataset_url&#125;</span><span class="subst">&#123;self.dataset_id&#125;</span>/documents/<span class="subst">&#123;document_id&#125;</span>/segments&quot;</span></span><br><span class="line">        payload = json.dumps(&#123;</span><br><span class="line">            <span class="string">&quot;segments&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="string">&quot;content&quot;</span>: text,</span><br><span class="line">                    <span class="string">&quot;keywords&quot;</span>: []</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;)</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">f&#x27;Bearer <span class="subst">&#123;self.api_key&#125;</span>&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Apifox/1.0.0 (https://apifox.com)&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detect_encoding</span>(<span class="params">self, file_path</span>):</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            result = chardet.detect(f.read())</span><br><span class="line">        <span class="keyword">return</span> result[<span class="string">&#x27;encoding&#x27;</span>]</span><br><span class="line">    <span class="comment"># è¯»å–æ ‡ç­¾åº“</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_label_file</span>(<span class="params">self, file_path</span>):</span></span><br><span class="line">        <span class="comment"># è¯»å– Excel æ–‡ä»¶</span></span><br><span class="line">        df = pd.read_excel(file_path, engine=<span class="string">&#x27;openpyxl&#x27;</span>)</span><br><span class="line">        data = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> index, row <span class="keyword">in</span> df.iterrows():</span><br><span class="line">            name = <span class="string">f&quot;<span class="subst">&#123;row[<span class="string">&#x27;ç±»åˆ«&#x27;</span>]&#125;</span>-<span class="subst">&#123;row[<span class="string">&#x27;æ ‡ç­¾&#x27;</span>]&#125;</span>&quot;</span></span><br><span class="line">            document_id = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">            label_name = row[<span class="string">&#x27;æ ‡ç­¾&#x27;</span>]</span><br><span class="line">            <span class="comment"># ç±»åˆ«</span></span><br><span class="line">            label_category = row[<span class="string">&#x27;ç±»åˆ«&#x27;</span>]</span><br><span class="line">            <span class="comment"># æ ‡ç­¾æè¿°</span></span><br><span class="line">            label_description = row[<span class="string">&#x27;æ ‡ç­¾æè¿°&#x27;</span>]</span><br><span class="line">            <span class="comment"># å¦‚æœå…³é”®è¯æè¿°çš„å†…å®¹è¶…è¿‡500ä¸ªå­—ç¬¦ï¼Œåˆ™æ¯500ä¸ªå­—ç¬¦åšåˆ†æ®µï¼Œå¹¶å†—ä½™20ä¸ªå­—ç¬¦</span></span><br><span class="line">            label_keywords = self.analyze_keywords(row[<span class="string">&#x27;å…³é”®è¯&#x27;</span>])</span><br><span class="line">            <span class="comment"># label_keywords = json.loads(row[&#x27;å…³é”®è¯&#x27;])</span></span><br><span class="line">            <span class="comment"># æ ‡ç­¾ç±»å‹</span></span><br><span class="line">            label_type = row[<span class="string">&#x27;æ ‡ç­¾åˆ†ç±»&#x27;</span>]</span><br><span class="line">            <span class="keyword">for</span> keyword <span class="keyword">in</span> label_keywords:</span><br><span class="line">                <span class="keyword">if</span> document_id == <span class="string">&quot;&quot;</span>:</span><br><span class="line">                    row_data = self.build_document_block(label_name, label_category, label_description, keyword,</span><br><span class="line">                                                 label_type)</span><br><span class="line">                    document_id = self.create_by_text(name, row_data)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    row_data = self.build_document_block(label_name, label_category, label_description, keyword,</span><br><span class="line">                                                         label_type)</span><br><span class="line">                    self.add_segments(row_data, document_id)</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line">    <span class="comment"># ç»„è£…æ–‡æ¡£å—</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">build_document_block</span>(<span class="params">self, label_name, label_category, label_description, label_keywords, label_type</span>):</span></span><br><span class="line">        block = &#123;</span><br><span class="line">            <span class="string">&quot;label_name&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_name&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;label_category&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_category&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;label_description&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_description&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;label_keywords&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_keywords&#125;</span>&quot;</span>,</span><br><span class="line">            <span class="string">&quot;label_type&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;label_type&#125;</span>&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(block)</span><br><span class="line">        <span class="keyword">return</span> block</span><br><span class="line">    <span class="comment"># åˆ†æå…³é”®è¯å†…å®¹</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">analyze_keywords</span>(<span class="params">self, label_keywords</span>):</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(label_keywords, <span class="built_in">int</span>) <span class="keyword">or</span> <span class="built_in">isinstance</span>(label_keywords, <span class="built_in">float</span>):  <span class="comment"># æ£€æŸ¥æ•°æ®æ˜¯å¦ä¸ºæ•´æ•°æˆ–æµ®ç‚¹æ•°</span></span><br><span class="line">            <span class="keyword">return</span> [<span class="built_in">str</span>(label_keywords)]  <span class="comment"># å¦‚æœæ˜¯æ•´æ•°æˆ–æµ®ç‚¹æ•°ï¼Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="keyword">if</span> pd.isna(label_keywords) <span class="keyword">or</span> label_keywords == <span class="literal">None</span> <span class="keyword">or</span> label_keywords == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> [<span class="string">&quot;æ— &quot;</span>]</span><br><span class="line">        new_keywords_list = []</span><br><span class="line">        <span class="comment"># ç›´æ¥å°†æ ‡ç­¾åˆ—è¡¨æˆªå–ä¸ºå¤šä¸ªæ®µ</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(label_keywords) &gt; <span class="number">500</span>:</span><br><span class="line">            <span class="comment"># è·å–å…³é”®è¯æè¿°çš„æ¯ä¸ªå­—ç¬¦</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(label_keywords), <span class="number">500</span>):</span><br><span class="line">                <span class="comment"># è·å–æ¯ä¸ªå­—ç¬¦çš„ç´¢å¼•</span></span><br><span class="line">                start = i</span><br><span class="line">                <span class="keyword">if</span> i != <span class="number">0</span>:</span><br><span class="line">                    start = i - <span class="number">20</span></span><br><span class="line">                end = i + <span class="number">500</span></span><br><span class="line">                <span class="comment"># è·å–æ¯ä¸ªå­—ç¬¦</span></span><br><span class="line">                segment = label_keywords[start:end]</span><br><span class="line">                new_keywords_list.append(segment)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            new_keywords_list.append(label_keywords)</span><br><span class="line">        <span class="keyword">return</span> new_keywords_list</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    commodity_knowledge = CommodityKnowledge()</span><br><span class="line">    file_path = <span class="string">&quot;C:\\Users\\xxx.xxx\\Desktop\\å•†å“è¯„ä»·åˆ†ç±»åŠå…¶å…³é”®è¯.xlsx&quot;</span></span><br><span class="line">    text = commodity_knowledge.read_label_file(file_path)</span><br><span class="line">    <span class="built_in">print</span>(text)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> dify </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éƒ¨ç½²prometheus</title>
      <link href="/2022/02/09/%E9%83%A8%E7%BD%B2prometheus/"/>
      <url>/2022/02/09/%E9%83%A8%E7%BD%B2prometheus/</url>
      
        <content type="html"><![CDATA[<h1 id="ææ–™å‡†å¤‡"><a href="#ææ–™å‡†å¤‡" class="headerlink" title="ææ–™å‡†å¤‡"></a>ææ–™å‡†å¤‡</h1><ul><li>prometheuså®‰è£…åŒ…ï¼š<a href="https://github.com/prometheus/prometheus/releases/download/v2.33.1/prometheus-2.33.1.linux-amd64.tar.gz">https://github.com/prometheus/prometheus/releases/download/v2.33.1/prometheus-2.33.1.linux-amd64.tar.gz</a></li></ul><h1 id="å‡†å¤‡å®‰è£…"><a href="#å‡†å¤‡å®‰è£…" class="headerlink" title="å‡†å¤‡å®‰è£…"></a>å‡†å¤‡å®‰è£…</h1><ol><li><p>è§£å‹å®‰è£…åŒ…ï¼Œå¾—åˆ°å¦‚ä¸‹ç›®å½•ç»“æ„ï¼š</p><p><img src="image-20220209103225489.png" alt="image-20220209103225489"></p></li><li><p>è¿è¡Œprometheus</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./prometheus --config.file=your_config.yml</span><br></pre></td></tr></table></figure></li><li><p>é…ç½®æ–‡ä»¶</p><p>è¿™æ˜¯é»˜è®¤è‡ªå¸¦çš„é…ç½®æ–‡ä»¶</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my global config</span></span><br><span class="line"><span class="attr">global:</span></span><br><span class="line">  <span class="attr">scrape_interval:</span> <span class="string">15s</span> <span class="comment"># Set the scrape interval to every 15 seconds. Default is every 1 minute.</span></span><br><span class="line">  <span class="attr">evaluation_interval:</span> <span class="string">15s</span> <span class="comment"># Evaluate rules every 15 seconds. The default is every 1 minute.</span></span><br><span class="line">  <span class="comment"># scrape_timeout is set to the global default (10s).</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Alertmanager configuration</span></span><br><span class="line"><span class="attr">alerting:</span></span><br><span class="line">  <span class="attr">alertmanagers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">static_configs:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">targets:</span></span><br><span class="line">          <span class="comment"># - alertmanager:9093</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load rules once and periodically evaluate them according to the global &#x27;evaluation_interval&#x27;.</span></span><br><span class="line"><span class="attr">rule_files:</span></span><br><span class="line">  <span class="comment"># - &quot;first_rules.yml&quot;</span></span><br><span class="line">  <span class="comment"># - &quot;second_rules.yml&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A scrape configuration containing exactly one endpoint to scrape:</span></span><br><span class="line"><span class="comment"># Here it&#x27;s Prometheus itself.</span></span><br><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="comment"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&quot;prometheus&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># metrics_path defaults to &#x27;/metrics&#x27;</span></span><br><span class="line">    <span class="comment"># scheme defaults to &#x27;http&#x27;.</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&quot;localhost:9090&quot;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯æˆ‘éƒ¨ç½²æ—¶çš„é…ç½®æ–‡ä»¶</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">global:</span></span><br><span class="line">  <span class="attr">scrape_interval:</span>     <span class="string">15s</span> <span class="comment"># Set the scrape interval to every 15 seconds. Default is every 1 minute.</span></span><br><span class="line">  <span class="attr">evaluation_interval:</span> <span class="string">15s</span> <span class="comment"># Evaluate rules every 15 seconds. The default is every 1 minute.</span></span><br><span class="line">  <span class="comment"># scrape_timeout is set to the global default (10s).</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load rules once and periodically evaluate them according to the global &#x27;evaluation_interval&#x27;.</span></span><br><span class="line"><span class="attr">rule_files:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;rules/*_rule.yml&quot;</span></span><br><span class="line">  <span class="comment"># - &quot;first_rules.yml&quot;</span></span><br><span class="line">  <span class="comment"># - &quot;second_rules.yml&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">alerting:</span></span><br><span class="line">  <span class="attr">alertmanagers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="number">172.26</span><span class="number">.42</span><span class="number">.215</span><span class="string">:9093</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A scrape configuration containing exactly one endpoint to scrape:</span></span><br><span class="line"><span class="comment"># Here it&#x27;s Prometheus itself.</span></span><br><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="comment"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;prometheus&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=PROMETHEUS</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;node&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=NODE</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;redis&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=REDIS</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;mysql&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=MYSQL</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;cadvisor&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=CADVISOR</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">minio-job</span></span><br><span class="line">    <span class="attr">bearer_token:</span> <span class="string">eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJleHAiOjQ3ODczNjE1MDEsImlzcyI6InByb21ldGhldXMiLCJzdWIiOiJtaW5pb2FkbWluIn0.Sw6Mcmwmx8J3-uU2MAX3BCmMOZyQuugWmwcjE4a2tJ66d8ZG7n85xZBd7kv33iQFz9l5d3ZOoKQi2KvJNd0Klw</span></span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">/minio/v2/metrics/cluster</span></span><br><span class="line">    <span class="attr">scheme:</span> <span class="string">http</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.18.40.91:9000&#x27;</span>]</span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;k8s-node&#x27;</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.18.40.81:32222&#x27;</span>]</span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;blackbox-exporter&#x27;</span></span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">/probe</span></span><br><span class="line">    <span class="attr">params:</span></span><br><span class="line">      <span class="attr">module:</span> [<span class="string">icmp</span>]  <span class="comment"># Look for a HTTP 200 response.</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.18.40.111&#x27;</span>,<span class="string">&#x27;172.18.40.40&#x27;</span>,<span class="string">&#x27;172.18.40.41&#x27;</span>,<span class="string">&#x27;172.18.40.42&#x27;</span>,<span class="string">&#x27;172.18.40.43&#x27;</span>,<span class="string">&#x27;172.18.40.44&#x27;</span>,<span class="string">&#x27;172.18.40.45&#x27;</span>,<span class="string">&#x27;172.18.40.46&#x27;</span>,<span class="string">&#x27;172.18.40.47&#x27;</span>,<span class="string">&#x27;172.18.40.48&#x27;</span>,<span class="string">&#x27;172.18.40.49&#x27;</span>]</span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">          <span class="attr">group:</span> <span class="string">&#x27;172.26.42.215&#x27;</span></span><br><span class="line">    <span class="attr">relabel_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__address__</span>]</span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">__param_target</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__param_target</span>]</span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">instance</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">target_label:</span> <span class="string">__address__</span></span><br><span class="line">        <span class="attr">replacement:</span> <span class="number">172.26</span><span class="number">.42</span><span class="number">.215</span><span class="string">:9115</span>  <span class="comment"># The blackbox exporter&#x27;s real hostname:port.</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;alertmanager&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.16.62.99:12000/prometheus/getTargetByType?exporterType=ALERTMANAGER</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;consul-prometheus&#x27;</span></span><br><span class="line">    <span class="attr">consul_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">server:</span> <span class="string">&#x27;172.26.42.215:8500&#x27;</span></span><br><span class="line">      <span class="attr">services:</span> []  </span><br><span class="line">    <span class="attr">relabel_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__meta_consul_tags</span>]</span><br><span class="line">        <span class="attr">regex:</span> <span class="string">.*test.*</span></span><br><span class="line">        <span class="attr">action:</span> <span class="string">keep</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">regex:</span> <span class="string">__meta_consul_service_metadata_(.+)</span></span><br><span class="line">        <span class="attr">action:</span> <span class="string">labelmap</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> prometheus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®°ä¸€æ¬¡ä½¿ç”¨k8séƒ¨ç½²mysqlå¼•å‘çš„é”™è¯¯æ’æŸ¥å†ç¨‹</title>
      <link href="/2022/01/28/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8k8s%E9%83%A8%E7%BD%B2mysql%E5%BC%95%E5%8F%91%E7%9A%84%E9%94%99%E8%AF%AF%E6%8E%92%E6%9F%A5%E5%8E%86%E7%A8%8B/"/>
      <url>/2022/01/28/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8k8s%E9%83%A8%E7%BD%B2mysql%E5%BC%95%E5%8F%91%E7%9A%84%E9%94%99%E8%AF%AF%E6%8E%92%E6%9F%A5%E5%8E%86%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>é—®é¢˜æè¿°ï¼Œè¿™æ˜¯æœ€å¼€å§‹ä¸çŸ¥é“å¦‚ä½•æ’æŸ¥é—®é¢˜æ—¶ï¼Œçœ‹åˆ°çš„æœ€å¼€å§‹çš„é”™è¯¯å¦‚ä¸‹ï¼š</p><blockquote><p>0/3 nodes are available: 1 node(s) had taint {node-role.kubernetes.io/master: }, that the pod didnâ€™t tolerate, 2 node(s) had taint {node.kubernetes.io/not-ready: }, that the pod didnâ€™t tolerate.</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¡¥å……ï¼šè¿™æ˜¯è‡ªè®¤ä¸ºk8sé›†ç¾¤å·²ç»éƒ¨ç½²å¥½äº†çš„æƒ…å†µä¸‹ï¼Œå»éƒ¨ç½²mysqlé‡åˆ°çš„é”™è¯¯ï¼Œé€šè¿‡ kubectl describe pod mysql æŸ¥çœ‹åˆ°çš„é”™è¯¯</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çš„ä¸€ç³»åˆ—æ“ä½œï¼š</p><blockquote><ol><li><p>æŸ¥çœ‹å„èŠ‚ç‚¹çš„èŠ‚ç‚¹äº²å’Œåº¦</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe node k8s-hostname-1 | grep Taints</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/jgdPCq4V2FEnmQ5.png" alt="image-20220127172204944"></p><p>å…¶ä¸­ k8s-hostname-1 ä¸ºå„èŠ‚ç‚¹çš„hostname</p></li><li><p>æ€»å…±ä¸‰ä¸ªèŠ‚ç‚¹ï¼ˆä¸€ä¸ªmasterï¼Œ2ä¸ªnodeï¼‰ï¼Œå‘ç°å…¨éƒ¨éƒ½æ˜¯<code>NoSchedule</code>çŠ¶æ€</p></li><li><p>å°è¯•å»é™¤æ±¡ç‚¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint nodes k8s-hostname-1 node-role.kubernetes.io/master:NoSchedule-</span><br></pre></td></tr></table></figure><p> <img src="https://s2.loli.net/2022/01/28/rHynk3KvifVUuOq.png" alt="image-20220127172504118"></p></li><li><p>è™½ç„¶æç¤ºå»é™¤äº†æ±¡ç‚¹ï¼Œä½†æ˜¯å†å»æŸ¥çœ‹æ—¶ï¼Œæ±¡ç‚¹ä¾ç„¶å­˜åœ¨<br><img src="https://s2.loli.net/2022/01/28/WEF8jCXByxdzm9D.png" alt="image-20220127172550251"></p></li><li><p>æœ€åå‘ç°ï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹çŠ¶æ€éƒ½æ˜¯å¤„äº NotReady ï¼ŒæŸ¥çœ‹å…¶ä¸­ä¸€ä¸ªnodeçš„è¯¦ç»†æƒ…å†µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get nodes</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/3KymMpNVhzFxGoa.png" alt="image-20220128102317301"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe node k8s-hostname-1</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/3bmdpRXHY4gN7Qi.png" alt="image-20220128102410103"></p></li><li><p>ä»èŠ‚ç‚¹çš„è¯¦æƒ…æŸ¥çœ‹åˆ°èŠ‚ç‚¹çš„cniæ’ä»¶æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œç½‘å¡çš„æ’ä»¶æ²¡æœ‰å‡†å¤‡å¥½ï¼Œå¯¼è‡´èŠ‚ç‚¹éƒ½å¤„äºNotReadyçŠ¶æ€</p></li><li><p>ä½¿ç”¨ <em>systemctl status kubelet</em> ä¹Ÿå¯ä»¥æŸ¥çœ‹åˆ°é—®é¢˜æ‰€åœ¨<br><img src="https://s2.loli.net/2022/01/28/XTwYnDcgCafbtUQ.png" alt="image-20220128102750449"></p></li><li><p>æœ€åè§£å†³åŠæ³•æ˜¯é‡å¯ containerd å³å¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart containerd</span><br></pre></td></tr></table></figure></li><li><p>æ­¤æ—¶å†çœ‹nodeçš„æ±¡ç‚¹å·²ç»æ²¡æœ‰äº†<br><img src="https://s2.loli.net/2022/01/28/ZjxvfaKANOYEM8P.png" alt="image-20220128110644548"></p></li></ol></blockquote><p>åˆ°è¿™é‡Œï¼Œk8sé›†ç¾¤ æ‰ç®—æ˜¯æ­£å¸¸çš„æ­å»ºå¥½äº†ï¼Œä¸‹é¢ç»§ç»­éƒ¨ç½²mysql</p><blockquote><ol><li><p>å‡†å¤‡å¥½äº†mysqlçš„pvå’Œdeploymentçš„é…ç½®æ–‡ä»¶<br><img src="https://s2.loli.net/2022/01/28/nG3hmJLUCMPFbWa.png" alt="image-20220128111422781"></p></li><li><p>å‡†å¤‡å®‰è£…</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f mysql-pv.yaml</span><br><span class="line">kubectl apply -f mysql-deployment.yaml</span><br></pre></td></tr></table></figure></li><li><p>éšåæŸ¥çœ‹mysqlçš„podçŠ¶æ€ï¼Œå¤„äºImagePullBackOff</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pod</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/r5x4oVtpayKjWlE.png" alt="image-20220128111558033"></p></li><li><p>æŸ¥çœ‹è¯¦æƒ…åï¼Œå‘ç°æ˜¯é•œåƒæ— æ³•æ‹‰å–ï¼Œè¿™é‡Œç”¨çš„æ˜¯å†…éƒ¨è‡ªå·±æ­å»ºçš„é•œåƒä»“åº“<code>harbor</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe pod mysql-765868998c-9cdxw</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/28/eCQHihOrsUf43ba.png" alt="image-20220128111959878"></p></li><li><p>é€šè¿‡æŸ¥è¯¢èµ„æ–™ï¼ŒåŸºæœ¬éƒ½æ˜¯è¯´çš„è¦åˆ›å»º <code>secret</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create secret docker-registry default --docker-server=harbor.core.powercloud.com --docker-username=admin --docker-password=rootxxx</span><br></pre></td></tr></table></figure></li><li><p>ä½†æ˜¯åˆ›å»ºå®Œæˆåï¼Œä¾æ—§æ— æ³•æ‹‰å–è¿›è¡Œé•œåƒ</p></li><li><p>æ— æ³•æ‹‰å–ç§æœ‰é•œåƒä»“åº“ä¸­çš„é•œåƒï¼Œæ˜¯éœ€è¦å¯¹containerdè¿›è¡Œç›¸åº”çš„é…ç½®ï¼Œåœ¨æ‰¾containerdçš„é…ç½®æ–‡ä»¶æ—¶ï¼Œå‘ç°æ˜¯æˆ‘å°† <code>/etc/containerd/config.toml</code> æ–‡ä»¶ç»™åˆ äº†ï¼Œé€šè¿‡å¦‚ä¸‹æ–¹å¼å¯ä»¥åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">containerd config default &gt; /etc/containerd/config.toml</span><br></pre></td></tr></table></figure></li><li></li></ol><p>ï¼ˆå¾…å®Œå–„ï¼‰</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨sealosä¸€è¡Œå‘½ä»¤å®‰è£…K8Sé›†ç¾¤</title>
      <link href="/2022/01/26/%E4%BD%BF%E7%94%A8sealos%E4%B8%80%E8%A1%8C%E5%91%BD%E4%BB%A4%E5%AE%89%E8%A3%85K8S%E9%9B%86%E7%BE%A4/"/>
      <url>/2022/01/26/%E4%BD%BF%E7%94%A8sealos%E4%B8%80%E8%A1%8C%E5%91%BD%E4%BB%A4%E5%AE%89%E8%A3%85K8S%E9%9B%86%E7%BE%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="å®‰è£…å‰çš„å‡†å¤‡"><a href="#å®‰è£…å‰çš„å‡†å¤‡" class="headerlink" title="å®‰è£…å‰çš„å‡†å¤‡"></a>å®‰è£…å‰çš„å‡†å¤‡</h1><h2 id="ææ–™"><a href="#ææ–™" class="headerlink" title="ææ–™"></a>ææ–™</h2><ul><li>sealos äºŒè¿›åˆ¶æ–‡ä»¶: <a href="https://sealyun.oss-cn-beijing.aliyuncs.com/latest/sealos">https://sealyun.oss-cn-beijing.aliyuncs.com/latest/sealos</a></li><li>ç¦»çº¿èµ„æºåŒ… kube1.22.0.tar.gz: <a href="https://sealyun.oss-cn-beijing.aliyuncs.com/05a3db657821277f5f3b92d834bbaf98-v1.22.0/kube1.22.0.tar.gz">https://sealyun.oss-cn-beijing.aliyuncs.com/05a3db657821277f5f3b92d834bbaf98-v1.22.0/kube1.22.0.tar.gz</a></li></ul><h2 id="æ‰§è¡Œå®‰è£…"><a href="#æ‰§è¡Œå®‰è£…" class="headerlink" title="æ‰§è¡Œå®‰è£…"></a>æ‰§è¡Œå®‰è£…</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./sealos init --passwd &#x27;root$123&#x27; --master 172.18.40.x1 --node 172.18.40.x2 --node 172.18.40.x3 --pkg-url /root/kube1.22.0.tar.gz --version v1.22.0</span><br></pre></td></tr></table></figure><blockquote><p>å…¶ä¸­ï¼š</p><p>â€“passwd æŒ‡å®šæœåŠ¡å™¨çš„rootç”¨æˆ·å¯†ç </p><p>â€“master æŒ‡å®šéœ€è¦å®‰è£…masterèŠ‚ç‚¹çš„æœåŠ¡å™¨</p><p>â€“node æŒ‡å®šéœ€è¦å®‰è£…nodeèŠ‚ç‚¹çš„æœåŠ¡å™¨</p><p>â€“pkg-url æŒ‡å®šç¦»çº¿èµ„æºåŒ…çš„è·¯å¾„</p><p>â€“version æŒ‡å®šå½“å‰å®‰è£…çš„ç‰ˆæœ¬ï¼ˆè¿™ä¸ªéœ€è¦ä¸ç¦»çº¿èµ„æºåŒ…çš„ç‰ˆæœ¬å¯¹åº”ï¼‰</p></blockquote><p>ç­‰å¾…æ‰§è¡Œå®Œæˆåï¼Œæœ€ç»ˆä¼šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼Œè‡³æ­¤åˆ™è¡¨ç¤ºk8sé›†ç¾¤å·²ç»å®‰è£…å®Œæˆï¼š<br><img src="https://s2.loli.net/2022/01/26/RGCQZ37Xg2qFej8.png" alt="20220126144120"></p><p>å¦‚åç»­è¿˜éœ€ç»§ç»­æ·»åŠ èŠ‚ç‚¹æˆ–åˆ é™¤èŠ‚ç‚¹ï¼Œå¯ä»¥å‚è€ƒå¦‚ä¸‹ç½‘å€ï¼š<br>Swalosçš„githubå®˜ç½‘ï¼š<a href="https://github.com/fanux/sealos">https://github.com/fanux/sealos</a></p><h1 id="å®‰è£…ä¸­é‡åˆ°çš„é—®é¢˜"><a href="#å®‰è£…ä¸­é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å®‰è£…ä¸­é‡åˆ°çš„é—®é¢˜"></a>å®‰è£…ä¸­é‡åˆ°çš„é—®é¢˜</h1><h2 id="ç³»ç»Ÿç›®å½•ä¸‹æ‰¾ä¸åˆ°-crictl"><a href="#ç³»ç»Ÿç›®å½•ä¸‹æ‰¾ä¸åˆ°-crictl" class="headerlink" title="ç³»ç»Ÿç›®å½•ä¸‹æ‰¾ä¸åˆ° crictl"></a>ç³»ç»Ÿç›®å½•ä¸‹æ‰¾ä¸åˆ° crictl</h2><p>é—®é¢˜æè¿°ï¼š</p><blockquote><p>ERROR FileExisting-crictl]: crictl not found in system path</p></blockquote><p>è§£å†³åŠæ³•ï¼š</p><blockquote><p>åœ¨githubä¸­ä¸‹è½½ç›¸åº”ç‰ˆæœ¬çš„ cri-toolsï¼Œå¹¶å°†ä¸‹è½½çš„å‹ç¼©åŒ…ï¼Œè§£å‹åˆ° <code>/usr/bin/</code> ç›®å½•å³å¯</p></blockquote><p>ä¸‹è½½ç›®å½•ï¼š<a href="https://github.com/kubernetes-sigs/cri-tools/releases">https://github.com/kubernetes-sigs/cri-tools/releases</a></p><h2 id="unknown-service-runtime-v1alpha2-RuntimeService"><a href="#unknown-service-runtime-v1alpha2-RuntimeService" class="headerlink" title="unknown service runtime.v1alpha2.RuntimeService"></a>unknown service runtime.v1alpha2.RuntimeService</h2><p>é—®é¢˜æè¿°ï¼š</p><blockquote><p>[ERROR CRI]: container runtime is not running: output: time=â€2022-01-26T14:19:38+08:00â€ level=fatal msg=â€getting status of runtime: rpc error: code = Unimplemented desc = unknown service runtime.v1alpha2.RuntimeServiceâ€</p></blockquote><p>è§£å†³åŠæ³•ï¼š</p><blockquote><p>rm /etc/containerd/config.toml<br>systemctl restart containerd</p></blockquote><p>å‚è€ƒç½‘å€ï¼š<a href="https://github.com/kubernetes-sigs/cri-tools/issues/710">https://github.com/kubernetes-sigs/cri-tools/issues/710</a></p><h2 id="nodeèŠ‚ç‚¹ä¸­æŸ¥çœ‹nodeä¿¡æ¯æŠ¥é”™"><a href="#nodeèŠ‚ç‚¹ä¸­æŸ¥çœ‹nodeä¿¡æ¯æŠ¥é”™" class="headerlink" title="nodeèŠ‚ç‚¹ä¸­æŸ¥çœ‹nodeä¿¡æ¯æŠ¥é”™"></a>nodeèŠ‚ç‚¹ä¸­æŸ¥çœ‹nodeä¿¡æ¯æŠ¥é”™</h2><p>é—®é¢˜æè¿°ï¼š</p><blockquote><p>The connection to the server localhost:8080 was refused - did you specify the right host or port?<br><img src="https://s2.loli.net/2022/01/27/pocLw9PCyX4buGi.png" alt="20220127160004"></p></blockquote><p>è§£å†³åŠæ³•ï¼š</p><blockquote><p>åœ¨masterä¸»èŠ‚ç‚¹ä¸­æ‰¾åˆ°æ–‡ä»¶<code>/etc/kubernetes/admin.conf</code><br>å¹¶å°†è¯¥æ–‡ä»¶æ‹·è´åˆ° nodeèŠ‚ç‚¹çš„ <code>$HOME/.kube/config</code> æ–‡ä»¶ä¸­<br><img src="https://s2.loli.net/2022/01/27/e9mglQG7LvB8NVD.png" alt="20220127160251"></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
            <tag> sealos </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºä¸­å°çš„åˆæ­¥è®¤è¯†</title>
      <link href="/2022/01/25/%E5%85%B3%E4%BA%8E%E4%B8%AD%E5%8F%B0%E7%9A%84%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/"/>
      <url>/2022/01/25/%E5%85%B3%E4%BA%8E%E4%B8%AD%E5%8F%B0%E7%9A%84%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="èƒŒæ™¯çŸ¥è¯†"><a href="#èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="èƒŒæ™¯çŸ¥è¯†"></a>èƒŒæ™¯çŸ¥è¯†</h1><p>æ ¹æ®æ—¶é—´çº¿æ¥æ¢ç´¢ä¸­å°çš„å…´èµ·ï¼š<br><strong>2003å¹´</strong>ï¼Œé˜¿é‡Œå·´å·´æˆç«‹äº†æ·˜å®äº‹ä¸šéƒ¨<br><strong>2008å¹´</strong>ï¼Œé˜¿é‡Œå·´å·´æˆç«‹äº†å¤©çŒ«ï¼Œæœ€åˆæœŸå«æ·˜å®å•†åŸï¼Œå½“æ—¶æ˜¯ä»æ·˜å®å›¢é˜Ÿä¸­æŠ½è°ƒä¸€æ‹¨äººï¼Œä½œä¸ºæ·˜å®äº‹ä¸šéƒ¨ä¸­çš„ä¸€ä¸ªéƒ¨é—¨è¿›è¡Œè¿è¥ï¼›éšç€å¤©çŒ«ä¸šåŠ¡çš„è“¬å‹ƒå‘å±•ï¼Œæ²¡è¿‡å¤šä¹…å°±å•ç‹¬æˆç«‹äº†å¤©çŒ«äº‹ä¸šéƒ¨ï¼Œæˆä¸ºè·Ÿæ·˜å®å¹¶é©¾é½é©±çš„ä¸¤å¤§ç”µå•†äº‹ä¸šéƒ¨ã€‚æ­¤æ—¶ä¹Ÿå‡ºç°äº†ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>æ·˜å®çš„æŠ€æœ¯å›¢é˜ŸåŒæ—¶æ”¯æŒä¸¤å¤§ç”µå•†çš„ä¸šåŠ¡ï¼Œæ·˜å®ä¸šåŠ¡éœ€æ±‚æ»¡è¶³çš„ä¼˜å…ˆçº§é«˜äºå¤©çŒ«ï¼Œä¸¥é‡å½±å“äº†å¤©çŒ«çš„ä¸šåŠ¡å‘å±•</li><li>å½“æ—¶æ·˜å®å’Œå¤©çŒ«æ˜¯å®Œå…¨ç‹¬ç«‹çš„ä¸¤å¥—ä½“ç³»ï¼Œå…·å¤‡å•†å“ã€äº¤æ˜“ã€è¯„ä»·ã€æ”¯ä»˜ç­‰ç›¸åŒçš„åŠŸèƒ½</li></ul><p><strong>2009å¹´</strong>ï¼Œå…±äº«ä¸šåŠ¡äº‹ä¸šéƒ¨åº”è¿è€Œç”Ÿï¼ŒåŒæ—¶æ”¯æŒæ·˜å®å’Œå¤©çŒ«çš„ä¸šåŠ¡ï¼Œä¹Ÿå°†ä¸¤å¥—ç”µå•†çš„ä¸šåŠ¡åšäº†æ¢³ç†å’Œæ²‰æ·€ï¼Œå°†ä¸¤ä¸ªå¹³å°ä¸­å…¬å…±çš„ã€é€šç”¨çš„ä¸šåŠ¡åŠŸèƒ½æ²‰æ·€åˆ°äº†å…±äº«ä¸šåŠ¡äº‹ä¸šéƒ¨ï¼Œé¿å…æœ‰äº›åŠŸèƒ½çš„é‡å¤å»ºè®¾å’Œç»´æŠ¤ï¼Œæ›´åˆç†çš„åˆ©ç”¨æŠ€æœ¯èµ„æºã€‚</p><p>ä½†æ˜¯å…±äº«ä¸šåŠ¡äº‹ä¸šéƒ¨çš„å‘å±•äº‹ä¸æ„¿è¿ï¼Œåœ¨ä¸¤å¤§ä¸šåŠ¡éƒ¨é—¨çš„ä¸šåŠ¡éœ€æ±‚ä¸‹è‰°éš¾çš„ç”Ÿå­˜ã€‚</p><p><strong>2010å¹´</strong>ï¼Œèšåˆ’ç®—çš„å‡ºç°ï¼Œå±•ç°äº†å®ƒå¼ºå¤§çš„æµé‡å¸å¼•çš„å¨åŠ›ï¼Œæ®ä¸å®Œå…¨ç»Ÿè®¡ï¼Œä¸ç®¡æ˜¯æ·˜å®è¿˜æ˜¯å¤©çŒ«å•†å“ï¼Œä¸€æ—¦è¿›å…¥èšåˆ’ç®—å¹³å°ï¼Œé”€å”®é¢ä¼šåœ¨çŸ­æ—¶é—´å†…è‡³å°‘å¢é•¿25å€ï¼Œéšåå¤§å®¶çº·çº·å¯¹æ¥èšåˆ’ç®—å¹³å°ï¼Œ1688ä¹Ÿå‚ä¸å…¶ä¸­ï¼Œæ´ªæµèˆ¬çš„ä¸šåŠ¡å¯¹æ¥éœ€æ±‚è®©å½“æ—¶æˆç«‹ä¸ä¹…çš„èšåˆ’ç®—å›¢é˜Ÿåº”æ¥ä¸æš‡ã€‚</p><p>éšåé›†å›¢è¦æ±‚ä¸‰å¤§ç”µå•†å¹³å°ä¸èšåˆ’ç®—å¹³å°è¿›è¡Œä¸šåŠ¡å¯¹æ¥ï¼Œå¿…é¡»é€šè¿‡å…±äº«ä¸šåŠ¡äº‹ä¸šéƒ¨ã€‚</p><p>é˜¿é‡Œå·´å·´â€œåšå¹³å°ã€è–„åº”ç”¨â€æ¶æ„å½¢æ€é€æ¸æ¸…æ™°ã€‚</p><p>å‰ç«¯ä¸šåŠ¡ä¸­å…¬å…±ã€é€šç”¨çš„ä¸šåŠ¡ä¹Ÿæ²‰æ·€åˆ°äº†è¿™ä¸ªäº‹ä¸šéƒ¨ï¼ŒåŒ…å«äº†ç”¨æˆ·ä¸­å¿ƒã€å•†å“ä¸­å¿ƒã€äº¤æ˜“ä¸­å¿ƒç­‰ã€‚</p><p><strong>2015å¹´</strong>ï¼Œé˜¿é‡Œå·´å·´å¸¦é¢†</p><h1 id="ä»€ä¹ˆæ˜¯ä¸­å°"><a href="#ä»€ä¹ˆæ˜¯ä¸­å°" class="headerlink" title="ä»€ä¹ˆæ˜¯ä¸­å°"></a>ä»€ä¹ˆæ˜¯ä¸­å°</h1><h1 id="ä¸ºä»€ä¹ˆéœ€è¦ä¸­å°"><a href="#ä¸ºä»€ä¹ˆéœ€è¦ä¸­å°" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦ä¸­å°"></a>ä¸ºä»€ä¹ˆéœ€è¦ä¸­å°</h1><h1 id="ä¸­å°çš„åˆ†ç±»"><a href="#ä¸­å°çš„åˆ†ç±»" class="headerlink" title="ä¸­å°çš„åˆ†ç±»"></a>ä¸­å°çš„åˆ†ç±»</h1>]]></content>
      
      
      
        <tags>
            
            <tag> ä¸­å° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kubernetes å…¥é—¨&amp;è¿›é˜¶å®æˆ˜</title>
      <link href="/2022/01/25/Kubernetes-%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/"/>
      <url>/2022/01/25/Kubernetes-%E5%85%A5%E9%97%A8-%E8%BF%9B%E9%98%B6%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[<p>ä½œä¸ºåˆå­¦è€…ï¼Œè¿™ç¯‡æ–‡ç« å¯ä»¥å¾ˆå¥½çš„å…¥é—¨<br>å‚è€ƒæ–‡ç« ï¼š<a href="https://mp.weixin.qq.com/s/mUF0AEncu3T2yDqKyt-0Ow">https://mp.weixin.qq.com/s/mUF0AEncu3T2yDqKyt-0Ow</a></p><p>æ€ç»´å¯¼å›¾ï¼š<br><img src="https://s2.loli.net/2022/01/25/gGyXmJ6ortpLW9Q.png" alt="K8S"></p>]]></content>
      
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaä»£ç†æ¨¡å¼</title>
      <link href="/2022/01/16/java%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/"/>
      <url>/2022/01/16/java%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»£ç†æ¨¡å¼"><a href="#ä»£ç†æ¨¡å¼" class="headerlink" title="ä»£ç†æ¨¡å¼"></a>ä»£ç†æ¨¡å¼</h1><p>ä»£ç†æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒå¥½ç†è§£çš„è®¾è®¡æ¨¡å¼ï¼Œç®€å•æ¥è¯´å°±æ˜¯é€šè¿‡ä»£ç†ï¼Œå¯ä»¥æåˆ°å¯¹çœŸæ˜¯å¯¹è±¡çš„è®¿é—®ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ä¸ä¿®æ”¹çœŸå®å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œæä¾›é¢å¤–çš„åŠŸèƒ½ï¼Œæ‰©å±•ç›®æ ‡å¯¹è±¡<br>ä¸¾ä¸ªä¾‹å­ï¼š<br>ä½ æ‰¾å¤–å–å°å“¥å¸®ä½ å–é¤ï¼Œå¤–å–å°å“¥å°±æ˜¯ä½ çš„ä»£ç†å¯¹è±¡ï¼Œä»£ç†çš„è¡Œä¸ºå°±æ˜¯å–é¤</p><p>ä»£ç†æ¨¡å¼åˆ†ä¸ºï¼šé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ä¸¤ç§å®ç°æ–¹å¼<br>æ€ç»´å¯¼å›¾æ•´ç†ï¼š<br><img src="https://s2.loli.net/2022/01/16/5x4BQIhZVKSGrsb.png" alt="ä»£ç†æ¨¡å¼"></p>]]></content>
      
      
      
        <tags>
            
            <tag> javaåŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨èä¸€æ¬¾è¶…å¥½ç”¨çš„IDEAæ’ä»¶:Sequencediagram</title>
      <link href="/2022/01/12/%E6%8E%A8%E8%8D%90%E4%B8%80%E6%AC%BE%E8%B6%85%E5%A5%BD%E7%94%A8%E7%9A%84IDEA%E6%8F%92%E4%BB%B6-Sequencediagram/"/>
      <url>/2022/01/12/%E6%8E%A8%E8%8D%90%E4%B8%80%E6%AC%BE%E8%B6%85%E5%A5%BD%E7%94%A8%E7%9A%84IDEA%E6%8F%92%E4%BB%B6-Sequencediagram/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨IDEAä¸­æœç´¢æ’ä»¶å¹¶å®‰è£…"><a href="#åœ¨IDEAä¸­æœç´¢æ’ä»¶å¹¶å®‰è£…" class="headerlink" title="åœ¨IDEAä¸­æœç´¢æ’ä»¶å¹¶å®‰è£…"></a>åœ¨IDEAä¸­æœç´¢æ’ä»¶å¹¶å®‰è£…</h1><p><img src="https://s2.loli.net/2022/01/12/qZKXPfFxYgRLGUN.png" alt="20220112094600"></p><p>æ’ä»¶çš„è®¿é—®åœ°å€ï¼š<a href="https://vanco.github.io/SequencePlugin">https://vanco.github.io/SequencePlugin</a></p><p>æ’ä»¶åŠŸèƒ½ä»‹ç»ï¼š</p><ul><li>ç”Ÿæˆç®€å•åºåˆ—å›¾</li><li>é€šè¿‡å•å‡»å›¾è¡¨å½¢çŠ¶æ¥å¯¼èˆªä»£ç </li><li>ä»å…³ç³»å›¾ä¸­åˆ é™¤ç±»</li><li>å°†å›¾è¡¨å¯¼å‡ºä¸ºå›¾åƒ</li><li>å°†å›¾è¡¨å¯¼å‡ºä¸ºPlantumlæ–‡ä»¶</li><li>ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®ä»å›¾è¡¨ä¸­æ’é™¤ç±»</li><li>åºåˆ—å›¾</li><li>æ™ºèƒ½æ¥å£ï¼ˆå®éªŒï¼‰ambdaè¡¨è¾¾å¼ï¼ˆå®éªŒï¼‰</li><li>Kotlinæ”¯æŒï¼ˆå®éªŒæ€§ï¼Œæ— ä»£ç å¯¼èˆªï¼‰</li></ul><h1 id="æ’ä»¶çš„ä½¿ç”¨"><a href="#æ’ä»¶çš„ä½¿ç”¨" class="headerlink" title="æ’ä»¶çš„ä½¿ç”¨"></a>æ’ä»¶çš„ä½¿ç”¨</h1><ol><li><p>åœ¨è‡ªå·±çš„å·¥ç¨‹ä¸­æ‰¾åˆ°éœ€è¦ç”Ÿæˆåºåˆ—å›¾çš„æ–¹æ³•ï¼Œå³é”®é¼ æ ‡<br><img src="https://s2.loli.net/2022/01/12/InYDXkZ5cWRJOgE.png" alt="20220112094952"></p></li><li><p>é€‰æ‹©IDEAä¸»ç•Œé¢å³ä¸Šè§’çš„<br><img src="https://s2.loli.net/2022/01/12/1oAXb8EVjCtaS4T.png" alt="20220112095037"><br>æŒ‰é’®ï¼Œæˆ–å³é”®é¼ æ ‡åæ˜¾ç¤ºçš„ Sequence Diagramâ€¦é€‰é¡¹ï¼Œå³å¯å¾—åˆ°è¯¥æ–¹æ³•çš„åºåˆ—å›¾<br><img src="https://s2.loli.net/2022/01/12/Y4ZEqJ3NawPLsb5.png" alt="20220112095221"></p></li><li><p>é€‰æ‹©åºåˆ—å›¾å·¦è¾¹èœå•çš„å›¾ç‰‡æŒ‰é’®ï¼Œå³å¯å°†åºåˆ—å›¾å¯¼å‡ºå›¾ç‰‡<br><img src="https://s2.loli.net/2022/01/12/Ski5aQAKjsJP7lC.png" alt="20220112095319"></p></li><li><p>æœ€ç»ˆå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„å›¾ç‰‡<br><img src="https://s2.loli.net/2022/01/12/ZmEuJrcLalsNVjg.png" alt="HostMoniterServiceImpl_searchBasHostMoniterData"></p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> å¥½ç‰©æ¨è </tag>
            
            <tag> IDEAæ’ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>java-Stringå­¦ä¹ </title>
      <link href="/2022/01/11/java-String%E5%AD%A6%E4%B9%A0/"/>
      <url>/2022/01/11/java-String%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="Stringã€StringBufferå’ŒStringBuilderçš„åŒºåˆ«"><a href="#Stringã€StringBufferå’ŒStringBuilderçš„åŒºåˆ«" class="headerlink" title="Stringã€StringBufferå’ŒStringBuilderçš„åŒºåˆ«"></a>Stringã€StringBufferå’ŒStringBuilderçš„åŒºåˆ«</h1><p>ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ¥è¯´ï¼š</p><h2 id="å¯å˜æ€§"><a href="#å¯å˜æ€§" class="headerlink" title="å¯å˜æ€§"></a>å¯å˜æ€§</h2><p>String ç±»ä¸­ä½¿ç”¨ final å…³é”®å­—ä¿®é¥°å­—ç¬¦æ•°ç»„æ¥ä¿å­˜å­—ç¬¦ä¸²ï¼Œprivate final char value[]ï¼Œæ‰€ä»¥ String å¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">String</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">Comparable</span>&lt;<span class="title">String</span>&gt;, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">    <span class="comment">/** The value is used for character storage. */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">char</span> value[];</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>è€Œ StringBuilder ä¸ StringBuffer éƒ½ç»§æ‰¿è‡ª AbstractStringBuilder ç±»ï¼Œåœ¨ AbstractStringBuilder ä¸­ä¹Ÿæ˜¯ä½¿ç”¨å­—ç¬¦æ•°ç»„ä¿å­˜å­—ç¬¦ä¸²char[]value ä½†æ˜¯æ²¡æœ‰ç”¨ final å…³é”®å­—ä¿®é¥°ï¼Œæ‰€ä»¥è¿™ä¸¤ç§å¯¹è±¡éƒ½æ˜¯å¯å˜çš„ã€‚</p><blockquote><p>è¡¥å……ï¼šåœ¨ Java 9 ä¹‹åï¼ŒString ã€StringBuilder ä¸ StringBuffer çš„å®ç°æ”¹ç”¨ byte æ•°ç»„å­˜å‚¨å­—ç¬¦ä¸² private final byte[] value</p></blockquote><p>StringBuilder ä¸ StringBuffer çš„æ„é€ æ–¹æ³•éƒ½æ˜¯è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•ä¹Ÿå°±æ˜¯ AbstractStringBuilder å®ç°çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBuffer</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractStringBuilder</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">CharSequence</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * A cache of the last value returned by toString. Cleared</span></span><br><span class="line"><span class="comment">     * whenever the StringBuffer is modified.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">char</span>[] toStringCache;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** use serialVersionUID from JDK 1.0.2 for interoperability */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">3388685877147921107L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs a string buffer with no characters in it and an</span></span><br><span class="line"><span class="comment">     * initial capacity of 16 characters.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StringBuffer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StringBuilder</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractStringBuilder</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span>, <span class="title">CharSequence</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** use serialVersionUID for interoperability */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">4383685877147921099L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs a string builder with no characters in it and an</span></span><br><span class="line"><span class="comment">     * initial capacity of 16 characters.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StringBuilder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">16</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractStringBuilder</span> <span class="keyword">implements</span> <span class="title">Appendable</span>, <span class="title">CharSequence</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The value is used for character storage.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">char</span>[] value;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The count is the number of characters used.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * This no-arg constructor is necessary for serialization of subclasses.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    AbstractStringBuilder() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Creates an AbstractStringBuilder of the specified capacity.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    AbstractStringBuilder(<span class="keyword">int</span> capacity) &#123;</span><br><span class="line">        value = <span class="keyword">new</span> <span class="keyword">char</span>[capacity];</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="çº¿ç¨‹å®‰å…¨"><a href="#çº¿ç¨‹å®‰å…¨" class="headerlink" title="çº¿ç¨‹å®‰å…¨"></a>çº¿ç¨‹å®‰å…¨</h2><p>String ä¸­çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±å¯ä»¥ç†è§£ä¸ºå¸¸é‡ï¼Œçº¿ç¨‹å®‰å…¨ã€‚</p><p>AbstractStringBuilder æ˜¯ StringBuilder ä¸ StringBuffer çš„å…¬å…±çˆ¶ç±»ï¼Œå®šä¹‰äº†ä¸€äº›å­—ç¬¦ä¸²çš„åŸºæœ¬æ“ä½œï¼Œå¦‚ expandCapacityã€appendã€insertã€indexOf ç­‰å…¬å…±æ–¹æ³•ã€‚</p><p>StringBuffer å¯¹æ–¹æ³•åŠ äº†åŒæ­¥é”æˆ–è€…å¯¹è°ƒç”¨çš„æ–¹æ³•åŠ äº†åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><p>StringBuilder å¹¶æ²¡æœ‰å¯¹æ–¹æ³•è¿›è¡ŒåŠ åŒæ­¥é”ï¼Œæ‰€ä»¥æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚</p><h2 id="æ€§èƒ½"><a href="#æ€§èƒ½" class="headerlink" title="æ€§èƒ½"></a>æ€§èƒ½</h2><p>æ¯æ¬¡å¯¹ String ç±»å‹è¿›è¡Œæ”¹å˜çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ String å¯¹è±¡ï¼Œç„¶åå°†æŒ‡é’ˆæŒ‡å‘æ–°çš„ String å¯¹è±¡ã€‚</p><p>StringBuffer æ¯æ¬¡éƒ½ä¼šå¯¹ StringBuffer å¯¹è±¡æœ¬èº«è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯ç”Ÿæˆæ–°çš„å¯¹è±¡å¹¶æ”¹å˜å¯¹è±¡å¼•ç”¨ã€‚</p><p>ç›¸åŒæƒ…å†µä¸‹ä½¿ç”¨ StringBuilder ç›¸æ¯”ä½¿ç”¨ StringBuffer ä»…èƒ½è·å¾— 10%~15% å·¦å³çš„æ€§èƒ½æå‡ï¼Œä½†å´è¦å†’å¤šçº¿ç¨‹ä¸å®‰å…¨çš„é£é™©ã€‚</p><h2 id="å¯¹äºä¸‰è€…ä½¿ç”¨çš„æ€»ç»“ï¼š"><a href="#å¯¹äºä¸‰è€…ä½¿ç”¨çš„æ€»ç»“ï¼š" class="headerlink" title="å¯¹äºä¸‰è€…ä½¿ç”¨çš„æ€»ç»“ï¼š"></a>å¯¹äºä¸‰è€…ä½¿ç”¨çš„æ€»ç»“ï¼š</h2><p>æ“ä½œå°‘é‡çš„æ•°æ®: é€‚ç”¨ String<br>å•çº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ®: é€‚ç”¨ StringBuilder<br>å¤šçº¿ç¨‹æ“ä½œå­—ç¬¦ä¸²ç¼“å†²åŒºä¸‹æ“ä½œå¤§é‡æ•°æ®: é€‚ç”¨ StringBuffer</p>]]></content>
      
      
      
        <tags>
            
            <tag> javaåŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•å¿«é€Ÿæ­å»ºä¸ªäººåšå®¢</title>
      <link href="/2022/01/11/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
      <url>/2022/01/11/%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<p>å‡†å¤‡ä¸­ï¼šå‚è€ƒç½‘å€<a href="https://segmentfault.com/a/1190000017986794">https://segmentfault.com/a/1190000017986794</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>javaå¤šçº¿ç¨‹å­¦ä¹ -æ€ç»´å¯¼å›¾</title>
      <link href="/2022/01/10/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AD%A6%E4%B9%A0-%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/"/>
      <url>/2022/01/10/java%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AD%A6%E4%B9%A0-%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<p><img src="https://s2.loli.net/2022/01/10/YxtHcFRTW2uv1qi.png" alt="Javaé«˜å¹¶å‘æ ¸å¿ƒç¼–ç¨‹"></p>]]></content>
      
      
      
        <tags>
            
            <tag> javaåŸºç¡€çŸ¥è¯† </tag>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¸©ä¹ springboot</title>
      <link href="/2022/01/10/%E6%B8%A9%E4%B9%A0springboot/"/>
      <url>/2022/01/10/%E6%B8%A9%E4%B9%A0springboot/</url>
      
        <content type="html"><![CDATA[<h1 id="ä»€ä¹ˆæ˜¯springboot"><a href="#ä»€ä¹ˆæ˜¯springboot" class="headerlink" title="ä»€ä¹ˆæ˜¯springboot"></a>ä»€ä¹ˆæ˜¯springboot</h1><p>Spring Boot æ˜¯ Spring å¼€æºç»„ç»‡ä¸‹çš„å­é¡¹ç›®ï¼Œæ˜¯ Spring ç»„ä»¶ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œä¸»è¦æ˜¯ç®€åŒ–äº†ä½¿ç”¨ Spring çš„éš¾åº¦ï¼Œç®€çœäº†ç¹é‡çš„é…ç½®ï¼Œæä¾›äº†å„ç§å¯åŠ¨å™¨ï¼Œå¼€å‘è€…èƒ½å¿«é€Ÿä¸Šæ‰‹ã€‚</p><h1 id="ä¸ºä»€ä¹ˆè¦ç”¨springboot"><a href="#ä¸ºä»€ä¹ˆè¦ç”¨springboot" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ç”¨springboot"></a>ä¸ºä»€ä¹ˆè¦ç”¨springboot</h1><p>Spring Boot ä¼˜ç‚¹éå¸¸å¤šï¼Œå¦‚ï¼š</p><p>ç‹¬ç«‹è¿è¡Œ<br>ç®€åŒ–é…ç½®<br>è‡ªåŠ¨é…ç½®<br>æ— ä»£ç ç”Ÿæˆå’ŒXMLé…ç½®<br>åº”ç”¨ç›‘æ§<br>ä¸Šæ‰‹å®¹æ˜“<br>â€¦<br>Spring Boot é›†è¿™ä¹ˆå¤šä¼˜ç‚¹äºä¸€èº«ï¼Œä¸ºä»€ä¹ˆä¸ç”¨ï¼Ÿ</p><h1 id="Spring-Boot-çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶æœ‰å“ªå‡ ä¸ªï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Spring-Boot-çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶æœ‰å“ªå‡ ä¸ªï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Spring Boot çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶æœ‰å“ªå‡ ä¸ªï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Spring Boot çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶æœ‰å“ªå‡ ä¸ªï¼Ÿå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>Spring Boot çš„æ ¸å¿ƒé…ç½®æ–‡ä»¶æ˜¯ application å’Œ bootstrap é…ç½®æ–‡ä»¶ã€‚</p><p>application é…ç½®æ–‡ä»¶è¿™ä¸ªå®¹æ˜“ç†è§£ï¼Œä¸»è¦ç”¨äº Spring Boot é¡¹ç›®çš„è‡ªåŠ¨åŒ–é…ç½®ã€‚</p><p>bootstrap é…ç½®æ–‡ä»¶æœ‰ä»¥ä¸‹å‡ ä¸ªåº”ç”¨åœºæ™¯ã€‚</p><ul><li>ä½¿ç”¨ Spring Cloud Config é…ç½®ä¸­å¿ƒæ—¶ï¼Œè¿™æ—¶éœ€è¦åœ¨ bootstrap é…ç½®æ–‡ä»¶ä¸­æ·»åŠ è¿æ¥åˆ°é…ç½®ä¸­å¿ƒçš„é…ç½®å±æ€§æ¥åŠ è½½å¤–éƒ¨é…ç½®ä¸­å¿ƒçš„é…ç½®ä¿¡æ¯ï¼›</li><li>ä¸€äº›å›ºå®šçš„ä¸èƒ½è¢«è¦†ç›–çš„å±æ€§ï¼›</li><li>ä¸€äº›åŠ å¯†/è§£å¯†çš„åœºæ™¯ï¼›</li></ul><h1 id="Spring-Boot-çš„é…ç½®æ–‡ä»¶æœ‰å“ªå‡ ç§æ ¼å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#Spring-Boot-çš„é…ç½®æ–‡ä»¶æœ‰å“ªå‡ ç§æ ¼å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="Spring Boot çš„é…ç½®æ–‡ä»¶æœ‰å“ªå‡ ç§æ ¼å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>Spring Boot çš„é…ç½®æ–‡ä»¶æœ‰å“ªå‡ ç§æ ¼å¼ï¼Ÿå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1><p>.properties å’Œ .ymlï¼Œå®ƒä»¬çš„åŒºåˆ«ä¸»è¦æ˜¯ä¹¦å†™æ ¼å¼ä¸åŒã€‚</p><p>1).properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">app.user.name</span> = <span class="string">javastack</span></span><br></pre></td></tr></table></figure><p>2).yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">app:</span></span><br><span class="line">  <span class="attr">user:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">javastack</span></span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œ.yml æ ¼å¼ä¸æ”¯æŒ @PropertySource æ³¨è§£å¯¼å…¥é…ç½®ã€‚</p><h1 id="Spring-Boot-çš„æ ¸å¿ƒæ³¨è§£æ˜¯å“ªä¸ªï¼Ÿå®ƒä¸»è¦ç”±å“ªå‡ ä¸ªæ³¨è§£ç»„æˆçš„ï¼Ÿ"><a href="#Spring-Boot-çš„æ ¸å¿ƒæ³¨è§£æ˜¯å“ªä¸ªï¼Ÿå®ƒä¸»è¦ç”±å“ªå‡ ä¸ªæ³¨è§£ç»„æˆçš„ï¼Ÿ" class="headerlink" title="Spring Boot çš„æ ¸å¿ƒæ³¨è§£æ˜¯å“ªä¸ªï¼Ÿå®ƒä¸»è¦ç”±å“ªå‡ ä¸ªæ³¨è§£ç»„æˆçš„ï¼Ÿ"></a>Spring Boot çš„æ ¸å¿ƒæ³¨è§£æ˜¯å“ªä¸ªï¼Ÿå®ƒä¸»è¦ç”±å“ªå‡ ä¸ªæ³¨è§£ç»„æˆçš„ï¼Ÿ</h1><p>å¯åŠ¨ç±»ä¸Šé¢çš„æ³¨è§£æ˜¯@SpringBootApplicationï¼Œå®ƒä¹Ÿæ˜¯ Spring Boot çš„æ ¸å¿ƒæ³¨è§£ï¼Œä¸»è¦ç»„åˆåŒ…å«äº†ä»¥ä¸‹ 3 ä¸ªæ³¨è§£ï¼š</p><p>@SpringBootConfigurationï¼šç»„åˆäº† @Configuration æ³¨è§£ï¼Œå®ç°é…ç½®æ–‡ä»¶çš„åŠŸèƒ½ã€‚</p><p>@EnableAutoConfigurationï¼šæ‰“å¼€è‡ªåŠ¨é…ç½®çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥å…³é—­æŸä¸ªè‡ªåŠ¨é…ç½®çš„é€‰é¡¹ï¼Œå¦‚å…³é—­æ•°æ®æºè‡ªåŠ¨é…ç½®åŠŸèƒ½ï¼š @SpringBootApplication(exclude = { DataSourceAutoConfiguration.class })ã€‚</p><p>@ComponentScanï¼šSpringç»„ä»¶æ‰«æã€‚</p><h1 id="å¼€å¯-Spring-Boot-ç‰¹æ€§æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"><a href="#å¼€å¯-Spring-Boot-ç‰¹æ€§æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ" class="headerlink" title="å¼€å¯ Spring Boot ç‰¹æ€§æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"></a>å¼€å¯ Spring Boot ç‰¹æ€§æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</h1><p>1ï¼‰ç»§æ‰¿spring-boot-starter-parenté¡¹ç›®</p><p>2ï¼‰å¯¼å…¥spring-boot-dependenciesé¡¹ç›®ä¾èµ–</p><h1 id="Spring-Boot-éœ€è¦ç‹¬ç«‹çš„å®¹å™¨è¿è¡Œå—ï¼Ÿ"><a href="#Spring-Boot-éœ€è¦ç‹¬ç«‹çš„å®¹å™¨è¿è¡Œå—ï¼Ÿ" class="headerlink" title="Spring Boot éœ€è¦ç‹¬ç«‹çš„å®¹å™¨è¿è¡Œå—ï¼Ÿ"></a>Spring Boot éœ€è¦ç‹¬ç«‹çš„å®¹å™¨è¿è¡Œå—ï¼Ÿ</h1><p>å¯ä»¥ä¸éœ€è¦ï¼Œå†…ç½®äº† Tomcat/ Jetty ç­‰å®¹å™¨ã€‚</p><h1 id="è¿è¡Œ-Spring-Boot-æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"><a href="#è¿è¡Œ-Spring-Boot-æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ" class="headerlink" title="è¿è¡Œ Spring Boot æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"></a>è¿è¡Œ Spring Boot æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</h1><p>1ï¼‰æ‰“åŒ…ç”¨å‘½ä»¤æˆ–è€…æ”¾åˆ°å®¹å™¨ä¸­è¿è¡Œ</p><p>2ï¼‰ç”¨ Maven/ Gradle æ’ä»¶è¿è¡Œ</p><p>3ï¼‰ç›´æ¥æ‰§è¡Œ main æ–¹æ³•è¿è¡Œ</p><h1 id="Spring-Boot-è‡ªåŠ¨é…ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Spring-Boot-è‡ªåŠ¨é…ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Spring Boot è‡ªåŠ¨é…ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Spring Boot è‡ªåŠ¨é…ç½®åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p>æ³¨è§£ @EnableAutoConfiguration, @Configuration, @ConditionalOnClass å°±æ˜¯è‡ªåŠ¨é…ç½®çš„æ ¸å¿ƒï¼Œé¦–å…ˆå®ƒå¾—æ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå…¶æ¬¡æ ¹æ®ç±»è·¯å¾„ä¸‹æ˜¯å¦æœ‰è¿™ä¸ªç±»å»è‡ªåŠ¨é…ç½®ã€‚</p><h1 id="Spring-Boot-çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ"><a href="#Spring-Boot-çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ" class="headerlink" title="Spring Boot çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ"></a>Spring Boot çš„ç›®å½•ç»“æ„æ˜¯æ€æ ·çš„ï¼Ÿ</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">+- javaproject</span><br><span class="line">    +- MyApplication.java</span><br><span class="line">    |</span><br><span class="line">    +- customer</span><br><span class="line">    |   +- Customer.java</span><br><span class="line">    |   +- CustomerController.java</span><br><span class="line">    |   +- CustomerService.java</span><br><span class="line">    |   +- CustomerRepository.java</span><br><span class="line">    |</span><br><span class="line">    +- order</span><br><span class="line">        +- Order.java</span><br><span class="line">        +- OrderController.java</span><br><span class="line">        +- OrderService.java</span><br><span class="line">        +- OrderRepository.java</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç›®å½•ç»“æ„æ˜¯ä¸»æµåŠæ¨èçš„åšæ³•ï¼Œè€Œåœ¨ä¸»å…¥å£ç±»ä¸ŠåŠ ä¸Š @SpringBootApplication æ³¨è§£æ¥å¼€å¯ Spring Boot çš„å„é¡¹èƒ½åŠ›ï¼Œå¦‚è‡ªåŠ¨é…ç½®ã€ç»„ä»¶æ‰«æç­‰ã€‚</p><h1 id="ä½ å¦‚ä½•ç†è§£-Spring-Boot-ä¸­çš„-Startersï¼Ÿ"><a href="#ä½ å¦‚ä½•ç†è§£-Spring-Boot-ä¸­çš„-Startersï¼Ÿ" class="headerlink" title="ä½ å¦‚ä½•ç†è§£ Spring Boot ä¸­çš„ Startersï¼Ÿ"></a>ä½ å¦‚ä½•ç†è§£ Spring Boot ä¸­çš„ Startersï¼Ÿ</h1><p>Starterså¯ä»¥ç†è§£ä¸ºå¯åŠ¨å™¨ï¼Œå®ƒåŒ…å«äº†ä¸€ç³»åˆ—å¯ä»¥é›†æˆåˆ°åº”ç”¨é‡Œé¢çš„ä¾èµ–åŒ…ï¼Œä½ å¯ä»¥ä¸€ç«™å¼é›†æˆ Spring åŠå…¶ä»–æŠ€æœ¯ï¼Œè€Œä¸éœ€è¦åˆ°å¤„æ‰¾ç¤ºä¾‹ä»£ç å’Œä¾èµ–åŒ…ã€‚å¦‚ä½ æƒ³ä½¿ç”¨ Spring JPA è®¿é—®æ•°æ®åº“ï¼Œåªè¦åŠ å…¥ spring-boot-starter-data-jpa å¯åŠ¨å™¨ä¾èµ–å°±èƒ½ä½¿ç”¨äº†ã€‚</p><p>StartersåŒ…å«äº†è®¸å¤šé¡¹ç›®ä¸­éœ€è¦ç”¨åˆ°çš„ä¾èµ–ï¼Œå®ƒä»¬èƒ½å¿«é€ŸæŒç»­çš„è¿è¡Œï¼Œéƒ½æ˜¯ä¸€ç³»åˆ—å¾—åˆ°æ”¯æŒçš„ç®¡ç†ä¼ é€’æ€§ä¾èµ–ã€‚</p><h1 id="å¦‚ä½•åœ¨-Spring-Boot-å¯åŠ¨çš„æ—¶å€™è¿è¡Œä¸€äº›ç‰¹å®šçš„ä»£ç ï¼Ÿ"><a href="#å¦‚ä½•åœ¨-Spring-Boot-å¯åŠ¨çš„æ—¶å€™è¿è¡Œä¸€äº›ç‰¹å®šçš„ä»£ç ï¼Ÿ" class="headerlink" title="å¦‚ä½•åœ¨ Spring Boot å¯åŠ¨çš„æ—¶å€™è¿è¡Œä¸€äº›ç‰¹å®šçš„ä»£ç ï¼Ÿ"></a>å¦‚ä½•åœ¨ Spring Boot å¯åŠ¨çš„æ—¶å€™è¿è¡Œä¸€äº›ç‰¹å®šçš„ä»£ç ï¼Ÿ</h1><p>å¯ä»¥å®ç°æ¥å£ ApplicationRunner æˆ–è€… CommandLineRunnerï¼Œè¿™ä¸¤ä¸ªæ¥å£å®ç°æ–¹å¼ä¸€æ ·ï¼Œå®ƒä»¬éƒ½åªæä¾›äº†ä¸€ä¸ª run æ–¹æ³•.</p><h1 id="Spring-Boot-æœ‰å“ªå‡ ç§è¯»å–é…ç½®çš„æ–¹å¼ï¼Ÿ"><a href="#Spring-Boot-æœ‰å“ªå‡ ç§è¯»å–é…ç½®çš„æ–¹å¼ï¼Ÿ" class="headerlink" title="Spring Boot æœ‰å“ªå‡ ç§è¯»å–é…ç½®çš„æ–¹å¼ï¼Ÿ"></a>Spring Boot æœ‰å“ªå‡ ç§è¯»å–é…ç½®çš„æ–¹å¼ï¼Ÿ</h1><p>Spring Boot å¯ä»¥é€šè¿‡ @PropertySource,@Value,@Environment, @ConfigurationProperties æ¥ç»‘å®šå˜é‡.</p><h1 id="Spring-Boot-æ”¯æŒå“ªäº›æ—¥å¿—æ¡†æ¶ï¼Ÿæ¨èå’Œé»˜è®¤çš„æ—¥å¿—æ¡†æ¶æ˜¯å“ªä¸ªï¼Ÿ"><a href="#Spring-Boot-æ”¯æŒå“ªäº›æ—¥å¿—æ¡†æ¶ï¼Ÿæ¨èå’Œé»˜è®¤çš„æ—¥å¿—æ¡†æ¶æ˜¯å“ªä¸ªï¼Ÿ" class="headerlink" title="Spring Boot æ”¯æŒå“ªäº›æ—¥å¿—æ¡†æ¶ï¼Ÿæ¨èå’Œé»˜è®¤çš„æ—¥å¿—æ¡†æ¶æ˜¯å“ªä¸ªï¼Ÿ"></a>Spring Boot æ”¯æŒå“ªäº›æ—¥å¿—æ¡†æ¶ï¼Ÿæ¨èå’Œé»˜è®¤çš„æ—¥å¿—æ¡†æ¶æ˜¯å“ªä¸ªï¼Ÿ</h1><p>Spring Boot æ”¯æŒ Java Util Logging, Log4j2, Lockback ä½œä¸ºæ—¥å¿—æ¡†æ¶ï¼Œå¦‚æœä½ ä½¿ç”¨ Starters å¯åŠ¨å™¨ï¼ŒSpring Boot å°†ä½¿ç”¨ Logback ä½œä¸ºé»˜è®¤æ—¥å¿—æ¡†æ¶</p><h1 id="SpringBoot-å®ç°çƒ­éƒ¨ç½²æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"><a href="#SpringBoot-å®ç°çƒ­éƒ¨ç½²æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ" class="headerlink" title="SpringBoot å®ç°çƒ­éƒ¨ç½²æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ"></a>SpringBoot å®ç°çƒ­éƒ¨ç½²æœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿ</h1><p>ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><p>Spring Loaded<br>Spring-boot-devtools</p><h1 id="ä½ å¦‚ä½•ç†è§£-Spring-Boot-é…ç½®åŠ è½½é¡ºåºï¼Ÿ"><a href="#ä½ å¦‚ä½•ç†è§£-Spring-Boot-é…ç½®åŠ è½½é¡ºåºï¼Ÿ" class="headerlink" title="ä½ å¦‚ä½•ç†è§£ Spring Boot é…ç½®åŠ è½½é¡ºåºï¼Ÿ"></a>ä½ å¦‚ä½•ç†è§£ Spring Boot é…ç½®åŠ è½½é¡ºåºï¼Ÿ</h1><p>åœ¨ Spring Boot é‡Œé¢ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡ ç§æ–¹å¼æ¥åŠ è½½é…ç½®ã€‚</p><p>1ï¼‰propertiesæ–‡ä»¶ï¼›</p><p>2ï¼‰YAMLæ–‡ä»¶ï¼›</p><p>3ï¼‰ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼›</p><p>4ï¼‰å‘½ä»¤è¡Œå‚æ•°ï¼›<br>â€¦</p><h1 id="Spring-Boot-å¦‚ä½•å®šä¹‰å¤šå¥—ä¸åŒç¯å¢ƒé…ç½®ï¼Ÿ"><a href="#Spring-Boot-å¦‚ä½•å®šä¹‰å¤šå¥—ä¸åŒç¯å¢ƒé…ç½®ï¼Ÿ" class="headerlink" title="Spring Boot å¦‚ä½•å®šä¹‰å¤šå¥—ä¸åŒç¯å¢ƒé…ç½®ï¼Ÿ"></a>Spring Boot å¦‚ä½•å®šä¹‰å¤šå¥—ä¸åŒç¯å¢ƒé…ç½®ï¼Ÿ</h1><p>æä¾›å¤šå¥—é…ç½®æ–‡ä»¶ï¼Œå¦‚ï¼š</p><p>applcation.properties</p><p>application-dev.properties</p><p>application-test.properties</p><p>application-prod.properties<br>è¿è¡Œæ—¶æŒ‡å®šå…·ä½“çš„é…ç½®æ–‡ä»¶</p><h1 id="Spring-Boot-å¯ä»¥å…¼å®¹è€-Spring-é¡¹ç›®å—ï¼Œå¦‚ä½•åšï¼Ÿ"><a href="#Spring-Boot-å¯ä»¥å…¼å®¹è€-Spring-é¡¹ç›®å—ï¼Œå¦‚ä½•åšï¼Ÿ" class="headerlink" title="Spring Boot å¯ä»¥å…¼å®¹è€ Spring é¡¹ç›®å—ï¼Œå¦‚ä½•åšï¼Ÿ"></a>Spring Boot å¯ä»¥å…¼å®¹è€ Spring é¡¹ç›®å—ï¼Œå¦‚ä½•åšï¼Ÿ</h1><p>å¯ä»¥å…¼å®¹ï¼Œä½¿ç”¨ @ImportResource æ³¨è§£å¯¼å…¥è€ Spring é¡¹ç›®é…ç½®æ–‡ä»¶ã€‚</p><h1 id="ä¿æŠ¤-Spring-Boot-åº”ç”¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"><a href="#ä¿æŠ¤-Spring-Boot-åº”ç”¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ" class="headerlink" title="ä¿æŠ¤ Spring Boot åº”ç”¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"></a>ä¿æŠ¤ Spring Boot åº”ç”¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</h1><p>åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨HTTPS<br>ä½¿ç”¨Snykæ£€æŸ¥ä½ çš„ä¾èµ–å…³ç³»<br>å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬<br>å¯ç”¨CSRFä¿æŠ¤<br>ä½¿ç”¨å†…å®¹å®‰å…¨ç­–ç•¥é˜²æ­¢XSSæ”»å‡»<br>â€¦</p><h1 id="Spring-Boot-2-X-æœ‰ä»€ä¹ˆæ–°ç‰¹æ€§ï¼Ÿä¸-1-X-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#Spring-Boot-2-X-æœ‰ä»€ä¹ˆæ–°ç‰¹æ€§ï¼Ÿä¸-1-X-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="Spring Boot 2.X æœ‰ä»€ä¹ˆæ–°ç‰¹æ€§ï¼Ÿä¸ 1.X æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>Spring Boot 2.X æœ‰ä»€ä¹ˆæ–°ç‰¹æ€§ï¼Ÿä¸ 1.X æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1><p>é…ç½®å˜æ›´<br>JDK ç‰ˆæœ¬å‡çº§<br>ç¬¬ä¸‰æ–¹ç±»åº“å‡çº§<br>å“åº”å¼ Spring ç¼–ç¨‹æ”¯æŒ<br>HTTP/2 æ”¯æŒ<br>é…ç½®å±æ€§ç»‘å®š<br>æ›´å¤šæ”¹è¿›ä¸åŠ å¼ºâ€¦</p>]]></content>
      
      
      
        <tags>
            
            <tag> springbootå­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Leetcodeåˆ·é¢˜â€”â€”æœ‰æ•ˆä¸‰è§’å½¢çš„ä¸ªæ•°</title>
      <link href="/2022/01/10/Leetcode%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94%E6%9C%89%E6%95%88%E4%B8%89%E8%A7%92%E5%BD%A2%E7%9A%84%E4%B8%AA%E6%95%B0/"/>
      <url>/2022/01/10/Leetcode%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94%E6%9C%89%E6%95%88%E4%B8%89%E8%A7%92%E5%BD%A2%E7%9A%84%E4%B8%AA%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">* ç»™å®šä¸€ä¸ªåŒ…å«éè´Ÿæ•´æ•°çš„æ•°ç»„ï¼Œä½ çš„ä»»åŠ¡æ˜¯ç»Ÿè®¡å…¶ä¸­å¯ä»¥ç»„æˆä¸‰è§’å½¢ä¸‰æ¡è¾¹çš„ä¸‰å…ƒç»„ä¸ªæ•°ã€‚</span><br><span class="line"> *</span><br><span class="line"> * ç¤ºä¾‹ 1:</span><br><span class="line"> * è¾“å…¥: [2,2,3,4]</span><br><span class="line"> * è¾“å‡º: 3</span><br><span class="line"> * è§£é‡Š:</span><br><span class="line"> * æœ‰æ•ˆçš„ç»„åˆæ˜¯:</span><br><span class="line"> * 2,3,4 (ä½¿ç”¨ç¬¬ä¸€ä¸ª 2)</span><br><span class="line"> * 2,3,4 (ä½¿ç”¨ç¬¬äºŒä¸ª 2)</span><br><span class="line"> * 2,2,3</span><br><span class="line"> *</span><br><span class="line"> * æ³¨æ„:</span><br><span class="line"> * æ•°ç»„é•¿åº¦ä¸è¶…è¿‡1000ã€‚</span><br><span class="line"> * æ•°ç»„é‡Œæ•´æ•°çš„èŒƒå›´ä¸º [0, 1000]ã€‚</span><br><span class="line"> */</span><br></pre></td></tr></table></figure><h1 id="è§£ç­”"><a href="#è§£ç­”" class="headerlink" title="è§£ç­”"></a>è§£ç­”</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yefan.leetcode;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Auther</span>: zq</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span>: 2021/8/4 09:40</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: æœ‰æ•ˆä¸‰è§’å½¢çš„ä¸ªæ•°</span></span><br><span class="line"><span class="comment">public class NumberOfValidTriangles &#123;</span></span><br><span class="line"><span class="comment">    /*</span></span><br><span class="line"><span class="comment">        äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment">        é¦–å…ˆå¯¹æ•°ç»„æ’åºã€‚</span></span><br><span class="line"><span class="comment">        å›ºå®šæœ€çŸ­çš„ä¸¤æ¡è¾¹ï¼ŒäºŒåˆ†æŸ¥æ‰¾æœ€åä¸€ä¸ªå°äºä¸¤è¾¹ä¹‹å’Œçš„ä½ç½®ã€‚å¯ä»¥æ±‚å¾—å›ºå®šä¸¤æ¡è¾¹é•¿ä¹‹å’Œæ»¡è¶³æ¡ä»¶çš„ç»“æœã€‚æšä¸¾ç»“æŸåï¼Œæ€»å’Œå°±æ˜¯ç­”æ¡ˆã€‚</span></span><br><span class="line"><span class="comment">        æ—¶é—´å¤æ‚åº¦ä¸º O(n^2logn)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">triangleNumber</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        <span class="keyword">int</span> n = nums.length;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">2</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n - <span class="number">1</span>; ++j) &#123;</span><br><span class="line">                <span class="keyword">int</span> s = nums[i] + nums[j];</span><br><span class="line">                <span class="keyword">int</span> l = j + <span class="number">1</span>, r = n - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">                    <span class="keyword">int</span> mid = l + r + <span class="number">1</span> &gt;&gt;&gt; <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (nums[mid] &lt; s) l = mid;</span><br><span class="line">                    <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (nums[r] &lt; s) &#123;</span><br><span class="line">                    res += r - j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Leetcodeåˆ·é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVAâ€”åå°„</title>
      <link href="/2022/01/10/JAVA%E2%80%94%E5%8F%8D%E5%B0%84/"/>
      <url>/2022/01/10/JAVA%E2%80%94%E5%8F%8D%E5%B0%84/</url>
      
        <content type="html"><![CDATA[<h1 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h1><blockquote><p>åå°„(Reflection)æ˜¯ Java ç¨‹åºå¼€å‘è¯­è¨€çš„ç‰¹å¾ä¹‹ä¸€ï¼Œå®ƒå…è®¸è¿è¡Œä¸­çš„ Java ç¨‹åºè·å–è‡ªèº«çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥æ“ä½œç±»æˆ–å¯¹è±¡çš„å†…éƒ¨å±æ€§ã€‚</p></blockquote><p><img src="https://s2.loli.net/2022/01/10/lTh9IUbarvERyFw.png" alt="20220110173650"></p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> price;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getPrice</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> price;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPrice</span><span class="params">(<span class="keyword">int</span> price)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.price = price;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//æ­£å¸¸çš„è°ƒç”¨</span></span><br><span class="line">        Apple apple = <span class="keyword">new</span> Apple();</span><br><span class="line">        apple.setPrice(<span class="number">5</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Apple Price:&quot;</span> + apple.getPrice());</span><br><span class="line">        <span class="comment">//ä½¿ç”¨åå°„è°ƒç”¨</span></span><br><span class="line">        Class clz = Class.forName(<span class="string">&quot;com.chenshuyi.api.Apple&quot;</span>);</span><br><span class="line">        Method setPriceMethod = clz.getMethod(<span class="string">&quot;setPrice&quot;</span>, <span class="keyword">int</span>.class);</span><br><span class="line">        Constructor appleConstructor = clz.getConstructor();</span><br><span class="line">        Object appleObj = appleConstructor.newInstance();</span><br><span class="line">        setPriceMethod.invoke(appleObj, <span class="number">14</span>);</span><br><span class="line">        Method getPriceMethod = clz.getMethod(<span class="string">&quot;getPrice&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Apple Price:&quot;</span> + getPriceMethod.invoke(appleObj));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="è·å–åå°„ä¸­çš„Classå¯¹è±¡"><a href="#è·å–åå°„ä¸­çš„Classå¯¹è±¡" class="headerlink" title="è·å–åå°„ä¸­çš„Classå¯¹è±¡"></a>è·å–åå°„ä¸­çš„Classå¯¹è±¡</h1><p>åœ¨åå°„ä¸­ï¼Œè¦è·å–ä¸€ä¸ªç±»æˆ–è°ƒç”¨ä¸€ä¸ªç±»çš„æ–¹æ³•ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦è·å–åˆ°è¯¥ç±»çš„ Class å¯¹è±¡ã€‚</p><p>åœ¨ Java API ä¸­ï¼Œè·å– Class ç±»å¯¹è±¡æœ‰ä¸‰ç§æ–¹æ³•ï¼š</p><p><strong>ç¬¬ä¸€ç§ï¼Œä½¿ç”¨ Class.forName é™æ€æ–¹æ³•ã€‚å½“ä½ çŸ¥é“è¯¥ç±»çš„å…¨è·¯å¾„åæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•è·å– Class ç±»å¯¹è±¡ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Class.forName(<span class="string">&quot;java.lang.String&quot;</span>);</span><br></pre></td></tr></table></figure><p><strong>ç¬¬äºŒç§ï¼Œä½¿ç”¨ .class æ–¹æ³•</strong></p><p>è¿™ç§æ–¹æ³•åªé€‚åˆåœ¨ç¼–è¯‘å‰å°±çŸ¥é“æ“ä½œçš„ Classã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class clz = String.class;</span><br></pre></td></tr></table></figure><p><strong>ç¬¬ä¸‰ç§ï¼Œä½¿ç”¨ç±»å¯¹è±¡çš„ getClass() æ–¹æ³•ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="keyword">new</span> String(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">Class clz = str.getClass();</span><br></pre></td></tr></table></figure><h1 id="é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡"><a href="#é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡" class="headerlink" title="é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡"></a>é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡</h1><p>é€šè¿‡åå°„åˆ›å»ºç±»å¯¹è±¡ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼šé€šè¿‡ Class å¯¹è±¡çš„ newInstance() æ–¹æ³•ã€é€šè¿‡ Constructor å¯¹è±¡çš„ newInstance() æ–¹æ³•ã€‚</p><p>ç¬¬ä¸€ç§ï¼šé€šè¿‡ Class å¯¹è±¡çš„ newInstance() æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Apple apple = (Apple)clz.newInstance();</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§ï¼šé€šè¿‡ Constructor å¯¹è±¡çš„ newInstance() æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Constructor constructor = clz.getConstructor();</span><br><span class="line">Apple apple = (Apple)constructor.newInstance();</span><br></pre></td></tr></table></figure><p>é€šè¿‡ Constructor å¯¹è±¡åˆ›å»ºç±»å¯¹è±¡å¯ä»¥é€‰æ‹©ç‰¹å®šæ„é€ æ–¹æ³•ï¼Œè€Œé€šè¿‡ Class å¯¹è±¡åˆ™åªèƒ½ä½¿ç”¨é»˜è®¤çš„æ— å‚æ•°æ„é€ æ–¹æ³•ã€‚ä¸‹é¢çš„ä»£ç å°±è°ƒç”¨äº†ä¸€ä¸ªæœ‰å‚æ•°çš„æ„é€ æ–¹æ³•è¿›è¡Œäº†ç±»å¯¹è±¡çš„åˆå§‹åŒ–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Constructor constructor = clz.getConstructor(String.class, <span class="keyword">int</span>.class);</span><br><span class="line">Apple apple = (Apple)constructor.newInstance(<span class="string">&quot;çº¢å¯Œå£«&quot;</span>, <span class="number">15</span>);</span><br></pre></td></tr></table></figure><h1 id="é€šè¿‡åå°„è·å–ç±»å±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨"><a href="#é€šè¿‡åå°„è·å–ç±»å±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨" class="headerlink" title="é€šè¿‡åå°„è·å–ç±»å±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨"></a>é€šè¿‡åå°„è·å–ç±»å±æ€§ã€æ–¹æ³•ã€æ„é€ å™¨</h1><p>æˆ‘ä»¬é€šè¿‡ Class å¯¹è±¡çš„ getFields() æ–¹æ³•å¯ä»¥è·å– Class ç±»çš„å±æ€§ï¼Œä½†æ— æ³•è·å–ç§æœ‰å±æ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Field[] fields = clz.getFields();</span><br><span class="line"><span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">    System.out.println(field.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœæ˜¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">price</span><br></pre></td></tr></table></figure><p>è€Œå¦‚æœä½¿ç”¨ Class å¯¹è±¡çš„ getDeclaredFields() æ–¹æ³•åˆ™å¯ä»¥è·å–åŒ…æ‹¬ç§æœ‰å±æ€§åœ¨å†…çš„æ‰€æœ‰å±æ€§ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class clz = Apple.class;</span><br><span class="line">Field[] fields = clz.getDeclaredFields();</span><br><span class="line"><span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">    System.out.println(field.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœæ˜¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name</span><br><span class="line">price</span><br></pre></td></tr></table></figure><p>ä¸è·å–ç±»å±æ€§ä¸€æ ·ï¼Œå½“æˆ‘ä»¬å»è·å–ç±»æ–¹æ³•ã€ç±»æ„é€ å™¨æ—¶ï¼Œå¦‚æœè¦è·å–ç§æœ‰æ–¹æ³•æˆ–ç§æœ‰æ„é€ å™¨ï¼Œåˆ™å¿…é¡»ä½¿ç”¨æœ‰ declared å…³é”®å­—çš„æ–¹æ³•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> javaåŸºç¡€çŸ¥è¯† </tag>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nginxè®¿é—®é€Ÿåº¦ä¸å¹¶å‘æ•°çš„é™åˆ¶</title>
      <link href="/2022/01/10/nginx%E8%AE%BF%E9%97%AE%E9%80%9F%E5%BA%A6%E4%B8%8E%E5%B9%B6%E5%8F%91%E6%95%B0%E7%9A%84%E9%99%90%E5%88%B6/"/>
      <url>/2022/01/10/nginx%E8%AE%BF%E9%97%AE%E9%80%9F%E5%BA%A6%E4%B8%8E%E5%B9%B6%E5%8F%91%E6%95%B0%E7%9A%84%E9%99%90%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="é™åˆ¶å¹¶å‘æ•°"><a href="#é™åˆ¶å¹¶å‘æ•°" class="headerlink" title="é™åˆ¶å¹¶å‘æ•°"></a>é™åˆ¶å¹¶å‘æ•°</h1><p>åœ¨nginxçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">http&#123;</span><br><span class="line">    limit_conn_zone $binary_remote_addr zone=one:10m;</span><br><span class="line">    ...</span><br><span class="line">    service&#123;</span><br><span class="line">        ...</span><br><span class="line">        location xxx&#123;</span><br><span class="line">            limit_conn one 1;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/10/zdIQgU5R2BDPyoG.png" alt="20220110133505"><br>è¿™é‡Œè®¾ç½®çš„å¹¶å‘æ•°ä¸º 1ï¼Œè¡¨ç¤ºåŒä¸€ä¸ªipçš„å¹¶å‘è®¿é—®æ•°ä¸º1 é…ç½®å¥½åï¼Œé‡å¯nginxå³å¯ã€‚</p><h1 id="é™åˆ¶è®¿é—®é€Ÿåº¦"><a href="#é™åˆ¶è®¿é—®é€Ÿåº¦" class="headerlink" title="é™åˆ¶è®¿é—®é€Ÿåº¦"></a>é™åˆ¶è®¿é—®é€Ÿåº¦</h1><p>åœ¨nginxé…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location xxx &#123;</span><br><span class="line">    limit_rate 100k;</span><br><span class="line">    ...</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/01/10/HusKzPQwWaByOgc.png" alt="20220110133605"><br>é‡å¯nginxåï¼Œå¯ä»¥å‘ç°ä¸‹è½½é€Ÿåº¦ï¼Œç¡®å®è¢«é™åˆ¶åœ¨ 100k/s å·¦å³<br><img src="https://s2.loli.net/2022/01/10/GvflQEUB6p8F7r9.png" alt="20220110133620"></p><h1 id="æ‰©å±•"><a href="#æ‰©å±•" class="headerlink" title="æ‰©å±•"></a>æ‰©å±•</h1><p>è¿™é‡Œä»‹ç»çš„æ˜¯å¯¹å•ä¸ªipè¿›è¡Œè®¿é—®é™åˆ¶ï¼Œå¦‚æœè¯´æƒ³å¯¹æ€»çš„è®¿é—®è¿›è¡Œé™åˆ¶ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š</p><blockquote><p>é€šè¿‡nginxçš„è¯·æ±‚è½¬å‘åŠŸèƒ½ï¼Œå°†æ‰€æœ‰çš„è¯·æ±‚è½¬å‘åˆ°å¦å¤–ä¸€ä¸ªç«¯å£ï¼Œè€Œåç›´æ¥å¯¹å›¾ç¤ºä¸­8889ç«¯å£è¿›è¡Œå¦‚ä¸Šçš„é™åˆ¶å³å¯<br><img src="https://s2.loli.net/2022/01/10/1awvyOJbl4WqIRM.png" alt="20220110133657"></p></blockquote><p>é…ç½®å…¥ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">limit_conn_zone $binary_remote_addr zone=one:10m;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 8888;</span><br><span class="line">        server_name localhost;</span><br><span class="line">    ...</span><br><span class="line">        location ~/grouptest/M0[0-9] &#123;</span><br><span class="line">            proxy_pass http://&lt;æœ¬æœºip&gt;:8889;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    server &#123;</span><br><span class="line">        listen 8889;</span><br><span class="line">        server_name localhost;</span><br><span class="line">        location xxx &#123;</span><br><span class="line">            limit_conn one 1;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å„ä¸­é—´ä»¶çš„exporterç›‘æ§å¯¹æ¥åˆ°prometheus</title>
      <link href="/2022/01/10/%E5%90%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84exporter%E7%9B%91%E6%8E%A7%E5%AF%B9%E6%8E%A5%E5%88%B0prometheus/"/>
      <url>/2022/01/10/%E5%90%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84exporter%E7%9B%91%E6%8E%A7%E5%AF%B9%E6%8E%A5%E5%88%B0prometheus/</url>
      
        <content type="html"><![CDATA[<h1 id="å„ä¸­é—´ä»¶exporterå¯¹æ¥åˆ°prometheusçš„æ–¹å¼"><a href="#å„ä¸­é—´ä»¶exporterå¯¹æ¥åˆ°prometheusçš„æ–¹å¼" class="headerlink" title="å„ä¸­é—´ä»¶exporterå¯¹æ¥åˆ°prometheusçš„æ–¹å¼"></a>å„ä¸­é—´ä»¶exporterå¯¹æ¥åˆ°prometheusçš„æ–¹å¼</h1><p>ç›‘æ§åŸç†ï¼šä½¿ç”¨prometheusç›‘æ§å„ç±»ä¸­é—´ä»¶ï¼Œåˆ™éœ€è¦éƒ¨ç½²å¯¹åº”ä¸­é—´ä»¶çš„exporterï¼Œå†å°†exporteræš´éœ²çš„æŒ‡æ ‡åœ°å€å‘ŠçŸ¥prometheuså³å¯<br>é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“å¦‚ä½•å°†æš´éœ²çš„åœ°å€å‘ŠçŸ¥prometheusï¼Œä¸»è¦æœ‰å¦‚ä¸‹é›†ä¸­æ–¹å¼ï¼š</p><ol><li>ä¿®æ”¹prometheusé…ç½®æ–‡ä»¶çš„æ–¹å¼</li><li>ä¿®æ”¹é™æ€æ–‡ä»¶çš„æ–¹å¼</li><li>ä½¿ç”¨httpdæ–¹å¼</li><li>ä½¿ç”¨æ³¨å†Œä¸­å¿ƒçš„æ–¹å¼</li></ol><p>è¿™é‡Œåªæåˆ°ä¿®æ”¹prometheusé…ç½®æ–‡ä»¶çš„æ–¹å¼å’Œé™æ€æ–‡ä»¶çš„æ–¹å¼ï¼ˆå…¶ä»–æ–¹å¼å¯ä»¥é˜…è¯»prometheusçš„å®˜ç½‘ï¼‰</p><p>ä¿®æ”¹prometheusé…ç½®æ–‡ä»¶å¦‚ä¸‹å†…å®¹:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;node_exporter&#x27;</span> </span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">8s</span>     <span class="comment"># é‡‡é›†æ—¶é—´é—´éš”</span></span><br><span class="line">    <span class="attr">file_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">files:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">node_exporter.json</span>  <span class="comment"># æŒ‡å®šé™æ€é…ç½®æ–‡ä»¶</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">10s</span> <span class="comment"># åˆ·æ–°é…ç½®æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;redis_exporter&#x27;</span> </span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">8s</span>     <span class="comment"># é‡‡é›†æ—¶é—´é—´éš”</span></span><br><span class="line">    <span class="attr">file_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">files:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis_exporter.json</span>  <span class="comment"># æŒ‡å®šé™æ€é…ç½®æ–‡ä»¶</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">10s</span> <span class="comment"># åˆ·æ–°é…ç½®æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;mysql_exporter&#x27;</span> </span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">8s</span>     <span class="comment"># é‡‡é›†æ—¶é—´é—´éš”</span></span><br><span class="line">    <span class="attr">file_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">files:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_exporter.json</span>  <span class="comment"># æŒ‡å®šé™æ€é…ç½®æ–‡ä»¶</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">10s</span> <span class="comment"># åˆ·æ–°é…ç½®æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;zookeeper_exporter&#x27;</span> </span><br><span class="line">    <span class="attr">scrape_interval:</span> <span class="string">8s</span>     <span class="comment"># é‡‡é›†æ—¶é—´é—´éš”</span></span><br><span class="line">    <span class="attr">file_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">files:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">zookeeper_exporter.json</span>  <span class="comment"># æŒ‡å®šé™æ€é…ç½®æ–‡ä»¶</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">10s</span> <span class="comment"># åˆ·æ–°é…ç½®æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ....ä»¥æ­¤ç±»æ¨ï¼Œå¾—å‡ºå…¶ä»–ä¸­é—´ä»¶exporterçš„é…ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä¸­ç‰¹æ®Šexporterçš„é…ç½®å¦‚ä¸‹</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;blackbox-exporter&#x27;</span></span><br><span class="line">    <span class="attr">metrics_path:</span> <span class="string">/probe</span></span><br><span class="line">    <span class="attr">params:</span></span><br><span class="line">      <span class="attr">module:</span> [<span class="string">icmp</span>]  <span class="comment"># ç½‘ç»œæ¢æµ‹ç±»å‹</span></span><br><span class="line">    <span class="attr">static_configs:</span></span><br><span class="line"><span class="comment"># æ¢æµ‹ç›®æ ‡èŠ‚ç‚¹</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.18.40.xxx&#x27;</span>,<span class="string">&#x27;172.18.40.xx1&#x27;</span>,<span class="string">&#x27;172.18.40.xx3&#x27;</span>,<span class="string">&#x27;172.18.40.xx4&#x27;</span>,<span class="string">&#x27;172.18.40.xx5&#x27;</span>]</span><br><span class="line">        <span class="attr">labels:</span></span><br><span class="line">          <span class="attr">group:</span> <span class="string">&#x27;172.26.42.123&#x27;</span>  <span class="comment"># è‡ªå®šä¹‰æ ‡ç­¾</span></span><br><span class="line">    <span class="attr">relabel_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__address__</span>]</span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">__param_target</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">source_labels:</span> [<span class="string">__param_target</span>]</span><br><span class="line">        <span class="attr">target_label:</span> <span class="string">instance</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">target_label:</span> <span class="string">__address__</span></span><br><span class="line">        <span class="attr">replacement:</span> <span class="number">172.26</span><span class="number">.42</span><span class="number">.123</span><span class="string">:9115</span>  <span class="comment"># blackbox-exporter çœŸå®éƒ¨ç½²çš„æœåŠ¡å™¨åœ°å€ ip:port</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è€Œè¿™äº›é™æ€é…ç½®æ–‡ä»¶çš„æ ¼å¼å¦‚ä¸‹ï¼šè¿™é‡Œä»¥node_exporter.jsonä¸ºä¾‹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;targets&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;172.18.40.xxx:9100&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">&quot;labels&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;acc&quot;</span>: <span class="string">&quot;acc1/acc2&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">&quot;targets&quot;</span>: [</span><br><span class="line">            <span class="string">&quot;172.18.40.xx1:9100&quot;</span></span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">&quot;labels&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;acc&quot;</span>: <span class="string">&quot;acc2/acc3&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°†éƒ¨ç½²çš„exporteræœåŠ¡å‘ŠçŸ¥prometheusçš„é…ç½®æ–¹å¼ï¼Œé…ç½®å¥½åï¼Œé‡å¯prometheuså³å¯ã€‚</p><h1 id="éƒ¨ç½²å„ç±»ä¸­é—´ä»¶çš„exporter"><a href="#éƒ¨ç½²å„ç±»ä¸­é—´ä»¶çš„exporter" class="headerlink" title="éƒ¨ç½²å„ç±»ä¸­é—´ä»¶çš„exporter"></a>éƒ¨ç½²å„ç±»ä¸­é—´ä»¶çš„exporter</h1><h2 id="Mysql-exporter"><a href="#Mysql-exporter" class="headerlink" title="Mysql-exporter"></a>Mysql-exporter</h2><ul><li><strong>éƒ¨ç½²å¯åŠ¨</strong>  é¦–å…ˆå¡«å†™mysqlç›¸å…³çš„é…ç½®ï¼Œä¿å­˜åœ¨ my.cnfæ–‡ä»¶ä¸­  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">client</span>]</span><br><span class="line"><span class="string">host=127.0.0.1</span></span><br><span class="line"><span class="string">port=3306</span></span><br><span class="line"><span class="string">user=exporter</span></span><br><span class="line"><span class="string">password=123456</span></span><br></pre></td></tr></table></figure>  ç„¶åï¼Œå¯åŠ¨mysql-exporterï¼Œå¹¶é€šè¿‡config.my-cnfæŒ‡å®šä¸Šé¢çš„é…ç½®æ–‡ä»¶  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤å‚æ•°å¯åŠ¨</span></span><br><span class="line"><span class="string">./mysqld_exporter</span>  <span class="string">--config.my-cnf=/usr/local/prometheus/mysqld_exporter-0.12.1.linux-amd64/my.cnf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯¦ç»†çš„å‚æ•°</span></span><br><span class="line"><span class="string">./mysqld_exporter</span> <span class="string">--web.listen-address=0.0.0.0:9104</span> <span class="string">--config.my-cnf=/usr/local/prometheus/mysqld_exporter-0.12.1.linux-amd64/my.cnf</span> <span class="string">--collect.slave_status</span> <span class="string">--collect.slave_hosts</span> <span class="string">--log.level=error</span>  <span class="string">--collect.info_schema.processlist</span> <span class="string">--collect.info_schema.innodb_metrics</span> <span class="string">--collect.info_schema.innodb_tablespaces</span> <span class="string">--collect.info_schema.innodb_cmp</span> <span class="string">--collect.info_schema.innodb_cmpmem</span></span><br></pre></td></tr></table></figure></li></ul><h2 id="redis-exporter"><a href="#redis-exporter" class="headerlink" title="redis-exporter"></a>redis-exporter</h2><p><strong>éƒ¨ç½²å¯åŠ¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis_exporter  -redis.addr 127.0.0.1:6379  -redis.password 123456 -web.listen-address 0.0.0.0:9121</span><br></pre></td></tr></table></figure><h2 id="nginx-prometheus-exporter"><a href="#nginx-prometheus-exporter" class="headerlink" title="nginx-prometheus-exporter"></a>nginx-prometheus-exporter</h2><p><strong>å‰ææ¡ä»¶</strong></p><p>ä½¿ç”¨nginx-prometheus-exporterç›‘æ§nginxæ—¶ï¼Œè¯¥nginxå¿…é¡»è¦å¼€å¯stub_statusåŠŸèƒ½</p><p>å¼€å¯ NGINX stub_status åŠŸèƒ½</p><ol><li>å¼€æº Nginx æä¾›ä¸€ä¸ªç®€å•é¡µé¢ç”¨äºå±•ç¤ºçŠ¶æ€æ•°æ®ï¼Œè¯¥é¡µé¢ç”±Â <a href="http://nginx.org/en/docs/http/ngx_http_stub_status_module.html">tub_status</a>Â æ¨¡å—æä¾›ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ Nginx æ˜¯å¦å·²ç»å¼€å¯äº†è¯¥æ¨¡å—ï¼š <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -V 2&gt;&amp;1 | grep -o with-http_stub_status_module</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœåœ¨ç»ˆç«¯ä¸­è¾“å‡ºÂ <code>with-http_stub_status_module</code>Â ï¼Œåˆ™è¯´æ˜ Nginx å·²å¯ç”¨ tub_status æ¨¡å—ã€‚</li><li>å¦‚æœæœªè¾“å‡ºä»»ä½•ç»“æœï¼Œåˆ™å¯ä»¥ä½¿ç”¨Â <code>-with-http_stub_status_module</code>Â å‚æ•°ä»æºç é‡æ–°é…ç½®ç¼–è¯‘ä¸€ä¸ª Nginxã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">./configure \</span><br><span class="line">â€¦ \</span><br><span class="line">--with-http_stub_status_module</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure></li></ul></li><li>ç¡®è®¤ stub_status æ¨¡å—å¯ç”¨ä¹‹åï¼Œä¿®æ”¹ Nginx çš„é…ç½®æ–‡ä»¶æŒ‡å®š status é¡µé¢çš„ URLã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    location /nginx_status &#123;</span><br><span class="line">        stub_status;</span><br><span class="line"></span><br><span class="line">        access_log off;</span><br><span class="line">        allow 127.0.0.1;</span><br><span class="line">        deny all;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>æ£€æŸ¥å¹¶é‡æ–°åŠ è½½ nginx çš„é…ç½®ä½¿å…¶ç”Ÿæ•ˆã€‚ <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx -t</span><br><span class="line">nginx -s reload</span><br></pre></td></tr></table></figure></li><li>å®Œæˆä¸Šè¿°æ­¥ä¹‹åï¼Œå¯ä»¥é€šè¿‡é…ç½®çš„ URL æŸ¥çœ‹ Nginx çš„æŒ‡æ ‡ï¼š <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Active connections: 45</span><br><span class="line">server accepts handled requests</span><br><span class="line">1056958 1156958 4491319</span><br><span class="line">Reading: 0 Writing: 25 Waiting : 7</span><br></pre></td></tr></table></figure></li></ol><p><strong>éƒ¨ç½²å¯åŠ¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx-prometheus-exporter -nginx.scrape-uri=http://&lt;nginx&gt;:8080/stub_status</span><br></pre></td></tr></table></figure><h2 id="zookeeper-exporter"><a href="#zookeeper-exporter" class="headerlink" title="zookeeper-exporter"></a>zookeeper-exporter</h2><p><strong>å¯åŠ¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./zookeeper_exporter -zookeeper 127.0.0.1:2181 -bind-addr :9143</span><br></pre></td></tr></table></figure><h2 id="elasticsearch-exporter"><a href="#elasticsearch-exporter" class="headerlink" title="elasticsearch-exporter"></a>elasticsearch-exporter</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line">--es.uri         ã€€ã€€ã€€ã€€é»˜è®¤http://localhost:9200ï¼Œè¿æ¥åˆ°çš„ElasticsearchèŠ‚ç‚¹çš„åœ°å€ï¼ˆä¸»æœºå’Œç«¯å£ï¼‰ã€‚ è¿™å¯ä»¥æ˜¯æœ¬åœ°èŠ‚ç‚¹ï¼ˆä¾‹å¦‚localhostï¼š9200ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯è¿œç¨‹ElasticsearchæœåŠ¡å™¨çš„åœ°å€</span><br><span class="line">--es.all                é»˜è®¤flaseï¼Œå¦‚æœä¸º<span class="literal">true</span>ï¼Œåˆ™æŸ¥è¯¢ç¾¤é›†ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œè€Œä¸ä»…ä»…æ˜¯æŸ¥è¯¢æˆ‘ä»¬è¿æ¥åˆ°çš„èŠ‚ç‚¹ã€‚</span><br><span class="line">--es.cluster_settings   é»˜è®¤flaseï¼Œå¦‚æœä¸º<span class="literal">true</span>ï¼Œè¯·åœ¨ç»Ÿè®¡ä¿¡æ¯ä¸­æŸ¥è¯¢é›†ç¾¤è®¾ç½®</span><br><span class="line">--es.indices            é»˜è®¤flaseï¼Œå¦‚æœä¸º<span class="literal">true</span>ï¼Œåˆ™æŸ¥è¯¢ç»Ÿè®¡ä¿¡æ¯ä»¥è·å–é›†ç¾¤ä¸­çš„æ‰€æœ‰ç´¢å¼•ã€‚</span><br><span class="line">--es.indices_settings   é»˜è®¤flaseï¼Œå¦‚æœä¸º<span class="literal">true</span>ï¼Œåˆ™æŸ¥è¯¢é›†ç¾¤ä¸­æ‰€æœ‰ç´¢å¼•çš„è®¾ç½®ç»Ÿè®¡ä¿¡æ¯ã€‚</span><br><span class="line">--es.shards             é»˜è®¤flaseï¼Œå¦‚æœä¸º<span class="literal">true</span>ï¼Œåˆ™æŸ¥è¯¢é›†ç¾¤ä¸­æ‰€æœ‰ç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆ†ç‰‡çº§ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ„å‘³ç€es.indices = <span class="literal">true</span>ï¼‰ã€‚</span><br><span class="line">--es.snapshots          é»˜è®¤flaseï¼Œå¦‚æœä¸º<span class="literal">true</span>ï¼Œåˆ™æŸ¥è¯¢é›†ç¾¤å¿«ç…§çš„ç»Ÿè®¡ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²å¯åŠ¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># esé›†ç¾¤1ï¼š10.xxx.xxx.10:9200</span></span><br><span class="line">./elasticsearch_exporter --es.all --es.indices --es.cluster_settings --es.indices_settings --es.shards --es.snapshots --es.timeout=10s --web.listen-address=<span class="string">&quot;:9114&quot;</span> --web.telemetry-path=<span class="string">&quot;/metrics&quot;</span> --es.uri http://10.xxx.xxx.10:9200</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœesé›†ç¾¤å¼€å¯äº†x-packéªŒè¯åˆ™å¯ä»¥ä½¿ç”¨å¦‚ä¸‹</span></span><br><span class="line">./elasticsearch_exporter --es.all --es.indices --es.cluster_settings --es.indices_settings --es.shards --es.snapshots  --es.uri http://ç”¨æˆ·å:å¯†ç @111.xxx.xxx.6:9200</span><br></pre></td></tr></table></figure><h2 id="kafka-exporter"><a href="#kafka-exporter" class="headerlink" title="kafka-exporter"></a>kafka-exporter</h2><p><strong>éƒ¨ç½²å¯åŠ¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./kafka_exporter --web.listen-address=9308 --kafka.server=kafka:9092 [--kafka.server=another-server ...]</span><br></pre></td></tr></table></figure><p>Grafana Dashboard ID: 7589, name: Kafka Exporter Overview.</p><h2 id="postgresql-exporter"><a href="#postgresql-exporter" class="headerlink" title="postgresql-exporter"></a>postgresql-exporter</h2><p><strong>éƒ¨ç½²å¯åŠ¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">./postgres_exporter &lt;flags&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸¾ä¾‹</span></span><br><span class="line"><span class="comment"># è®¾ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line">DATA_SOURCE_NAME=<span class="string">&quot;postgresql://postgres:password@localhost:5432/postgres?sslmode=disable&quot;</span></span><br><span class="line"><span class="comment"># å¯åŠ¨ï¼ŒæŒ‡å®šç«¯å£</span></span><br><span class="line">./postgres_exporter --web.listen-address=9187</span><br></pre></td></tr></table></figure><h3 id="Flags"><a href="#Flags" class="headerlink" title="Flags"></a><strong>Flags</strong></h3><ul><li><code>help</code>Â Show context-sensitive help (also try â€“help-long and â€“help-man).</li><li><code>web.listen-address</code>Â Address to listen on for web interface and telemetry. Default isÂ <code>:9187</code>.</li><li><code>web.telemetry-path</code>Â Path under which to expose metrics. Default isÂ <code>/metrics</code>.</li><li><code>disable-default-metrics</code>Â Use only metrics supplied fromÂ <code>queries.yaml</code>Â viaÂ <code>-extend.query-path</code>.</li><li><code>disable-settings-metrics</code>Â Use the flag if you donâ€™t want to scrapeÂ <code>pg_settings</code>.</li><li><code>auto-discover-databases</code>Â Whether to discover the databases on a server dynamically.</li><li><code>extend.query-path</code>Â Path to a YAML file containing custom queries to run. Check outÂ <code>[queries.yaml](https://github.com/prometheus-community/postgres_exporter/blob/master/queries.yaml)</code>Â for examples of the format.</li><li><code>dumpmaps</code>Â Do not run - print the internal representation of the metric maps. Useful when debugging a custom queries file.</li><li><code>constantLabels</code>Â Labels to set in all metrics. A list ofÂ <code>label=value</code>Â pairs, separated by commas.</li><li><code>version</code>Â Show application version.</li><li><code>exclude-databases</code>Â A list of databases to remove when autoDiscoverDatabases is enabled.</li><li><code>include-databases</code>Â A list of databases to only include when autoDiscoverDatabases is enabled.</li><li><code>log.level</code>Â Set logging level: one ofÂ <code>debug</code>,Â <code>info</code>,Â <code>warn</code>,Â <code>error</code>.</li><li><code>log.format</code>Â Set the log format: one ofÂ <code>logfmt</code>,Â <code>json</code>.</li><li><code>web.config.file</code>Â Configuration file to use TLS and/or basic authentication. The format of the file is describedÂ <a href="https://github.com/prometheus/exporter-toolkit/blob/master/docs/web-configuration.md">in the exporter-toolkit repository</a>.</li></ul><h3 id="Environment-Variables"><a href="#Environment-Variables" class="headerlink" title="Environment Variables"></a><strong>Environment Variables</strong></h3><p>The following environment variables configure the exporter:</p><ul><li><code>DATA_SOURCE_NAME</code>Â the default legacy format. Accepts URI form and key=value form arguments. The URI may contain the username and password to connect with.</li><li><code>DATA_SOURCE_URI</code>Â an alternative toÂ <code>DATA_SOURCE_NAME</code>Â which exclusively accepts the hostname without a username and password component. For example,Â <code>my_pg_hostname</code>Â orÂ <code>my_pg_hostname?sslmode=disable</code>.</li><li><code>DATA_SOURCE_URI_FILE</code>Â The same as above but reads the URI from a file.</li><li><code>DATA_SOURCE_USER</code>Â When usingÂ <code>DATA_SOURCE_URI</code>, this environment variable is used to specify the username.</li><li><code>DATA_SOURCE_USER_FILE</code>Â The same, but reads the username from a file.</li><li><code>DATA_SOURCE_PASS</code>Â When usingÂ <code>DATA_SOURCE_URI</code>, this environment variable is used to specify the password to connect with.</li><li><code>DATA_SOURCE_PASS_FILE</code>Â The same as above but reads the password from a file.</li><li><code>PG_EXPORTER_WEB_LISTEN_ADDRESS</code>Â Address to listen on for web interface and telemetry. Default isÂ <code>:9187</code>.</li><li><code>PG_EXPORTER_WEB_TELEMETRY_PATH</code>Â Path under which to expose metrics. Default isÂ <code>/metrics</code>.</li><li><code>PG_EXPORTER_DISABLE_DEFAULT_METRICS</code>Â Use only metrics supplied fromÂ <code>queries.yaml</code>. Value can beÂ <code>true</code>Â orÂ <code>false</code>. Default isÂ <code>false</code>.</li><li><code>PG_EXPORTER_DISABLE_SETTINGS_METRICS</code>Â Use the flag if you donâ€™t want to scrapeÂ <code>pg_settings</code>. Value can beÂ <code>true</code>Â orÂ <code>false</code>. Default isÂ <code>false</code>.</li><li><code>PG_EXPORTER_AUTO_DISCOVER_DATABASES</code>Â Whether to discover the databases on a server dynamically. Value can beÂ <code>true</code>Â orÂ <code>false</code>. Default isÂ <code>false</code>.</li><li><code>PG_EXPORTER_EXTEND_QUERY_PATH</code>Â Path to a YAML file containing custom queries to run. Check outÂ <code>[queries.yaml](https://github.com/prometheus-community/postgres_exporter/blob/master/queries.yaml)</code>Â for examples of the format.</li><li><code>PG_EXPORTER_CONSTANT_LABELS</code>Â Labels to set in all metrics. A list ofÂ <code>label=value</code>Â pairs, separated by commas.</li><li><code>PG_EXPORTER_EXCLUDE_DATABASES</code>Â A comma-separated list of databases to remove when autoDiscoverDatabases is enabled. Default is empty string.</li><li><code>PG_EXPORTER_INCLUDE_DATABASES</code>Â A comma-separated list of databases to only include when autoDiscoverDatabases is enabled. Default is empty string, means allow all.</li><li><code>PG_EXPORTER_METRIC_PREFIX</code>Â A prefix to use for each of the default metrics exported by postgres-exporter. Default isÂ <code>pg</code></li></ul><h2 id="bind-exporter"><a href="#bind-exporter" class="headerlink" title="bind-exporter"></a>bind-exporter</h2><p><strong>éƒ¨ç½²å¯åŠ¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">./bind_exporter \</span><br><span class="line">    --bind.pid-file=/var/run/named/named.pid \</span><br><span class="line">    --bind.timeout=20s \</span><br><span class="line">    --web.listen-address=0.0.0.0:9153 \</span><br><span class="line">    --web.telemetry-path=/metrics \</span><br><span class="line">    --bind.stats-url=http://localhost:8053/ \</span><br><span class="line">    --bind.stats-groups=server,view,tasks</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> äº‘ç›‘æ§ </tag>
            
            <tag> exporter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo butterfly ä¸»é¢˜æœç´¢æ¡†é—®é¢˜è§£å†³</title>
      <link href="/2022/01/10/hexo-butterfly-%E4%B8%BB%E9%A2%98%E6%90%9C%E7%B4%A2%E6%A1%86%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"/>
      <url>/2022/01/10/hexo-butterfly-%E4%B8%BB%E9%A2%98%E6%90%9C%E7%B4%A2%E6%A1%86%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<h1 id="é—®é¢˜è¯´æ˜"><a href="#é—®é¢˜è¯´æ˜" class="headerlink" title="é—®é¢˜è¯´æ˜"></a>é—®é¢˜è¯´æ˜</h1><p>hexo æœ¬åœ°å¯åŠ¨ä¸ªäººåšå®¢ï¼Œè®¿é—®æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯å‘å¸ƒåˆ°githubåï¼Œå°±ä¼šå‡ºç°æœç´¢æ¡†è·‘åˆ°ç•Œé¢çš„æœ€ä¸‹æ–¹<br><img src="https://s2.loli.net/2022/01/10/w8VWauQoRDkdi2p.png" alt="20220110085037"></p><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><p>é€šè¿‡æŸ¥è¯¢èµ„æ–™ï¼Œå‘ç°æ˜¯è‡ªå·±æ²¡æœ‰åœ¨æœ¬åœ°æ‰§è¡Œ <code>hexo clean</code>æ“ä½œå¯¼è‡´çš„ï¼›<br>å‚è€ƒç½‘å€ï¼š<a href="https://github.com/jerryc127/hexo-theme-butterfly/issues/101">https://github.com/jerryc127/hexo-theme-butterfly/issues/101</a><br><img src="https://s2.loli.net/2022/01/10/u587eHsJTXi9tOK.png" alt="20220110084225"></p>]]></content>
      
      
      
        <tags>
            
            <tag> ä¸ªäººåšå®¢é—®é¢˜ </tag>
            
            <tag> butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>picgoé…åˆSMMSæ„å»ºè‡ªå·±å…è´¹çš„å›¾åºŠ</title>
      <link href="/2022/01/07/picgo%E9%85%8D%E5%90%88SMMS%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E5%85%8D%E8%B4%B9%E7%9A%84%E5%9B%BE%E5%BA%8A/"/>
      <url>/2022/01/07/picgo%E9%85%8D%E5%90%88SMMS%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E5%85%8D%E8%B4%B9%E7%9A%84%E5%9B%BE%E5%BA%8A/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨SMMSä¸­æ³¨å†Œè´¦æˆ·"><a href="#åœ¨SMMSä¸­æ³¨å†Œè´¦æˆ·" class="headerlink" title="åœ¨SMMSä¸­æ³¨å†Œè´¦æˆ·"></a>åœ¨SMMSä¸­æ³¨å†Œè´¦æˆ·</h1><ol><li><p>æ³¨å†Œè´¦æˆ·ï¼Œsmmsçš„è®¿é—®åœ°å€ï¼š <a href="https://sm.ms/">https://sm.ms/</a></p></li><li><p>æ³¨å†Œå¥½ä¹‹åï¼Œè·å–smmsä¸­çš„tokenå€¼<br><img src="https://s2.loli.net/2022/01/07/ha8fmXuCFEv5QBg.png" alt="20220107171943"></p></li></ol><h1 id="åœ¨vsCodeä¸­ä½¿ç”¨picGo"><a href="#åœ¨vsCodeä¸­ä½¿ç”¨picGo" class="headerlink" title="åœ¨vsCodeä¸­ä½¿ç”¨picGo"></a>åœ¨vsCodeä¸­ä½¿ç”¨picGo</h1><ol><li><p>å®‰è£…picGoæ’ä»¶<br><img src="https://s2.loli.net/2022/01/07/deWqRhsKSLGtYcC.png" alt="20220107172133"></p></li><li><p>ä¿®æ”¹é…ç½®ï¼Œæœç´¢smmsï¼Œå¡«å†™è‡ªå·±çš„smmsä¸­çš„tokenå€¼<br><img src="https://s2.loli.net/2022/01/07/1qBlGF5Wj9N2cyQ.png" alt="20220107172339"></p></li><li><p>ä¿å­˜åï¼Œå³å¯ä¸Šä¼ æ–‡ä»¶ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</p><p> â‘  æˆªå›¾æ“ä½œåï¼Œå›¾ç‰‡ä¿å­˜åœ¨äº†ç²˜è´´æ¿ä¸­</p><p> â‘¡ mac ç”¨æˆ·çš„ä¸Šä¼ å›¾ç‰‡çš„å¿«æ·é”®æ˜¯ï¼šoption + command + u </p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">windowns ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡çš„å¿«æ·é”®ï¼šctrl + alt + u</span><br></pre></td></tr></table></figure><p> â‘¢ ä¸Šä¼ åï¼Œvscodeç•Œé¢çš„åˆä¸‹è§’å¯çœ‹åˆ°å¦‚ä¸‹æµ®åŠ¨çª—å£<br> <img src="https://s2.loli.net/2022/01/07/UCAwFmLlMVyqbvE.png" alt="20220107173047"></p><p> â‘£ å¹¶åœ¨smmsä¸­å¯ä»¥çœ‹åˆ°ä¸Šä¼ çš„å›¾ç‰‡<br> <img src="https://s2.loli.net/2022/01/07/TxtDJSEngwjsbXo.png" alt="20220107173128"></p></li></ol><h1 id="å‚è€ƒç½‘å€"><a href="#å‚è€ƒç½‘å€" class="headerlink" title="å‚è€ƒç½‘å€"></a>å‚è€ƒç½‘å€</h1><p>ã€å›¾åºŠæ­é… PicGoï¼šæ‰“é€ é«˜æ•ˆçš„å›¾ç‰‡å¤„ç†å·¥ä½œæµã€‘<a href="https://sspai.com/post/65716">https://sspai.com/post/65716</a><br>ã€æ¯”PicGoæ›´å¥½ç”¨çš„æ˜¯VSCodeé‡Œçš„PicGoæ’ä»¶ã€‘<a href="https://kouss.com/2019-7-11">https://kouss.com/2019-7-11</a><br>ã€SMMSç½‘å€ã€‘<a href="https://sm.ms/">https://sm.ms/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> picgo </tag>
            
            <tag> å›¾åºŠ </tag>
            
            <tag> SMMS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€BUGè®°å½•ã€‘Javaè¿æ¥mysqlæ•°æ®åº“æŠ¥é”™ï¼šCommunications link failure</title>
      <link href="/2022/01/07/Java%E8%BF%9E%E6%8E%A5mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%A5%E9%94%99%EF%BC%9ACommunications-link-failure/"/>
      <url>/2022/01/07/Java%E8%BF%9E%E6%8E%A5mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%A5%E9%94%99%EF%BC%9ACommunications-link-failure/</url>
      
        <content type="html"><![CDATA[<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><p>javaé¡¹ç›®ï¼ˆspringbootï¼‰è¿æ¥mysqlå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p><p><img src="image-20220107152352681.png" alt="image-20220107152352681"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caused by: com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure</span><br></pre></td></tr></table></figure><p>é¡¹ç›®ä¸­é…ç½®çš„jdbcè¿æ¥åœ°å€å¦‚ä¸‹ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">druid.url</span>=<span class="string">jdbc:log4jdbc:mysql://172.18.xxx.xxx:3306/xxxxdb?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=UTC</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯é€šè¿‡navicatç­‰å·¥å…·å¯ä»¥æ­£å¸¸çš„è¿æ¥</p><p><img src="image-20220107152618747.png" alt="image-20220107152618747"></p><h1 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h1><p>æŸ¥äº†å¾ˆå¤šèµ„æ–™ï¼Œå‘ç°åœ¨MySQL5.7ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå®‰å…¨æ€§è¾ƒä½ï¼Œå­˜åœ¨ä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥è¿æ¥ä¸Šçš„ test åº“ï¼Œæ‰€ä»¥å®˜æ–¹åœ¨5.7ç‰ˆæœ¬åŠ å¤§äº†å¯¹éšç§çš„ä¿æŠ¤ã€‚å¹¶ä¸”é‡‡ç”¨äº†é»˜è®¤ useSSL = trueå€¼é˜²æ­¢å¯¹æ•°æ®åº“çš„éšæ„ä¿®æ”¹ï¼Œåˆ°äº†8.0ç‰ˆæœ¬ï¼Œä»ç„¶ä¿ç•™äº†SSLï¼Œå¹¶ä¸”é»˜è®¤å€¼ä¸º trueï¼Œæ‰€ä»¥åªè¦å°† â€œ?useSSL= falseâ€ æ”¾åœ¨urlè¡¨ååå³å¯</p><h1 id="è§£å†³åŠæ³•"><a href="#è§£å†³åŠæ³•" class="headerlink" title="è§£å†³åŠæ³•"></a>è§£å†³åŠæ³•</h1><p>åœ¨é…ç½®çš„jdbcè¿æ¥åœ°å€æœ«å°¾å¸¦ä¸Šå¦‚ä¸‹å‚æ•°å³å¯ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&amp;useSSL</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">druid.url</span>=<span class="string">jdbc:log4jdbc:mysql://172.18.xxx.xxx:3306/xxxxdb?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=UTC&amp;useSSL=false</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> jdbc </tag>
            
            <tag> BUG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å„ç³»ç»Ÿä¸‹æ— é™é‡ç½®IDEAè¯•ç”¨ç‰ˆæœ¬</title>
      <link href="/2022/01/07/%E5%90%84%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%97%A0%E9%99%90%E9%87%8D%E7%BD%AEIDEA%E8%AF%95%E7%94%A8%E7%89%88%E6%9C%AC/"/>
      <url>/2022/01/07/%E5%90%84%E7%B3%BB%E7%BB%9F%E4%B8%8B%E6%97%A0%E9%99%90%E9%87%8D%E7%BD%AEIDEA%E8%AF%95%E7%94%A8%E7%89%88%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<h1 id="åœ¨Ubuntuï¼ˆlinuxï¼‰ä¸‹é‡ç½®"><a href="#åœ¨Ubuntuï¼ˆlinuxï¼‰ä¸‹é‡ç½®" class="headerlink" title="åœ¨Ubuntuï¼ˆlinuxï¼‰ä¸‹é‡ç½®"></a>åœ¨Ubuntuï¼ˆlinuxï¼‰ä¸‹é‡ç½®</h1><p>å…ˆè¯´ä¸€ä¸‹åŸç†ï¼Œåœ¨2021.2.3ç‰ˆæœ¬ä¹‹å‰ï¼Œæˆ‘ä»¬æœ¬æœºä½¿ç”¨IDEAæ˜¯ä¸éœ€è¦ç™»å½•ä»€ä¹ˆè´¦æˆ·çš„ï¼Œå› æ­¤IDEAæ— æ³•è®²è¯•ç”¨æ—¶é—´çš„é™åˆ¶æ”¾åœ¨äº‘ç«¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒIDEAçš„è¯•ç”¨æ—¶é—´çš„é™åˆ¶æ•°æ®æ˜¯æ”¾åœ¨æˆ‘ä»¬æœ¬åœ°çš„ï¼Œåªéœ€è¦æ‰¾åˆ°IDEAå­˜æ”¾åœ¨æˆ‘ä»¬<strong>æœ¬åœ°çš„æ—¶é—´é™åˆ¶æ•°æ®</strong>ï¼Œå¹¶åˆ æ‰å°±å¯ä»¥é‡ç½®è¯•ç”¨æ—¶é—´ï¼›ä¸‹é¢å°±å¼€å§‹å§ã€‚</p><ol><li><p>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°IDEA çš„æ•°æ®å­˜æ”¾åœ¨å“ªå„¿</p><p>ç»è¿‡ä¸€ç•ªå¯»æ‰¾ï¼Œç»ˆäºåˆ°æ‰¾äº†ï¼Œæ•°æ®ç›®å½•åœ¨æˆ‘ä»¬ç”¨æˆ·ç›®å½•ä¸‹çš„ .config/JetBrains/ ç›®å½•ä¸‹ï¼š</p><p><img src="image-20220107120704640.png" alt="image-20220107120704640"></p></li><li><p><del>ç”±äºæ²¡åŠæ³•åŒºåˆ†é‚£äº›æ–‡ä»¶æ˜¯ç”¨æ¥å­˜æ”¾æ—¶é—´é™åˆ¶çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æŠŠå…¨éƒ¨åˆ æ‰ï¼Œç›¸å½“äºé‡æ–°å®‰è£…</del></p><p><img src="image-20220107120725543.png" alt="image-20220107120725543"></p></li><li><p>æœ€æ–°å‘ç°ï¼Œåªéœ€è¦åˆ é™¤ <code>/home/yefan/.config/JetBrains/IntelliJIdea2021.2/eval</code> ç›®å½•ä¸‹çš„æ–‡ä»¶å³å¯</p><p><img src="image-20220107120746900.png" alt="image-20220107120746900"></p></li><li><p>åˆ é™¤åå†é‡å¯IDEAï¼Œå°±å¯ä»¥å‘ç°IDEAè·Ÿæ–°å®‰è£…ä¸€æ ·</p></li></ol><p>evaluation.key</p><ol start="5"><li>åˆ°è¿™é‡Œå°±å®Œæˆäº†é‡ç½®</li></ol><p>è¿™ç§æ–¹å¼åŒæ ·é€‚ç”¨äºæ‰€æœ‰ <code>JetBrains</code> çš„å…¶ä»–äº§å“ï¼Œä½†æ˜¯è¦æ±‚ç‰ˆæœ¬æ˜¯åœ¨  2021.2 ç‰ˆæœ¬ä»¥å‰</p><h1 id="åœ¨windowsä¸‹é‡ç½®"><a href="#åœ¨windowsä¸‹é‡ç½®" class="headerlink" title="åœ¨windowsä¸‹é‡ç½®"></a>åœ¨windowsä¸‹é‡ç½®</h1><p>è·¯å¾„å¦‚ä¸‹ï¼š</p><p>C:\Users\zq\AppData\Roaming\JetBrains\IntelliJIdea2021.1\eval</p><p><img src="image-20220107120806097.png" alt="image-20220107120806097"></p><p>æŠŠ.keyçš„æ–‡ä»¶ é‡å‘½åä¸ºå…¶ä»–çš„åå­—å°±å¯ä»¥é‡æ–°é€‰æ‹©è¯•ç”¨</p><p>å¦‚æœæ— æ³•æ‰¾åˆ°è·¯å¾„ï¼Œå¯ä»¥åœ¨ Cç›˜æ ¹ç›®å½•ä¸‹è¿›è¡Œä½¿ç”¨æœç´¢ï¼Œå…³é”®è¯ä¸ºï¼ševaluation.key</p><h1 id="åœ¨Mac-ä¸‹é‡ç½®"><a href="#åœ¨Mac-ä¸‹é‡ç½®" class="headerlink" title="åœ¨Mac ä¸‹é‡ç½®"></a>åœ¨Mac ä¸‹é‡ç½®</h1><p>è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment"># reset jetbrains ide evals for now</span></span><br><span class="line"></span><br><span class="line">OS_NAME=$(uname -s)</span><br><span class="line">JB_PRODUCTS=<span class="string">&quot;IntelliJIdea CLion PhpStorm GoLand PyCharm WebStorm Rider DataGrip RubyMine AppCode&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$OS_NAME</span>&quot;</span> = <span class="string">&quot;Darwin&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;macOS:&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> PRD <span class="keyword">in</span> <span class="variable">$JB_PRODUCTS</span>; <span class="keyword">do</span></span><br><span class="line">    rm -rf ~/Library/Preferences/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line">    rm -rf ~/Library/Application\\ Support/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line">    rm -rf ~/Library/Application\\ Support/JetBrains/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$OS_NAME</span>&quot;</span> = <span class="string">&quot;Linux&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;Linux:&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> PRD <span class="keyword">in</span> <span class="variable">$JB_PRODUCTS</span>; <span class="keyword">do</span></span><br><span class="line">  rm -rf ~/.<span class="variable">$&#123;PRD&#125;</span>*/config/<span class="built_in">eval</span></span><br><span class="line">    rm -rf ~/.config/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line">    rm -rf ~/.config/JetBrains/<span class="variable">$&#123;PRD&#125;</span>*/<span class="built_in">eval</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;unsupported&#x27;</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;done.&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> IDEA </tag>
            
            <tag> è½¯ä»¶ç ´è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bind-exporterçš„éƒ¨ç½²</title>
      <link href="/2022/01/07/bind-exporter%E7%9A%84%E9%83%A8%E7%BD%B2/"/>
      <url>/2022/01/07/bind-exporter%E7%9A%84%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…éƒ¨ç½²exporter"><a href="#å®‰è£…éƒ¨ç½²exporter" class="headerlink" title="å®‰è£…éƒ¨ç½²exporter"></a>å®‰è£…éƒ¨ç½²exporter</h2><h3 id="ä¸‹è½½exporteräºŒè¿›åˆ¶åŒ…"><a href="#ä¸‹è½½exporteräºŒè¿›åˆ¶åŒ…" class="headerlink" title="ä¸‹è½½exporteräºŒè¿›åˆ¶åŒ…"></a>ä¸‹è½½exporteräºŒè¿›åˆ¶åŒ…</h3><p>æ ¹æ®ä¸åŒçš„ç¯å¢ƒï¼Œé€‰æ‹©ä¸åŒçš„äºŒè¿›åˆ¶åŒ…</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/prometheus-community/bind_exporter/releases/tag/v0.5.0">https://github.com/prometheus-community/bind_exporter/releases/tag/v0.5.0</a></p><p>æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯è¿™ä¸ªåŒ…ã€bind_exporter-0.5.0.linux-amd64.tar.gzã€‘</p><p><a href="https://github.com/prometheus-community/bind_exporter/releases/download/v0.5.0/bind_exporter-0.5.0.linux-amd64.tar.gz">https://github.com/prometheus-community/bind_exporter/releases/download/v0.5.0/bind_exporter-0.5.0.linux-amd64.tar.gz</a></p><h3 id="è§£å‹å®‰è£…åŒ…"><a href="#è§£å‹å®‰è£…åŒ…" class="headerlink" title="è§£å‹å®‰è£…åŒ…"></a>è§£å‹å®‰è£…åŒ…</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf bind_exporter-0.5.0.linux-amd64.tar.gz</span><br></pre></td></tr></table></figure><p><img src="image-20220104161539352.png" alt="image-20220104161539352"></p><p>è§£å‹ä¹‹åçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="image-20220104161634390.png" alt="image-20220104161634390"></p><h3 id="è¿è¡Œexporter"><a href="#è¿è¡Œexporter" class="headerlink" title="è¿è¡Œexporter"></a>è¿è¡Œexporter</h3><p>è¿›å…¥è§£å‹çš„ç›®å½•ï¼Œè¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ bind_exporter</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bind_exporter --bind.pid-file=/var/run/named/named.pid --bind.timeout=20s --web.listen-address=0.0.0.0:9119 --web.telemetry-path=/metrics --bind.stats-url=http://localhost:53/ --bind.stats-groups=server,view,tasks</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š</p><p>â‘  å…¶ä¸­çš„localhostï¼Œæ˜¯æŒ‡è¢«ç›‘æ§çš„bindæ‰€åœ¨çš„æœåŠ¡å™¨åœ°å€ï¼Œæˆ‘è¿™é‡Œæ˜¯æœ¬æœºï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨localhostæ›¿ä»£</p></blockquote><p>å¯åŠ¨ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="image-20220104161949523.png" alt="image-20220104161949523"></p><h2 id="å¯¹æ¥prometheus"><a href="#å¯¹æ¥prometheus" class="headerlink" title="å¯¹æ¥prometheus"></a>å¯¹æ¥prometheus</h2><p>æˆ‘è¿™é‡Œé‡‡ç”¨çš„http_sd_configçš„æ–¹å¼å‘ç°æœåŠ¡ï¼Œéœ€è¦äº†è§£çš„å¯ä»¥æŸ¥é˜…ã€ŠprometheusæœåŠ¡åŠ¨æ€å‘ç°ä¹‹<code>http_sd_config</code>ã€‹è¿™ç¯‡æ–‡ç« </p><ol><li><p>åœ¨prometheusä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;bind&#x27;</span></span><br><span class="line">  <span class="attr">http_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.26.62.xx:12000/prometheus/getTargetByType?exporterType=BIND</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="image-20220104170356350.png" alt="image-20220104170356350"></p><ol start="2"><li>é‡å¯æˆ–reloadä¸€ä¸‹prometheuså³å¯</li></ol><blockquote><p>æ³¨æ„ï¼š</p><p>â‘   é…ç½®ä¸­çš„urlå¡«å†™çš„æ˜¯è‡ªå·±æä¾›çš„æœåŠ¡åœ°å€ï¼Œprometheusä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ¥å£è·å–æœåŠ¡èŠ‚ç‚¹ä¿¡æ¯ï¼Œè¯¥æ¥å£è¿”å›çš„çš„ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">&quot;targets&quot;</span>:[</span><br><span class="line">         <span class="string">&quot;172.18.40.xx:9119&quot;</span></span><br><span class="line">     ],</span><br><span class="line">     <span class="attr">&quot;labels&quot;</span>:&#123;</span><br><span class="line">         <span class="attr">&quot;job&quot;</span>:<span class="string">&quot;bind&quot;</span></span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></blockquote><ol start="3"><li>æŸ¥çœ‹èŠ‚ç‚¹æ˜¯å¦æ³¨å†Œä¸Šå»</li></ol><h2 id="ä½¿ç”¨grafanaæŸ¥çœ‹ç›‘æ§å¤§ç›˜"><a href="#ä½¿ç”¨grafanaæŸ¥çœ‹ç›‘æ§å¤§ç›˜" class="headerlink" title="ä½¿ç”¨grafanaæŸ¥çœ‹ç›‘æ§å¤§ç›˜"></a>ä½¿ç”¨grafanaæŸ¥çœ‹ç›‘æ§å¤§ç›˜</h2><p>è¿™é‡Œä½¿ç”¨çš„æ˜¯<code>1666</code>çš„ç›‘æ§å¤§ç›˜ï¼Œè®¿é—®åœ°å€å¦‚ä¸‹ï¼š</p><p><a href="https://grafana.com/grafana/dashboards/1666">https://grafana.com/grafana/dashboards/1666</a></p><p><img src="image-20220104164022200.png" alt="image-20220104164022200"></p><p>æœ€ç»ˆå‘ˆç°çš„ç›‘æ§å¤§ç›˜å¦‚ä¸‹ï¼š</p><h2 id="bind-exporterç›‘æ§çš„æŒ‡æ ‡"><a href="#bind-exporterç›‘æ§çš„æŒ‡æ ‡" class="headerlink" title="bind_exporterç›‘æ§çš„æŒ‡æ ‡"></a>bind_exporterç›‘æ§çš„æŒ‡æ ‡</h2><p>é€šè¿‡è®¿é—®exporteræš´éœ²å‡ºæ¥çš„æŒ‡æ ‡è®¿é—®åœ°å€ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å½“å‰é‡‡é›†ç›‘æ§æ•°æ®ï¼š</p><p><a href="http://172.18.40.88:9119/metrics">http://172.18.40.88:9119/metrics</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h2><p>åœ¨éƒ¨ç½²çš„çš„è¿‡ç¨‹ä¸­å‡ºç°äº†å¦‚ä¸‹çš„é—®é¢˜ï¼š</p><h3 id="Couldnâ€™t-retrieve-BIND-stats"><a href="#Couldnâ€™t-retrieve-BIND-stats" class="headerlink" title="Couldnâ€™t retrieve BIND stats"></a>Couldnâ€™t retrieve BIND stats</h3><p>é—®é¢˜è¯´æ˜ï¼š</p><p>bind_exporterå¯åŠ¨åï¼Œæ— æ³•æˆåŠŸè®¿é—®bindï¼Œä»è€Œå¯¼è‡´æ— æ³•è·å–ç›‘æ§æ•°æ®</p><p><img src="image-20220104164953642.png" alt="image-20220104164953642"></p><p>è§£å†³åŠæ³•ï¼š</p><p>å‚è€ƒç½‘å€å¦‚ä¸‹ï¼š</p><p><a href="https://github.com/prometheus-community/bind_exporter/issues/118">https://github.com/prometheus-community/bind_exporter/issues/118</a></p><p><a href="https://github.com/prometheus-community/bind_exporter/issues/69">https://github.com/prometheus-community/bind_exporter/issues/69</a></p><p>åˆ†æç»“è®ºæ˜¯ï¼š</p><p>è¿™ä¸ªé—®é¢˜æ˜¯bindä¸bind_exporterçš„ç‰ˆæœ¬é—®é¢˜å¯¼è‡´çš„ï¼Œç›®å‰æš‚æ—¶åªé€‚ç”¨äº bind 9.17.20 å’Œ bind_exporter 0.5.0</p><p>æœ€ç»ˆè§£å†³é—®é¢˜çš„æ“ä½œå¦‚ä¸‹ï¼š</p><p>æˆ‘å½“å‰ç‰ˆæœ¬ä¸º<code>æš‚æ—¶æ²¡æœ‰åˆ‡æ¢bindçš„ç‰ˆæœ¬ï¼Œæ²¡æœ‰éªŒè¯è¯¥ç»“æœ</code></p><p><img src="image-20220104170912736.png" alt="image-20220104170912736"></p>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> äº‘ç›‘æ§ </tag>
            
            <tag> bind-exporter </tag>
            
            <tag> äº‘è®¡ç®— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>elasticsearch-exporterçš„éƒ¨ç½²</title>
      <link href="/2022/01/07/elasticsearch-exporter%E7%9A%84%E9%83%A8%E7%BD%B2/"/>
      <url>/2022/01/07/elasticsearch-exporter%E7%9A%84%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…éƒ¨ç½²exporter"><a href="#å®‰è£…éƒ¨ç½²exporter" class="headerlink" title="å®‰è£…éƒ¨ç½²exporter"></a>å®‰è£…éƒ¨ç½²exporter</h2><h3 id="ä¸‹è½½exporteräºŒè¿›åˆ¶åŒ…"><a href="#ä¸‹è½½exporteräºŒè¿›åˆ¶åŒ…" class="headerlink" title="ä¸‹è½½exporteräºŒè¿›åˆ¶åŒ…"></a>ä¸‹è½½exporteräºŒè¿›åˆ¶åŒ…</h3><p>æ ¹æ®ä¸åŒçš„ç¯å¢ƒï¼Œé€‰æ‹©ä¸åŒçš„äºŒè¿›åˆ¶åŒ…</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/prometheus-community/elasticsearch_exporter/releases/tag/v1.3.0">https://github.com/prometheus-community/elasticsearch_exporter/releases/tag/v1.3.0</a></p><p>æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯è¿™ä¸ªåŒ…ã€elasticsearch_exporter-1.3.0.linux-amd64.tar.gzã€‘</p><p><a href="https://github.com/prometheus-community/elasticsearch_exporter/releases/download/v1.3.0/elasticsearch_exporter-1.3.0.linux-amd64.tar.gz">https://github.com/prometheus-community/elasticsearch_exporter/releases/download/v1.3.0/elasticsearch_exporter-1.3.0.linux-amd64.tar.gz</a></p><h3 id="è§£å‹å®‰è£…åŒ…"><a href="#è§£å‹å®‰è£…åŒ…" class="headerlink" title="è§£å‹å®‰è£…åŒ…"></a>è§£å‹å®‰è£…åŒ…</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf elasticsearch_exporter-1.3.0.linux-amd64.tar.gz </span><br></pre></td></tr></table></figure><p><img src="image-20220104145334774.png" alt="image-20220104145334774"></p><p>è§£å‹ä¹‹åçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><p><img src="image-20220104145445891.png" alt="image-20220104145445891"></p><h3 id="è¿è¡Œexporter"><a href="#è¿è¡Œexporter" class="headerlink" title="è¿è¡Œexporter"></a>è¿è¡Œexporter</h3><p>è¿›å…¥è§£å‹çš„ç›®å½•ï¼Œè¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ elasticsearch_exporter</p><p>æ ¹æ®è¢«ç›‘æ§çš„elasticsearchæ˜¯å¦ç”¨æˆ·å¯†ç ï¼Œéœ€è¦åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µè¿›è¡Œè¿è¡Œï¼š</p><ol><li><p>ä¸éœ€è¦ç”¨æˆ·åå’Œå¯†ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./elasticsearch_exporter --web.listen-address &quot;:9109&quot;  --es.uri http://localhost:9200</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼š</p><p>â‘  å…¶ä¸­çš„localhostï¼Œæ˜¯æŒ‡è¢«ç›‘æ§çš„elasticsearchæ‰€åœ¨çš„æœåŠ¡å™¨åœ°å€ï¼Œæˆ‘è¿™é‡Œæ˜¯æœ¬æœºï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨localhostæ›¿ä»£</p><p>â‘¡ å¦‚æœå¯åŠ¨æ˜¯å‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š</p><p>caller=clusterinfo.go:188 msg=â€failed to retrieve cluster info from ESâ€ err=â€HTTP Request failed with code 401â€</p><p>å¾ˆæ˜¾ç„¶æ˜¯è¡¨ç¤ºæ²¡æœ‰æƒé™ï¼Œéœ€è¦ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è®¿é—®elasticsearchï¼Œéœ€è¦ä½¿ç”¨ä¸‹é¢ç¬¬äºŒç§æ–¹å¼è¿›è¡Œå¯åŠ¨å³å¯</p></blockquote></li><li><p>éœ€è¦ç”¨æˆ·åå’Œå¯†ç </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./elasticsearch_exporter --web.listen-address &quot;:9109&quot;  --es.uri http://elastic:elastic@localhost:9200</span><br></pre></td></tr></table></figure></li></ol><h2 id="å¯¹æ¥prometheus"><a href="#å¯¹æ¥prometheus" class="headerlink" title="å¯¹æ¥prometheus"></a>å¯¹æ¥prometheus</h2><p>æˆ‘è¿™é‡Œé‡‡ç”¨çš„http_sd_configçš„æ–¹å¼å‘ç°æœåŠ¡ï¼Œéœ€è¦äº†è§£çš„å¯ä»¥æŸ¥é˜…ã€ŠprometheusæœåŠ¡åŠ¨æ€å‘ç°ä¹‹<code>http_sd_config</code>ã€‹è¿™ç¯‡æ–‡ç« </p><ol><li><p>åœ¨prometheusä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;elasticsearch&#x27;</span></span><br><span class="line">  <span class="attr">http_sd_configs:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.26.62.99:12000/prometheus/getTargetByType?exporterType=ELASTICSEARCH</span></span><br><span class="line">      <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="image-20220104151110867.png" alt="image-20220104151110867"></p><ol start="2"><li>é‡å¯æˆ–reloadä¸€ä¸‹prometheuså³å¯</li></ol><blockquote><p>æ³¨æ„ï¼š</p><p>â‘   é…ç½®ä¸­çš„urlå¡«å†™çš„æ˜¯è‡ªå·±æä¾›çš„æœåŠ¡åœ°å€ï¼Œprometheusä¼šè‡ªåŠ¨è°ƒç”¨è¯¥æ¥å£è·å–æœåŠ¡èŠ‚ç‚¹ä¿¡æ¯ï¼Œè¯¥æ¥å£è¿”å›çš„çš„ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="attr">&quot;targets&quot;</span>:[</span><br><span class="line">         <span class="string">&quot;172.18.40.xx:9109&quot;</span></span><br><span class="line">     ],</span><br><span class="line">     <span class="attr">&quot;labels&quot;</span>:&#123;</span><br><span class="line">         <span class="attr">&quot;job&quot;</span>:<span class="string">&quot;elasticsearch&quot;</span></span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure></blockquote><ol start="3"><li><p>æŸ¥çœ‹èŠ‚ç‚¹æ˜¯å¦æ³¨å†Œä¸Šå»</p><p><img src="image-20220104151553748.png" alt="image-20220104151553748"></p></li></ol><h2 id="ä½¿ç”¨grafanaæŸ¥çœ‹ç›‘æ§å¤§ç›˜"><a href="#ä½¿ç”¨grafanaæŸ¥çœ‹ç›‘æ§å¤§ç›˜" class="headerlink" title="ä½¿ç”¨grafanaæŸ¥çœ‹ç›‘æ§å¤§ç›˜"></a>ä½¿ç”¨grafanaæŸ¥çœ‹ç›‘æ§å¤§ç›˜</h2><p>è¿™é‡Œä½¿ç”¨çš„æ˜¯<code>6483</code>çš„ç›‘æ§å¤§ç›˜ï¼Œè®¿é—®åœ°å€å¦‚ä¸‹ï¼š</p><p><a href="https://grafana.com/grafana/dashboards/6483">https://grafana.com/grafana/dashboards/6483</a></p><p><img src="image-20220104160409120.png" alt="image-20220104160409120"></p><p>æœ€ç»ˆå‘ˆç°çš„ç›‘æ§å¤§ç›˜å¦‚ä¸‹ï¼š</p><p><img src="image-20220104160329215.png" alt="image-20220104160329215"></p><h2 id="elasticsearch-exporterç›‘æ§çš„æŒ‡æ ‡"><a href="#elasticsearch-exporterç›‘æ§çš„æŒ‡æ ‡" class="headerlink" title="elasticsearch_exporterç›‘æ§çš„æŒ‡æ ‡"></a>elasticsearch_exporterç›‘æ§çš„æŒ‡æ ‡</h2><p>é€šè¿‡è®¿é—®exporteræš´éœ²å‡ºæ¥çš„æŒ‡æ ‡è®¿é—®åœ°å€ï¼Œå¯ä»¥æŸ¥çœ‹åˆ°å½“å‰é‡‡é›†ç›‘æ§æ•°æ®ï¼š</p><p><a href="http://172.18.40.xx:9109/metrics">http://172.18.40.xx:9109/metrics</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br></pre></td><td class="code"><pre><span class="line"># HELP elasticsearch_breakers_estimated_size_bytes Estimated size in bytes of breaker</span><br><span class="line"># TYPE elasticsearch_breakers_estimated_size_bytes gauge</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;accounting&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.1915479e+07</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;fielddata&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 47232</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;in_flight_requests&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 41421</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;parent&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.2004132e+07</span><br><span class="line">elasticsearch_breakers_estimated_size_bytes&#123;breaker=&quot;request&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_breakers_limit_size_bytes Limit size in bytes for breaker</span><br><span class="line"># TYPE elasticsearch_breakers_limit_size_bytes gauge</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;accounting&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.112618496e+09</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;fielddata&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.267571097e+09</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;in_flight_requests&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.112618496e+09</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;parent&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.478832947e+09</span><br><span class="line">elasticsearch_breakers_limit_size_bytes&#123;breaker=&quot;request&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.267571097e+09</span><br><span class="line"># HELP elasticsearch_breakers_overhead Overhead of circuit breakers</span><br><span class="line"># TYPE elasticsearch_breakers_overhead counter</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;accounting&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;fielddata&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.03</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;in_flight_requests&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;parent&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1</span><br><span class="line">elasticsearch_breakers_overhead&#123;breaker=&quot;request&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_breakers_tripped tripped for breaker</span><br><span class="line"># TYPE elasticsearch_breakers_tripped counter</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;accounting&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;fielddata&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;in_flight_requests&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;parent&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line">elasticsearch_breakers_tripped&#123;breaker=&quot;request&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_active_primary_shards The number of primary shards in your cluster. This is an aggregate total across all indices.</span><br><span class="line"># TYPE elasticsearch_cluster_health_active_primary_shards gauge</span><br><span class="line">elasticsearch_cluster_health_active_primary_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 4236</span><br><span class="line"># HELP elasticsearch_cluster_health_active_shards Aggregate total of all shards across all indices, which includes replica shards.</span><br><span class="line"># TYPE elasticsearch_cluster_health_active_shards gauge</span><br><span class="line">elasticsearch_cluster_health_active_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 4236</span><br><span class="line"># HELP elasticsearch_cluster_health_delayed_unassigned_shards Shards delayed to reduce reallocation overhead</span><br><span class="line"># TYPE elasticsearch_cluster_health_delayed_unassigned_shards gauge</span><br><span class="line">elasticsearch_cluster_health_delayed_unassigned_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_initializing_shards Count of shards that are being freshly created.</span><br><span class="line"># TYPE elasticsearch_cluster_health_initializing_shards gauge</span><br><span class="line">elasticsearch_cluster_health_initializing_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_json_parse_failures Number of errors while parsing JSON.</span><br><span class="line"># TYPE elasticsearch_cluster_health_json_parse_failures counter</span><br><span class="line">elasticsearch_cluster_health_json_parse_failures 0</span><br><span class="line"># HELP elasticsearch_cluster_health_number_of_data_nodes Number of data nodes in the cluster.</span><br><span class="line"># TYPE elasticsearch_cluster_health_number_of_data_nodes gauge</span><br><span class="line">elasticsearch_cluster_health_number_of_data_nodes&#123;cluster=&quot;powercloud_log&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_cluster_health_number_of_in_flight_fetch The number of ongoing shard info requests.</span><br><span class="line"># TYPE elasticsearch_cluster_health_number_of_in_flight_fetch gauge</span><br><span class="line">elasticsearch_cluster_health_number_of_in_flight_fetch&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_number_of_nodes Number of nodes in the cluster.</span><br><span class="line"># TYPE elasticsearch_cluster_health_number_of_nodes gauge</span><br><span class="line">elasticsearch_cluster_health_number_of_nodes&#123;cluster=&quot;powercloud_log&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_cluster_health_number_of_pending_tasks Cluster level changes which have not yet been executed</span><br><span class="line"># TYPE elasticsearch_cluster_health_number_of_pending_tasks gauge</span><br><span class="line">elasticsearch_cluster_health_number_of_pending_tasks&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_relocating_shards The number of shards that are currently moving from one node to another node.</span><br><span class="line"># TYPE elasticsearch_cluster_health_relocating_shards gauge</span><br><span class="line">elasticsearch_cluster_health_relocating_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_status Whether all primary and replica shards are allocated.</span><br><span class="line"># TYPE elasticsearch_cluster_health_status gauge</span><br><span class="line">elasticsearch_cluster_health_status&#123;cluster=&quot;powercloud_log&quot;,color=&quot;green&quot;&#125; 1</span><br><span class="line">elasticsearch_cluster_health_status&#123;cluster=&quot;powercloud_log&quot;,color=&quot;red&quot;&#125; 0</span><br><span class="line">elasticsearch_cluster_health_status&#123;cluster=&quot;powercloud_log&quot;,color=&quot;yellow&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_task_max_waiting_in_queue_millis Tasks max time waiting in queue.</span><br><span class="line"># TYPE elasticsearch_cluster_health_task_max_waiting_in_queue_millis gauge</span><br><span class="line">elasticsearch_cluster_health_task_max_waiting_in_queue_millis&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_total_scrapes Current total ElasticSearch cluster health scrapes.</span><br><span class="line"># TYPE elasticsearch_cluster_health_total_scrapes counter</span><br><span class="line">elasticsearch_cluster_health_total_scrapes 86</span><br><span class="line"># HELP elasticsearch_cluster_health_unassigned_shards The number of shards that exist in the cluster state, but cannot be found in the cluster itself.</span><br><span class="line"># TYPE elasticsearch_cluster_health_unassigned_shards gauge</span><br><span class="line">elasticsearch_cluster_health_unassigned_shards&#123;cluster=&quot;powercloud_log&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_cluster_health_up Was the last scrape of the ElasticSearch cluster health endpoint successful.</span><br><span class="line"># TYPE elasticsearch_cluster_health_up gauge</span><br><span class="line">elasticsearch_cluster_health_up 1</span><br><span class="line"># HELP elasticsearch_clusterinfo_last_retrieval_failure_ts Timestamp of the last failed cluster info retrieval</span><br><span class="line"># TYPE elasticsearch_clusterinfo_last_retrieval_failure_ts gauge</span><br><span class="line">elasticsearch_clusterinfo_last_retrieval_failure_ts&#123;url=&quot;http://localhost:9200&quot;&#125; 1.641279194e+09</span><br><span class="line"># HELP elasticsearch_clusterinfo_last_retrieval_success_ts Timestamp of the last successful cluster info retrieval</span><br><span class="line"># TYPE elasticsearch_clusterinfo_last_retrieval_success_ts gauge</span><br><span class="line">elasticsearch_clusterinfo_last_retrieval_success_ts&#123;url=&quot;http://localhost:9200&quot;&#125; 1.641279789e+09</span><br><span class="line"># HELP elasticsearch_clusterinfo_up Up metric for the cluster info collector</span><br><span class="line"># TYPE elasticsearch_clusterinfo_up gauge</span><br><span class="line">elasticsearch_clusterinfo_up&#123;url=&quot;http://localhost:9200&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_clusterinfo_version_info Constant metric with ES version information as labels</span><br><span class="line"># TYPE elasticsearch_clusterinfo_version_info gauge</span><br><span class="line">elasticsearch_clusterinfo_version_info&#123;build_date=&quot;2020-10-16T09:09:46.555371Z&quot;,build_hash=&quot;be13c69&quot;,cluster=&quot;powercloud_log&quot;,cluster_uuid=&quot;YHZNY2gQRwSdApY_N5ZRGg&quot;,lucene_version=&quot;7.7.3&quot;,version=&quot;6.8.13&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_exporter_build_info A metric with a constant &#x27;1&#x27; value labeled by version, revision, branch, and goversion from which elasticsearch_exporter was built.</span><br><span class="line"># TYPE elasticsearch_exporter_build_info gauge</span><br><span class="line">elasticsearch_exporter_build_info&#123;branch=&quot;HEAD&quot;,goversion=&quot;go1.16.9&quot;,revision=&quot;5b2e5c7e0e5059c5e2c8046802fa59fb88b30773&quot;,version=&quot;1.3.0&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_filesystem_data_available_bytes Available space on block device in bytes</span><br><span class="line"># TYPE elasticsearch_filesystem_data_available_bytes gauge</span><br><span class="line">elasticsearch_filesystem_data_available_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,mount=&quot;/ (rootfs)&quot;,name=&quot;node-65&quot;,path=&quot;/mysql/es/nodes/0&quot;&#125; 7.907373056e+09</span><br><span class="line"># HELP elasticsearch_filesystem_data_free_bytes Free space on block device in bytes</span><br><span class="line"># TYPE elasticsearch_filesystem_data_free_bytes gauge</span><br><span class="line">elasticsearch_filesystem_data_free_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,mount=&quot;/ (rootfs)&quot;,name=&quot;node-65&quot;,path=&quot;/mysql/es/nodes/0&quot;&#125; 7.907373056e+09</span><br><span class="line"># HELP elasticsearch_filesystem_data_size_bytes Size of block device in bytes</span><br><span class="line"># TYPE elasticsearch_filesystem_data_size_bytes gauge</span><br><span class="line">elasticsearch_filesystem_data_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,mount=&quot;/ (rootfs)&quot;,name=&quot;node-65&quot;,path=&quot;/mysql/es/nodes/0&quot;&#125; 1.3407092736e+10</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_operations_count Count of disk operations</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_operations_count counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_operations_count&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 4.24902462e+08</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_read_operations_count Count of disk read operations</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_read_operations_count counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_read_operations_count&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 173739</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_read_size_kilobytes_sum Total kilobytes read from disk</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_read_size_kilobytes_sum counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_read_size_kilobytes_sum&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 5.766904e+06</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_write_operations_count Count of disk write operations</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_write_operations_count counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_write_operations_count&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 4.24728723e+08</span><br><span class="line"># HELP elasticsearch_filesystem_io_stats_device_write_size_kilobytes_sum Total kilobytes written to disk</span><br><span class="line"># TYPE elasticsearch_filesystem_io_stats_device_write_size_kilobytes_sum counter</span><br><span class="line">elasticsearch_filesystem_io_stats_device_write_size_kilobytes_sum&#123;cluster=&quot;powercloud_log&quot;,device=&quot;dm-0&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.996657082e+09</span><br><span class="line"># HELP elasticsearch_indices_completion_size_in_bytes Completion in bytes</span><br><span class="line"># TYPE elasticsearch_indices_completion_size_in_bytes counter</span><br><span class="line">elasticsearch_indices_completion_size_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_docs Count of documents on this node</span><br><span class="line"># TYPE elasticsearch_indices_docs gauge</span><br><span class="line">elasticsearch_indices_docs&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.844747e+06</span><br><span class="line"># HELP elasticsearch_indices_docs_deleted Count of deleted documents on this node</span><br><span class="line"># TYPE elasticsearch_indices_docs_deleted gauge</span><br><span class="line">elasticsearch_indices_docs_deleted&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 31972</span><br><span class="line"># HELP elasticsearch_indices_fielddata_evictions Evictions from field data</span><br><span class="line"># TYPE elasticsearch_indices_fielddata_evictions counter</span><br><span class="line">elasticsearch_indices_fielddata_evictions&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_fielddata_memory_size_bytes Field data cache memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_fielddata_memory_size_bytes gauge</span><br><span class="line">elasticsearch_indices_fielddata_memory_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 47232</span><br><span class="line"># HELP elasticsearch_indices_filter_cache_evictions Evictions from filter cache</span><br><span class="line"># TYPE elasticsearch_indices_filter_cache_evictions counter</span><br><span class="line">elasticsearch_indices_filter_cache_evictions&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_filter_cache_memory_size_bytes Filter cache memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_filter_cache_memory_size_bytes gauge</span><br><span class="line">elasticsearch_indices_filter_cache_memory_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_flush_time_seconds Cumulative flush time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_flush_time_seconds counter</span><br><span class="line">elasticsearch_indices_flush_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1281.583</span><br><span class="line"># HELP elasticsearch_indices_flush_total Total flushes</span><br><span class="line"># TYPE elasticsearch_indices_flush_total counter</span><br><span class="line">elasticsearch_indices_flush_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 88700</span><br><span class="line"># HELP elasticsearch_indices_get_exists_time_seconds Total time get exists in seconds</span><br><span class="line"># TYPE elasticsearch_indices_get_exists_time_seconds counter</span><br><span class="line">elasticsearch_indices_get_exists_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7334.63</span><br><span class="line"># HELP elasticsearch_indices_get_exists_total Total get exists operations</span><br><span class="line"># TYPE elasticsearch_indices_get_exists_total counter</span><br><span class="line">elasticsearch_indices_get_exists_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.09638173e+08</span><br><span class="line"># HELP elasticsearch_indices_get_missing_time_seconds Total time of get missing in seconds</span><br><span class="line"># TYPE elasticsearch_indices_get_missing_time_seconds counter</span><br><span class="line">elasticsearch_indices_get_missing_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.69</span><br><span class="line"># HELP elasticsearch_indices_get_missing_total Total get missing</span><br><span class="line"># TYPE elasticsearch_indices_get_missing_total counter</span><br><span class="line">elasticsearch_indices_get_missing_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 978</span><br><span class="line"># HELP elasticsearch_indices_get_time_seconds Total get time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_get_time_seconds counter</span><br><span class="line">elasticsearch_indices_get_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7336.32</span><br><span class="line"># HELP elasticsearch_indices_get_total Total get</span><br><span class="line"># TYPE elasticsearch_indices_get_total counter</span><br><span class="line">elasticsearch_indices_get_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.09639151e+08</span><br><span class="line"># HELP elasticsearch_indices_indexing_delete_time_seconds_total Total time indexing delete in seconds</span><br><span class="line"># TYPE elasticsearch_indices_indexing_delete_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_indexing_delete_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_indexing_delete_total Total indexing deletes</span><br><span class="line"># TYPE elasticsearch_indices_indexing_delete_total counter</span><br><span class="line">elasticsearch_indices_indexing_delete_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_indexing_index_time_seconds_total Cumulative index time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_indexing_index_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_indexing_index_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 47008.786</span><br><span class="line"># HELP elasticsearch_indices_indexing_index_total Total index calls</span><br><span class="line"># TYPE elasticsearch_indices_indexing_index_total counter</span><br><span class="line">elasticsearch_indices_indexing_index_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 8.7126405e+07</span><br><span class="line"># HELP elasticsearch_indices_indexing_is_throttled Indexing throttling</span><br><span class="line"># TYPE elasticsearch_indices_indexing_is_throttled gauge</span><br><span class="line">elasticsearch_indices_indexing_is_throttled&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_indexing_throttle_time_seconds_total Cumulative indexing throttling time</span><br><span class="line"># TYPE elasticsearch_indices_indexing_throttle_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_indexing_throttle_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_merges_current Current merges</span><br><span class="line"># TYPE elasticsearch_indices_merges_current gauge</span><br><span class="line">elasticsearch_indices_merges_current&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_merges_current_size_in_bytes Size of a current merges in bytes</span><br><span class="line"># TYPE elasticsearch_indices_merges_current_size_in_bytes gauge</span><br><span class="line">elasticsearch_indices_merges_current_size_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_merges_docs_total Cumulative docs merged</span><br><span class="line"># TYPE elasticsearch_indices_merges_docs_total counter</span><br><span class="line">elasticsearch_indices_merges_docs_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 5.91988704e+08</span><br><span class="line"># HELP elasticsearch_indices_merges_total Total merges</span><br><span class="line"># TYPE elasticsearch_indices_merges_total counter</span><br><span class="line">elasticsearch_indices_merges_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.595759e+06</span><br><span class="line"># HELP elasticsearch_indices_merges_total_size_bytes_total Total merge size in bytes</span><br><span class="line"># TYPE elasticsearch_indices_merges_total_size_bytes_total counter</span><br><span class="line">elasticsearch_indices_merges_total_size_bytes_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.77768194134e+11</span><br><span class="line"># HELP elasticsearch_indices_merges_total_throttled_time_seconds_total Total throttled time of merges in seconds</span><br><span class="line"># TYPE elasticsearch_indices_merges_total_throttled_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_merges_total_throttled_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_merges_total_time_seconds_total Total time spent merging in seconds</span><br><span class="line"># TYPE elasticsearch_indices_merges_total_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_merges_total_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 13919.644</span><br><span class="line"># HELP elasticsearch_indices_query_cache_cache_size Query cache cache size</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_cache_size gauge</span><br><span class="line">elasticsearch_indices_query_cache_cache_size&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_cache_total Query cache cache count</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_cache_total counter</span><br><span class="line">elasticsearch_indices_query_cache_cache_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_count Query cache count</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_count counter</span><br><span class="line">elasticsearch_indices_query_cache_count&#123;cache=&quot;hit&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_evictions Evictions from query cache</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_evictions counter</span><br><span class="line">elasticsearch_indices_query_cache_evictions&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_memory_size_bytes Query cache memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_memory_size_bytes gauge</span><br><span class="line">elasticsearch_indices_query_cache_memory_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_cache_total Query cache total count</span><br><span class="line"># TYPE elasticsearch_indices_query_cache_total counter</span><br><span class="line">elasticsearch_indices_query_cache_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_query_miss_count Query miss count</span><br><span class="line"># TYPE elasticsearch_indices_query_miss_count counter</span><br><span class="line">elasticsearch_indices_query_miss_count&#123;cache=&quot;miss&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_refresh_time_seconds_total Total time spent refreshing in seconds</span><br><span class="line"># TYPE elasticsearch_indices_refresh_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_refresh_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 321386.712</span><br><span class="line"># HELP elasticsearch_indices_refresh_total Total refreshes</span><br><span class="line"># TYPE elasticsearch_indices_refresh_total counter</span><br><span class="line">elasticsearch_indices_refresh_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 6.0047433e+07</span><br><span class="line"># HELP elasticsearch_indices_request_cache_count Request cache count</span><br><span class="line"># TYPE elasticsearch_indices_request_cache_count counter</span><br><span class="line">elasticsearch_indices_request_cache_count&#123;cache=&quot;hit&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 959</span><br><span class="line"># HELP elasticsearch_indices_request_cache_evictions Evictions from request cache</span><br><span class="line"># TYPE elasticsearch_indices_request_cache_evictions counter</span><br><span class="line">elasticsearch_indices_request_cache_evictions&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_request_cache_memory_size_bytes Request cache memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_request_cache_memory_size_bytes gauge</span><br><span class="line">elasticsearch_indices_request_cache_memory_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 97920</span><br><span class="line"># HELP elasticsearch_indices_request_miss_count Request miss count</span><br><span class="line"># TYPE elasticsearch_indices_request_miss_count counter</span><br><span class="line">elasticsearch_indices_request_miss_count&#123;cache=&quot;miss&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2431</span><br><span class="line"># HELP elasticsearch_indices_search_fetch_time_seconds Total search fetch time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_search_fetch_time_seconds counter</span><br><span class="line">elasticsearch_indices_search_fetch_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 235.096</span><br><span class="line"># HELP elasticsearch_indices_search_fetch_total Total number of fetches</span><br><span class="line"># TYPE elasticsearch_indices_search_fetch_total counter</span><br><span class="line">elasticsearch_indices_search_fetch_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.892078e+06</span><br><span class="line"># HELP elasticsearch_indices_search_query_time_seconds Total search query time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_search_query_time_seconds counter</span><br><span class="line">elasticsearch_indices_search_query_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 44106.837</span><br><span class="line"># HELP elasticsearch_indices_search_query_total Total number of queries</span><br><span class="line"># TYPE elasticsearch_indices_search_query_total counter</span><br><span class="line">elasticsearch_indices_search_query_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.52018903e+08</span><br><span class="line"># HELP elasticsearch_indices_search_scroll_time_seconds Total scroll time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_search_scroll_time_seconds counter</span><br><span class="line">elasticsearch_indices_search_scroll_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_search_scroll_total Total number of scrolls</span><br><span class="line"># TYPE elasticsearch_indices_search_scroll_total counter</span><br><span class="line">elasticsearch_indices_search_scroll_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_search_suggest_time_seconds Total suggest time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_search_suggest_time_seconds counter</span><br><span class="line">elasticsearch_indices_search_suggest_time_seconds&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_search_suggest_total Total number of suggests</span><br><span class="line"># TYPE elasticsearch_indices_search_suggest_total counter</span><br><span class="line">elasticsearch_indices_search_suggest_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_segments_count Count of index segments on this node</span><br><span class="line"># TYPE elasticsearch_indices_segments_count gauge</span><br><span class="line">elasticsearch_indices_segments_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 25317</span><br><span class="line"># HELP elasticsearch_indices_segments_doc_values_memory_in_bytes Count of doc values memory</span><br><span class="line"># TYPE elasticsearch_indices_segments_doc_values_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_doc_values_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 6.907292e+06</span><br><span class="line"># HELP elasticsearch_indices_segments_fixed_bit_set_memory_in_bytes Count of fixed bit set</span><br><span class="line"># TYPE elasticsearch_indices_segments_fixed_bit_set_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_fixed_bit_set_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_segments_index_writer_memory_in_bytes Count of memory for index writer on this node</span><br><span class="line"># TYPE elasticsearch_indices_segments_index_writer_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_index_writer_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.0151996e+07</span><br><span class="line"># HELP elasticsearch_indices_segments_memory_bytes Current memory size of segments in bytes</span><br><span class="line"># TYPE elasticsearch_indices_segments_memory_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_memory_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.1915479e+07</span><br><span class="line"># HELP elasticsearch_indices_segments_norms_memory_in_bytes Count of memory used by norms</span><br><span class="line"># TYPE elasticsearch_indices_segments_norms_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_norms_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 669440</span><br><span class="line"># HELP elasticsearch_indices_segments_points_memory_in_bytes Point values memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_segments_points_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_points_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 268735</span><br><span class="line"># HELP elasticsearch_indices_segments_stored_fields_memory_in_bytes Count of stored fields memory</span><br><span class="line"># TYPE elasticsearch_indices_segments_stored_fields_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_stored_fields_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.991504e+06</span><br><span class="line"># HELP elasticsearch_indices_segments_term_vectors_memory_in_bytes Term vectors memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_segments_term_vectors_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_term_vectors_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_segments_terms_memory_in_bytes Count of terms in memory for this node</span><br><span class="line"># TYPE elasticsearch_indices_segments_terms_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_terms_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.6078508e+07</span><br><span class="line"># HELP elasticsearch_indices_segments_version_map_memory_in_bytes Version map memory usage in bytes</span><br><span class="line"># TYPE elasticsearch_indices_segments_version_map_memory_in_bytes gauge</span><br><span class="line">elasticsearch_indices_segments_version_map_memory_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 12348</span><br><span class="line"># HELP elasticsearch_indices_store_size_bytes Current size of stored index data in bytes</span><br><span class="line"># TYPE elasticsearch_indices_store_size_bytes gauge</span><br><span class="line">elasticsearch_indices_store_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 6.10025718e+08</span><br><span class="line"># HELP elasticsearch_indices_store_throttle_time_seconds_total Throttle time for index store in seconds</span><br><span class="line"># TYPE elasticsearch_indices_store_throttle_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_store_throttle_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_indices_translog_operations Total translog operations</span><br><span class="line"># TYPE elasticsearch_indices_translog_operations counter</span><br><span class="line">elasticsearch_indices_translog_operations&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 3.788237e+06</span><br><span class="line"># HELP elasticsearch_indices_translog_size_in_bytes Total translog size in bytes</span><br><span class="line"># TYPE elasticsearch_indices_translog_size_in_bytes counter</span><br><span class="line">elasticsearch_indices_translog_size_in_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.161283492e+09</span><br><span class="line"># HELP elasticsearch_indices_warmer_time_seconds_total Total warmer time in seconds</span><br><span class="line"># TYPE elasticsearch_indices_warmer_time_seconds_total counter</span><br><span class="line">elasticsearch_indices_warmer_time_seconds_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 766.68</span><br><span class="line"># HELP elasticsearch_indices_warmer_total Total warmer count</span><br><span class="line"># TYPE elasticsearch_indices_warmer_total counter</span><br><span class="line">elasticsearch_indices_warmer_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 5.1882607e+07</span><br><span class="line"># HELP elasticsearch_jvm_buffer_pool_used_bytes JVM buffer currently used</span><br><span class="line"># TYPE elasticsearch_jvm_buffer_pool_used_bytes gauge</span><br><span class="line">elasticsearch_jvm_buffer_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;direct&quot;&#125; 1.35439297e+08</span><br><span class="line">elasticsearch_jvm_buffer_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;mapped&quot;&#125; 5.61244239e+08</span><br><span class="line"># HELP elasticsearch_jvm_gc_collection_seconds_count Count of JVM GC runs</span><br><span class="line"># TYPE elasticsearch_jvm_gc_collection_seconds_count counter</span><br><span class="line">elasticsearch_jvm_gc_collection_seconds_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,gc=&quot;old&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 349475</span><br><span class="line">elasticsearch_jvm_gc_collection_seconds_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,gc=&quot;young&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.310973e+06</span><br><span class="line"># HELP elasticsearch_jvm_gc_collection_seconds_sum GC run time in seconds</span><br><span class="line"># TYPE elasticsearch_jvm_gc_collection_seconds_sum counter</span><br><span class="line">elasticsearch_jvm_gc_collection_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,gc=&quot;old&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 29972.916</span><br><span class="line">elasticsearch_jvm_gc_collection_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,gc=&quot;young&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 35169.164</span><br><span class="line"># HELP elasticsearch_jvm_memory_committed_bytes JVM memory currently committed by area</span><br><span class="line"># TYPE elasticsearch_jvm_memory_committed_bytes gauge</span><br><span class="line">elasticsearch_jvm_memory_committed_bytes&#123;area=&quot;heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.112618496e+09</span><br><span class="line">elasticsearch_jvm_memory_committed_bytes&#123;area=&quot;non-heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.94031616e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_max_bytes JVM memory max</span><br><span class="line"># TYPE elasticsearch_jvm_memory_max_bytes gauge</span><br><span class="line">elasticsearch_jvm_memory_max_bytes&#123;area=&quot;heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.112618496e+09</span><br><span class="line"># HELP elasticsearch_jvm_memory_pool_max_bytes JVM memory max by pool</span><br><span class="line"># TYPE elasticsearch_jvm_memory_pool_max_bytes counter</span><br><span class="line">elasticsearch_jvm_memory_pool_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;old&quot;&#125; 1.798569984e+09</span><br><span class="line">elasticsearch_jvm_memory_pool_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;survivor&quot;&#125; 3.4865152e+07</span><br><span class="line">elasticsearch_jvm_memory_pool_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;young&quot;&#125; 2.7918336e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_pool_peak_max_bytes JVM memory peak max by pool</span><br><span class="line"># TYPE elasticsearch_jvm_memory_pool_peak_max_bytes counter</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;old&quot;&#125; 1.798569984e+09</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;survivor&quot;&#125; 3.4865152e+07</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_max_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;young&quot;&#125; 2.7918336e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_pool_peak_used_bytes JVM memory peak used by pool</span><br><span class="line"># TYPE elasticsearch_jvm_memory_pool_peak_used_bytes counter</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;old&quot;&#125; 1.79310328e+09</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;survivor&quot;&#125; 3.4865152e+07</span><br><span class="line">elasticsearch_jvm_memory_pool_peak_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;young&quot;&#125; 2.7918336e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_pool_used_bytes JVM memory currently used by pool</span><br><span class="line"># TYPE elasticsearch_jvm_memory_pool_used_bytes gauge</span><br><span class="line">elasticsearch_jvm_memory_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;old&quot;&#125; 1.749747304e+09</span><br><span class="line">elasticsearch_jvm_memory_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;survivor&quot;&#125; 2.7390528e+07</span><br><span class="line">elasticsearch_jvm_memory_pool_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,pool=&quot;young&quot;&#125; 2.570478e+08</span><br><span class="line"># HELP elasticsearch_jvm_memory_used_bytes JVM memory currently used by area</span><br><span class="line"># TYPE elasticsearch_jvm_memory_used_bytes gauge</span><br><span class="line">elasticsearch_jvm_memory_used_bytes&#123;area=&quot;heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 2.034185632e+09</span><br><span class="line">elasticsearch_jvm_memory_used_bytes&#123;area=&quot;non-heap&quot;,cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.80895256e+08</span><br><span class="line"># HELP elasticsearch_node_stats_json_parse_failures Number of errors while parsing JSON.</span><br><span class="line"># TYPE elasticsearch_node_stats_json_parse_failures counter</span><br><span class="line">elasticsearch_node_stats_json_parse_failures 0</span><br><span class="line"># HELP elasticsearch_node_stats_total_scrapes Current total ElasticSearch node scrapes.</span><br><span class="line"># TYPE elasticsearch_node_stats_total_scrapes counter</span><br><span class="line">elasticsearch_node_stats_total_scrapes 86</span><br><span class="line"># HELP elasticsearch_node_stats_up Was the last scrape of the ElasticSearch nodes endpoint successful.</span><br><span class="line"># TYPE elasticsearch_node_stats_up gauge</span><br><span class="line">elasticsearch_node_stats_up 1</span><br><span class="line"># HELP elasticsearch_nodes_roles Node roles</span><br><span class="line"># TYPE elasticsearch_nodes_roles gauge</span><br><span class="line">elasticsearch_nodes_roles&#123;cluster=&quot;powercloud_log&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,role=&quot;client&quot;&#125; 1</span><br><span class="line">elasticsearch_nodes_roles&#123;cluster=&quot;powercloud_log&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,role=&quot;data&quot;&#125; 1</span><br><span class="line">elasticsearch_nodes_roles&#123;cluster=&quot;powercloud_log&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,role=&quot;ingest&quot;&#125; 1</span><br><span class="line">elasticsearch_nodes_roles&#123;cluster=&quot;powercloud_log&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,role=&quot;master&quot;&#125; 1</span><br><span class="line"># HELP elasticsearch_os_cpu_percent Percent CPU used by OS</span><br><span class="line"># TYPE elasticsearch_os_cpu_percent gauge</span><br><span class="line">elasticsearch_os_cpu_percent&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 25</span><br><span class="line"># HELP elasticsearch_os_load1 Shortterm load average</span><br><span class="line"># TYPE elasticsearch_os_load1 gauge</span><br><span class="line">elasticsearch_os_load1&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0.47</span><br><span class="line"># HELP elasticsearch_os_load15 Longterm load average</span><br><span class="line"># TYPE elasticsearch_os_load15 gauge</span><br><span class="line">elasticsearch_os_load15&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 1.04</span><br><span class="line"># HELP elasticsearch_os_load5 Midterm load average</span><br><span class="line"># TYPE elasticsearch_os_load5 gauge</span><br><span class="line">elasticsearch_os_load5&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0.91</span><br><span class="line"># HELP elasticsearch_os_mem_actual_free_bytes Amount of free physical memory in bytes</span><br><span class="line"># TYPE elasticsearch_os_mem_actual_free_bytes gauge</span><br><span class="line">elasticsearch_os_mem_actual_free_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_os_mem_actual_used_bytes Amount of used physical memory in bytes</span><br><span class="line"># TYPE elasticsearch_os_mem_actual_used_bytes gauge</span><br><span class="line">elasticsearch_os_mem_actual_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_os_mem_free_bytes Amount of free physical memory in bytes</span><br><span class="line"># TYPE elasticsearch_os_mem_free_bytes gauge</span><br><span class="line">elasticsearch_os_mem_free_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 4.4890112e+08</span><br><span class="line"># HELP elasticsearch_os_mem_used_bytes Amount of used physical memory in bytes</span><br><span class="line"># TYPE elasticsearch_os_mem_used_bytes gauge</span><br><span class="line">elasticsearch_os_mem_used_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.752511488e+09</span><br><span class="line"># HELP elasticsearch_process_cpu_percent Percent CPU used by process</span><br><span class="line"># TYPE elasticsearch_process_cpu_percent gauge</span><br><span class="line">elasticsearch_process_cpu_percent&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 11</span><br><span class="line"># HELP elasticsearch_process_cpu_time_seconds_sum Process CPU time in seconds</span><br><span class="line"># TYPE elasticsearch_process_cpu_time_seconds_sum counter</span><br><span class="line">elasticsearch_process_cpu_time_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;sys&quot;&#125; 0</span><br><span class="line">elasticsearch_process_cpu_time_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;total&quot;&#125; 3.33384018e+06</span><br><span class="line">elasticsearch_process_cpu_time_seconds_sum&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;user&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_process_max_files_descriptors Max file descriptors</span><br><span class="line"># TYPE elasticsearch_process_max_files_descriptors gauge</span><br><span class="line">elasticsearch_process_max_files_descriptors&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 131072</span><br><span class="line"># HELP elasticsearch_process_mem_resident_size_bytes Resident memory in use by process in bytes</span><br><span class="line"># TYPE elasticsearch_process_mem_resident_size_bytes gauge</span><br><span class="line">elasticsearch_process_mem_resident_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_process_mem_share_size_bytes Shared memory in use by process in bytes</span><br><span class="line"># TYPE elasticsearch_process_mem_share_size_bytes gauge</span><br><span class="line">elasticsearch_process_mem_share_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_process_mem_virtual_size_bytes Total virtual memory used in bytes</span><br><span class="line"># TYPE elasticsearch_process_mem_virtual_size_bytes gauge</span><br><span class="line">elasticsearch_process_mem_virtual_size_bytes&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 7.020691456e+09</span><br><span class="line"># HELP elasticsearch_process_open_files_count Open file descriptors</span><br><span class="line"># TYPE elasticsearch_process_open_files_count gauge</span><br><span class="line">elasticsearch_process_open_files_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 9494</span><br><span class="line"># HELP elasticsearch_thread_pool_active_count Thread Pool threads active</span><br><span class="line"># TYPE elasticsearch_thread_pool_active_count gauge</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 1</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_active_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_thread_pool_completed_count Thread Pool operations completed</span><br><span class="line"># TYPE elasticsearch_thread_pool_completed_count counter</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 364</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 177298</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 4.17230997e+08</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 2.8834648e+07</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 2.8825882e+07</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 2.7632481e+07</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 3.89357528e+08</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 607</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 6.07410367e+08</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 7.75406281e+08</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_completed_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 6.7644324e+07</span><br><span class="line"># HELP elasticsearch_thread_pool_largest_count Thread Pool largest threads count</span><br><span class="line"># TYPE elasticsearch_thread_pool_largest_count gauge</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 8</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 128</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 4</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 4</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 5</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 80</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 7</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_largest_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 4</span><br><span class="line"># HELP elasticsearch_thread_pool_queue_count Thread Pool operations queued</span><br><span class="line"># TYPE elasticsearch_thread_pool_queue_count gauge</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_queue_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_thread_pool_rejected_count Thread Pool operations rejected</span><br><span class="line"># TYPE elasticsearch_thread_pool_rejected_count counter</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_rejected_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_thread_pool_threads_count Thread Pool current threads count</span><br><span class="line"># TYPE elasticsearch_thread_pool_threads_count gauge</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;analyze&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ccr&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_started&quot;&#125; 1</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;fetch_shard_store&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;flush&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;force_merge&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;generic&quot;&#125; 128</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;get&quot;&#125; 4</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;index&quot;&#125; 4</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;listener&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;management&quot;&#125; 5</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_autodetect&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_datafeed&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;ml_utility&quot;&#125; 80</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;refresh&quot;&#125; 2</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;rollup_indexing&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search&quot;&#125; 7</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;search_throttled&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;security-token-key&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;snapshot&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;warmer&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;watcher&quot;&#125; 0</span><br><span class="line">elasticsearch_thread_pool_threads_count&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;,type=&quot;write&quot;&#125; 4</span><br><span class="line"># HELP elasticsearch_transport_rx_packets_total Count of packets received</span><br><span class="line"># TYPE elasticsearch_transport_rx_packets_total counter</span><br><span class="line">elasticsearch_transport_rx_packets_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_transport_rx_size_bytes_total Total number of bytes received</span><br><span class="line"># TYPE elasticsearch_transport_rx_size_bytes_total counter</span><br><span class="line">elasticsearch_transport_rx_size_bytes_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_transport_tx_packets_total Count of packets sent</span><br><span class="line"># TYPE elasticsearch_transport_tx_packets_total counter</span><br><span class="line">elasticsearch_transport_tx_packets_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP elasticsearch_transport_tx_size_bytes_total Total number of bytes sent</span><br><span class="line"># TYPE elasticsearch_transport_tx_size_bytes_total counter</span><br><span class="line">elasticsearch_transport_tx_size_bytes_total&#123;cluster=&quot;powercloud_log&quot;,es_client_node=&quot;true&quot;,es_data_node=&quot;true&quot;,es_ingest_node=&quot;true&quot;,es_master_node=&quot;true&quot;,host=&quot;172.18.40.65&quot;,name=&quot;node-65&quot;&#125; 0</span><br><span class="line"># HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.</span><br><span class="line"># TYPE go_gc_duration_seconds summary</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;0&quot;&#125; 3.6794e-05</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;0.25&quot;&#125; 6.2783e-05</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;0.5&quot;&#125; 8.6707e-05</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;0.75&quot;&#125; 0.00011003</span><br><span class="line">go_gc_duration_seconds&#123;quantile=&quot;1&quot;&#125; 0.015864101</span><br><span class="line">go_gc_duration_seconds_sum 0.02416966</span><br><span class="line">go_gc_duration_seconds_count 40</span><br><span class="line"># HELP go_goroutines Number of goroutines that currently exist.</span><br><span class="line"># TYPE go_goroutines gauge</span><br><span class="line">go_goroutines 19</span><br><span class="line"># HELP go_info Information about the Go environment.</span><br><span class="line"># TYPE go_info gauge</span><br><span class="line">go_info&#123;version=&quot;go1.16.9&quot;&#125; 1</span><br><span class="line"># HELP go_memstats_alloc_bytes Number of bytes allocated and still in use.</span><br><span class="line"># TYPE go_memstats_alloc_bytes gauge</span><br><span class="line">go_memstats_alloc_bytes 3.887952e+06</span><br><span class="line"># HELP go_memstats_alloc_bytes_total Total number of bytes allocated, even if freed.</span><br><span class="line"># TYPE go_memstats_alloc_bytes_total counter</span><br><span class="line">go_memstats_alloc_bytes_total 9.1755768e+07</span><br><span class="line"># HELP go_memstats_buck_hash_sys_bytes Number of bytes used by the profiling bucket hash table.</span><br><span class="line"># TYPE go_memstats_buck_hash_sys_bytes gauge</span><br><span class="line">go_memstats_buck_hash_sys_bytes 1.458561e+06</span><br><span class="line"># HELP go_memstats_frees_total Total number of frees.</span><br><span class="line"># TYPE go_memstats_frees_total counter</span><br><span class="line">go_memstats_frees_total 884448</span><br><span class="line"># HELP go_memstats_gc_cpu_fraction The fraction of this program&#x27;s available CPU time used by the GC since the program started.</span><br><span class="line"># TYPE go_memstats_gc_cpu_fraction gauge</span><br><span class="line">go_memstats_gc_cpu_fraction 2.339386189125989e-05</span><br><span class="line"># HELP go_memstats_gc_sys_bytes Number of bytes used for garbage collection system metadata.</span><br><span class="line"># TYPE go_memstats_gc_sys_bytes gauge</span><br><span class="line">go_memstats_gc_sys_bytes 5.026296e+06</span><br><span class="line"># HELP go_memstats_heap_alloc_bytes Number of heap bytes allocated and still in use.</span><br><span class="line"># TYPE go_memstats_heap_alloc_bytes gauge</span><br><span class="line">go_memstats_heap_alloc_bytes 3.887952e+06</span><br><span class="line"># HELP go_memstats_heap_idle_bytes Number of heap bytes waiting to be used.</span><br><span class="line"># TYPE go_memstats_heap_idle_bytes gauge</span><br><span class="line">go_memstats_heap_idle_bytes 6.1202432e+07</span><br><span class="line"># HELP go_memstats_heap_inuse_bytes Number of heap bytes that are in use.</span><br><span class="line"># TYPE go_memstats_heap_inuse_bytes gauge</span><br><span class="line">go_memstats_heap_inuse_bytes 5.185536e+06</span><br><span class="line"># HELP go_memstats_heap_objects Number of allocated objects.</span><br><span class="line"># TYPE go_memstats_heap_objects gauge</span><br><span class="line">go_memstats_heap_objects 16097</span><br><span class="line"># HELP go_memstats_heap_released_bytes Number of heap bytes released to OS.</span><br><span class="line"># TYPE go_memstats_heap_released_bytes gauge</span><br><span class="line">go_memstats_heap_released_bytes 6.0555264e+07</span><br><span class="line"># HELP go_memstats_heap_sys_bytes Number of heap bytes obtained from system.</span><br><span class="line"># TYPE go_memstats_heap_sys_bytes gauge</span><br><span class="line">go_memstats_heap_sys_bytes 6.6387968e+07</span><br><span class="line"># HELP go_memstats_last_gc_time_seconds Number of seconds since 1970 of last garbage collection.</span><br><span class="line"># TYPE go_memstats_last_gc_time_seconds gauge</span><br><span class="line">go_memstats_last_gc_time_seconds 1.6412798140310771e+09</span><br><span class="line"># HELP go_memstats_lookups_total Total number of pointer lookups.</span><br><span class="line"># TYPE go_memstats_lookups_total counter</span><br><span class="line">go_memstats_lookups_total 0</span><br><span class="line"># HELP go_memstats_mallocs_total Total number of mallocs.</span><br><span class="line"># TYPE go_memstats_mallocs_total counter</span><br><span class="line">go_memstats_mallocs_total 900545</span><br><span class="line"># HELP go_memstats_mcache_inuse_bytes Number of bytes in use by mcache structures.</span><br><span class="line"># TYPE go_memstats_mcache_inuse_bytes gauge</span><br><span class="line">go_memstats_mcache_inuse_bytes 4800</span><br><span class="line"># HELP go_memstats_mcache_sys_bytes Number of bytes used for mcache structures obtained from system.</span><br><span class="line"># TYPE go_memstats_mcache_sys_bytes gauge</span><br><span class="line">go_memstats_mcache_sys_bytes 16384</span><br><span class="line"># HELP go_memstats_mspan_inuse_bytes Number of bytes in use by mspan structures.</span><br><span class="line"># TYPE go_memstats_mspan_inuse_bytes gauge</span><br><span class="line">go_memstats_mspan_inuse_bytes 84456</span><br><span class="line"># HELP go_memstats_mspan_sys_bytes Number of bytes used for mspan structures obtained from system.</span><br><span class="line"># TYPE go_memstats_mspan_sys_bytes gauge</span><br><span class="line">go_memstats_mspan_sys_bytes 98304</span><br><span class="line"># HELP go_memstats_next_gc_bytes Number of heap bytes when next garbage collection will take place.</span><br><span class="line"># TYPE go_memstats_next_gc_bytes gauge</span><br><span class="line">go_memstats_next_gc_bytes 5.69084e+06</span><br><span class="line"># HELP go_memstats_other_sys_bytes Number of bytes used for other system allocations.</span><br><span class="line"># TYPE go_memstats_other_sys_bytes gauge</span><br><span class="line">go_memstats_other_sys_bytes 856207</span><br><span class="line"># HELP go_memstats_stack_inuse_bytes Number of bytes in use by the stack allocator.</span><br><span class="line"># TYPE go_memstats_stack_inuse_bytes gauge</span><br><span class="line">go_memstats_stack_inuse_bytes 688128</span><br><span class="line"># HELP go_memstats_stack_sys_bytes Number of bytes obtained from system for stack allocator.</span><br><span class="line"># TYPE go_memstats_stack_sys_bytes gauge</span><br><span class="line">go_memstats_stack_sys_bytes 688128</span><br><span class="line"># HELP go_memstats_sys_bytes Number of bytes obtained from system.</span><br><span class="line"># TYPE go_memstats_sys_bytes gauge</span><br><span class="line">go_memstats_sys_bytes 7.4531848e+07</span><br><span class="line"># HELP go_threads Number of OS threads created.</span><br><span class="line"># TYPE go_threads gauge</span><br><span class="line">go_threads 9</span><br><span class="line"># HELP process_cpu_seconds_total Total user and system CPU time spent in seconds.</span><br><span class="line"># TYPE process_cpu_seconds_total counter</span><br><span class="line">process_cpu_seconds_total 0.87</span><br><span class="line"># HELP process_max_fds Maximum number of open file descriptors.</span><br><span class="line"># TYPE process_max_fds gauge</span><br><span class="line">process_max_fds 131072</span><br><span class="line"># HELP process_open_fds Number of open file descriptors.</span><br><span class="line"># TYPE process_open_fds gauge</span><br><span class="line">process_open_fds 13</span><br><span class="line"># HELP process_resident_memory_bytes Resident memory size in bytes.</span><br><span class="line"># TYPE process_resident_memory_bytes gauge</span><br><span class="line">process_resident_memory_bytes 1.5499264e+07</span><br><span class="line"># HELP process_start_time_seconds Start time of the process since unix epoch in seconds.</span><br><span class="line"># TYPE process_start_time_seconds gauge</span><br><span class="line">process_start_time_seconds 1.64127828876e+09</span><br><span class="line"># HELP process_virtual_memory_bytes Virtual memory size in bytes.</span><br><span class="line"># TYPE process_virtual_memory_bytes gauge</span><br><span class="line">process_virtual_memory_bytes 7.31824128e+08</span><br><span class="line"># HELP process_virtual_memory_max_bytes Maximum amount of virtual memory available in bytes.</span><br><span class="line"># TYPE process_virtual_memory_max_bytes gauge</span><br><span class="line">process_virtual_memory_max_bytes 1.8446744073709552e+19</span><br><span class="line"># HELP promhttp_metric_handler_requests_in_flight Current number of scrapes being served.</span><br><span class="line"># TYPE promhttp_metric_handler_requests_in_flight gauge</span><br><span class="line">promhttp_metric_handler_requests_in_flight 1</span><br><span class="line"># HELP promhttp_metric_handler_requests_total Total number of scrapes by HTTP status code.</span><br><span class="line"># TYPE promhttp_metric_handler_requests_total counter</span><br><span class="line">promhttp_metric_handler_requests_total&#123;code=&quot;200&quot;&#125; 85</span><br><span class="line">promhttp_metric_handler_requests_total&#123;code=&quot;500&quot;&#125; 0</span><br><span class="line">promhttp_metric_handler_requests_total&#123;code=&quot;503&quot;&#125; 0</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> äº‘ç›‘æ§ </tag>
            
            <tag> äº‘è®¡ç®— </tag>
            
            <tag> elasticsearch-exporter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>prometheusç›‘æ§ä¹‹nodeå„é¡¹æŒ‡æ ‡</title>
      <link href="/2022/01/06/prometheus%E7%9B%91%E6%8E%A7%E4%B9%8Bnode%E5%90%84%E9%A1%B9%E6%8C%87%E6%A0%87/"/>
      <url>/2022/01/06/prometheus%E7%9B%91%E6%8E%A7%E4%B9%8Bnode%E5%90%84%E9%A1%B9%E6%8C%87%E6%A0%87/</url>
      
        <content type="html"><![CDATA[<h1 id="æ ¹æ®node-exporteré‡‡é›†çš„æŒ‡æ ‡å¾—åˆ°æƒ³è¦çš„æŒ‡æ ‡"><a href="#æ ¹æ®node-exporteré‡‡é›†çš„æŒ‡æ ‡å¾—åˆ°æƒ³è¦çš„æŒ‡æ ‡" class="headerlink" title="æ ¹æ®node-exporteré‡‡é›†çš„æŒ‡æ ‡å¾—åˆ°æƒ³è¦çš„æŒ‡æ ‡"></a>æ ¹æ®node-exporteré‡‡é›†çš„æŒ‡æ ‡å¾—åˆ°æƒ³è¦çš„æŒ‡æ ‡</h1><ol><li><p>æ‰€æœ‰nodeèŠ‚ç‚¹çš„ç£ç›˜å¤§å°æ€»å’Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">typeï¼šSinglestat</span><br><span class="line">Unitï¼š bytes</span><br><span class="line">metrics:</span><br><span class="line">sum(node_filesystem_size_bytes&#123;device=~&quot;/.*&quot;&#125;)</span><br></pre></td></tr></table></figure></li><li><p>æ‰€æœ‰nodeèŠ‚ç‚¹çš„å†…å­˜å¤§å°æ€»å’Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">typeï¼šSinglestat</span><br><span class="line">Unitï¼š bytes</span><br><span class="line">metrics:</span><br><span class="line">sum(node_memory_MemTotal_bytes)</span><br></pre></td></tr></table></figure></li><li><p>æ‰€æœ‰nodeèŠ‚ç‚¹çš„CPUå¤§å°æ€»å’Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">typeï¼šSinglestat</span><br><span class="line">Unitï¼š bytes</span><br><span class="line">metrics:</span><br><span class="line">count(node_cpu_seconds_total&#123;mode=&#x27;system&#x27;&#125;)</span><br></pre></td></tr></table></figure></li><li></li></ol><h1 id="node-exporteré‡‡é›†çš„æŒ‡æ ‡"><a href="#node-exporteré‡‡é›†çš„æŒ‡æ ‡" class="headerlink" title="node-exporteré‡‡é›†çš„æŒ‡æ ‡"></a>node-exporteré‡‡é›†çš„æŒ‡æ ‡</h1>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> node-exporter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>img-test</title>
      <link href="/2022/01/06/img-test/"/>
      <url>/2022/01/06/img-test/</url>
      
        <content type="html"><![CDATA[<p>ç”¨äºæµ‹è¯•å›¾ç‰‡æ˜¯å¦å¯ä»¥æ­£å¸¸å±•ç¤º</p><img src="/2022/01/06/img-test/image-20220106104706904.png" class="" title="This is an image"><p><img src="image-20220106105728993.png" alt="image-20220106105728993"></p><p>æ“ä½œæ­¥éª¤ï¼š</p><ol><li>åœ¨_config.yml ä¸­ä¿®æ”¹å¦‚ä¸‹é…ç½®ä¸º true<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">post_asset_folder: true</span><br></pre></td></tr></table></figure></li><li>æ–‡ç« ä¸­ä½¿ç”¨å›¾ç‰‡</li></ol><ul><li>ç¬¬ä¸€ç§å¯ä»¥ä½¿ç”¨ï¼Œmakedownçš„æ ¼å¼  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![image-20220106105728993](image-20220106105728993.png)</span><br></pre></td></tr></table></figure></li><li>ç¬¬äºŒç§ ä½¿ç”¨å¦‚ä¸‹æ–¹å¼  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% asset_img image-20220106104706904.png This is an image %&#125;</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>æ³¨æ„ï¼šå…¶ä¸­çš„ image-20220106104706904.png ä¸ºéœ€è¦å±•ç¤ºçš„å›¾ç‰‡åç§°ï¼Œè¯¥å›¾ç‰‡ä¼šæ”¾åœ¨ä¸å½“å‰åšå®¢åŒåçš„ç›®å½•ä¸‹é¢</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–°çš„ç¬¬ä¸€ç¯‡åšå®¢</title>
      <link href="/2022/01/06/my-first-blog/"/>
      <url>/2022/01/06/my-first-blog/</url>
      
        <content type="html"><![CDATA[<h1 id="å¼€å§‹æ–°çš„åšå®¢"><a href="#å¼€å§‹æ–°çš„åšå®¢" class="headerlink" title="å¼€å§‹æ–°çš„åšå®¢"></a>å¼€å§‹æ–°çš„åšå®¢</h1><p>è¿™é‡Œä½¿ç”¨github+hexoæ­å»ºäº†è‡ªå·±çš„åšå®¢ï¼Œå‚è€ƒäº†å¦‚ä¸‹çš„åšå®¢æ–‡ç« ï¼š<br>[GitHub Pages + Hexoæ­å»ºä¸ªäººåšå®¢ç½‘ç«™ï¼Œå²ä¸Šæœ€å…¨æ•™ç¨‹] <a href="https://blog.csdn.net/yaorongke/article/details/119089190">https://blog.csdn.net/yaorongke/article/details/119089190</a></p><h1 id="hexoæ“ä½œ"><a href="#hexoæ“ä½œ" class="headerlink" title="hexoæ“ä½œ"></a>hexoæ“ä½œ</h1><ol><li>åˆ›å»ºæ–°åšå®¢æ–‡æ¡£<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new &#x27;åšå®¢æ–‡ç« æ ‡é¢˜&#x27;</span><br></pre></td></tr></table></figure></li><li>ç”Ÿæˆhtmlæ–‡ä»¶<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure></li><li>å‘å¸ƒåˆ°github<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure></li><li>å¯åŠ¨æœ¬åœ°<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure></li></ol><h1 id="åœ¨ä¸åŒæœºå™¨ä¸Šæ›´æ–°åšå®¢"><a href="#åœ¨ä¸åŒæœºå™¨ä¸Šæ›´æ–°åšå®¢" class="headerlink" title="åœ¨ä¸åŒæœºå™¨ä¸Šæ›´æ–°åšå®¢"></a>åœ¨ä¸åŒæœºå™¨ä¸Šæ›´æ–°åšå®¢</h1><ol><li><p>åœ¨æ–°æœºå™¨ä¸Šå®‰è£…npm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># è¿™é‡Œæ ¹æ®ä¸åŒçš„ç³»ç»Ÿè¿›è¡Œå®‰è£…</span><br></pre></td></tr></table></figure></li><li><p>å®‰è£…hexo</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br></pre></td></tr></table></figure></li><li><p>æ‹‰å–githubä¸Šé¢çš„é¡¹ç›®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:xxxxx/xxx.git</span><br></pre></td></tr></table></figure></li></ol><p>ç„¶åå³å¯åœ¨åšå®¢çš„æ ¹ç›®å½•ä¸‹ä½¿ç”¨hexoè¿›è¡Œæ“ä½œ</p>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>prometheusæœåŠ¡åŠ¨æ€å‘ç°ä¹‹http_sd_config</title>
      <link href="/2021/12/22/prometheus%E6%9C%8D%E5%8A%A1%E5%8A%A8%E6%80%81%E5%8F%91%E7%8E%B0%E4%B9%8Bhttp_sd_config/"/>
      <url>/2021/12/22/prometheus%E6%9C%8D%E5%8A%A1%E5%8A%A8%E6%80%81%E5%8F%91%E7%8E%B0%E4%B9%8Bhttp_sd_config/</url>
      
        <content type="html"><![CDATA[<p>prometheusæä¾›äº†å¤šç§åŠ¨æ€æœåŠ¡å‘ç°çš„æ–¹å¼ï¼Œè¿™é‡Œè®²ä¸€ä¸‹<code>http_sd_config</code>çš„é…ç½®æ–¹æ³•</p><h2 id="å®˜æ–¹è¯´æ˜"><a href="#å®˜æ–¹è¯´æ˜" class="headerlink" title="å®˜æ–¹è¯´æ˜"></a>å®˜æ–¹è¯´æ˜</h2><p>å…ˆæ¥çœ‹ä¸‹prometheuså®˜æ–¹æ–‡æ¡£çš„è¯´æ˜</p><p><img src="image-20211222181659426.png" alt="image-20211222181659426"></p><p>å¤§è‡´å°±æ˜¯è¯´ï¼šéœ€è¦è‡ªå·±æä¾›ä¸€ä¸ªhttpè®¿é—®åœ°å€ï¼Œprometheusèƒ½å¤Ÿé€šè¿‡è®¿é—®è¯¥åœ°å€å¾—åˆ°éœ€è¦å‘ç°çš„æœåŠ¡èŠ‚ç‚¹çš„æ•°æ®ï¼Œå¹¶ä¸”è¯¥åœ°å€è¿”å›çš„jsonæ•°æ®ç»“æ„è¦ä¸å›¾ä¸­ä¿æŒä¸€è‡´ã€‚</p><h2 id="é…ç½®è¯´æ˜"><a href="#é…ç½®è¯´æ˜" class="headerlink" title="é…ç½®è¯´æ˜"></a>é…ç½®è¯´æ˜</h2><p>å†æ¥çœ‹ä¸‹å…³äºè¯¥é€‰é¡¹æœ‰å“ªäº›é…ç½®é¡¹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–ç›®æ ‡æœåŠ¡çš„åœ°å€</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">&lt;string&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ·æ–°é¢‘ç‡ï¼Œé—´éš”å¤šä¹…å†æ¬¡è°ƒç”¨urlè·å–ç›®æ ‡æœåŠ¡</span></span><br><span class="line">[ <span class="attr">refresh_interval:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">60s</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># APIæœåŠ¡å™¨çš„èº«ä»½éªŒè¯ä¿¡æ¯ï¼Œç”¨äºè®¿é—®urlæ—¶éªŒè¯èº«ä»½ç”¨</span></span><br><span class="line"><span class="comment"># ä¸‹é¢è¿™å‡ é¡¹ `basic_auth`, `authorization` ã€`oauth2` æ˜¯äº’æ–¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µé…ä¸€é¡¹èº«ä»½éªŒè¯çš„æ–¹å¼å°±å¯ä»¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯é€‰çš„HTTPåŸºæœ¬è®¤è¯ä¿¡æ¯ã€‚å…¶ä¸­ `password` and `password_file` è¿™ä¸¤é¡¹æ˜¯äº’æ–¥çš„</span></span><br><span class="line"><span class="attr">basic_auth:</span></span><br><span class="line">  [ <span class="attr">username:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line">  [ <span class="attr">password:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line">  [ <span class="attr">password_file:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯é€‰çš„â€œæˆæƒâ€å¤´é…ç½®ã€‚</span></span><br><span class="line"><span class="attr">authorization:</span></span><br><span class="line">  <span class="comment"># Sets the authentication type.</span></span><br><span class="line">  [ <span class="attr">type:</span> <span class="string">&lt;string&gt;</span> <span class="string">|</span> <span class="attr">default:</span> <span class="string">Bearer</span> ]</span><br><span class="line">  <span class="comment"># Sets the credentials. It is mutually exclusive with</span></span><br><span class="line">  <span class="comment"># `credentials_file`.</span></span><br><span class="line">  [ <span class="attr">credentials:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line">  <span class="comment"># Sets the credentials to the credentials read from the configured file.</span></span><br><span class="line">  <span class="comment"># It is mutually exclusive with `credentials`.</span></span><br><span class="line">  [ <span class="attr">credentials_file:</span> <span class="string">&lt;filename&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># #å¯é€‰OAuth 2.0é…ç½®ã€‚</span></span><br><span class="line"><span class="attr">oauth2:</span></span><br><span class="line">  [ <span class="string">&lt;oauth2&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional proxy URL.</span></span><br><span class="line">[ <span class="attr">proxy_url:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure whether HTTP requests follow HTTP 3xx redirects.</span></span><br><span class="line">[ <span class="attr">follow_redirects:</span> <span class="string">&lt;bool&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">true</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># TLS configuration.</span></span><br><span class="line"><span class="attr">tls_config:</span></span><br><span class="line">  [ <span class="string">&lt;tls_config&gt;</span> ]</span><br></pre></td></tr></table></figure><p>å¦‚æœè‡ªå·±æä¾›çš„æ¥å£ä¸ç”¨éªŒè¯èº«ä»½ï¼Œé‚£ä¹ˆåªéœ€è¦é…ç½®urlå’Œåˆ·æ–°é¢‘ç‡å³å¯ï¼›</p><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p><strong>å‰æï¼š</strong></p><ul><li>å·²ç»éƒ¨ç½²å¥½äº†prometheuså’Œå„exporterçš„èŠ‚ç‚¹</li><li>å…¶ä¸­prometheusæœ€å¥½æ˜¯æœ€æ–°ç‰ˆï¼ˆ2.30ç‰ˆæœ¬åŠä»¥å‰çš„ç‰ˆæœ¬å¥½åƒä¸æ”¯æŒï¼‰</li></ul><h3 id="å¼€å‘åŠ¨æ€è·å–æœåŠ¡çš„æ¥å£"><a href="#å¼€å‘åŠ¨æ€è·å–æœåŠ¡çš„æ¥å£" class="headerlink" title="å¼€å‘åŠ¨æ€è·å–æœåŠ¡çš„æ¥å£"></a>å¼€å‘åŠ¨æ€è·å–æœåŠ¡çš„æ¥å£</h3><p>æˆ‘è¿™é‡Œç”¨çš„javaå¼€å‘çš„ä¸€ä¸ªåç«¯ç¨‹åºï¼Œcontrollerçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/prometheus&quot;)</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrometheusController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/getTarget&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getTarget</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List exporterList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        Map target = <span class="keyword">new</span> HashMap();</span><br><span class="line">        <span class="comment">// æœåŠ¡èŠ‚ç‚¹åœ°å€</span></span><br><span class="line">        List targetList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        targetList.add(<span class="string">&quot;172.18.40.40:9100&quot;</span>);</span><br><span class="line">        targetList.add(<span class="string">&quot;172.18.40.91:9100&quot;</span>);</span><br><span class="line">        <span class="comment">// æ ‡ç­¾</span></span><br><span class="line">        Map labelsMap = <span class="keyword">new</span> HashMap();</span><br><span class="line">        labelsMap.put(<span class="string">&quot;acc&quot;</span> , <span class="string">&quot;acc1&quot;</span>);</span><br><span class="line">        labelsMap.put(<span class="string">&quot;uuid&quot;</span> , <span class="string">&quot;123123&quot;</span>);</span><br><span class="line"></span><br><span class="line">        target.put(<span class="string">&quot;targets&quot;</span> , targetList);</span><br><span class="line">        target.put(<span class="string">&quot;labels&quot;</span> , labelsMap);</span><br><span class="line"></span><br><span class="line">        exporterList.add(target);</span><br><span class="line">        <span class="keyword">return</span> JSONObject.toJSONString(exporterList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­ï¼Œè®¿é—®è¯¥æ¥å£ï¼ŒæŸ¥çœ‹è¿”å›çš„æ•°æ®å¦‚ä¸‹ï¼š</p><p><img src="image-20211222184806273.png" alt="image-20211222184806273"></p><h3 id="ä¿®æ”¹prometheusçš„é…ç½®"><a href="#ä¿®æ”¹prometheusçš„é…ç½®" class="headerlink" title="ä¿®æ”¹prometheusçš„é…ç½®"></a>ä¿®æ”¹prometheusçš„é…ç½®</h3><p>prometheusçš„é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">scrape_configs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;test-node&#x27;</span></span><br><span class="line">    <span class="attr">http_sd_configs:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">url:</span> <span class="string">http://172.26.62.xx:12000/prometheus/getTarget</span></span><br><span class="line">        <span class="attr">refresh_interval:</span> <span class="string">5s</span></span><br></pre></td></tr></table></figure><blockquote><p>é…ç½®è¯´æ˜ï¼š</p><p><a href="http://172.26.62.xx:12000/prometheus/getTarget%EF%BC%9A%E8%AF%A5%E5%9C%B0%E5%9D%80%E6%98%AF%E5%90%8E%E7%AB%AF%E7%A8%8B%E5%BA%8F%E6%8F%90%E4%BE%9B%E7%9A%84">http://172.26.62.xx:12000/prometheus/getTargetï¼šè¯¥åœ°å€æ˜¯åç«¯ç¨‹åºæä¾›çš„</a></p></blockquote><p>ä¿®æ”¹å®Œprometheusçš„é…ç½®åï¼Œé‡å¯prometheusæˆ–è°ƒç”¨prometheusçš„reloadçš„æ¥å£(<a href="http://ip:port/-/reload">http://ip:port/-/reload</a>)</p><h3 id="æ£€æŸ¥"><a href="#æ£€æŸ¥" class="headerlink" title="æ£€æŸ¥"></a>æ£€æŸ¥</h3><p>è®¿é—®prometheusçš„ç•Œé¢ï¼ŒæŸ¥çœ‹æˆ‘åç«¯æ¥å£æä¾›çš„æœåŠ¡æ˜¯å¦è¢«å‘ç°</p><p><img src="image-20211222184910138.png" alt="image-20211222184910138"></p><p>å¯ä»¥å‘ç°ï¼Œprometheuså·²ç»æˆåŠŸç›‘æ§åˆ°äº†æä¾›çš„æœåŠ¡ï¼›</p><h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><p>ä¿®æ”¹æ¥å£æä¾›çš„æ•°æ®ï¼Œåœ¨ä¸é‡å¯å’Œä¸é‡æ–°åŠ è½½prometheusçš„æƒ…å†µä¸‹ï¼Œè§‚å¯Ÿprometheusä¼šä¸ä¼šå˜åŒ–ç›‘æ§çš„èŠ‚ç‚¹</p><ol><li>æˆ‘åœ¨åç«¯æœåŠ¡æ¥å£ä¸­ï¼Œæ·»åŠ äº†ä¸€ä¸ªä¸å­˜åœ¨çš„èŠ‚ç‚¹</li></ol><p><img src="image-20211222185422933.png" alt="image-20211222185422933"></p><ol start="2"><li>ç­‰å¾…å‡ ç§’é’Ÿåï¼Œå¯ä»¥å‘ç°prometheuså‘ç°äº†è¯¥èŠ‚ç‚¹ï¼Œä½†è¿˜æ²¡æœ‰å»è®¿é—®è¯¥èŠ‚ç‚¹å»è·å–ç›‘æ§æ•°æ®ï¼Œå› æ­¤çŠ¶æ€ä¸ºUNKNOWN</li></ol><p><img src="image-20211222185438507.png" alt="image-20211222185438507"></p><ol start="3"><li>åœ¨ç­‰å‡ ç§’ï¼Œprometheuså»è®¿é—®è¯¥å‡ ç‚¹æ—¶ï¼Œå‘ç°æœåŠ¡æ˜¯ä¸å­˜åœ¨çš„ï¼Œè°ƒæ•´çŠ¶æ€ä¸ºDOWN</li></ol><p><img src="image-20211222185501042.png" alt="image-20211222185501042"></p><ol start="4"><li>ä»prometheusçš„æ—¥å¿—ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œæ¯éš” 5s å°±æ‰ä¸€æ¬¡æˆ‘çš„åç«¯æœåŠ¡</li></ol><p><img src="image-20211222191259320.png" alt="image-20211222191259320"></p>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> äº‘ç›‘æ§ </tag>
            
            <tag> äº‘è®¡ç®— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Nginxè®¿é—®é™åˆ¶é…ç½®</title>
      <link href="/2021/12/15/Nginx%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6%E9%85%8D%E7%BD%AE/"/>
      <url>/2021/12/15/Nginx%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="é™åˆ¶ä¸‹è½½é€Ÿåº¦"><a href="#é™åˆ¶ä¸‹è½½é€Ÿåº¦" class="headerlink" title="é™åˆ¶ä¸‹è½½é€Ÿåº¦"></a>é™åˆ¶ä¸‹è½½é€Ÿåº¦</h1><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location xxx &#123;</span><br><span class="line">            limit_rate 100k;</span><br><span class="line">...</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p><img src="image-20220107120229415.png" alt="image-20220107120229415"></p><p>é‡å¯nginxåï¼Œå¯ä»¥å‘ç°ä¸‹è½½é€Ÿåº¦ï¼Œç¡®å®è¢«é™åˆ¶åœ¨ 100k/s å·¦å³</p><p><img src="image-20220107120250231.png" alt="image-20220107120250231"></p><h1 id="é™åˆ¶å¹¶å‘æ•°"><a href="#é™åˆ¶å¹¶å‘æ•°" class="headerlink" title="é™åˆ¶å¹¶å‘æ•°"></a>é™åˆ¶å¹¶å‘æ•°</h1><p>æ·»åŠ å¦‚ä¸‹ä¸¤è¡Œå‚æ•°</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http&#123;</span><br><span class="line">limit_conn_zone $binary_remote_addr zone=one:10m;</span><br><span class="line">...</span><br><span class="line">service&#123;</span><br><span class="line">...</span><br><span class="line">location xxx&#123;</span><br><span class="line">limit_conn one <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="image-20220107120309413.png" alt="image-20220107120309413"></p>]]></content>
      
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Prometheuså­¦ä¹ è®°å½•</title>
      <link href="/2021/10/10/Prometheus%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/"/>
      <url>/2021/10/10/Prometheus%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ol><li>Prometheus æ˜¯ä»€ä¹ˆï¼›</li><li>æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å»äº†è§£Prometheus ï¼›</li><li>ä¸ºä»€ä¹ˆæ˜¯Prometheus è€Œä¸æ˜¯å…¶ä»–çš„ç›‘æ§ç³»ç»Ÿï¼›Prometheus ä¸ ç›®å‰ ç›¸å¯¹æ¯”è¾ƒæ´»è·ƒçš„å…¶ä»–ç›‘æ§ç³»ç»Ÿæœ‰å“ªäº› ä¼˜åŠ¿ï¼›</li><li>äº†è§£Prometheus çš„åŸºæœ¬æ¶æ„ï¼Œä»¥åŠPrometheus æ˜¯å¦‚ä½•è¿ä½œçš„ï¼›</li></ol><h2 id="Prometheus-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Prometheus-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Prometheus æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Prometheus æ˜¯ä»€ä¹ˆï¼Ÿ</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>Prometheuså—å¯å‘äºGoogleçš„Brogmonç›‘æ§ç³»ç»Ÿï¼ˆç›¸ä¼¼çš„Kubernetesæ˜¯ä»Googleçš„Brogç³»ç»Ÿæ¼”å˜è€Œæ¥ï¼‰ï¼Œä»2012å¹´å¼€å§‹ç”±å‰Googleå·¥ç¨‹å¸ˆåœ¨Soundcloudä»¥å¼€æºè½¯ä»¶çš„å½¢å¼è¿›è¡Œç ”å‘ï¼Œå¹¶ä¸”äº2015å¹´æ—©æœŸå¯¹å¤–å‘å¸ƒæ—©æœŸç‰ˆæœ¬ã€‚2016å¹´5æœˆç»§Kubernetesä¹‹åæˆä¸ºç¬¬äºŒä¸ªæ­£å¼åŠ å…¥CNCFåŸºé‡‘ä¼šçš„é¡¹ç›®ï¼ŒåŒå¹´6æœˆæ­£å¼å‘å¸ƒ1.0ç‰ˆæœ¬ã€‚2017å¹´åº•å‘å¸ƒäº†åŸºäºå…¨æ–°å­˜å‚¨å±‚çš„2.0ç‰ˆæœ¬ï¼Œèƒ½æ›´å¥½åœ°ä¸å®¹å™¨å¹³å°ã€äº‘å¹³å°é…åˆã€‚</p><p><img src="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/prometheus-release-roadmaps.png" alt="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/prometheus-release-roadmaps.png"></p><p>Prometheusç®€å²</p><p>Prometheusä½œä¸ºæ–°ä¸€ä»£çš„äº‘åŸç”Ÿç›‘æ§ç³»ç»Ÿï¼Œç›®å‰å·²ç»æœ‰è¶…è¿‡650+ä½è´¡çŒ®è€…å‚ä¸åˆ°Prometheusçš„ç ”å‘å·¥ä½œä¸Šï¼Œå¹¶ä¸”è¶…è¿‡120+é¡¹çš„ç¬¬ä¸‰æ–¹é›†æˆã€‚</p><p>ç›®å‰çš„ç¤¾åŒºæ´»è·ƒåº¦ï¼šä»å¦‚ä¸‹åœ¨githubä¸Šçš„æˆªå›¾å¯ä»¥çœ‹å‡ºå…¶æ´»è·ƒåº¦ (æˆªå›¾æ—¶é—´2021.9.2)<br><img src="https://s2.loli.net/2022/01/10/vA58OKX3NgrDjkz.png" alt="20220110223828"></p><h3 id="ç›‘æ§ç›®æ ‡"><a href="#ç›‘æ§ç›®æ ‡" class="headerlink" title="ç›‘æ§ç›®æ ‡"></a>ç›‘æ§ç›®æ ‡</h3><ul><li>é•¿æœŸè¶‹åŠ¿åˆ†æï¼šé€šè¿‡å¯¹ç›‘æ§æ ·æœ¬æ•°æ®çš„æŒç»­æ”¶é›†å’Œç»Ÿè®¡ï¼Œå¯¹ç›‘æ§æŒ‡æ ‡è¿›è¡Œé•¿æœŸè¶‹åŠ¿åˆ†æã€‚ä¾‹å¦‚ï¼Œé€šè¿‡å¯¹ç£ç›˜ç©ºé—´å¢é•¿ç‡çš„åˆ¤æ–­ï¼Œæˆ‘ä»¬å¯ä»¥æå‰é¢„æµ‹åœ¨æœªæ¥ä»€ä¹ˆæ—¶é—´èŠ‚ç‚¹ä¸Šéœ€è¦å¯¹èµ„æºè¿›è¡Œæ‰©å®¹ã€‚ï¼ˆ<strong>å®é™…å°±æ˜¯ä½¿ç”¨PromQLè¡¨è¾¾å¼ï¼ˆå†…ç½®çš„å‡½æ•°ï¼‰å¯¹é‡‡é›†çš„ç›‘æ§æ•°æ®è¿›è¡Œæ•°å­¦åˆ†æï¼ˆç»Ÿè®¡å­¦ï¼‰</strong> ï¼‰</li><li>å¯¹ç…§åˆ†æï¼šä¸¤ä¸ªç‰ˆæœ¬çš„ç³»ç»Ÿè¿è¡Œèµ„æºä½¿ç”¨æƒ…å†µçš„å·®å¼‚å¦‚ä½•ï¼Ÿåœ¨ä¸åŒå®¹é‡æƒ…å†µä¸‹ç³»ç»Ÿçš„å¹¶å‘å’Œè´Ÿè½½å˜åŒ–å¦‚ä½•ï¼Ÿé€šè¿‡ç›‘æ§èƒ½å¤Ÿæ–¹ä¾¿çš„å¯¹ç³»ç»Ÿè¿›è¡Œè·Ÿè¸ªå’Œæ¯”è¾ƒã€‚ï¼ˆ<strong>åŒæ ·æ˜¯åŸºäºç›‘æ§æ•°æ®ï¼Œä¾‹å¦‚ï¼šä¸¤ä¸ªç›¸åŒåº”ç”¨åœ¨ä¸åŒçš„ç³»ç»Ÿèµ„æºä¸‹çš„å¹¶å‘å’Œè´Ÿè½½å˜åŒ–å¯¹æ¯”</strong>ï¼‰</li><li>å‘Šè­¦ï¼šå½“ç³»ç»Ÿå‡ºç°æˆ–è€…å³å°†å‡ºç°æ•…éšœæ—¶ï¼Œç›‘æ§ç³»ç»Ÿéœ€è¦è¿…é€Ÿååº”å¹¶é€šçŸ¥ç®¡ç†å‘˜ï¼Œä»è€Œèƒ½å¤Ÿå¯¹é—®é¢˜è¿›è¡Œå¿«é€Ÿçš„å¤„ç†æˆ–è€…æå‰é¢„é˜²é—®é¢˜çš„å‘ç”Ÿï¼Œé¿å…å‡ºç°å¯¹ä¸šåŠ¡çš„å½±å“ã€‚ï¼ˆï¼‰  <strong>Prometheus æœåŠ¡ç«¯äº§ç”Ÿå‘Šè­¦ï¼Œç”±Alertmanagerè¿›è¡Œå¤„ç†</strong></li><li>æ•…éšœåˆ†æä¸å®šä½ï¼šå½“é—®é¢˜å‘ç”Ÿåï¼Œéœ€è¦å¯¹é—®é¢˜è¿›è¡Œè°ƒæŸ¥å’Œå¤„ç†ã€‚é€šè¿‡å¯¹ä¸åŒç›‘æ§ç›‘æ§ä»¥åŠå†å²æ•°æ®çš„åˆ†æï¼Œèƒ½å¤Ÿæ‰¾åˆ°å¹¶è§£å†³æ ¹æºé—®é¢˜ã€‚ï¼ˆ<strong>åˆ†æç›‘æ§æ•°æ®</strong>ï¼‰</li><li>æ•°æ®å¯è§†åŒ–ï¼šé€šè¿‡å¯è§†åŒ–ä»ªè¡¨ç›˜èƒ½å¤Ÿç›´æ¥è·å–ç³»ç»Ÿçš„è¿è¡ŒçŠ¶æ€ã€èµ„æºä½¿ç”¨æƒ…å†µã€ä»¥åŠæœåŠ¡è¿è¡ŒçŠ¶æ€ç­‰ç›´è§‚çš„ä¿¡æ¯ã€‚ï¼ˆ<strong>Prometheus è‡ªå¸¦æ•°æ®å¯è§†åŒ–UI ï¼Œ ä½†æ˜¯æ¯”è¾ƒç®€å•</strong>ï¼‰</li></ul><p>è¿™é‡Œè¿˜æ˜¯åªæ˜¯å¯¹Prometheus è¿›è¡Œäº†ä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„å°†å…¶ç±»æ¯”å’Œå®‡äº‘çš„ monitor(äº‘ç›‘æ§ä¸­å¿ƒ)</p><h2 id="ä¸ºä»€ä¹ˆè¦å»äº†è§£Prometheus"><a href="#ä¸ºä»€ä¹ˆè¦å»äº†è§£Prometheus" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å»äº†è§£Prometheus"></a>ä¸ºä»€ä¹ˆè¦å»äº†è§£Prometheus</h2><p>æˆ–è€…è¯´ä¸ºä»€ä¹ˆè¦äº†è§£å…¶ä»–çš„ ç›‘æ§ç³»ç»Ÿï¼Œæˆ‘ä»¬çš„å¹³å°å·²ç»æœ‰äº† äº‘ç›‘æ§ä¸­å¿ƒï¼›</p><p>ä¸ªäººè®¤ä¸ºæœ‰å¦‚ä¸‹å‡ ä¸ªåŸå› ï¼š</p><ol><li>äº†è§£å…¶ä»–çš„ç›‘æ§ç³»ç»Ÿï¼Œå­¦ä¹ å®ƒä»¬çš„ä¼˜ç‚¹ï¼Œå¯¹ æˆ‘ä»¬å¹³å°çš„äº‘ç›‘æ§è¿›è¡Œä¼˜åŒ–ï¼Œä¾‹å¦‚ ç›‘æ§æŒ‡æ ‡çš„å®Œå–„ä¸ä¼˜åŒ–</li><li>ç›®å‰æˆ‘ä»¬çš„äº‘ç›‘æ§ä¸­å¿ƒæ˜¯åŸºäºè™šæ‹Ÿæœºçš„ç›‘æ§ï¼Œå¯¹å®¹å™¨çš„ç›‘æ§è¿˜æ²¡æœ‰æ¶‰è¶³ï¼Œéœ€è¦å­¦ä¹ è¿™äº›ä¼˜ç§€äº§å“çš„ç»éªŒï¼Œä¸ºåæœŸå’Œå®‡äº‘è¿›å†›k8såšå‡†å¤‡</li></ol><p>å½“ç„¶é’ˆå¯¹ä¸åŒçš„éœ€æ±‚ï¼Œè¿˜éœ€è¦å…·ä½“åˆ†æ</p><h2 id="å„ç›‘æ§ç³»ç»Ÿçš„å¯¹æ¯”"><a href="#å„ç›‘æ§ç³»ç»Ÿçš„å¯¹æ¯”" class="headerlink" title="å„ç›‘æ§ç³»ç»Ÿçš„å¯¹æ¯”"></a>å„ç›‘æ§ç³»ç»Ÿçš„å¯¹æ¯”</h2><p>ç›®å‰å¸‚é¢ä¸Šç›¸å¯¹æ¯”è¾ƒæ´»è·ƒçš„ç›‘æ§ç³»ç»Ÿï¼š</p><ul><li>Prometheus</li><li>Zabbix</li><li>Nagios</li></ul><h3 id="Prometheus-ä¸-Zabbix-å¯¹æ¯”"><a href="#Prometheus-ä¸-Zabbix-å¯¹æ¯”" class="headerlink" title="Prometheus ä¸ Zabbix å¯¹æ¯”"></a>Prometheus ä¸ Zabbix å¯¹æ¯”</h3><h3 id="æ¶æ„å¯¹æ¯”"><a href="#æ¶æ„å¯¹æ¯”" class="headerlink" title="æ¶æ„å¯¹æ¯”"></a>æ¶æ„å¯¹æ¯”</h3><p>prometheus:<br><img src="https://s2.loli.net/2022/01/10/4XbgTnJldGeV6vF.png" alt="20220110224409"></p><p>zabbix:<br><img src="https://s2.loli.net/2022/01/10/5msuDeH1y2polVK.png" alt="20220110224548"></p><h3 id="ç»¼åˆå¯¹æ¯”"><a href="#ç»¼åˆå¯¹æ¯”" class="headerlink" title="ç»¼åˆå¯¹æ¯”"></a>ç»¼åˆå¯¹æ¯”</h3><p><img src="https://s2.loli.net/2022/01/10/d6bKIP7oscNl4Oy.png" alt="20220110224609"></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æˆ‘ä»¬è¦å¯¹å®¹å™¨è¿›è¡Œå…¼å®¹ï¼Œåˆ™éœ€è¦å­¦ä¹ Prometheusã€‚</p><h3 id="Prometheus-ä¸-Nagios-å¯¹æ¯”"><a href="#Prometheus-ä¸-Nagios-å¯¹æ¯”" class="headerlink" title="Prometheus ä¸ Nagios å¯¹æ¯”"></a>Prometheus ä¸ Nagios å¯¹æ¯”</h3><h3 id="æ¶æ„å¯¹æ¯”-1"><a href="#æ¶æ„å¯¹æ¯”-1" class="headerlink" title="æ¶æ„å¯¹æ¯”"></a>æ¶æ„å¯¹æ¯”</h3><p><img src="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/nagios-platform.png" alt="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/nagios-platform.png"></p><p>Nagiosç›‘æ§ç³»ç»Ÿ</p><p>Nagiosçš„ä¸»è¦åŠŸèƒ½æ˜¯ç›‘æ§æœåŠ¡å’Œä¸»æœºã€‚Nagiosè½¯ä»¶éœ€è¦å®‰è£…åœ¨ä¸€å°ç‹¬ç«‹çš„æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œè¯¥æœåŠ¡å™¨ç§°ä¸ºç›‘æ§ä¸­å¿ƒã€‚æ¯ä¸€å°è¢«ç›‘æ§çš„ç¡¬ä»¶ä¸»æœºæˆ–è€…æœåŠ¡éƒ½éœ€è¦è¿è¡Œä¸€ä¸ªä¸ç›‘æ§ä¸­å¿ƒæœåŠ¡å™¨è¿›è¡Œé€šä¿¡çš„Nagiosè½¯ä»¶åå°ç¨‹åºï¼Œå¯ä»¥ç†è§£ä¸ºAgentæˆ–è€…æ’ä»¶ï¼›</p><p><img src="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/nagios-ui.png" alt="https://static.sitestack.cn/projects/prometheus-book/quickstart/static/nagios-ui.png"></p><p>Nagiosä¸»æœºç›‘æ§é¡µé¢</p><p>é¦–å…ˆå¯¹äºNagiosè€Œè¨€ï¼Œå¤§éƒ¨åˆ†çš„ç›‘æ§èƒ½åŠ›éƒ½æ˜¯å›´ç»•ç³»ç»Ÿçš„ä¸€äº›è¾¹ç¼˜æ€§çš„é—®é¢˜ï¼Œä¸»è¦é’ˆå¯¹ç³»ç»ŸæœåŠ¡å’Œèµ„æºçš„çŠ¶æ€ä»¥åŠåº”ç”¨ç¨‹åºçš„å¯ç”¨æ€§ã€‚ ä¾‹å¦‚ï¼šNagiosé€šè¿‡check_diskæ’ä»¶å¯ä»¥ç”¨äºæ£€æŸ¥ç£ç›˜ç©ºé—´ï¼Œcheck_loadç”¨äºæ£€æŸ¥CPUè´Ÿè½½ç­‰ã€‚è¿™äº›æ’ä»¶ä¼šè¿”å›4ç§Nagioså¯è¯†åˆ«çš„çŠ¶æ€ï¼Œ0(OK)è¡¨ç¤ºæ­£å¸¸ï¼Œ1(WARNING)è¡¨ç¤ºè­¦å‘Šï¼Œ2(CRITTCAL)è¡¨ç¤ºé”™è¯¯ï¼Œ3(UNKNOWN)è¡¨ç¤ºæœªçŸ¥é”™è¯¯ï¼Œå¹¶é€šè¿‡Web UIæ˜¾ç¤ºå‡ºæ¥ã€‚</p><p>å¯¹äºNagiosè¿™ç±»ç³»ç»Ÿè€Œè¨€ï¼Œå…¶æ ¸å¿ƒæ˜¯é‡‡ç”¨äº†æµ‹è¯•å’Œå‘Šè­¦(check&amp;alert)çš„ç›‘æ§ç³»ç»Ÿæ¨¡å‹ã€‚ å¯¹äºåŸºäºè¿™ç±»æ¨¡å‹çš„ç›‘æ§ç³»ç»Ÿè€Œè¨€å¾€å¾€å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li>ä¸ä¸šåŠ¡è„±ç¦»çš„ç›‘æ§ï¼šç›‘æ§ç³»ç»Ÿè·å–åˆ°çš„ç›‘æ§æŒ‡æ ‡ä¸ä¸šåŠ¡æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§åˆ†ç¦»çš„å…³ç³»ã€‚å¥½æ¯”å®¢æˆ·å¯èƒ½å…³æ³¨çš„æ˜¯æœåŠ¡çš„å¯ç”¨æ€§ã€æœåŠ¡çš„SLAç­‰çº§ï¼Œè€Œç›‘æ§ç³»ç»Ÿå´åªèƒ½æ ¹æ®ç³»ç»Ÿè´Ÿè½½å»äº§ç”Ÿå‘Šè­¦ï¼›</li><li>è¿ç»´ç®¡ç†éš¾åº¦å¤§ï¼šNagiosè¿™ä¸€ç±»ç›‘æ§ç³»ç»Ÿæœ¬èº«è¿ç»´ç®¡ç†éš¾åº¦å°±æ¯”è¾ƒå¤§ï¼Œéœ€è¦æœ‰ä¸“ä¸šçš„äººå‘˜è¿›è¡Œå®‰è£…ï¼Œé…ç½®å’Œç®¡ç†ï¼Œè€Œä¸”è¿‡ç¨‹å¹¶ä¸ç®€å•ï¼›</li><li>å¯æ‰©å±•æ€§ä½ï¼š ç›‘æ§ç³»ç»Ÿè‡ªèº«éš¾ä»¥æ‰©å±•ï¼Œä»¥é€‚åº”ç›‘æ§è§„æ¨¡çš„å˜åŒ–ï¼›</li><li>é—®é¢˜å®šä½éš¾åº¦å¤§ï¼šå½“é—®é¢˜äº§ç”Ÿä¹‹åï¼ˆæ¯”å¦‚ä¸»æœºè´Ÿè½½å¼‚å¸¸å¢åŠ ï¼‰å¯¹äºç”¨æˆ·è€Œè¨€ï¼Œä»–ä»¬çœ‹åˆ°çš„ä¾ç„¶æ˜¯ä¸€ä¸ªé»‘ç›’ï¼Œä»–ä»¬æ— æ³•äº†è§£ä¸»æœºä¸ŠæœåŠ¡çœŸæ­£çš„è¿è¡Œæƒ…å†µï¼Œå› æ­¤å½“æ•…éšœå‘ç”Ÿåï¼Œè¿™äº›å‘Šè­¦ä¿¡æ¯å¹¶ä¸èƒ½æœ‰æ•ˆçš„æ”¯æŒç”¨æˆ·å¯¹äºæ•…éšœæ ¹æºé—®é¢˜çš„åˆ†æå’Œå®šä½ã€‚</li></ul><p>nagiosç°åœ¨ç”¨çš„ç›¸å¯¹æ¯”è¾ƒå°‘äº†ï¼Œæ•°æ®å±•ç¤ºå¤ªä¸å‹å¥½ï¼Œè¿˜éœ€è¦æ’ä»¶å®ç°ï¼Œuiä¹Ÿä¸å¤Ÿç¾è§‚ï¼›è‡ªåŠ¨åŒ–æ‰¹é‡ç›‘æ§ä¹Ÿæ‰é“¾å­ã€‚</p><h3 id="Prometheus-çš„ä¼˜åŠ¿"><a href="#Prometheus-çš„ä¼˜åŠ¿" class="headerlink" title="Prometheus çš„ä¼˜åŠ¿"></a>Prometheus çš„ä¼˜åŠ¿</h3><p>Prometheusæ˜¯ä¸€ä¸ªå¼€æºçš„å®Œæ•´ç›‘æ§è§£å†³æ–¹æ¡ˆï¼Œå…¶å¯¹ä¼ ç»Ÿç›‘æ§ç³»ç»Ÿçš„æµ‹è¯•å’Œå‘Šè­¦æ¨¡å‹è¿›è¡Œäº†å½»åº•çš„é¢ è¦†ï¼Œå½¢æˆäº†åŸºäºä¸­å¤®åŒ–çš„è§„åˆ™è®¡ç®—ã€ç»Ÿä¸€åˆ†æå’Œå‘Šè­¦çš„æ–°æ¨¡å‹ã€‚ ç›¸æ¯”äºä¼ ç»Ÿç›‘æ§ç³»ç»ŸPrometheuså…·æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ul><li><strong>æ˜“äºç®¡ç†</strong>  PrometheusåŸºäºPullæ¨¡å‹çš„æ¶æ„æ–¹å¼ï¼Œå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ï¼ˆæœ¬åœ°ç”µè„‘ï¼Œå¼€å‘ç¯å¢ƒï¼Œæµ‹è¯•ç¯å¢ƒï¼‰æ­å»ºæˆ‘ä»¬çš„ç›‘æ§ç³»ç»Ÿã€‚å¯¹äºä¸€äº›å¤æ‚çš„æƒ…å†µï¼Œè¿˜å¯ä»¥ä½¿ç”¨PrometheusæœåŠ¡å‘ç°(Service Discovery)çš„èƒ½åŠ›åŠ¨æ€ç®¡ç†ç›‘æ§ç›®æ ‡ã€‚</li><li><strong>ç›‘æ§æœåŠ¡çš„å†…éƒ¨è¿è¡ŒçŠ¶æ€</strong>  Pometheusé¼“åŠ±ç”¨æˆ·ç›‘æ§æœåŠ¡çš„å†…éƒ¨çŠ¶æ€ï¼ŒåŸºäºPrometheusä¸°å¯Œçš„Clientåº“ï¼Œç”¨æˆ·å¯ä»¥è½»æ¾çš„<strong>åœ¨åº”ç”¨ç¨‹åºä¸­æ·»åŠ å¯¹Prometheusçš„æ”¯æŒ</strong>ï¼Œä»è€Œè®©ç”¨æˆ·å¯ä»¥è·å–æœåŠ¡å’Œåº”ç”¨å†…éƒ¨çœŸæ­£çš„è¿è¡ŒçŠ¶æ€ã€‚<br>  <img src="https://s2.loli.net/2022/01/10/TF1wfWp6UDcgCzY.png" alt="20220110224102"></li><li><strong>å¼ºå¤§çš„æ•°æ®æ¨¡å‹</strong>  æ‰€æœ‰é‡‡é›†çš„ç›‘æ§æ•°æ®å‡ä»¥æŒ‡æ ‡(metric)çš„å½¢å¼ä¿å­˜åœ¨å†…ç½®çš„æ—¶é—´åºåˆ—æ•°æ®åº“å½“ä¸­(TSDB)ã€‚æ‰€æœ‰çš„æ ·æœ¬é™¤äº†åŸºæœ¬çš„æŒ‡æ ‡åç§°ä»¥å¤–ï¼Œè¿˜åŒ…å«ä¸€ç»„ç”¨äºæè¿°è¯¥æ ·æœ¬ç‰¹å¾çš„æ ‡ç­¾ã€‚  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http_request_status&#123;code=&#x27;200&#x27;,content_path=&#x27;/api/path&#x27;, environment=&#x27;produment&#x27;&#125; =&gt; [value1@timestamp1,value2@timestamp2...]</span><br><span class="line">http_request_status&#123;code=&#x27;200&#x27;,content_path=&#x27;/api/path2&#x27;, environment=&#x27;produment&#x27;&#125; =&gt; [value1@timestamp1,value2@timestamp2...]</span><br></pre></td></tr></table></figure></li><li><strong>å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€PromQL</strong>  Prometheuså†…ç½®äº†ä¸€ä¸ªå¼ºå¤§çš„æ•°æ®æŸ¥è¯¢è¯­è¨€PromQLã€‚ é€šè¿‡PromQLå¯ä»¥å®ç°å¯¹ç›‘æ§æ•°æ®çš„æŸ¥è¯¢ã€èšåˆã€‚åŒæ—¶PromQLä¹Ÿè¢«åº”ç”¨äºæ•°æ®å¯è§†åŒ–(å¦‚Grafana)ä»¥åŠå‘Šè­¦å½“ä¸­ã€‚</li><li><strong>é«˜æ•ˆ</strong>  å¯¹äºç›‘æ§ç³»ç»Ÿè€Œè¨€ï¼Œå¤§é‡çš„ç›‘æ§ä»»åŠ¡å¿…ç„¶å¯¼è‡´æœ‰å¤§é‡çš„æ•°æ®äº§ç”Ÿã€‚è€ŒPrometheuså¯ä»¥é«˜æ•ˆåœ°å¤„ç†è¿™äº›æ•°æ®ï¼Œå¯¹äºå•ä¸€Prometheus Serverå®ä¾‹è€Œè¨€å®ƒå¯ä»¥å¤„ç†ï¼š<ul><li>æ•°ä»¥ç™¾ä¸‡çš„ç›‘æ§æŒ‡æ ‡</li><li><code>æ¯ç§’å¤„ç†æ•°åä¸‡çš„æ•°æ®ç‚¹</code></li></ul></li><li><strong>å¯æ‰©å±•</strong>  Prometheusæ˜¯å¦‚æ­¤ç®€å•ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨æ¯ä¸ªæ•°æ®ä¸­å¿ƒã€æ¯ä¸ªå›¢é˜Ÿè¿è¡Œç‹¬ç«‹çš„Prometheus Sevrerã€‚Prometheuså¯¹äºè”é‚¦é›†ç¾¤çš„æ”¯æŒï¼Œå¯ä»¥è®©å¤šä¸ªPrometheuså®ä¾‹äº§ç”Ÿä¸€ä¸ªé€»è¾‘é›†ç¾¤ï¼Œå½“å•å®ä¾‹Prometheus Serverå¤„ç†çš„ä»»åŠ¡é‡è¿‡å¤§æ—¶ï¼Œé€šè¿‡ä½¿ç”¨åŠŸèƒ½åˆ†åŒº(sharding)+è”é‚¦é›†ç¾¤(federation)å¯ä»¥å¯¹å…¶è¿›è¡Œæ‰©å±•ã€‚</li><li><strong>æ˜“äºé›†æˆ</strong>  ä½¿ç”¨Prometheuså¯ä»¥å¿«é€Ÿæ­å»ºç›‘æ§æœåŠ¡ï¼Œå¹¶ä¸”å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œé›†æˆã€‚ç›®å‰æ”¯æŒï¼š Javaï¼Œ JMXï¼Œ Pythonï¼Œ Goï¼ŒRubyï¼Œ .Netï¼Œ Node.jsç­‰ç­‰è¯­è¨€çš„å®¢æˆ·ç«¯SDKï¼ŒåŸºäºè¿™äº›SDKå¯ä»¥å¿«é€Ÿè®©åº”ç”¨ç¨‹åºçº³å…¥åˆ°Prometheusçš„ç›‘æ§å½“ä¸­ï¼Œæˆ–è€…å¼€å‘è‡ªå·±çš„ç›‘æ§æ•°æ®æ”¶é›†ç¨‹åºã€‚åŒæ—¶è¿™äº›å®¢æˆ·ç«¯æ”¶é›†çš„ç›‘æ§æ•°æ®ï¼Œä¸ä»…ä»…æ”¯æŒPrometheusï¼Œè¿˜èƒ½æ”¯æŒGraphiteè¿™äº›å…¶ä»–çš„ç›‘æ§å·¥å…·ã€‚  åŒæ—¶Prometheusè¿˜æ”¯æŒä¸å…¶ä»–çš„ç›‘æ§ç³»ç»Ÿè¿›è¡Œé›†æˆï¼šGraphiteï¼Œ Statsdï¼Œ Collectedï¼Œ Scollectorï¼Œ muiniï¼Œ Nagiosç­‰ã€‚  Prometheusç¤¾åŒºè¿˜æä¾›äº†å¤§é‡ç¬¬ä¸‰æ–¹å®ç°çš„ç›‘æ§æ•°æ®é‡‡é›†æ”¯æŒï¼šJMXï¼Œ CloudWatchï¼Œ EC2ï¼Œ MySQLï¼Œ PostgresSQLï¼Œ Haskellï¼Œ Bashï¼Œ SNMPï¼Œ Consulï¼Œ Haproxyï¼Œ Mesosï¼Œ Bindï¼Œ CouchDBï¼Œ Djangoï¼Œ Memcachedï¼Œ RabbitMQï¼Œ Redisï¼Œ RethinkDBï¼Œ Rsyslogç­‰ç­‰ã€‚</li><li><strong>å¯è§†åŒ–</strong>  Prometheus Serverä¸­è‡ªå¸¦äº†ä¸€ä¸ªPrometheus UIï¼Œé€šè¿‡è¿™ä¸ªUIå¯ä»¥æ–¹ä¾¿åœ°ç›´æ¥å¯¹æ•°æ®è¿›è¡ŒæŸ¥è¯¢ï¼Œå¹¶ä¸”æ”¯æŒç›´æ¥ä»¥å›¾å½¢åŒ–çš„å½¢å¼å±•ç¤ºæ•°æ®ã€‚åŒæ—¶Prometheusè¿˜æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„åŸºäºRuby On Railsçš„Dashboardè§£å†³æ–¹æ¡ˆPromdashã€‚æœ€æ–°çš„Grafanaå¯è§†åŒ–å·¥å…·ä¹Ÿå·²ç»æä¾›äº†å®Œæ•´çš„Prometheusæ”¯æŒï¼ŒåŸºäºGrafanaå¯ä»¥åˆ›å»ºæ›´åŠ ç²¾ç¾çš„ç›‘æ§å›¾æ ‡ã€‚åŸºäºPrometheusæä¾›çš„APIè¿˜å¯ä»¥å®ç°è‡ªå·±çš„ç›‘æ§å¯è§†åŒ–UIã€‚</li><li><strong>å¼€æ”¾æ€§</strong>  é€šå¸¸æ¥è¯´å½“æˆ‘ä»¬éœ€è¦ç›‘æ§ä¸€ä¸ªåº”ç”¨ç¨‹åºæ—¶ï¼Œä¸€èˆ¬éœ€è¦è¯¥åº”ç”¨ç¨‹åºæä¾›å¯¹ç›¸åº”ç›‘æ§ç³»ç»Ÿåè®®çš„æ”¯æŒã€‚å› æ­¤åº”ç”¨ç¨‹åºä¼šä¸æ‰€é€‰æ‹©çš„ç›‘æ§ç³»ç»Ÿè¿›è¡Œç»‘å®šã€‚ä¸ºäº†å‡å°‘è¿™ç§ç»‘å®šæ‰€å¸¦æ¥çš„é™åˆ¶ã€‚å¯¹äºå†³ç­–è€…è€Œè¨€è¦ä¹ˆä½ å°±ç›´æ¥åœ¨åº”ç”¨ä¸­é›†æˆè¯¥ç›‘æ§ç³»ç»Ÿçš„æ”¯æŒï¼Œè¦ä¹ˆå°±åœ¨å¤–éƒ¨åˆ›å»ºå•ç‹¬çš„æœåŠ¡æ¥é€‚é…ä¸åŒçš„ç›‘æ§ç³»ç»Ÿã€‚  è€Œå¯¹äºPrometheusæ¥è¯´ï¼Œä½¿ç”¨Prometheusçš„client libraryçš„è¾“å‡ºæ ¼å¼ä¸æ­¢æ”¯æŒPrometheusçš„æ ¼å¼åŒ–æ•°æ®ï¼Œä¹Ÿå¯ä»¥è¾“å‡ºæ”¯æŒå…¶å®ƒç›‘æ§ç³»ç»Ÿçš„æ ¼å¼åŒ–æ•°æ®ï¼Œæ¯”å¦‚Graphiteã€‚  <strong>å› æ­¤ä½ ç”šè‡³å¯ä»¥åœ¨ä¸ä½¿ç”¨Prometheusçš„æƒ…å†µä¸‹ï¼Œé‡‡ç”¨Prometheusçš„client libraryæ¥è®©ä½ çš„åº”ç”¨ç¨‹åºæ”¯æŒç›‘æ§æ•°æ®é‡‡é›†ã€‚</strong></li></ul><p>å¯ä»¥è¯´ Prometheus æ˜¯ä¸€ä¸ªç›‘æ§å‘Šè­¦ç³»ç»Ÿï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæ—¶åºæ•°æ®åº“</p><p>äº†è§£äº† Prometheus æ˜¯ä»€ä¹ˆï¼Œä¹Ÿåˆ†æäº† ä¸ºä»€ä¹ˆè¦äº†è§£ Prometheus ï¼Œ ç°åœ¨æ¥ çœ‹çœ‹ Prometheus æ˜¯æ€ä¹ˆåšçš„</p><h2 id="Prometheus-è§£æ"><a href="#Prometheus-è§£æ" class="headerlink" title="Prometheus è§£æ"></a>Prometheus è§£æ</h2><h3 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h3><p><img src="https://s2.loli.net/2022/01/10/lWZISmsc35DgNyi.png" alt="20220110161226"></p><h3 id="ä¸‰å¤§å¥—ä»¶"><a href="#ä¸‰å¤§å¥—ä»¶" class="headerlink" title="ä¸‰å¤§å¥—ä»¶"></a>ä¸‰å¤§å¥—ä»¶</h3><ul><li>Prometheus Server ä¸»è¦è´Ÿè´£æ•°æ®é‡‡é›†å’Œå­˜å‚¨ï¼Œæä¾›PromQLæŸ¥è¯¢è¯­è¨€çš„æ”¯æŒã€‚</li><li>Alertmanager è­¦å‘Šç®¡ç†å™¨ï¼Œç”¨æ¥è¿›è¡ŒæŠ¥è­¦ï¼Œå‘Šè­¦ä¿¡æ¯æ¨é€ã€‚</li><li>Push Gateway æ”¯æŒä¸´æ—¶æ€§Jobä¸»åŠ¨æ¨é€æŒ‡æ ‡çš„ä¸­é—´ç½‘å…³ã€‚<br><img src="https://s2.loli.net/2022/01/10/g3KtPwJfuSvm59F.png" alt="20220110224903"></li></ul><h3 id="Prometheus-Server"><a href="#Prometheus-Server" class="headerlink" title="Prometheus Server"></a>Prometheus Server</h3><h3 id="Prometheus-æ˜¯å¦‚ä½•é‡‡é›†ç›‘æ§æ•°æ®"><a href="#Prometheus-æ˜¯å¦‚ä½•é‡‡é›†ç›‘æ§æ•°æ®" class="headerlink" title="Prometheus æ˜¯å¦‚ä½•é‡‡é›†ç›‘æ§æ•°æ®"></a>Prometheus æ˜¯å¦‚ä½•é‡‡é›†ç›‘æ§æ•°æ®</h3><p>ç›‘æ§æ•°æ®çš„è·å–æœ‰å¦‚ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>Pull çš„æ–¹å¼  é€šè¿‡å®šæ—¶æŠ“å– ç›®æ ‡ä¸Šçš„Metricsæ•°æ®ï¼Œæ¯ä¸ªæŠ“å–ç›®æ ‡éƒ½éœ€è¦æš´éœ²ä¸€ä¸ªHTTPæœåŠ¡æ¥å£ç”¨äºPrometheuså®šæ—¶æŠ“å–ï¼Œè¿™ç§è°ƒç”¨è¢«ç›‘æ§å¯¹è±¡è·å–ç›‘æ§æ•°æ®çš„æ–¹å¼è¢«ç§°ä¸ºPull  <img src="https://s2.loli.net/2022/01/10/2FbqXkZROdJUYfB.png" alt="20210902134110181.png"></li><li>Pushçš„æ–¹å¼  Prometheusæä¾›å¯¹PushGatewayçš„æ”¯æŒï¼Œè¿™äº›ç³»ç»Ÿä¸»åŠ¨æ¨é€metricsåˆ°PushGatewayï¼Œè€ŒPrometheusåªæ˜¯å®šæ—¶å»Gatewayä¸ŠæŠ“å–æ•°æ®ã€‚<br>  <img src="https://s2.loli.net/2022/01/10/spdMak7KgcI1Pui.png" alt="20220110225032"></li></ul><p>ä»€ä¹ˆæƒ…å†µä¸‹ä¼šç”¨åˆ° Pushçš„æ–¹å¼å‘¢ï¼Ÿ</p><ul><li>Prometheus é‡‡ç”¨å®šæ—¶ Pull æ¨¡å¼ï¼Œå¯èƒ½ç”±äºå­ç½‘ç»œæˆ–è€…é˜²ç«å¢™çš„åŸå› ï¼Œä¸èƒ½ç›´æ¥æ‹‰å–å„ä¸ª Target çš„æŒ‡æ ‡æ•°æ®ï¼Œæ­¤æ—¶å¯ä»¥é‡‡ç”¨å„ä¸ª Target å¾€ PushGateway ä¸Š Push æ•°æ®ï¼Œç„¶å Prometheus å» PushGateway ä¸Šå®šæ—¶ pullã€‚</li><li>å…¶æ¬¡åœ¨ç›‘æ§å„ä¸ªä¸šåŠ¡æ•°æ®æ—¶ï¼Œéœ€è¦å°†å„ä¸ªä¸åŒçš„ä¸šåŠ¡æ•°æ®è¿›è¡Œç»Ÿä¸€æ±‡æ€»ï¼Œæ­¤æ—¶ä¹Ÿå¯ä»¥é‡‡ç”¨ PushGateway æ¥ç»Ÿä¸€æ”¶é›†ï¼Œç„¶å Prometheus æ¥ç»Ÿä¸€æ‹‰å–ã€‚</li></ul><p>é‡‡é›†æ•°æ®çš„ä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>Prometheus server å®šæœŸä»é™æ€é…ç½®çš„ä¸»æœºæˆ–æœåŠ¡å‘ç°çš„ targets æ‹‰å–æ•°æ®(zookeeperï¼Œconsulï¼ŒDNS SRV Lookupç­‰æ–¹å¼)</li><li>å½“æ–°æ‹‰å–çš„æ•°æ®å¤§äºé…ç½®å†…å­˜ç¼“å­˜åŒºçš„æ—¶å€™ï¼ˆæˆ–è€… è¶…è¿‡äº†è®¾å®šçš„æ—¶é—´çª—å£çš„æ—¶é—´ï¼‰ï¼ŒPrometheusä¼šå°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œä¹Ÿå¯ä»¥è¿œç¨‹æŒä¹…åŒ–åˆ°äº‘ç«¯ã€‚</li><li>Prometheusé€šè¿‡PromQLã€APIã€Consoleå’Œå…¶ä»–å¯è§†åŒ–ç»„ä»¶å¦‚Grafanaã€Promdashå±•ç¤ºæ•°æ®ã€‚</li><li>Prometheus å¯ä»¥é…ç½®rulesï¼Œç„¶åå®šæ—¶æŸ¥è¯¢æ•°æ®ï¼Œå½“æ¡ä»¶è§¦å‘çš„æ—¶å€™ï¼Œä¼šå°†å‘Šè­¦æ¨é€åˆ°é…ç½®çš„Alertmanagerã€‚</li><li>Alertmanageræ”¶åˆ°å‘Šè­¦çš„æ—¶å€™ï¼Œä¼šæ ¹æ®é…ç½®ï¼Œèšåˆï¼Œå»é‡ï¼Œé™å™ªï¼Œæœ€åå‘å‡ºè­¦å‘Šï¼Œ Alertmanageræ˜¯ç‹¬ç«‹äºPrometheusçš„ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥æ”¯æŒPrometheusçš„æŸ¥è¯¢è¯­å¥ï¼Œæä¾›ååˆ†çµæ´»çš„æŠ¥è­¦æ–¹å¼ã€‚</li></ul><p>æŒ‡æ ‡æ•°æ®çš„æ ·å¼å¦‚ä¸‹ï¼š</p><p><a href="http://172.26.65.49:9100/metrics">http://172.26.65.49:9100/metrics</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># HELP node_cpu_guest_seconds_total Seconds the CPUs spent in guests (VMs) for each mode.</span><br><span class="line"># TYPE node_cpu_guest_seconds_total counter</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;0&quot;,mode=&quot;nice&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;0&quot;,mode=&quot;user&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;1&quot;,mode=&quot;nice&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;1&quot;,mode=&quot;user&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;2&quot;,mode=&quot;nice&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;2&quot;,mode=&quot;user&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;3&quot;,mode=&quot;nice&quot;&#125; 0</span><br><span class="line">node_cpu_guest_seconds_total&#123;cpu=&quot;3&quot;,mode=&quot;user&quot;&#125; 0</span><br><span class="line"># HELP node_cpu_package_throttles_total Number of times this CPU package has been throttled.</span><br><span class="line"># TYPE node_cpu_package_throttles_total counter</span><br><span class="line">node_cpu_package_throttles_total&#123;package=&quot;0&quot;&#125; 0</span><br><span class="line"># HELP node_cpu_scaling_frequency_hertz Current scaled CPU thread frequency in hertz.</span><br><span class="line"># TYPE node_cpu_scaling_frequency_hertz gauge</span><br><span class="line">node_cpu_scaling_frequency_hertz&#123;cpu=&quot;0&quot;&#125; 2.44895e+09</span><br><span class="line">node_cpu_scaling_frequency_hertz&#123;cpu=&quot;1&quot;&#125; 2.402221e+09</span><br><span class="line">node_cpu_scaling_frequency_hertz&#123;cpu=&quot;2&quot;&#125; 2.415515e+09</span><br><span class="line">node_cpu_scaling_frequency_hertz&#123;cpu=&quot;3&quot;&#125; 2.200134e+09</span><br><span class="line"># HELP node_cpu_scaling_frequency_max_hertz Maximum scaled CPU thread frequency in hertz.</span><br><span class="line"># TYPE node_cpu_scaling_frequency_max_hertz gauge</span><br><span class="line">node_cpu_scaling_frequency_max_hertz&#123;cpu=&quot;0&quot;&#125; 2.7e+09</span><br><span class="line">node_cpu_scaling_frequency_max_hertz&#123;cpu=&quot;1&quot;&#125; 2.7e+09</span><br><span class="line">node_cpu_scaling_frequency_max_hertz&#123;cpu=&quot;2&quot;&#125; 2.7e+09</span><br><span class="line">node_cpu_scaling_frequency_max_hertz&#123;cpu=&quot;3&quot;&#125; 2.7e+09</span><br><span class="line"># HELP node_cpu_scaling_frequency_min_hertz Minimum scaled CPU thread frequency in hertz.</span><br><span class="line"># TYPE node_cpu_scaling_frequency_min_hertz gauge</span><br><span class="line">node_cpu_scaling_frequency_min_hertz&#123;cpu=&quot;0&quot;&#125; 5e+08</span><br><span class="line">node_cpu_scaling_frequency_min_hertz&#123;cpu=&quot;1&quot;&#125; 5e+08</span><br><span class="line">node_cpu_scaling_frequency_min_hertz&#123;cpu=&quot;2&quot;&#125; 5e+08</span><br><span class="line">node_cpu_scaling_frequency_min_hertz&#123;cpu=&quot;3&quot;&#125; 5e+08</span><br></pre></td></tr></table></figure><h3 id="Metricç±»å‹ï¼ˆæŒ‡æ ‡ç±»å‹ï¼‰"><a href="#Metricç±»å‹ï¼ˆæŒ‡æ ‡ç±»å‹ï¼‰" class="headerlink" title="Metricç±»å‹ï¼ˆæŒ‡æ ‡ç±»å‹ï¼‰"></a>Metricç±»å‹ï¼ˆæŒ‡æ ‡ç±»å‹ï¼‰</h3><p>Prometheuså®šä¹‰äº†4ç§ä¸åŒçš„æŒ‡æ ‡ç±»å‹(metric type)ï¼šCounterï¼ˆè®¡æ•°å™¨ï¼‰ã€Gaugeï¼ˆä»ªè¡¨ç›˜ï¼‰ã€Histogramï¼ˆç›´æ–¹å›¾ï¼‰ã€Summaryï¼ˆæ‘˜è¦ï¼‰</p><p><strong>Counterï¼šåªå¢ä¸å‡çš„è®¡æ•°å™¨</strong></p><p>Counterç±»å‹çš„æŒ‡æ ‡å…¶å·¥ä½œæ–¹å¼å’Œè®¡æ•°å™¨ä¸€æ ·ï¼Œåªå¢ä¸å‡ï¼ˆé™¤éç³»ç»Ÿå‘ç”Ÿé‡ç½®ï¼‰ã€‚</p><p>å¸¸è§çš„ç›‘æ§æŒ‡æ ‡ï¼Œå¦‚http_requests_totalï¼Œnode_cpuéƒ½æ˜¯Counterç±»å‹çš„ç›‘æ§æŒ‡æ ‡ã€‚ ä¸€èˆ¬åœ¨å®šä¹‰Counterç±»å‹æŒ‡æ ‡çš„åç§°æ—¶æ¨èä½¿ç”¨_totalä½œä¸ºåç¼€ã€‚</p><p><strong>Gaugeï¼šå¯å¢å¯å‡çš„ä»ªè¡¨ç›˜</strong></p><p>Gaugeç±»å‹çš„æŒ‡æ ‡ä¾§é‡äºååº”ç³»ç»Ÿçš„å½“å‰çŠ¶æ€ã€‚</p><p>å¸¸è§æŒ‡æ ‡å¦‚ï¼šnode_memory_MemFreeï¼ˆä¸»æœºå½“å‰ç©ºé—²çš„å†…å®¹å¤§å°ï¼‰ã€node_memory_MemAvailableï¼ˆå¯ç”¨å†…å­˜å¤§å°ï¼‰éƒ½æ˜¯Gaugeç±»å‹çš„ç›‘æ§æŒ‡æ ‡ã€‚</p><p><strong>ä½¿ç”¨Histogramå’ŒSummaryåˆ†ææ•°æ®åˆ†å¸ƒæƒ…å†µ</strong></p><p>é™¤äº†Counterå’ŒGaugeç±»å‹çš„ç›‘æ§æŒ‡æ ‡ä»¥å¤–ï¼ŒPrometheusè¿˜å®šä¹‰äº†Histogramå’ŒSummaryçš„æŒ‡æ ‡ç±»å‹ã€‚Histogramå’ŒSummaryä¸»ç”¨ç”¨äºç»Ÿè®¡å’Œåˆ†ææ ·æœ¬çš„åˆ†å¸ƒæƒ…å†µ</p><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹äººä»¬éƒ½å€¾å‘äºä½¿ç”¨æŸäº›é‡åŒ–æŒ‡æ ‡çš„å¹³å‡å€¼ï¼Œä¾‹å¦‚CPUçš„å¹³å‡ä½¿ç”¨ç‡ã€é¡µé¢çš„å¹³å‡å“åº”æ—¶é—´ã€‚è¿™ç§æ–¹å¼çš„é—®é¢˜å¾ˆæ˜æ˜¾ï¼Œä»¥ç³»ç»ŸAPIè°ƒç”¨çš„å¹³å‡å“åº”æ—¶é—´ä¸ºä¾‹ï¼šå¦‚æœå¤§å¤šæ•°APIè¯·æ±‚éƒ½ç»´æŒåœ¨100msçš„å“åº”æ—¶é—´èŒƒå›´å†…ï¼Œè€Œä¸ªåˆ«è¯·æ±‚çš„å“åº”æ—¶é—´éœ€è¦5sï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´æŸäº›WEBé¡µé¢çš„å“åº”æ—¶é—´è½åˆ°ä¸­ä½æ•°çš„æƒ…å†µï¼Œè€Œè¿™ç§ç°è±¡è¢«ç§°ä¸ºé•¿å°¾é—®é¢˜ã€‚</p><p>ä¸ºäº†åŒºåˆ†æ˜¯å¹³å‡çš„æ…¢è¿˜æ˜¯é•¿å°¾çš„æ…¢ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æŒ‰ç…§è¯·æ±‚å»¶è¿Ÿçš„èŒƒå›´è¿›è¡Œåˆ†ç»„ã€‚ä¾‹å¦‚ï¼Œç»Ÿè®¡å»¶è¿Ÿåœ¨010msä¹‹é—´çš„è¯·æ±‚æ•°æœ‰å¤šå°‘è€Œ1020msä¹‹é—´çš„è¯·æ±‚æ•°åˆæœ‰å¤šå°‘ã€‚é€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥å¿«é€Ÿåˆ†æç³»ç»Ÿæ…¢çš„åŸå› ã€‚Histogramå’ŒSummaryéƒ½æ˜¯ä¸ºäº†èƒ½å¤Ÿè§£å†³è¿™æ ·é—®é¢˜çš„å­˜åœ¨ï¼Œé€šè¿‡Histogramå’ŒSummaryç±»å‹çš„ç›‘æ§æŒ‡æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€Ÿäº†è§£ç›‘æ§æ ·æœ¬çš„åˆ†å¸ƒæƒ…å†µã€‚</p><p>ä¾‹å¦‚ï¼š wal_fsyncå¤„ç†çš„å¤„ç†æ—¶é—´ (Summaryç±»å‹)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># HELP prometheus_tsdb_wal_fsync_duration_seconds Duration of WAL fsync.</span><br><span class="line"># TYPE prometheus_tsdb_wal_fsync_duration_seconds summary</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds&#123;quantile=&quot;0.5&quot;&#125; 0.012352463</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds&#123;quantile=&quot;0.9&quot;&#125; 0.014458005</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds&#123;quantile=&quot;0.99&quot;&#125; 0.017316173</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds_sum 2.888716127000002</span><br><span class="line">prometheus_tsdb_wal_fsync_duration_seconds_count 216</span><br></pre></td></tr></table></figure><h3 id="Exporter-è¯¦è§£"><a href="#Exporter-è¯¦è§£" class="headerlink" title="Exporter è¯¦è§£"></a>Exporter è¯¦è§£</h3><p>å¹¿ä¹‰ä¸Šè®²æ‰€æœ‰å¯ä»¥å‘Prometheusæä¾›ç›‘æ§æ ·æœ¬æ•°æ®çš„ç¨‹åºéƒ½å¯ä»¥è¢«ç§°ä¸ºä¸€ä¸ªExporterï¼Œè€ŒExporterçš„ä¸€ä¸ªå®ä¾‹ç§°ä¸ºtargetã€‚</p><p>Exporter æ˜¯ å®‰è£…åœ¨è¢«ç›‘æ§çš„ç›®æ ‡ï¼ˆä¸»æœºæˆ–æœåŠ¡ï¼‰ä¸Šï¼Œç”¨äºé‡‡é›†ç›®æ ‡ä¸Šç›¸åº”çš„ç›‘æ§æ•°æ®ï¼ŒåŒæ—¶ä¼šæš´éœ²å‡ºHttpçš„æ¥å£ï¼Œæ™®ç½—ç±³ä¿®æ–¯é€šè¿‡HTTPåè®®ä½¿ç”¨Pullçš„æ–¹å¼å‘¨æœŸæ€§æ‹‰å–ç›¸åº”çš„æ•°æ®ã€‚</p><p><img src="https://static.sitestack.cn/projects/prometheus-book/exporter/static/prometheus-exporter.png" alt="https://static.sitestack.cn/projects/prometheus-book/exporter/static/prometheus-exporter.png"></p><p><strong>Exporterçš„æ¥æº</strong></p><p>ä»Exporterçš„æ¥æºä¸Šæ¥è®²ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li>ç¤¾åŒºæä¾›çš„  Prometheusç¤¾åŒºæä¾›äº†ä¸°å¯Œçš„Exporterå®ç°ï¼Œæ¶µç›–äº†ä»åŸºç¡€è®¾æ–½ï¼Œä¸­é—´ä»¶ä»¥åŠç½‘ç»œç­‰å„ä¸ªæ–¹é¢çš„ç›‘æ§åŠŸèƒ½ã€‚è¿™äº›Exporterå¯ä»¥å®ç°å¤§éƒ¨åˆ†é€šç”¨çš„ç›‘æ§éœ€æ±‚ã€‚ä¸‹è¡¨åˆ—ä¸¾ä¸€äº›ç¤¾åŒºä¸­å¸¸ç”¨çš„Exporterï¼š(<a href="https://prometheus.io/docs/instrumenting/exporters/">Exporters and integrations | Prometheus</a>å®˜ç½‘)  <a href="https://www.notion.so/9c3a22421d0f4e92a7eecd761c6a9a72">Untitled</a></li><li>ç”¨æˆ·è‡ªå®šä¹‰çš„  é™¤äº†ç›´æ¥ä½¿ç”¨ç¤¾åŒºæä¾›çš„Exporterç¨‹åºä»¥å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥åŸºäºPrometheusæä¾›çš„Client Libraryåˆ›å»ºè‡ªå·±çš„Exporterç¨‹åºï¼Œç›®å‰Promthuesç¤¾åŒºå®˜æ–¹æä¾›äº†å¯¹ä»¥ä¸‹ç¼–ç¨‹è¯­è¨€çš„æ”¯æŒï¼šGoã€Java/Scalaã€Pythonã€Rubyã€‚åŒæ—¶è¿˜æœ‰ç¬¬ä¸‰æ–¹å®ç°çš„å¦‚ï¼šBashã€C++ã€Common Lispã€Erlang,ã€Haskeelã€Luaã€Node.jsã€PHPã€Rustç­‰ã€‚  ã€ä½¿ç”¨Client Javaæ„å»ºExporterç¨‹åºã€‘<a href="https://www.bookstack.cn/read/prometheus-book/exporter-client_library_java.md">https://www.bookstack.cn/read/prometheus-book/exporter-client_library_java.md</a></li></ul><h3 id="Prometheusç›‘æ§æ•°æ®çš„å­˜å‚¨"><a href="#Prometheusç›‘æ§æ•°æ®çš„å­˜å‚¨" class="headerlink" title="Prometheusç›‘æ§æ•°æ®çš„å­˜å‚¨"></a>Prometheusç›‘æ§æ•°æ®çš„å­˜å‚¨</h3><p>æ•°æ®å­˜å‚¨çš„æ–¹å¼åˆ†ä¸ºå¦‚ä¸‹ä¸¤ç§ï¼š</p><ul><li>ä¸€ç§æ˜¯æœ¬åœ°å­˜å‚¨ã€‚é€šè¿‡Prometheusè‡ªå¸¦çš„æ—¶åºæ•°æ®åº“å°†æ•°æ®ä¿å­˜åˆ°æœ¬åœ°ç£ç›˜ï¼Œä¸ºäº†æ€§èƒ½è€ƒè™‘ï¼Œå»ºè®®ä½¿ç”¨SSDã€‚ä½†æœ¬åœ°å­˜å‚¨çš„å®¹é‡æ¯•ç«Ÿæœ‰é™ï¼Œå»ºè®®ä¸è¦ä¿å­˜è¶…è¿‡ä¸€ä¸ªæœˆçš„æ•°æ®ã€‚</li><li>å¦ä¸€ç§æ˜¯è¿œç¨‹å­˜å‚¨ï¼Œé€‚ç”¨äºå­˜å‚¨å¤§é‡ç›‘æ§æ•°æ®ã€‚é€šè¿‡ä¸­é—´å±‚çš„é€‚é…å™¨çš„è½¬åŒ–ï¼Œç›®å‰Prometheusæ”¯æŒOpenTSDBã€InfluxDBã€Elasticsearchç­‰åç«¯å­˜å‚¨ï¼Œé€šè¿‡é€‚é…å™¨å®ç°Prometheuså­˜å‚¨çš„remote writeå’Œremote readæ¥å£ï¼Œä¾¿å¯ä»¥æ¥å…¥Prometheusä½œä¸ºè¿œç«¯å­˜å‚¨ä½¿ç”¨ã€‚</li></ul><p><strong>æœ¬åœ°å­˜å‚¨</strong><br><img src="https://s2.loli.net/2022/01/10/AiXPxNTDVLsmWlz.png" alt="20220110225208"></p><p>ç‰¹ç‚¹ï¼š</p><p>â‘  è‡ªèº«è¿ç»´å’Œç®¡ç†çš„å¤æ‚åº¦ä½</p><p>Prometheus 2.x é‡‡ç”¨è‡ªå®šä¹‰çš„å­˜å‚¨æ ¼å¼å°†æ ·æœ¬æ•°æ®ä¿å­˜åœ¨æœ¬åœ°ç£ç›˜å½“ä¸­ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼ŒæŒ‰ç…§ä¸¤ä¸ªå°æ—¶ä¸ºä¸€ä¸ªæ—¶é—´çª—å£ï¼Œå°†ä¸¤å°æ—¶å†…äº§ç”Ÿçš„æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªå—(Block)ä¸­ï¼Œæ¯ä¸€ä¸ªå—ä¸­åŒ…å«è¯¥æ—¶é—´çª—å£å†…çš„æ‰€æœ‰æ ·æœ¬æ•°æ®(chunks)ï¼Œå…ƒæ•°æ®æ–‡ä»¶(meta.json)ä»¥åŠç´¢å¼•æ–‡ä»¶(index)ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">t0            t1             t2             now</span><br><span class="line"> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line"> â”‚           â”‚  â”‚           â”‚  â”‚           â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line"> â”‚           â”‚  â”‚           â”‚  â”‚  mutable  â”‚ &lt;â”€â”€â”€ write â”€â”€â”€â”€ â”¤ Prometheus â”‚</span><br><span class="line"> â”‚           â”‚  â”‚           â”‚  â”‚           â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line"> â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        ^</span><br><span class="line">       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                              â”‚</span><br><span class="line">                              â”‚                                   query</span><br><span class="line">                              â”‚                                     â”‚</span><br><span class="line">                            merge â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure><p>å½“å‰æ—¶é—´çª—å£å†…æ­£åœ¨æ”¶é›†çš„æ ·æœ¬æ•°æ®ï¼Œ<strong>Prometheusåˆ™ä¼šç›´æ¥å°†æ•°æ®ä¿å­˜åœ¨å†…å­˜å½“ä¸­</strong>ã€‚ä¸ºäº†ç¡®ä¿æ­¤æœŸé—´å¦‚æœPrometheuså‘ç”Ÿå´©æºƒæˆ–è€…é‡å¯æ—¶èƒ½å¤Ÿæ¢å¤æ•°æ®ï¼Œ<strong>Prometheuså¯åŠ¨æ—¶ä¼šä»å†™å…¥æ—¥å¿—(WAL)è¿›è¡Œé‡æ’­ï¼Œä»è€Œæ¢å¤æ•°æ®</strong>ã€‚æ­¤æœŸé—´å¦‚æœé€šè¿‡APIåˆ é™¤æ—¶é—´åºåˆ—ï¼Œåˆ é™¤è®°å½•ä¹Ÿä¼šä¿å­˜åœ¨å•ç‹¬çš„é€»è¾‘æ–‡ä»¶å½“ä¸­(tombstone)ã€‚</p><p>åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­è¿™äº›å—ä¿å­˜åœ¨å•ç‹¬çš„ç›®å½•å½“ä¸­ï¼ŒPrometheusä¿å­˜å—æ•°æ®çš„ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">./data</span><br><span class="line">   |- 01BKGV7JBM69T2G1BGBGM6KB12 # å—</span><br><span class="line">      |- meta.json  # å…ƒæ•°æ®</span><br><span class="line">      |- wal        # å†™å…¥æ—¥å¿—</span><br><span class="line">        |- 000002</span><br><span class="line">        |- 000001</span><br><span class="line">   |- 01BKGTZQ1SYQJTR4PB43C8PD98  # å—</span><br><span class="line">      |- meta.json  #å…ƒæ•°æ®</span><br><span class="line">      |- index   # ç´¢å¼•æ–‡ä»¶</span><br><span class="line">      |- chunks  # æ ·æœ¬æ•°æ®</span><br><span class="line">        |- 000001</span><br><span class="line">      |- tombstones # é€»è¾‘æ•°æ®</span><br><span class="line">   |- 01BKGTZQ1HHWHV8FBJXW1Y3W0K</span><br><span class="line">      |- meta.json</span><br><span class="line">      |- wal</span><br><span class="line">        |-000001</span><br></pre></td></tr></table></figure><p>æœ¬åœ°å­˜å‚¨é…ç½®ï¼š<br><img src="https://s2.loli.net/2022/01/10/LTGFmsN2awX1Sk3.png" alt="20220110225415"></p><p>å¯¹Prometheus Serverçš„æœ¬åœ°ç£ç›˜ç©ºé—´åšå®¹é‡è§„åˆ’æ—¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">needed_disk_space = retention_time_seconds * ingested_samples_per_second * bytes_per_sample</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼šä¿ç•™æ—¶é—´(retention_time_seconds)ã€æ¯ç§’è·å–æ ·æœ¬æ•°(ingested_samples_per_second)ã€æ ·æœ¬å¤§å°(bytes_per_sample)</p><p>å‡å°‘æœ¬åœ°ç£ç›˜çš„å®¹é‡éœ€æ±‚ï¼Œå¯ä»¥é€šè¿‡ å‡å°‘ æ¯ç§’è·å–æ ·æœ¬æ•° è¿™ä¸ªæ•°å€¼ çš„æ–¹å¼ ï¼›æœ‰ä¸¤ç§æ‰‹æ®µï¼Œä¸€æ˜¯å‡å°‘æ—¶é—´åºåˆ—çš„æ•°é‡ï¼ŒäºŒæ˜¯å¢åŠ é‡‡é›†æ ·æœ¬çš„æ—¶é—´é—´éš”ã€‚è€ƒè™‘åˆ°Prometheusä¼šå¯¹æ—¶é—´åºåˆ—è¿›è¡Œå‹ç¼©æ•ˆç‡ï¼Œå‡å°‘æ—¶é—´åºåˆ—çš„æ•°é‡æ•ˆæœæ›´æ˜æ˜¾ã€‚</p><p><strong>è¿œç¨‹å­˜å‚¨</strong><br><img src="https://s2.loli.net/2022/01/10/fW85C4wrsaqTFom.png" alt="20220110225442"></p><p>ç‰¹ç‚¹ï¼š</p><p>â‘  å¯ä»¥æŒä¹…åŒ–å¤§é‡å†å²æ•°æ®</p><p>â‘¡ çµæ´»æ‰©å±•</p><p>â‘¢ æ–¹ä¾¿è¿ç§»</p><p>ä¸ºäº†ä¿æŒPrometheusçš„ç®€å•æ€§ï¼ŒPrometheuså¹¶æ²¡æœ‰å°è¯•åœ¨è‡ªèº«ä¸­è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Œè€Œæ˜¯é€šè¿‡å®šä¹‰ä¸¤ä¸ªæ ‡å‡†æ¥å£(remote_write/remote_read)ï¼Œè®©ç”¨æˆ·å¯ä»¥åŸºäºè¿™ä¸¤ä¸ªæ¥å£å¯¹æ¥å°†æ•°æ®ä¿å­˜åˆ°ä»»æ„ç¬¬ä¸‰æ–¹çš„å­˜å‚¨æœåŠ¡ä¸­ï¼Œè¿™ç§æ–¹å¼åœ¨Promthuesä¸­ç§°ä¸ºRemote Storageã€‚</p><p>ã€Remote Writeã€‘ï¼ˆè¿œç¨‹å†™ï¼‰</p><p>ç”¨æˆ·å¯ä»¥åœ¨Prometheusé…ç½®æ–‡ä»¶ä¸­æŒ‡å®šRemote Write(è¿œç¨‹å†™)çš„URLåœ°å€ï¼Œä¸€æ—¦è®¾ç½®äº†è¯¥é…ç½®é¡¹ï¼ŒPrometheuså°†é‡‡é›†åˆ°çš„æ ·æœ¬æ•°æ®é€šè¿‡HTTPçš„å½¢å¼å‘é€ç»™é€‚é…å™¨(Adaptor)ã€‚è€Œç”¨æˆ·åˆ™å¯ä»¥åœ¨é€‚é…å™¨ä¸­å¯¹æ¥å¤–éƒ¨ä»»æ„çš„æœåŠ¡ã€‚å¤–éƒ¨æœåŠ¡å¯ä»¥æ˜¯çœŸæ­£çš„å­˜å‚¨ç³»ç»Ÿï¼Œå…¬æœ‰äº‘çš„å­˜å‚¨æœåŠ¡ï¼Œä¹Ÿå¯ä»¥æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ç­‰ä»»æ„å½¢å¼ã€‚</p><p><img src="https://static.sitestack.cn/projects/prometheus-book/ha/static/remote-write-path-2.png" alt="https://static.sitestack.cn/projects/prometheus-book/ha/static/remote-write-path-2.png"></p><p>Remote Write</p><p>ã€Remote Readã€‘ï¼ˆè¿œç¨‹è¯»ï¼‰</p><p>Promthuesçš„Remote Read(è¿œç¨‹è¯»)ä¹Ÿé€šè¿‡äº†ä¸€ä¸ªé€‚é…å™¨å®ç°ã€‚åœ¨è¿œç¨‹è¯»çš„æµç¨‹å½“ä¸­ï¼Œå½“ç”¨æˆ·å‘èµ·æŸ¥è¯¢è¯·æ±‚åï¼ŒPromthueså°†å‘remote_readä¸­é…ç½®çš„URLå‘èµ·æŸ¥è¯¢è¯·æ±‚(matchers,ranges)ï¼ŒAdaptoræ ¹æ®è¯·æ±‚æ¡ä»¶ä»ç¬¬ä¸‰æ–¹å­˜å‚¨æœåŠ¡ä¸­è·å–å“åº”çš„æ•°æ®ã€‚åŒæ—¶å°†æ•°æ®è½¬æ¢ä¸ºPromthuesçš„åŸå§‹æ ·æœ¬æ•°æ®è¿”å›ç»™Prometheus Serverã€‚</p><p>å½“è·å–åˆ°æ ·æœ¬æ•°æ®åï¼ŒPromthuesåœ¨æœ¬åœ°ä½¿ç”¨PromQLå¯¹æ ·æœ¬æ•°æ®è¿›è¡ŒäºŒæ¬¡å¤„ç†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ³¨æ„ï¼šå¯ç”¨è¿œç¨‹è¯»è®¾ç½®åï¼Œåªåœ¨æ•°æ®æŸ¥è¯¢æ—¶æœ‰æ•ˆï¼Œå¯¹äºè§„åˆ™æ–‡ä»¶çš„å¤„ç†ï¼Œä»¥åŠMetadata APIçš„å¤„ç†éƒ½åªåŸºäºPrometheusæœ¬åœ°å­˜å‚¨å®Œæˆã€‚</span><br></pre></td></tr></table></figure><p><img src="https://static.sitestack.cn/projects/prometheus-book/ha/static/remote_read_path-2.png" alt="https://static.sitestack.cn/projects/prometheus-book/ha/static/remote_read_path-2.png"></p><p>Remote Read</p><p><strong>é€‚é…å™¨ï¼šéœ€è¦éƒ¨ç½²åˆ°æ•°æ®åº“æ‰€åœ¨çš„æœåŠ¡å™¨ï¼Œæš´éœ²HTTPæœåŠ¡ï¼Œå¹¶ä¸”å°†æ•°æ®å†™å…¥æ•°æ®åº“ä¸­</strong></p><p>è¿œç¨‹è¯»å†™é…ç½®ï¼š</p><p>Prometheusé…ç½®æ–‡ä»¶ä¸­æ·»åŠ remote_writeå’Œremote_readé…ç½®ï¼Œå…¶ä¸­urlç”¨äºæŒ‡å®šè¿œç¨‹è¯»/å†™çš„HTTPæœåŠ¡åœ°å€ã€‚å¦‚æœè¯¥URLå¯åŠ¨äº†è®¤è¯åˆ™å¯ä»¥é€šè¿‡<strong>basic_auth</strong>è¿›è¡Œå®‰å…¨è®¤è¯é…ç½®ã€‚å¯¹äºhttpsçš„æ”¯æŒéœ€è¦è®¾å®š<strong>tls_concig</strong>ã€‚<strong>proxy_url</strong>ä¸»è¦ç”¨äºPrometheusæ— æ³•ç›´æ¥è®¿é—®é€‚é…å™¨æœåŠ¡çš„æƒ…å†µä¸‹ã€‚</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># The URL of the endpoint to send samples to.</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">&lt;string&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Timeout for requests to the remote write endpoint.</span></span><br><span class="line">[ <span class="attr">remote_timeout:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">30s</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Custom HTTP headers to be sent along with each remote write request.</span></span><br><span class="line"><span class="comment"># Be aware that headers that are set by Prometheus itself can&#x27;t be overwritten.</span></span><br><span class="line"><span class="attr">headers:</span></span><br><span class="line">  [ <span class="string">&lt;string&gt;:</span> <span class="string">&lt;string&gt;</span> <span class="string">...</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># List of remote write relabel configurations.</span></span><br><span class="line"><span class="attr">write_relabel_configs:</span></span><br><span class="line">  [ <span class="bullet">-</span> <span class="string">&lt;relabel_config&gt;</span> <span class="string">...</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Name of the remote write config, which if specified must be unique among remote write configs.</span></span><br><span class="line"><span class="comment"># The name will be used in metrics and logging in place of a generated value to help users distinguish between</span></span><br><span class="line"><span class="comment"># remote write configs.</span></span><br><span class="line">[ <span class="attr">name:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Enables sending of exemplars over remote write. Note that exemplar storage itself must be enabled for exemplars to be scraped in the first place.</span></span><br><span class="line">[ <span class="attr">send_exemplars:</span> <span class="string">&lt;boolean&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">false</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sets the `Authorization` header on every remote write request with the</span></span><br><span class="line"><span class="comment"># configured username and password.</span></span><br><span class="line"><span class="comment"># password and password_file are mutually exclusive.</span></span><br><span class="line"><span class="attr">basic_auth:</span></span><br><span class="line">  [ <span class="attr">username:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line">  [ <span class="attr">password:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line">  [ <span class="attr">password_file:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional `Authorization` header configuration.</span></span><br><span class="line"><span class="attr">authorization:</span></span><br><span class="line">  <span class="comment"># Sets the authentication type.</span></span><br><span class="line">  [ <span class="attr">type:</span> <span class="string">&lt;string&gt;</span> <span class="string">|</span> <span class="attr">default:</span> <span class="string">Bearer</span> ]</span><br><span class="line">  <span class="comment"># Sets the credentials. It is mutually exclusive with</span></span><br><span class="line">  <span class="comment"># `credentials_file`.</span></span><br><span class="line">  [ <span class="attr">credentials:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line">  <span class="comment"># Sets the credentials to the credentials read from the configured file.</span></span><br><span class="line">  <span class="comment"># It is mutually exclusive with `credentials`.</span></span><br><span class="line">  [ <span class="attr">credentials_file:</span> <span class="string">&lt;filename&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optionally configures AWS&#x27;s Signature Verification 4 signing process to</span></span><br><span class="line"><span class="comment"># sign requests. Cannot be set at the same time as basic_auth, authorization, or oauth2.</span></span><br><span class="line"><span class="comment"># To use the default credentials from the AWS SDK, use `sigv4: &#123;&#125;`.</span></span><br><span class="line"><span class="attr">sigv4:</span></span><br><span class="line">  <span class="comment"># The AWS region. If blank, the region from the default credentials chain</span></span><br><span class="line">  <span class="comment"># is used.</span></span><br><span class="line">  [ <span class="attr">region:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># The AWS API keys. If blank, the environment variables `AWS_ACCESS_KEY_ID`</span></span><br><span class="line">  <span class="comment"># and `AWS_SECRET_ACCESS_KEY` are used.</span></span><br><span class="line">  [ <span class="attr">access_key:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line">  [ <span class="attr">secret_key:</span> <span class="string">&lt;secret&gt;</span> ]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Named AWS profile used to authenticate.</span></span><br><span class="line">  [ <span class="attr">profile:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line">  <span class="comment"># AWS Role ARN, an alternative to using AWS API keys.</span></span><br><span class="line">  [ <span class="attr">role_arn:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional OAuth 2.0 configuration.</span></span><br><span class="line"><span class="comment"># Cannot be used at the same time as basic_auth, authorization, or sigv4.</span></span><br><span class="line"><span class="attr">oauth2:</span></span><br><span class="line">  [ <span class="string">&lt;oauth2&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configures the remote write request&#x27;s TLS settings.</span></span><br><span class="line"><span class="attr">tls_config:</span></span><br><span class="line">  [ <span class="string">&lt;tls_config&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Optional proxy URL.</span></span><br><span class="line">[ <span class="attr">proxy_url:</span> <span class="string">&lt;string&gt;</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure whether HTTP requests follow HTTP 3xx redirects.</span></span><br><span class="line">[ <span class="attr">follow_redirects:</span> <span class="string">&lt;bool&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">true</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configures the queue used to write to remote storage.</span></span><br><span class="line"><span class="attr">queue_config:</span></span><br><span class="line">  <span class="comment"># Number of samples to buffer per shard before we block reading of more</span></span><br><span class="line">  <span class="comment"># samples from the WAL. It is recommended to have enough capacity in each</span></span><br><span class="line">  <span class="comment"># shard to buffer several requests to keep throughput up while processing</span></span><br><span class="line">  <span class="comment"># occasional slow remote requests.</span></span><br><span class="line">  [ <span class="attr">capacity:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">2500</span> ]</span><br><span class="line">  <span class="comment"># Maximum number of shards, i.e. amount of concurrency.</span></span><br><span class="line">  [ <span class="attr">max_shards:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">200</span> ]</span><br><span class="line">  <span class="comment"># Minimum number of shards, i.e. amount of concurrency.</span></span><br><span class="line">  [ <span class="attr">min_shards:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">1</span> ]</span><br><span class="line">  <span class="comment"># Maximum number of samples per send.</span></span><br><span class="line">  [ <span class="attr">max_samples_per_send:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">500</span>]</span><br><span class="line">  <span class="comment"># Maximum time a sample will wait in buffer.</span></span><br><span class="line">  [ <span class="attr">batch_send_deadline:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">5s</span> ]</span><br><span class="line">  <span class="comment"># Initial retry delay. Gets doubled for every retry.</span></span><br><span class="line">  [ <span class="attr">min_backoff:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">30ms</span> ]</span><br><span class="line">  <span class="comment"># Maximum retry delay.</span></span><br><span class="line">  [ <span class="attr">max_backoff:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">5s</span> ]</span><br><span class="line">  <span class="comment"># Retry upon receiving a 429 status code from the remote-write storage.</span></span><br><span class="line">  <span class="comment"># This is experimental and might change in the future.</span></span><br><span class="line">  [ <span class="attr">retry_on_http_429:</span> <span class="string">&lt;boolean&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">false</span> ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configures the sending of series metadata to remote storage.</span></span><br><span class="line"><span class="comment"># Metadata configuration is subject to change at any point</span></span><br><span class="line"><span class="comment"># or be removed in future releases.</span></span><br><span class="line"><span class="attr">metadata_config:</span></span><br><span class="line">  <span class="comment"># Whether metric metadata is sent to remote storage or not.</span></span><br><span class="line">  [ <span class="attr">send:</span> <span class="string">&lt;boolean&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="literal">true</span> ]</span><br><span class="line">  <span class="comment"># How frequently metric metadata is sent to remote storage.</span></span><br><span class="line">  [ <span class="attr">send_interval:</span> <span class="string">&lt;duration&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="string">1m</span> ]</span><br><span class="line">  <span class="comment"># Maximum number of samples per send.</span></span><br><span class="line">  [ <span class="attr">max_samples_per_send:</span> <span class="string">&lt;int&gt;</span> <span class="string">|</span> <span class="string">default</span> <span class="string">=</span> <span class="number">500</span>]</span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰Remote Storage Adaptorï¼ˆè‡ªå®šä¹‰é€‚é…å™¨ï¼‰</p><p>è¯¦æƒ…è§ï¼š<a href="https://www.bookstack.cn/read/prometheus-book/ha-prometheus-remote-storage.md">https://www.bookstack.cn/read/prometheus-book/ha-prometheus-remote-storage.md</a></p><p>ç›®å‰Prometheusç¤¾åŒºä¹Ÿæä¾›äº†éƒ¨åˆ†å¯¹äºç¬¬ä¸‰æ–¹æ•°æ®åº“çš„Remote Storageæ”¯æŒï¼š<br><img src="https://s2.loli.net/2022/01/10/oOcUiTAahxPEg1Q.png" alt="20220110225757"></p><p>è‡ªå®šä¹‰Remote Storage Adaptorï¼ˆè‡ªå®šä¹‰é€‚é…å™¨ï¼‰ä»¥åŠ ä½¿ç”¨Influxdbä½œä¸ºRemote Storageçš„æ¡ˆä¾‹</p><p>è¯¦æƒ…è§ï¼š<a href="https://www.bookstack.cn/read/prometheus-book/ha-prometheus-remote-storage.md">https://www.bookstack.cn/read/prometheus-book/ha-prometheus-remote-storage.md</a></p><h3 id="Prometheus-é«˜å¯ç”¨éƒ¨ç½²æ–¹æ¡ˆ"><a href="#Prometheus-é«˜å¯ç”¨éƒ¨ç½²æ–¹æ¡ˆ" class="headerlink" title="Prometheus é«˜å¯ç”¨éƒ¨ç½²æ–¹æ¡ˆ"></a>Prometheus é«˜å¯ç”¨éƒ¨ç½²æ–¹æ¡ˆ</h3><p>Prometheusçš„æœ¬åœ°å­˜å‚¨ç»™Prometheuså¸¦æ¥äº†ç®€å•é«˜æ•ˆçš„ä½¿ç”¨ä½“éªŒï¼Œå¯ä»¥è®©Promthuesåœ¨å•èŠ‚ç‚¹çš„æƒ…å†µä¸‹æ»¡è¶³å¤§éƒ¨åˆ†ç”¨æˆ·çš„ç›‘æ§éœ€æ±‚ã€‚ä½†æ˜¯æœ¬åœ°å­˜å‚¨ä¹ŸåŒæ—¶é™åˆ¶äº†Prometheusçš„å¯æ‰©å±•æ€§ï¼Œå¸¦æ¥äº†æ•°æ®æŒä¹…åŒ–ç­‰ä¸€ç³»åˆ—çš„é—®é¢˜ã€‚é€šè¿‡Prometheusçš„Remote Storageç‰¹æ€§å¯ä»¥è§£å†³è¿™ä¸€ç³»åˆ—é—®é¢˜ï¼ŒåŒ…æ‹¬Promthuesçš„åŠ¨æ€æ‰©å±•ï¼Œä»¥åŠå†å²æ•°æ®çš„å­˜å‚¨ã€‚</p><p>è€Œé™¤äº†æ•°æ®æŒä¹…åŒ–é—®é¢˜ä»¥å¤–ï¼Œå½±å“Promthuesæ€§èƒ½è¡¨ç°çš„å¦å¤–ä¸€ä¸ªé‡è¦å› ç´ å°±æ˜¯æ•°æ®é‡‡é›†ä»»åŠ¡é‡ï¼Œä»¥åŠå•å°Promthuesèƒ½å¤Ÿå¤„ç†çš„æ—¶é—´åºåˆ—æ•°ã€‚å› æ­¤å½“ç›‘æ§è§„æ¨¡å¤§åˆ°Promthueså•å°æ— æ³•æœ‰æ•ˆå¤„ç†çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€‰æ‹©åˆ©ç”¨Promthuesçš„è”é‚¦é›†ç¾¤çš„ç‰¹æ€§ï¼Œå°†Promthuesçš„ç›‘æ§ä»»åŠ¡åˆ’åˆ†åˆ°ä¸åŒçš„å®ä¾‹å½“ä¸­ã€‚</p><h3 id="åŸºæœ¬HAï¼šæœåŠ¡å¯ç”¨æ€§"><a href="#åŸºæœ¬HAï¼šæœåŠ¡å¯ç”¨æ€§" class="headerlink" title="åŸºæœ¬HAï¼šæœåŠ¡å¯ç”¨æ€§"></a>åŸºæœ¬HAï¼šæœåŠ¡å¯ç”¨æ€§</h3><p>ç”±äºPromthuesçš„Pullæœºåˆ¶çš„è®¾è®¡ï¼Œä¸ºäº†ç¡®ä¿PromthuesæœåŠ¡çš„å¯ç”¨æ€§ï¼Œç”¨æˆ·åªéœ€è¦éƒ¨ç½²å¤šå¥—Prometheus Serverå®ä¾‹ï¼Œå¹¶ä¸”é‡‡é›†ç›¸åŒçš„Exporterç›®æ ‡å³å¯ã€‚</p><p><img src="https://s2.loli.net/2022/01/11/xDUuMBghdOrAY3z.png" alt="20220111102211"></p><p>åŸºæœ¬çš„HAæ¨¡å¼åªèƒ½ç¡®ä¿PromthuesæœåŠ¡çš„å¯ç”¨æ€§é—®é¢˜ï¼Œä½†æ˜¯ä¸è§£å†³Prometheus Serverä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ä»¥åŠæŒä¹…åŒ–é—®é¢˜(æ•°æ®ä¸¢å¤±åæ— æ³•æ¢å¤)ï¼Œä¹Ÿæ— æ³•è¿›è¡ŒåŠ¨æ€çš„æ‰©å±•ã€‚å› æ­¤è¿™ç§éƒ¨ç½²æ–¹å¼é€‚åˆç›‘æ§è§„æ¨¡ä¸å¤§ï¼ŒPromthues Serverä¹Ÿä¸ä¼šé¢‘ç¹å‘ç”Ÿè¿ç§»çš„æƒ…å†µï¼Œå¹¶ä¸”åªéœ€è¦ä¿å­˜çŸ­å‘¨æœŸç›‘æ§æ•°æ®çš„åœºæ™¯ã€‚</p><h3 id="åŸºæœ¬HA-è¿œç¨‹å­˜å‚¨"><a href="#åŸºæœ¬HA-è¿œç¨‹å­˜å‚¨" class="headerlink" title="åŸºæœ¬HA + è¿œç¨‹å­˜å‚¨"></a>åŸºæœ¬HA + è¿œç¨‹å­˜å‚¨</h3><p>åœ¨åŸºæœ¬HAæ¨¡å¼çš„åŸºç¡€ä¸Šé€šè¿‡æ·»åŠ Remote Storageå­˜å‚¨æ”¯æŒï¼Œå°†ç›‘æ§æ•°æ®ä¿å­˜åœ¨ç¬¬ä¸‰æ–¹å­˜å‚¨æœåŠ¡ä¸Šã€‚</p><p><img src="https://s2.loli.net/2022/01/11/Bis1wHDNqLT2mEv.png" alt="20220111102237"></p><p>åœ¨è§£å†³äº†PromthuesæœåŠ¡å¯ç”¨æ€§çš„åŸºç¡€ä¸Šï¼ŒåŒæ—¶ç¡®ä¿äº†æ•°æ®çš„æŒä¹…åŒ–ï¼Œå½“Promthues Serverå‘ç”Ÿå®•æœºæˆ–è€…æ•°æ®ä¸¢å¤±çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å¿«é€Ÿçš„æ¢å¤ã€‚ åŒæ—¶Promthues Serverå¯èƒ½å¾ˆå¥½çš„è¿›è¡Œè¿ç§»ã€‚å› æ­¤ï¼Œè¯¥æ–¹æ¡ˆé€‚ç”¨äºç”¨æˆ·ç›‘æ§è§„æ¨¡ä¸å¤§ï¼Œä½†æ˜¯å¸Œæœ›èƒ½å¤Ÿå°†ç›‘æ§æ•°æ®æŒä¹…åŒ–ï¼ŒåŒæ—¶èƒ½å¤Ÿç¡®ä¿Promthues Serverçš„å¯è¿ç§»æ€§çš„åœºæ™¯ã€‚</p><h3 id="åŸºæœ¬HA-è¿œç¨‹å­˜å‚¨-è”é‚¦é›†ç¾¤"><a href="#åŸºæœ¬HA-è¿œç¨‹å­˜å‚¨-è”é‚¦é›†ç¾¤" class="headerlink" title="åŸºæœ¬HA + è¿œç¨‹å­˜å‚¨ + è”é‚¦é›†ç¾¤"></a>åŸºæœ¬HA + è¿œç¨‹å­˜å‚¨ + è”é‚¦é›†ç¾¤</h3><p>å½“å•å°Promthues Serveræ— æ³•å¤„ç†å¤§é‡çš„é‡‡é›†ä»»åŠ¡æ—¶ï¼Œç”¨æˆ·å¯ä»¥è€ƒè™‘åŸºäºPrometheusè”é‚¦é›†ç¾¤çš„æ–¹å¼å°†ç›‘æ§é‡‡é›†ä»»åŠ¡åˆ’åˆ†åˆ°ä¸åŒçš„Promthueså®ä¾‹å½“ä¸­å³åœ¨ä»»åŠ¡çº§åˆ«åŠŸèƒ½åˆ†åŒºã€‚<br><img src="https://s2.loli.net/2022/01/11/6DW5ZoFQC41qr3w.png" alt="20220111102254"></p><p>è¿™ç§éƒ¨ç½²æ–¹å¼ä¸€èˆ¬é€‚ç”¨äºä¸¤ç§åœºæ™¯ï¼š</p><p>åœºæ™¯ä¸€ï¼šå•æ•°æ®ä¸­å¿ƒ + å¤§é‡çš„é‡‡é›†ä»»åŠ¡</p><p>è¿™ç§åœºæ™¯ä¸‹Promthuesçš„æ€§èƒ½ç“¶é¢ˆä¸»è¦åœ¨äºå¤§é‡çš„é‡‡é›†ä»»åŠ¡ï¼Œå› æ­¤ç”¨æˆ·éœ€è¦åˆ©ç”¨Prometheusè”é‚¦é›†ç¾¤çš„ç‰¹æ€§ï¼Œå°†ä¸åŒç±»å‹çš„é‡‡é›†ä»»åŠ¡åˆ’åˆ†åˆ°ä¸åŒçš„Promthueså­æœåŠ¡ä¸­ï¼Œä»è€Œå®ç°åŠŸèƒ½åˆ†åŒºã€‚ä¾‹å¦‚ä¸€ä¸ªPromthues Serverè´Ÿè´£é‡‡é›†åŸºç¡€è®¾æ–½ç›¸å…³çš„ç›‘æ§æŒ‡æ ‡ï¼Œå¦å¤–ä¸€ä¸ªPrometheus Serverè´Ÿè´£é‡‡é›†åº”ç”¨ç›‘æ§æŒ‡æ ‡ã€‚å†æœ‰ä¸Šå±‚Prometheus Serverå®ç°å¯¹æ•°æ®çš„æ±‡èšã€‚</p><p>åœºæ™¯äºŒï¼šå¤šæ•°æ®ä¸­å¿ƒ</p><p>è¿™ç§æ¨¡å¼ä¹Ÿé€‚åˆä¸å¤šæ•°æ®ä¸­å¿ƒçš„æƒ…å†µï¼Œå½“Promthues Serveræ— æ³•ç›´æ¥ä¸æ•°æ®ä¸­å¿ƒä¸­çš„Exporterè¿›è¡Œé€šè®¯æ—¶ï¼Œåœ¨æ¯ä¸€ä¸ªæ•°æ®ä¸­éƒ¨ç½²ä¸€ä¸ªå•ç‹¬çš„Promthues Serverè´Ÿè´£å½“å‰æ•°æ®ä¸­å¿ƒçš„é‡‡é›†ä»»åŠ¡æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹å¼ã€‚è¿™æ ·å¯ä»¥é¿å…ç”¨æˆ·è¿›è¡Œå¤§é‡çš„ç½‘ç»œé…ç½®ï¼Œåªéœ€è¦ç¡®ä¿ä¸»Promthues Serverå®ä¾‹èƒ½å¤Ÿä¸å½“å‰æ•°æ®ä¸­å¿ƒçš„Prometheus Serveré€šè®¯å³å¯ã€‚ ä¸­å¿ƒPromthues Serverè´Ÿè´£å®ç°å¯¹å¤šæ•°æ®ä¸­å¿ƒæ•°æ®çš„èšåˆã€‚</p><h3 id="å‘Šè­¦å¤„ç†Alertmanager"><a href="#å‘Šè­¦å¤„ç†Alertmanager" class="headerlink" title="å‘Šè­¦å¤„ç†Alertmanager"></a>å‘Šè­¦å¤„ç†Alertmanager</h3><p>å¦‚ä¸‹æ‰€ç¤ºï¼Œé€šè¿‡åœ¨Prometheusä¸­å®šä¹‰AlertRuleï¼ˆå‘Šè­¦è§„åˆ™ï¼‰ï¼ŒPrometheusä¼šå‘¨æœŸæ€§çš„å¯¹å‘Šè­¦è§„åˆ™è¿›è¡Œè®¡ç®—ï¼Œå¦‚æœæ»¡è¶³å‘Šè­¦è§¦å‘æ¡ä»¶å°±ä¼šå‘Alertmanagerå‘é€å‘Šè­¦ä¿¡æ¯ã€‚<br><img src="https://s2.loli.net/2022/01/10/8cJPyEwRiqXGOFL.png" alt="20220110225920"></p><h3 id="è‡ªå®šä¹‰Prometheuså‘Šè­¦è§„åˆ™"><a href="#è‡ªå®šä¹‰Prometheuså‘Šè­¦è§„åˆ™" class="headerlink" title="è‡ªå®šä¹‰Prometheuså‘Šè­¦è§„åˆ™"></a>è‡ªå®šä¹‰Prometheuså‘Šè­¦è§„åˆ™</h3><p>å®šä¹‰å‘Šè­¦è§„åˆ™ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">groups:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">example</span></span><br><span class="line">    <span class="attr">rules:</span>  <span class="comment"># Alert for any instance that is unreachable for &gt;5 minutes.  </span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">InstanceDown</span>    </span><br><span class="line">        <span class="attr">expr:</span> <span class="string">up</span> <span class="string">==</span> <span class="number">0</span>    </span><br><span class="line">        <span class="attr">for:</span> <span class="string">5m</span>    </span><br><span class="line">        <span class="attr">labels:</span>      </span><br><span class="line">        <span class="attr">severity:</span> <span class="string">page</span>    </span><br><span class="line">        <span class="attr">annotations:</span>      </span><br><span class="line">        <span class="attr">summary:</span> <span class="string">&quot;Instance <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span> down&quot;</span>      </span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span> of job <span class="template-variable">&#123;&#123; $labels.job &#125;&#125;</span> has been down for more than 5 minutes.&quot;</span>  <span class="comment"># Alert for any instance that has a median request latency &gt;1s.  </span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">alert:</span> <span class="string">APIHighRequestLatency</span>    </span><br><span class="line">        <span class="attr">expr:</span> <span class="string">api_http_request_latencies_second&#123;quantile=&quot;0.5&quot;&#125;</span> <span class="string">&gt;</span> <span class="number">1</span>    </span><br><span class="line">        <span class="attr">for: 10m    annotations:</span>      </span><br><span class="line">        <span class="attr">summary:</span> <span class="string">&quot;High request latency on <span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span>&quot;</span>      </span><br><span class="line">        <span class="attr">description:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; $labels.instance &#125;&#125;</span> has a median request latency above 1s (current value: <span class="template-variable">&#123;&#123; $value &#125;&#125;</span>s)&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨å‘Šè­¦è§„åˆ™æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸€ç»„ç›¸å…³çš„è§„åˆ™è®¾ç½®å®šä¹‰åœ¨ä¸€ä¸ªgroupä¸‹ã€‚åœ¨æ¯ä¸€ä¸ªgroupä¸­æˆ‘ä»¬å¯ä»¥å®šä¹‰å¤šä¸ªå‘Šè­¦è§„åˆ™(rule)ã€‚ä¸€æ¡å‘Šè­¦è§„åˆ™ä¸»è¦ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>alertï¼šå‘Šè­¦è§„åˆ™çš„åç§°ã€‚</li><li>exprï¼šåŸºäºPromQLè¡¨è¾¾å¼å‘Šè­¦è§¦å‘æ¡ä»¶ï¼Œç”¨äºè®¡ç®—æ˜¯å¦æœ‰æ—¶é—´åºåˆ—æ»¡è¶³è¯¥æ¡ä»¶ã€‚</li><li>forï¼šè¯„ä¼°ç­‰å¾…æ—¶é—´ï¼Œå¯é€‰å‚æ•°ã€‚ç”¨äºè¡¨ç¤ºåªæœ‰å½“è§¦å‘æ¡ä»¶æŒç»­ä¸€æ®µæ—¶é—´åæ‰å‘é€å‘Šè­¦ã€‚åœ¨ç­‰å¾…æœŸé—´æ–°äº§ç”Ÿå‘Šè­¦çš„çŠ¶æ€ä¸ºpendingã€‚</li><li>labelsï¼šè‡ªå®šä¹‰æ ‡ç­¾ï¼Œå…è®¸ç”¨æˆ·æŒ‡å®šè¦é™„åŠ åˆ°å‘Šè­¦ä¸Šçš„ä¸€ç»„é™„åŠ æ ‡ç­¾ã€‚</li><li>annotationsï¼šç”¨äºæŒ‡å®šä¸€ç»„é™„åŠ ä¿¡æ¯ï¼Œæ¯”å¦‚ç”¨äºæè¿°å‘Šè­¦è¯¦ç»†ä¿¡æ¯çš„æ–‡å­—ç­‰ï¼Œannotationsçš„å†…å®¹åœ¨å‘Šè­¦äº§ç”Ÿæ—¶ä¼šä¸€åŒä½œä¸ºå‚æ•°å‘é€åˆ°Alertmanagerã€‚</li></ul><h3 id="ç›‘æ§æ•°æ®çš„å¯è§†åŒ–"><a href="#ç›‘æ§æ•°æ®çš„å¯è§†åŒ–" class="headerlink" title="ç›‘æ§æ•°æ®çš„å¯è§†åŒ–"></a>ç›‘æ§æ•°æ®çš„å¯è§†åŒ–</h3><h3 id="Prometheusè‡ªå¸¦çš„æ•°æ®å¯è§†åŒ–ç•Œé¢"><a href="#Prometheusè‡ªå¸¦çš„æ•°æ®å¯è§†åŒ–ç•Œé¢" class="headerlink" title="Prometheusè‡ªå¸¦çš„æ•°æ®å¯è§†åŒ–ç•Œé¢"></a>Prometheusè‡ªå¸¦çš„æ•°æ®å¯è§†åŒ–ç•Œé¢</h3><p><a href="http://172.26.65.49:9090/graph">http://172.26.65.49:9090/graph</a></p><p>ä¾‹å­ï¼šæŒ‡æ ‡ prometheus_http_requests_total<br><img src="https://s2.loli.net/2022/01/10/7MBT8fGxvpcukt3.png" alt="20220110230003"></p><h3 id="ä½¿ç”¨Grafanaå±•ç¤ºæ•°æ®"><a href="#ä½¿ç”¨Grafanaå±•ç¤ºæ•°æ®" class="headerlink" title="ä½¿ç”¨Grafanaå±•ç¤ºæ•°æ®"></a>ä½¿ç”¨Grafanaå±•ç¤ºæ•°æ®</h3><p><a href="http://172.26.65.49:3000/?orgId=1">http://172.26.65.49:3000/?orgId=1</a><br><img src="https://s2.loli.net/2022/01/10/lQte3FBZvSaVf8R.png" alt="20220110230024"></p><p>ç½‘å›¾ï¼š</p><p><img src="https://img-blog.csdnimg.cn/20210713100126346.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzUwNzQxMA==,size_16,color_FFFFFF,t_70" alt="https://img-blog.csdnimg.cn/20210713100126346.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzUwNzQxMA==,size_16,color_FFFFFF,t_70"></p><p>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</p><h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹"></a>æ¡ˆä¾‹</h2><h3 id="ç›‘æ§Mysql"><a href="#ç›‘æ§Mysql" class="headerlink" title="ç›‘æ§Mysql"></a>ç›‘æ§Mysql</h3><p>å‰ææ¡ä»¶ï¼š</p><ol><li>prometheuså’Œgrafanaç¯å¢ƒå·²æ­å»º</li><li>dockerç¯å¢ƒå·²æ­å»º</li><li>mysqld-exporter æ‰€éƒ¨ç½²çš„æœºå™¨ä¸Šéœ€è¦å­˜åœ¨ mysqlå®ä¾‹</li></ol><p>æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li>ä¸‹è½½ <strong>prom/mysqld-exporter</strong> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull prom/mysqld-exporter</span><br></pre></td></tr></table></figure></li><li>åœ¨grafanaä¸Šä¸‹è½½mysqlç›‘æ§æ•°æ®å±•ç¤ºæ¨¡æ¿ ï¼ˆIDï¼š11323ï¼‰ <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://grafana.com/grafana/dashboards/11323</span><br></pre></td></tr></table></figure></li><li>è¿è¡Œmysqld-exporter <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d  --name mysql_exporter   --restart always  -e DATA_SOURCE_NAME=&#x27;root:root$123@(172.26.65.49:3306)/&#x27; --network host  prom/mysqld-exporter</span><br></pre></td></tr></table></figure></li><li>åœ¨prometheusçš„é…ç½®ä¸­æ·»åŠ  mysql_exporter çš„job <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">job_name:</span> <span class="string">&#x27;MySQL&#x27;</span>    </span><br><span class="line">   <span class="attr">static_configs:</span>      </span><br><span class="line">       <span class="bullet">-</span> <span class="attr">targets:</span> [<span class="string">&#x27;172.26.65.49:9104&#x27;</span>]        </span><br><span class="line">       <span class="attr">labels:</span>          </span><br><span class="line">       <span class="attr">instance:</span> <span class="number">172.26</span><span class="number">.65</span><span class="number">.49</span><span class="string">:3306</span>    </span><br><span class="line">       <span class="attr">metrics_path:</span> <span class="string">&#x27;/metrics&#x27;</span></span><br></pre></td></tr></table></figure> <img src="https://s2.loli.net/2022/01/10/ZC3JpAKfBLTvihF.png" alt="20220110230129"></li><li>é‡å¯prometheus</li></ol><p>æ•°æ®å±•ç¤ºï¼š<br><img src="https://s2.loli.net/2022/01/10/ozgLXB3p8kZ5tDm.png" alt="20220110230146"></p><p><img src="https://s2.loli.net/2022/01/10/A5vSMPGzU3Fjrhb.png" alt="20220110230202"></p><p><img src="https://s2.loli.net/2022/01/10/v1yXg4aoTQ3i5fZ.png" alt="20220110230224"></p><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><h3 id="ä»€ä¹ˆæ˜¯æ—¶åºæ•°æ®åº“ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ—¶åºæ•°æ®åº“ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ—¶åºæ•°æ®åº“ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯æ—¶åºæ•°æ®åº“ï¼Ÿ</h3><p>æ—¶é—´åºåˆ—æ•°æ®åº“ä¸»è¦ç”¨äºæŒ‡å¤„ç†å¸¦æ—¶é—´æ ‡ç­¾ï¼ˆæŒ‰ç…§æ—¶é—´çš„é¡ºåºå˜åŒ–ï¼Œå³æ—¶é—´åºåˆ—åŒ–ï¼‰çš„æ•°æ®ï¼Œå¸¦æ—¶é—´æ ‡ç­¾çš„æ•°æ®ä¹Ÿç§°ä¸ºæ—¶é—´åºåˆ—æ•°æ®ã€‚</p><p>ä¾‹å¦‚ï¼šInfluxDB ã€ ElasticSearch ç­‰</p><p>eså­˜æ—¶åºæ•°æ®å¦‚ä¸‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;results&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;series&quot;</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;cpu_load_short&quot;</span>,</span><br><span class="line">                    <span class="attr">&quot;columns&quot;</span>: [</span><br><span class="line">                        <span class="string">&quot;time&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;value&quot;</span></span><br><span class="line">                    ],</span><br><span class="line">                    <span class="attr">&quot;values&quot;</span>: [</span><br><span class="line">                        [</span><br><span class="line">                            <span class="string">&quot;2015-06-11T20:46:02Z&quot;</span>,</span><br><span class="line">                            <span class="number">0.64</span></span><br><span class="line">                        ]</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> prometheus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> prometheus </tag>
            
            <tag> äº‘ç›‘æ§ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
